!function t(e,i,o){function l(r,h){if(!i[r]){if(!e[r]){var s="function"==typeof require&&require;if(!h&&s)return s(r,!0);if(n)return n(r,!0);var a=new Error("Cannot find module '"+r+"'");throw a.code="MODULE_NOT_FOUND",a}var g=i[r]={exports:{}};e[r][0].call(g.exports,function(t){return l(e[r][1][t]||t)},g,g.exports,t,e,i,o)}return i[r].exports}for(var n="function"==typeof require&&require,r=0;r<o.length;r++)l(o[r]);return l}({1:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const o=t("./mapGenerationFunctions.component"),l=t("./config.component"),n=t("./enums/tile-type.enum"),r=t("./renderelements.component");i.Renderer=class{constructor(){this.config=new l.Config,this.calculations=new o.MapGenerationFunctions,this.render=new r.RenderElements}showData(t){let e='<div class="showData">';return e+=`map width: ${t.mapWidth} tiles<br>map length: ${t.mapLength} tiles<br>`,e+=`tile width: ${this.config.tileWidth}<br>tile length: ${this.config.tileLength}<br>`,e+="</div>"}build2DMap(t){let e=`<div class="map" style="width:${this.config.getMapWidth(t.mapWidth+1)}px;">`;e+=`<div class="tile axis" style="width:${this.config.tileWidth}px;height:${this.config.tileLength}px;"></div>`;for(let i=0;i<t.mapWidth;i++)e+=`<div class="tile axis" style="width:${this.config.tileWidth}px;height:${this.config.tileLength}px;">${i}</div>`;for(let i=0;i<t.mapLength;i++){let o="";i===Math.round(t.mapLength/2)&&(o=" half"),e+=`<div class="tile axis${o}" style="width:${this.config.tileWidth}px;height:${this.config.tileLength}px;">${i}</div>`;for(let l=0;l<t.mapWidth;l++)if(e+=`<div data-y="${i}" data-x="${l}" class="tile${o}" style="width:${this.config.tileWidth}px;height:${this.config.tileLength}px;`,t.getColumn(l,i).isDefined&&t.getTopTile(l,i)){let o=t.getTopTile(l,i).getColor().rgb(),r=`rgb(${o.r}, ${o.g}, ${o.b})`,h=!1;for(let e=0;e<t.map[i][l].height;e++)if(t.map[i][l].tileStack[e].type===n.TileType.None){h=!0;break}let s=!!(t.map[i][l].edge.top||t.map[i][l].edge.right||t.map[i][l].edge.bottom||t.map[i][l].edge.left),a=t.map[i][l].blockGroup;e+=`background-color:${r}">${h?"x":""}<div class="tileInfo">x: ${l} y: ${i}<br>height: ${t.map[i][l].height}<br>edge: ${s}<br>group: ${a}</div></div>`}else e+='"></div>'}return e+="</div>"}buildMap(t){let e=t.mapWidth,i=t.mapLength;const o=this.config.tileHeight,l=this.config.lightInWindows;console.log("windowLights",l);let r=this.render.createTile(0,0,""),h=(r.coords.bottom.x,r.coords.top.x,r.coords.right.y-r.coords.left.y),s=r.coords.top.x-r.coords.left.x,a=r.coords.right.x-r.coords.top.x,g=r.coords.right.y,d=g*e,c=(r.coords.bottom.y-r.coords.right.y)*i,u=Math.round((s+a)*e),p=Math.round(d+c)+this.config.topMargin;const $=this.config.groundColor.changeColorLighting(-20),f=t.map;let m='<svg width="'+u+'" height="'+p+'">',b=null,y=s*(e-1);const _=Math.floor(5*Math.random()),x=Math.floor(5*Math.random());let L="";1===_?L="triangles":3===_&&(L="squares");for(let t=0;t<i;t++)for(let r=0;r<e;r++){let a=0,d=0;0===r&&0===t&&(d=y),null!=b&&(a=b.coords.right.y),t>0&&0===r&&(d=y-s*t,a=g*t-h*t),r>0&&(d=b.coords.right.x-(b.coords.right.x-b.coords.bottom.x));let c=this.render.createTile(d,a,"shade"),u="";if(f[t][r].isDefined){if(f[t][r].tileStack[0].type===n.TileType.Shadow){let e=$;u+=this.render.createPlane(d,a,f[t][r].tileStack[0],e).html}else if(f[t][r].tileStack[0].type===n.TileType.Grass){let e=f[t][r].tileStack[0].tileColor;u+=this.render.createPlane(d,a,f[t][r].tileStack[0],e).html}if(0===f[t][r].height&&f[t][r].tileStack[0].type===n.TileType.None&&""!==f[t][r].tileStack[0].options.areaDecoration&&"tree"===f[t][r].tileStack[0].options.areaDecoration){u+=this.render.createTree(d,a).html,console.log("tree placed at y: "+t+", x: "+r)}if(f[t][r].height>0){u+=this.render.createPlane(d,a,f[t][r].tileStack[0],$).html;let h=!1;for(let s=0;s<f[t][r].height;s++){let g,c=f[t][r].tileStack[s];if((g=c.options?c.options:{roof:!1,pillar:!1,slope:!1,windowed:0,tower:!1,stairs:!1,halfArch:!1,wholeArch:!1}).slope&&(h=!0),c.type===n.TileType.Body){if(c.options.slope){u+=this.render.createSlopeBlock(d,a+4.75*o,f[t][r].getTile(s),"e").html}else if(!h){let e="";if(f[t][r].blockGroup%2==1&&s===f[t][r].height-1&&(e=L,x>2&&(1===_?e="triangles":3===_&&(e="squares"))),u+=this.render.createBlock(d,a-o,c,e).html,c.options.windowed>0){if((f[t][r].edge.right||f[t][r].edge.bottom)&&Math.round(6*Math.random())>4){u+=this.render.createWindow(d,a-o,c,f[t][r],l).html}if(f[t][r].edge.bottom&&(s===f[t+1][r].height||0===s)&&Math.round(10*Math.random())>8){u+=this.render.createDoor(d,a-o,c,f[t][r],"bottom").html}else if(f[t][r].edge.right&&(s===f[t][r+1].height||0===s)&&Math.round(10*Math.random())>8){u+=this.render.createDoor(d,a-o,c,f[t][r],"right").html}}}}else if(g.tower||c.type!==n.TileType.HalfBlock){if(!g.tower&&c.type===n.TileType.None){if(c.options.pillar&&s<f[t][r].height&&(t<i/2-1||t>i/2)){u+=this.render.createPillarBlock(d,a-o,c).html}if(c.options.halfArch&&t>1&&t<i-1)if(f[t+1][r].isDefined&&f[t+1][r].height>0&&f[t+1][r].height>s&&f[t+1][r].tileStack[s].type===n.TileType.None){u+=this.render.createHalfArch(d,a-o,c,"right-top").html}else if(f[t-1][r].isDefined&&f[t-1][r].height>0&&f[t-1][r].height>s&&f[t-1][r].tileStack[s].type===n.TileType.None){u+=this.render.createHalfArch(d,a-o,c,"right-bottom").html}}}else{u+=this.render.createHalfBlock(d,a-o,c).html}if(s===f[t][r].height-1&&c.options.tower){let l="";if(t>0&&t<i&&r<e&&(f[t-1][r].tileStack[s]&&f[t-1][r].tileStack[s].options.tower&&(l="se"),f[t+1][r].tileStack[s]&&f[t+1][r].tileStack[s].options.tower&&(l="ne"),""!==l)){u+=this.render.createSlopeBlock(d,a=o,c,l).html}}}}}m+=u,b=c}return'<div id="debug"></div>'+(m+="</svg>")}addSlopedEdges(t,e,i,o,l,n){let r=null;return r=t[i][e].edge.top&&!t[i][e].corner&&o===t[i][e].height-1?this.render.createSlopeBlock(l,n-this.config.tileHeight,t[i][e].getTile(o),"n"):t[i][e].edge.bottom&&!t[i][e].corner&&o===t[i][e].height-1?this.render.createSlopeBlock(l,n-this.config.tileHeight,t[i][e].getTile(o),"s"):t[i][e].edge.right&&!t[i][e].corner&&o===t[i][e].height-1?this.render.createSlopeBlock(l,n-this.config.tileHeight,t[i][e].getTile(o),"e"):t[i][e].edge.left&&!t[i][e].corner&&o===t[i][e].height-1?this.render.createSlopeBlock(l,n-this.config.tileHeight,t[i][e].getTile(o),"w"):this.render.createBlock(l,n-this.config.tileHeight,t[i][e].getTile(o)),t[i][e].corner&&o===t[i][e].height-1&&(t[i][e].edge.top&&t[i][e].edge.left?r=this.render.createSlopeBlock(l,n-this.config.tileHeight,t[i][e].getTile(o),"nw"):t[i][e].edge.top&&t[i][e].edge.right?r=this.render.createSlopeBlock(l,n-this.config.tileHeight,t[i][e].getTile(o),"ne"):t[i][e].edge.bottom&&t[i][e].edge.left?r=this.render.createSlopeBlock(l,n-this.config.tileHeight,t[i][e].getTile(o),"sw"):t[i][e].edge.bottom&&t[i][e].edge.right&&(r=this.render.createSlopeBlock(l,n-this.config.tileHeight,t[i][e].getTile(o),"se"))),r}}},{"./config.component":4,"./enums/tile-type.enum":7,"./mapGenerationFunctions.component":17,"./renderelements.component":21}],2:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});i.Color=class{constructor(...t){let e=null;if(1===t.length)if("string"==typeof t[0])if(this.validateHex(t[0])){let e=t[0];"#"!==e.charAt(0)&&(e=`#${e}`),this.setHex(e),this.hexToRgb(),this.convertToHSL()}else e="Hexadecimal color is incorrect";else e="Length of 1 in parameters is not equal to string";else 3===t.length&&(this.validateRgb(t)?(this.setRgb(t[0],t[1],t[2]),this.rgbToHex(),this.convertToHSL()):e="Values of RGB exceed limits");if(null!==e)throw"Color type is incorrect. "+e+": "+t.toString()}setRgb(t,e,i){this._colorRgb={r:t,g:e,b:i}}setHsl(t,e,i){this._colorHsl={h:t,s:e,l:i}}setHex(t){if(t.length<7){let e=t.charAt(1),i=t.charAt(2),o=t.charAt(3);t="#"+e+e+i+i+o+o}this._colorHex=t}rgb(){return this._colorRgb}hex(){return this._colorHex}hsl(){return this._colorHsl}validateRgb(t){return t[0]>-1&&t[0]<256&&t[1]>-1&&t[1]<256&&t[2]>-1&&t[2]<256}validateHex(t){return!!t.match(/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/)}hexToRgb(){let t=this._colorHex.substr(1).split(""),e=parseInt(t[0]+t[1],16),i=parseInt(t[2]+t[3],16),o=parseInt(t[4]+t[5],16);this.setRgb(e,i,o),this.rgbToHex()}rgbToHex(){if("object"==typeof this._colorRgb){let t=this._colorRgb.r,e=this._colorRgb.b,i=this._colorRgb.g,o=Number(t).toString(16),l=Number(i).toString(16),n=Number(e).toString(16);this._colorHex="#"+o+l+n}}convertRGBtoHex(t){let e=t.r,i=t.b,o=t.g;return"#"+Number(e).toString(16)+Number(o).toString(16)+Number(i).toString(16)}changeColorLightingString(t){let e=this._colorRgb.r,i=this._colorRgb.b,o=e+t,l=this._colorRgb.g+t,n=i+(t-8);return o>255&&(o=255),l>255&&(l=255),o>255&&(o=255),"#"+Number(o).toString(16)+Number(l).toString(16)+Number(n).toString(16)}changeColorLighting(t){let e=this._colorRgb.r,i=(this._colorRgb.b,e+t),o=this._colorRgb.g+t;return i>255&&(i=255),o>255&&(o=255),i>255&&(i=255),this.setRgb(i,o,i),this.rgbToHex(),this.convertToHSL(),this}getColorStringByHue(t){let e=this._colorHsl.h,i=this._colorHsl.s,o=this._colorHsl.l,l=e+t;l>360&&(l%=360);let n=this.convertHSLtoRGB({h:l,s:i,l:o});return this.convertRGBtoHex(n)}getColorByHue(t){let e=this._colorHsl.h,i=this._colorHsl.s,o=this._colorHsl.l,l=e+t;l>360&&(l%=360);let n=this.convertHSLtoRGB({h:l,s:i,l:o});return this.setRgb(n.r,n.g,n.b),this.rgbToHex(),this}convertToHSL(){let t=this._colorRgb.r,e=this._colorRgb.b,i=this._colorRgb.g;t/=255,i/=255,e/=255;let o=Math.min(t,i,e),l=Math.max(t,i,e),n=l-o,r=0,h=0,s=0;r=0===n?0:l===t?(i-e)/n%6:l===i?(e-t)/n+2:(t-i)/n+4,(r=Math.round(60*r))<0&&(r+=360),s=(l+o)/2,h=+(100*(h=0===n?0:n/(1-Math.abs(2*s-1)))).toFixed(1),s=+(100*s).toFixed(1),this._colorHsl={h:r,s:h,l:s}}convertHSLtoRGB(t){let e=t.h,i=t.s,o=t.l;i/=100,o/=100;let l=(1-Math.abs(2*o-1))*i,n=l*(1-Math.abs(e/60%2-1)),r=o-l/2,h=0,s=0,a=0;return 0<=e&&e<60?(h=l,s=n,a=0):60<=e&&e<120?(h=n,s=l,a=0):120<=e&&e<180?(h=0,s=l,a=n):180<=e&&e<240?(h=0,s=n,a=l):240<=e&&e<300?(h=n,s=0,a=l):300<=e&&e<360&&(h=l,s=0,a=n),{r:h=Math.round(255*(h+r)),g:s=Math.round(255*(s+r)),b:a=Math.round(255*(a+r))}}}},{}],3:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});i.Column=class{constructor(t,e,i,o){this.defined=t,this.colX=e,this.colY=i,this.colHeight=o,this._edge={top:!1,right:!1,bottom:!1,left:!1},this._tileStack=[],this._defined=t,this._x=e,this._y=i,this._height=o}set x(t){this._x=t}set y(t){this._y=t}set height(t){this._height=t}set blockGroup(t){this._blockGroup=t}set corner(t){this._corner=t}set edge(t){this._edge=t}set tileStack(t){this._tileStack=t}get isDefined(){return this._defined}get x(){return this._x}get y(){return this._y}get height(){return this._height}get blockGroup(){return this._blockGroup}get corner(){return this._corner}get edge(){return this._edge}get tileStack(){return this._tileStack}getTile(t){return this._tileStack[t]}removeTopTile(){this._tileStack.pop()}}},{}],4:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const o=t("./colors.component");i.Config=class{constructor(){this._allowDebug=!0,this._tileWidth=16,this._tileLength=16,this._tileHeight=14,this._tileSmallAngle=85,this._tileLargeAngle=100,this._groundColor=new o.Color("#f5f3e5"),this._buildingBaseColor=new o.Color(125+Math.floor(75*Math.random()),125+Math.floor(40*Math.random()),160+Math.floor(30*Math.random())),this._tileEdgeBleed=.3,this._maxAllowedHeight=12,this._topMargin=80,this._allowSurroundingDecorations=!0,this._allowWindows=!1,this._lightInWindows=Math.round(8*Math.random())>6,this._goldenRatio=1.61803399,this._fibonacci=[1,2,3,5,8,13]}get allowDebug(){return this._allowDebug}get tileWidth(){return this._tileWidth}get tileLength(){return this._tileLength}get tileHeight(){return this._tileHeight}get tileSmallAngle(){return this._tileSmallAngle}get tileLargeAngle(){return this._tileLargeAngle}get groundColor(){return this._groundColor}get buildingBaseColor(){return this._buildingBaseColor}get tileEdgeBleed(){return this._tileEdgeBleed}get maxAllowedHeight(){return this._maxAllowedHeight}get topMargin(){return this._topMargin}get lightInWindows(){return this._lightInWindows}get allowWindows(){return this._allowWindows}get allowSurroundingDecorations(){return this._allowSurroundingDecorations}get goldenRatio(){return this._goldenRatio}get fibonacci(){return this._fibonacci}getMapWidth(t){return t*this._tileWidth}getMapLength(t){return t*this._tileLength}}},{"./colors.component":2}],5:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const o=t("./column.component"),l=t("./config.component"),n=t("./tile.component"),r=t("./enums/tile-type.enum");i.Decorations=class{constructor(){this.config=new l.Config}placeRandomTrees(t){const e=Math.floor(6*Math.random()),i=[],l=[];for(let o=0;o<e;o++)i.push(Math.floor(5+Math.random()*(t.mapLength-5)));for(let e=0;e<t.mapLength;e++)if(e>1&&e<t.mapLength-2){let h=0,s=0;i.includes(e)&&i.forEach(t=>{t===e&&h++});for(let i=1;i<t.mapWidth;i++)if(i>2&&i<t.mapWidth-3&&!(t.map[e][i].isDefined||t.map[e-1][i].isDefined||t.map[e+1][i].isDefined||t.map[e][i-2].isDefined||t.map[e][i+2].isDefined)){if(Math.floor(200*Math.random())>160&&s<h&&-1===l.indexOf(i)){let h=new o.Column(!0,i,e,0);h.tileStack=[new n.Tile(1e4+s,i,e,0,r.TileType.None,this.config.groundColor,{roof:!1,pillar:!1,slope:!1,windowed:0,tower:!1,stairs:!1,halfArch:!1,wholeArch:!1,areaDecoration:"tree"})],t.map[e][i]=h,l.push(i),s++}}}return t.map}}},{"./column.component":3,"./config.component":4,"./enums/tile-type.enum":7,"./tile.component":22}],6:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),function(t){t.TallCenter="tallCenter",t.TallSurrounds="tallSurrounds",t.Random="random"}(i.BuildingHeightVariations||(i.BuildingHeightVariations={}))},{}],7:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),function(t){t.None="none",t.Body="body",t.Tower="tower",t.HalfBlock="halfBlock",t.Roof="roof",t.Grass="grass",t.Shadow="shadow"}(i.TileType||(i.TileType={}))},{}],8:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0})},{}],9:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0})},{}],10:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0})},{}],11:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0})},{}],12:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0})},{}],13:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0})},{}],14:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0})},{}],15:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0})},{}],16:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const o=t("./mapper.component"),l=t("./builder.component"),n=t("./config.component");class r{constructor(){this._builder=new l.Renderer,this.config=new n.Config,this._map=new o.Map(36,36,10,1,5,3,3,!1),document.querySelector("body").style.background=this.config.groundColor.hex()}debug(){return this.config.allowDebug}get map(){return this._map}colorMap(){return this._builder.build2DMap(this._map)}addToBuildingAndRedraw(){return this._map.addToBuilding(),this._builder.build2DMap(this._map)}drawTileMap(){return this._builder.buildMap(this._map)}getBaseColor(){const t=this.map.getFirstDefinedColumn();return t.tileStack[t.tileStack.length-1].getColor()}getImageTag(){document.querySelector("#buildingimg")&&document.querySelector("#buildingimg").remove();let t=(new XMLSerializer).serializeToString(document.querySelector("svg")),e=window.btoa(t),i=document.createElement("img");i.setAttribute("id","buildingimg"),window.debug&&i.setAttribute("class","debug-active"),i.setAttribute("src","data:image/svg+xml;base64,"+e);let o=document.querySelector("#worldtest");document.querySelector("body").insertBefore(i,o)}}let h;window.debug=!1,window.activateDebug=()=>{window.debug=!0,document.querySelector("#color").classList.remove("hide"),document.querySelector("#add").classList.remove("hide"),document.querySelector("#color-scheme").classList.remove("hide"),document.querySelector("#buildingimg")&&document.querySelector("#buildingimg").classList.add("debug-active"),document.querySelector("#color").innerHTML=s.colorMap();const t=document.querySelector("#color").querySelectorAll(".tile");h=s.map,t.forEach(t=>{t.addEventListener("click",t=>{const e=t.target,i=e.getAttribute("data-y"),o=e.getAttribute("data-x");console.log(h.map[i][o])})})};let s=new r;s.debug()&&window.activateDebug(),document.querySelector("#worldtest").innerHTML=s.drawTileMap(),s.debug()||(s.getImageTag(),document.querySelector("#worldtest").classList.add("hide")),a(s),document.querySelector("#add").addEventListener("click",()=>{document.querySelector("#color").innerHTML=s.addToBuildingAndRedraw(),document.querySelector("#worldtest").innerHTML=s.drawTileMap()}),document.querySelector("#generate").addEventListener("click",()=>{s=new r,window.debug&&(document.querySelector("#color").innerHTML=s.colorMap()),document.querySelector("#worldtest").innerHTML=s.drawTileMap(),s.debug()||(s.getImageTag(),document.querySelector("#worldtest").classList.add("hide")),document.querySelectorAll(".point").forEach(t=>{t.addEventListener("click",()=>{console.log("toggled",t),t.parentElement.classList.toggle("active")})}),a(s)});function a(t){const e=t.getBaseColor(),i=e.changeColorLightingString(0),o=e.changeColorLightingString(20),l=(e.changeColorLightingString(-20),`\n\t\t<div class="color__tile" style="background-color:${i};"></div>\n\t\t<div class="color__tile" style="background-color:${o};"></div>\n\t\t<div class="color__tile" style="background-color:${e.getColorStringByHue(60)};"></div>\n\t\t<div class="color__tile" style="background-color:${e.getColorStringByHue(120)};"></div>\n\t\t<div class="color__tile" style="background-color:${e.getColorStringByHue(180)};"></div>\n\t\t<div class="color__tile" style="background-color:${e.getColorStringByHue(240)};"></div>\n\t\t<div class="color__tile" style="background-color:${e.getColorStringByHue(300)};"></div>`);document.querySelector("#color-scheme").innerHTML=l}},{"./builder.component":1,"./config.component":4,"./mapper.component":18}],17:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const o=t("./config.component");i.MapGenerationFunctions=class{constructor(){this.config=new o.Config,this.smallAngle=this.config.tileSmallAngle,this.largeAngle=this.config.tileLargeAngle}calculateAdditionalBlockIterations(t){return 2+Math.floor(Math.random()*t)}calculateStraightLinesFromIsometricSquare(t,e){let i=(180-this.smallAngle)/2,o=(180-this.largeAngle)/2,l=this.getHorizontalBottomShortestWidth(t,i),n=this.getVerticalBottomShortestHeight(l,i),r=this.getHorizontalTopLongestWidth(e,o),h=this.getVerticalTopLongestHeight(r,o);return{totalWidth:l+r,totalHeight:n+h,horizontalWidthFromBottom:l,horizontalWidthFromTop:r,verticalHeightFromBottom:n,verticalHeightFromTop:h}}getHorizontalBottomShortestWidth(t,e){return t*Math.sin(this.toRadians(e))}getVerticalBottomShortestHeight(t,e){return t*Math.cos(this.toRadians(e))}getHorizontalTopLongestWidth(t,e){return t*Math.sin(this.toRadians(e))}getVerticalTopLongestHeight(t,e){return t*Math.cos(this.toRadians(e))}addGradient(t,e,i){let o='<linearGradient id="'+t+'">';return o+='<stop offset="5%" stop-color="'+e+'" />',o+='<stop offset="95%" stop-color="'+i+'" />',o+="</linearGradient>"}toRadians(t){return t*(Math.PI/180)}getHighestXfromArray(t){let e={x:0,y:0};return t.forEach(t=>{t.x>e.x&&(e=t)}),e}getHighestYfromArray(t){let e={x:0,y:0};return t.forEach(t=>{t.y>e.y&&(e=t)}),e}getLowestXfromArray(t){let e=this.getHighestXfromArray(t);return t.forEach(t=>{t.x<e.x&&(e=t)}),e}getLowestYfromArray(t){let e=this.getHighestYfromArray(t);return t.forEach(t=>{t.y<e.y&&(e=t)}),e}}},{"./config.component":4}],18:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const o=t("./mapGenerationFunctions.component"),l=t("./enums/building-height-variations.enum"),n=t("./colors.component"),r=t("./column.component"),h=t("./tile.component"),s=t("./enums/tile-type.enum"),a=t("./config.component"),g=t("./primitives.component"),d=t("./modifiers.component"),c=t("./decorations.component");i.Map=class{constructor(t,e,i,u,p,$,f,m=!1){this.mapGen=new o.MapGenerationFunctions,this.config=new a.Config,this.primitives=new g.Primitives,this.mods=new d.Modifiers,this.deco=new c.Decorations,this._blockHeightVariationLabels=[l.BuildingHeightVariations.TallCenter,l.BuildingHeightVariations.TallSurrounds,l.BuildingHeightVariations.Random],this._blockHeightVariation=this._blockHeightVariationLabels[Math.floor(3*Math.random())],this._world=[],this._mapWidth=t,this._mapLength=e,this._mapMaxHeight=i,this._mapEdgeWidth=u,this._averageBuildingSize=p,this._blockHeight=$,this._mirrorAtCenter=m;let b;b=this._blockHeightVariation===l.BuildingHeightVariations.TallCenter?2:this._blockHeightVariation===l.BuildingHeightVariations.TallSurrounds?8:4,0===Math.round(Math.random())?(this._startBlockWidth=this._averageBuildingSize+Math.floor(Math.random()*b),this._startBlockLength=Math.floor(this._startBlockWidth*this.config.goldenRatio)):(this._startBlockLength=this._averageBuildingSize+Math.floor(Math.random()*b),this._startBlockWidth=Math.floor(this._startBlockLength*this.config.goldenRatio)),this._maximumBlockIterations=f,this._additionalBlockIterations=this.mapGen.calculateAdditionalBlockIterations(f),this._blockGroups=[],this._blockEdges=[],this._blockHeightsArray=[],this._mapHalfLength=Math.floor(e/2),this._blockIdIterator=0,this._blockAmountIterator=1,this._blockHeightIterator=1,this._decorationLineH=-1;let y=this.config.buildingBaseColor.getColorStringByHue(-120),_=new n.Color(y);this._defaultColor=new n.Color(this.config.buildingBaseColor.hex()),this._lineColor=_.changeColorLighting(-30),this._firstLevelColor=new n.Color(this.config.buildingBaseColor.getColorStringByHue(10)).changeColorLighting(-20),this._groundColor=this.config.groundColor,this._HorizontalRemainingEmptyBlocksMin=0,this._HorizontalRemainingEmptyBlocksMax=0,this._surroundingsGrassColor=new n.Color("#7bb376"),this._surroundingsWaterColor=new n.Color("#6fb9ca"),this._surroundingsSandColor=new n.Color("#e9e3ba"),this._surroundingsDefaultColor=this._surroundingsGrassColor,this._showWindows=this.config.allowWindows?Math.round(2*Math.random()):0;let x=0;this._mirrorAtCenter||(x=-8,0===Math.round(Math.random())&&(x=8),console.log("not mirrorred: dev:",x));let L=Math.floor(e/2),H=(Math.floor(t/2),4+Math.floor(7*Math.random())),w=Math.floor(this._startBlockLength/2),M=(Math.floor(this._startBlockWidth/2),Math.floor(this._mapWidth/2)-Math.floor(H/2)),k=!!Math.round(2*Math.random()),C=!1,S=Math.floor(Math.random()*this.config.fibonacci.length),T=this.config.fibonacci[S],B=0;this._defaultColor.rgb().g>=180&&this._defaultColor.rgb().b>=150&&Math.round(4*Math.random())>=3?(C=Math.round(10*Math.random())>6,this._surroundingsDefaultColor=this._surroundingsWaterColor):Math.round(10*Math.random())<=1&&(C=Math.round(10*Math.random())>3,this._surroundingsDefaultColor=this._surroundingsWaterColor),this._blockHeightVariation===l.BuildingHeightVariations.TallCenter?T=this.config.fibonacci[f]:this._blockHeightVariation===l.BuildingHeightVariations.TallSurrounds&&(T=2+this.config.fibonacci[0],this._blockHeight=T);let v=!1;3===T&&(v=!0),T>6?this._decorationLineH=4:T>3&&(this._decorationLineH=3),T<4&&Math.round(5*Math.random())>2&&(B=M+Math.ceil(Math.random()*this._startBlockWidth-2)),this._blockHeight=T;let A=1===Math.round(Math.random()),W=this._blockHeight>2&&1===Math.round(Math.random());for(let t=0;t<this.mapLength;t++){this._world[t]=[];for(let e=0;e<this.mapWidth;e++){let i,o=0,l=new r.Column(!1,e,t,0),n=e>M&&e<=M+this._startBlockWidth;if((i=this._mirrorAtCenter?t>=L&&t<=L+w:t>=L+x&&t<=L+(x+this._startBlockLength))&&n){o=1;let i=[];for(let l=0;l<this._blockHeight;l++){let n=!1,r=s.TileType.Body;l<2&&W&&(t%2==0&&(n=!0),r=s.TileType.None),this._decorationLineH>3&&l+1===this._decorationLineH&&l+1<this._blockHeight&&(r=s.TileType.None,t%2==0&&(n=!0));let a=0;!n&&this._showWindows>0&&l%2==1&&(a=this._showWindows);let g=l===this._blockHeight-1,d=this._defaultColor;d=l===this._decorationLineH?this._lineColor:0===l?this._firstLevelColor:this._defaultColor;let c=!1;l<this._blockHeight&&t===B&&(0===l?e===M+this._startBlockWidth&&(c=!0):1===l?e===M+this._startBlockWidth-1?c=!0:e===M+this._startBlockWidth&&(r=s.TileType.None):2===l&&(e===M+this._startBlockWidth-2?c=!0:e>M+this._startBlockWidth-2&&(r=s.TileType.None))),v&&l<2&&(r=s.TileType.None,(t%2==0&&e%2==1||t%2==1&&e%2==0)&&(n=!0)),i.push(new h.Tile(this._blockIdIterator,e,t,l,r,d,{roof:g,pillar:n,slope:c,windowed:a,tower:!1,stairs:!1,halfArch:!1,wholeArch:!1,areaDecoration:""})),-1===this._blockGroups.indexOf(o)&&this._blockGroups.push(o),this._blockHeightsArray.push(this._blockHeight),this._blockIdIterator++}(l=new r.Column(!0,e,t,this._blockHeight)).blockGroup=o,l.height=this._blockHeight,l.corner=!1,l.tileStack=i}this._world[t][e]=l}}if(this.setEdges(!1),A&&this._blockHeight>2)for(let t=0;t<this.mapLength;t++)for(let e=0;e<this.mapWidth;e++){if(this._world[t][e].edge.left)for(let i=0;i<this._blockHeight;i++)this._world[t][e].tileStack[i].type===s.TileType.None&&t%2==0&&(this._world[t][e].tileStack[i].options.pillar=!0);if(this._world[t][e].edge.bottom)for(let i=0;i<this._blockHeight;i++)this._world[t][e].tileStack[i].type===s.TileType.None&&e%2==0&&(this._world[t][e].tileStack[i].options.pillar=!0);if(this._world[t][e].edge.right)for(let i=0;i<this._blockHeight;i++)this._world[t][e].tileStack[i].type===s.TileType.None&&t%2==0&&(this._world[t][e].tileStack[i].options.pillar=!0);if(this._world[t][e].edge.top)for(let i=0;i<this._blockHeight;i++)this._world[t][e].tileStack[i].type===s.TileType.None&&e%2==0&&(this._world[t][e].tileStack[i].options.pillar=!0);let i=!!(this._world[t][e].edge.left||this._world[t][e].edge.bottom||this._world[t][e].edge.right);this._world[t][e].isDefined&&!i&&(this._world[t][e]=new r.Column(!1,e,t,0))}for(let t=0;t<this._additionalBlockIterations;t++)this.getEdges(),this._world=this.mods.addBuildingComponent(this);if(console.log("remove excess arches"),this._world=this.mods.removeExcessArches(this),this.config.allowSurroundingDecorations&&k){if(this._HorizontalRemainingEmptyBlocksMin=this.getLeastOpenSpaceOnX().min,this._HorizontalRemainingEmptyBlocksMax=this.getLeastOpenSpaceOnX().max,this._HorizontalRemainingEmptyBlocksMin>7){let t=2*this._HorizontalRemainingEmptyBlocksMin;t>16&&(t=16);let e=this._mapLength-t;for(let t=Math.floor(e/2);t<this.mapLength-Math.floor(e/2);t++)for(let i=0;i<this._HorizontalRemainingEmptyBlocksMin-3;i++)if(!this._world[t][i].isDefined){let o=s.TileType.Grass,l=this._surroundingsDefaultColor,n=0;0===i||i===this._HorizontalRemainingEmptyBlocksMin-4?C?(l=this._defaultColor,o=s.TileType.HalfBlock,n=1):(l=this._surroundingsSandColor,o=s.TileType.Grass):t!==Math.floor(e/2)&&t!==this.mapLength-Math.floor(e/2)-1||(C?(l=this._defaultColor,o=s.TileType.HalfBlock,n=1):(l=this._surroundingsSandColor,o=s.TileType.Grass));let a=new r.Column(!0,i,t,n);a.tileStack=[new h.Tile(this._blockIdIterator,i,t,0,o,l,{roof:!1,pillar:!1,slope:!1,windowed:0,tower:!1,stairs:!1,halfArch:!1,wholeArch:!1,areaDecoration:""})],this._world[t][i]=a,this._blockIdIterator++}}if(this._HorizontalRemainingEmptyBlocksMax>7){let t=2*this._HorizontalRemainingEmptyBlocksMax,e=this._mapLength-t;for(let t=Math.floor(e/2);t<this.mapLength-Math.floor(e/2);t++)for(let i=this._mapWidth-this._HorizontalRemainingEmptyBlocksMax+2;i<this._mapWidth;i++)if(!this._world[t][i].isDefined){let o=s.TileType.Grass,l=this._surroundingsDefaultColor,n=0;i===this._mapWidth-1||i===this._mapWidth-this._HorizontalRemainingEmptyBlocksMax+2?C?(l=this._defaultColor,o=s.TileType.HalfBlock,n=1):(l=this._surroundingsSandColor,o=s.TileType.Grass):t!==Math.floor(e/2)&&t!==this.mapLength-Math.floor(e/2)-1||(C?(l=this._defaultColor,o=s.TileType.HalfBlock,n=1):(l=this._surroundingsSandColor,o=s.TileType.Grass));let a=new r.Column(!0,i,t,n);a.tileStack=[new h.Tile(this._blockIdIterator,i,t,0,o,l,{roof:!1,pillar:!1,slope:!1,windowed:0,tower:!1,stairs:!1,halfArch:!1,wholeArch:!1,areaDecoration:""})],this._world[t][i]=a,this._blockIdIterator++}}}for(let t=0;t<this._blockEdges.length;t++){let e=this._blockEdges[t].y,i=this._blockEdges[t].x,o=new r.Column(!0,i,e,0);o.tileStack=[new h.Tile(this._blockIdIterator,i,e,0,s.TileType.Shadow,this._defaultColor,{roof:!1,pillar:!1,slope:!1,windowed:0,tower:!1,stairs:!1,halfArch:!1,wholeArch:!1,areaDecoration:""})],this._world[e][i].isDefined&&(this._world[e-1][i].isDefined||(this._world[e-1][i]=o),this._world[e+1][i].isDefined||(this._world[e+1][i]=o),this._world[e][i-1].isDefined||(this._world[e][i-1]=o),this._world[e][i+1].isDefined||(this._world[e][i+1]=o)),this._blockIdIterator++}this._world=this.mods.resetGrassTilesBelowPillars(this),this._world=this.mods.clearMapEdges(this),this._mirrorAtCenter&&(this._world=this.mods.mirrorMap(this)),this._world=this.deco.placeRandomTrees(this),console.log(this._world)}get mapWidth(){return this._mapWidth}get mapLength(){return this._mapLength}get mapHalfLength(){return this._mapHalfLength}get mapEdgeWidth(){return this._mapEdgeWidth}get map(){return this._world}get blockGroups(){return this._blockGroups}set blockGroups(t){this._blockGroups=t}get blockHeight(){return this._blockHeight}get mapMaxHeight(){return this._mapMaxHeight}get startBlockSize(){return{w:this._startBlockWidth,l:this._startBlockLength}}set blockHeight(t){this._blockHeight=t}get maxBlockIterations(){return this._maximumBlockIterations}get blockAmountIterator(){return this._blockAmountIterator}set blockAmountIterator(t){this._blockAmountIterator=t}get averageBuildingSize(){return this._averageBuildingSize}get blockEdges(){return this._blockEdges}set blockEdges(t){this._blockEdges=t}get blockHeightsArray(){return this._blockHeightsArray}set blockHeightsArray(t){this._blockHeightsArray=t}get blockIdIterator(){return this._blockIdIterator}set blockIdIterator(t){this._blockIdIterator=t}get blockHeightVariation(){return this._blockHeightVariation}get lineHeight(){return this._decorationLineH}get groundColor(){return this._groundColor}get defaultColor(){return this._defaultColor}get firstLevelColor(){return this._firstLevelColor}get decorativeColors(){return{lineColor:this._lineColor}}get showWindows(){return this._showWindows}getColumn(t,e){return this._world[e][t]}getTiles(t,e){return this._world[e][t].tileStack}getTile(t,e,i){return this._world[e][t].getTile(i)}getTopTile(t,e){let i=this._world[e][t].height;return this._world[e][t].getTile(i-1)}getFirstDefinedColumn(){let t;for(let e=0;e<this.mapLength;e++)for(let i=0;i<this.mapWidth;i++)if(this._world[e][i].isDefined&&this._world[e][i].height>0){t=this._world[e][i];break}return t}setEdges(t){for(let e=0;e<this.mapLength;e++)for(let i=0;i<this.mapWidth;i++)e>0&&i>0&&e<this.mapLength-1&&i<this.mapWidth-1&&this._world[e][i].isDefined&&(t?((this._world[e-1][i].height<this._world[e][i].height||0===e)&&(this._world[e][i].edge.top=!0),(this._world[e+1][i].height<this._world[e][i].height||e===this.mapLength-1)&&(this._world[e][i].edge.bottom=!0),this._world[e][i-1].height<this._world[e][i].height&&(this._world[e][i].edge.left=!0),this._world[e][i+1].height<this._world[e][i].height&&(this._world[e][i].edge.right=!0)):(this._world[e-1][i].isDefined&&0!==e||(this._world[e][i].edge.top=!0),this._world[e+1][i].isDefined&&e!==this.mapLength-1||(this._world[e][i].edge.bottom=!0),this._world[e][i-1].isDefined||(this._world[e][i].edge.left=!0),this._world[e][i+1].isDefined||(this._world[e][i].edge.right=!0)),(this._world[e][i].edge.top&&this._world[e][i].edge.right||this._world[e][i].edge.top&&this._world[e][i].edge.left||this._world[e][i].edge.bottom&&this._world[e][i].edge.right||this._world[e][i].edge.bottom&&this._world[e][i].edge.left)&&(this._world[e][i].corner=!0))}getEdges(){let t;this._blockEdges=[];for(let e=0;e<this._mapLength;e++)if(t=this._mirrorAtCenter?e>this._mapHalfLength+(this._blockAmountIterator-1)&&e<this._mapLength-2:e>2&&e<this._mapLength-2)for(let t=0;t<this._mapWidth;t++)if(t>this._mapEdgeWidth&&t<this._mapWidth-1&&this._world[e][t].isDefined)if(this._world[e][t+1].isDefined&&this._world[e][t-1].isDefined&&this._world[e+1][t].isDefined&&this._world[e-1][t+1].isDefined&&this._world[e-1][t-1].isDefined){if(!this._world[e-1][t].isDefined&&!this._world[e+1][t].isDefined||!this._world[e][t-1].isDefined&&!this._world[e][t+1].isDefined){e>this._mapLength-1&&(e=this._mapLength-1);let i={x:t,y:e};this._blockEdges.push(i)}}else{e>this._mapLength-1&&(e=this._mapLength-1);let i={x:t,y:e};this._blockEdges.push(i)}return this._blockEdges}getLeastOpenSpaceOnX(){let t=[],e=[];for(let i=0;i<this.mapLength;i++){let o=0,l=0;for(let t=0;t<this.mapWidth;t++)t<Math.floor(this.mapWidth/2)?this._world[i][t].isDefined||0!==this._world[i][t].height||o++:this._world[i][t].isDefined||0!==this._world[i][t].height||l++;t.push(o),e.push(l)}return{min:Math.min(...t),max:Math.min(...e)}}addToBuilding(){this._world=this.mods.addBuildingComponent(this),this._world=this.mods.clearMapEdges(this),this.setEdges(!1),console.log(this._world)}}},{"./colors.component":2,"./column.component":3,"./config.component":4,"./decorations.component":5,"./enums/building-height-variations.enum":6,"./enums/tile-type.enum":7,"./mapGenerationFunctions.component":17,"./modifiers.component":19,"./primitives.component":20,"./tile.component":22}],19:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const o=t("./column.component"),l=t("./mapGenerationFunctions.component"),n=t("./enums/building-height-variations.enum"),r=t("./tile.component"),h=t("./enums/tile-type.enum"),s=t("./config.component");i.Modifiers=class{constructor(){this.config=new s.Config,this.mapGen=new l.MapGenerationFunctions,this._lastBlockHollow=!1}mirrorMap(t){let e=[];t.blockGroups.forEach(t=>{e.push(t)});for(let i=0;i<t.mapHalfLength;i++)if(i<t.mapHalfLength)for(let l=0;l<t.mapWidth;l++)if(t.map[t.mapLength-i-1][l].isDefined){let n=t.map[t.mapLength-i-1][l],h=n.height;if(h>0){let s=e.length+n.blockGroup,a=[];for(let e=0;e<h;e++){let o,s,g,d,c,u,p,$,f=n.tileStack[e].tileColor;n.tileStack[e].options?(o=n.tileStack[e].options.pillar,s=n.tileStack[e].options.slope,g=n.tileStack[e].options.windowed,d=n.tileStack[e].options.tower,c=n.tileStack[e].options.stairs,u=e===h-1,p=n.tileStack[e].options.halfArch,$=n.tileStack[e].options.wholeArch,a.push(new r.Tile(t.blockIdIterator,l,i,e,n.tileStack[e].type,f,{roof:u,pillar:o,slope:s,windowed:g,tower:d,stairs:c,halfArch:p,wholeArch:$,areaDecoration:""}))):a.push(new r.Tile(t.blockIdIterator,l,i,e,n.tileStack[e].type,f,{roof:!1,pillar:!1,slope:!1,windowed:0,tower:!1,stairs:!1,halfArch:!1,wholeArch:!1,areaDecoration:""})),t.blockIdIterator++}t.blockHeightsArray.push(h),-1===t.blockGroups.indexOf(s)&&t.blockGroups.push(s),t.map[i][l]=null;let g=new o.Column(!0,l,i,h);g.blockGroup=s,g.height=h,g.corner=!1,g.tileStack=a,t.map[i][l]=g}else 0===h&&n.isDefined&&(t.map[i][l]=n)}return t.map}clearMapEdges(t){for(let e=0;e<t.mapLength;e++)for(let i=1;i<t.mapWidth;i++)if((i<t.mapEdgeWidth||i>=t.mapWidth||e<t.mapEdgeWidth||e>=t.mapLength-t.mapEdgeWidth)&&t.map[e][i].isDefined&&t.map[e][i].height>0){t.map[e][i]=null;let l=new o.Column(!1,i,e,0);l.tileStack=[],t.map[e][i]=l}return t.map}addBuildingComponent(t){const e=t.defaultColor;if(t.blockAmountIterator<t.maxBlockIterations+1){const i=e.changeColorLighting(-Math.floor(15*Math.random()));if(t.blockEdges=t.getEdges(),t.blockEdges.length>0){let e,l,s=0,a=t.showWindows;if(l=1===t.blockAmountIterator?Math.min(t.startBlockSize.w,t.startBlockSize.l):this._lastBlockShortestSide,t.blockHeightVariation===n.BuildingHeightVariations.TallCenter)e=this.config.fibonacci[t.maxBlockIterations-t.blockAmountIterator+1];else if(t.blockHeightVariation===n.BuildingHeightVariations.TallSurrounds)e=this.config.fibonacci[t.blockAmountIterator+1];else if(t.blockHeightVariation===n.BuildingHeightVariations.Random){let i=Math.ceil(4*Math.random());e=0===Math.round(Math.random())&&t.blockHeight>3?t.blockHeight-i:t.blockHeight+i}e<2?e=1:e>t.mapMaxHeight&&(e=t.mapMaxHeight),e>5&&(s=2+Math.floor(3*Math.random()));let g,d=this.mapGen.getHighestYfromArray(t.blockEdges),c=this.mapGen.getLowestXfromArray(t.blockEdges),u=this.mapGen.getHighestXfromArray(t.blockEdges),p=t.blockEdges.filter(t=>t.y===d.y),$=t.blockEdges.filter(t=>t.x===c.x),f=t.blockEdges.filter(t=>t.x===u.x),m=Math.floor(3*Math.random());d.y>t.mapLength-5&&(m=Math.floor(2*Math.random()));let b,y,_,x,L=l-t.blockAmountIterator,H=Math.floor(L*this.config.goldenRatio);if(0===m){let t=Math.floor(Math.random()*$.length);$.length>4&&(t=2+Math.floor(Math.random()*($.length-2))),b=(g=$[t]).y-Math.round(H/2)-1,y=g.y+Math.round(H/2)+1,_=g.x-L,x=g.x}else if(1===m){let t=Math.floor(Math.random()*f.length);f.length>4&&(t=2+Math.floor(Math.random()*(f.length-2))),b=(g=f[t]).y-Math.round(H/2)-1,y=g.y+Math.round(H/2)+1,_=g.x,x=g.x+L}else if(2===m){b=(g=p[Math.floor(Math.random()*p.length)]).y,y=g.y+H,_=g.x-Math.round(L/2)+1,x=g.x+Math.round(L/2)-1}this._lastBlockShortestSide=Math.min(L,H);let w=t.blockGroups.length+1,M=(Math.round(Math.random()),0),k=1===Math.round(Math.random());g.y+H>t.mapLength-1&&(H=t.mapLength-(g.y+M)-1),L>4&&H>4?(this._lastBlockHollow?(k=!1,this._lastBlockHollow=!1):(k=Math.round(8*Math.random())>5,this._lastBlockHollow=!0),k=!0):k=!1;let C=Math.round(8*Math.random()),S=!0,T=!1,B=!1,v=e<7&&Math.round(8*Math.random())>5,A=0;v&&(A=Math.round(2*Math.random()));let W;t.getFirstDefinedColumn().tileStack[0].tileColor;e<4&&Math.round(5*Math.random())>0&&(W=g.x+Math.ceil(Math.random()*Math.round(L/2)-2));for(let l=0;l<t.mapLength;l++){b===l?T=!0:y===l?B=!0:(T=!1,B=!1);let d=!1,c=!1;for(let u=0;u<t.mapWidth;u++)if(u===_?d=!0:u===x&&(c=!0),l>=b&&l<=y&&u>=_&&u<=x){let d=!0;if(k&&l>b&&l<y&&u>_+1&&u<x-1&&(d=!1),d){let d=!1;v&&(0===A?l<=b+1&&u<=_+1&&(d=!0):1===A?l<=b+1&&u>=x-2&&(d=!0):2===A&&l>=y-1&&u>=x-2&&t.blockHeightVariation!==n.BuildingHeightVariations.TallCenter&&(d=!0));let c=e;d&&(console.log("tower built"),c=e+5);let p=[];for(let o=0;o<c;o++){let n=!1,$=0;a>0&&o%2==1&&($=a);let f=o===c-1,m=!1;o<e&&l===W&&u===g.x+Math.round(L/2)-o&&(m=!0);let w=i,M=h.TileType.Body,k=!1;d&&(k=!0);let T=!1,B=!1,v=!1;if(c>4)if(S){if(H>4&&H<6){let t=g.y+5;g.y+5>g.y+H/2&&(t=g.y+4),l>g.y+1&&l<t&&o<c-2&&(M=h.TileType.None,g.y+5>27&&l%2==0&&u%2!=0&&(n=!0),o===c-3&&(B=!0))}6===H&&(l!==b+1&&l!==b+2&&l!==y-2&&l!==y-3||(o<c-2&&(M=h.TileType.None),o===c-3&&(B=!0))),8===H&&(l===b+1||l===b+2||l===b+4||l===b+5?(o<c-2&&(M=h.TileType.None),o===c-3&&(B=!0)):l!==b+3&&l!==b+6||(M=h.TileType.Body,B=!1)),6===L&&(u!==_+1&&u!==_+2&&u!==x-2&&u!==x-3||(o<c-2&&(M=h.TileType.None),o===c-3&&(B=!0))),8===L&&(u===_+1||u===_+2||u===_+4||u===_+5?(o<c-2&&(M=h.TileType.None),o===c-3&&(B=!0)):u!==_+3&&u!==_+6||(M=h.TileType.Body,B=!1))}else C>4?s>0&&(o===s||o+1===s)&&(M=h.TileType.None,l%2==0&&u%2!=0&&(n=!0)):c>7&&s>0&&o>s&&o<s+4&&(M=h.TileType.None,l%2==0&&u%2!=0&&(n=!0));w=o===t.lineHeight?t.decorativeColors.lineColor:0===o?t.firstLevelColor:i,t.map[l][u].isDefined&&t.map[l][u].tileStack[0].type===h.TileType.Grass&&0===o&&M===h.TileType.None&&(M=h.TileType.Grass,w=t.map[l][u].tileStack[0].tileColor),p.push(new r.Tile(t.blockIdIterator,u,l,o,M,w,{roof:f,pillar:n,slope:m,windowed:$,tower:k,stairs:T,halfArch:B,wholeArch:v,areaDecoration:""})),t.blockHeightsArray.push(c),t.blockIdIterator++,w=void 0}-1===t.blockGroups.indexOf(w)&&t.blockGroups.push(w),t.map[l][u]=null;let $=new o.Column(!0,u,l,c);$.blockGroup=w,$.height=c,$.corner=!1,$.tileStack=p,t.map[l][u]=$}}}t.blockHeight=e,t.blockAmountIterator++}else console.warn("Block edges array is empty.")}else console.warn("Cannot add more building components, maximum block iterations reached.");return t.map}removeExcessArches(t){for(let e=0;e<t.mapLength;e++)for(let i=0;i<t.mapWidth;i++)if(e>0&&i>0&&e<t.mapLength-2&&i<t.mapWidth-2&&t.map[e][i].isDefined)for(let o=0;o<t.map[e][i].height;o++)t.map[e][i].tileStack[o].type===h.TileType.None&&t.map[e][i].tileStack[o].options.halfArch&&(t.map[e-1][i].isDefined&&t.map[e-1][i].height>0&&t.map[e-1][i].height===t.map[e][i].height&&t.map[e-1][i].tileStack[o].options.halfArch&&(console.log("y + 1",t.map[e+1][i]),t.map[e+1][i].isDefined&&t.map[e+1][i].height>0&&t.map[e+1][i].height===t.map[e][i].height&&t.map[e+1][i].tileStack[o].options.halfArch&&(t.map[e][i].tileStack[o].options.halfArch=!1),console.log("y + 2",t.map[e+2][i]),t.map[e+2][i].isDefined&&t.map[e+2][i].height>0&&t.map[e+2][i].height===t.map[e][i].height&&t.map[e+2][i].tileStack[o].options.halfArch&&(t.map[e+1][i].tileStack[o].options.halfArch=!1)),i>1&&i<t.mapWidth-3&&t.map[e][i-1].isDefined&&t.map[e][i-1].height===t.map[e][i].height&&t.map[e][i-1].tileStack[o].options.halfArch&&(t.map[e][i+1].isDefined&&t.map[e][i+1].height===t.map[e][i].height&&t.map[e][i+1].tileStack[o].options.halfArch&&(t.map[e][i].tileStack[o].options.halfArch=!1),console.log("x + 2",t.map[e+2][i]),t.map[e][i+2].isDefined&&t.map[e][i+1].height===t.map[e][i].height&&t.map[e][i+2].height===t.map[e][i].height&&t.map[e][i+2].tileStack[o].options.halfArch&&(t.map[e][i+1].tileStack[o].options.halfArch=!1)));return t.map}resetGrassTilesBelowPillars(t){for(let e=0;e<t.mapLength;e++)for(let i=0;i<t.mapWidth;i++)e>0&&i>0&&e<t.mapLength-1&&i<t.mapWidth-1&&t.map[e][i].isDefined&&t.map[e][i].height>0&&t.map[e][i].tileStack[0].type===h.TileType.None&&(t.map[e-1][i].isDefined&&t.map[e-1][i].tileStack[0].type===h.TileType.Grass||t.map[e+1][i].isDefined&&t.map[e+1][i].tileStack[0].type===h.TileType.Grass||t.map[e][i-1].isDefined&&t.map[e][i-1].tileStack[0].type===h.TileType.Grass||t.map[e][i+1].isDefined&&t.map[e][i+1].tileStack[0].type===h.TileType.Grass)&&console.log("should be grass tile!");return t.map}}},{"./column.component":3,"./config.component":4,"./enums/building-height-variations.enum":6,"./enums/tile-type.enum":7,"./mapGenerationFunctions.component":17,"./tile.component":22}],20:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});i.Primitives=class{getPyramid(t,e){let i=[],o=Math.min(t,e),l=Math.min(t,e),n=Math.floor(o/2),r=Math.floor(l/2),h=[];for(let t=0;t<o;t++){i[t]=[];for(let e=0;e<l;e++)t<Math.round(l/2)&&e<Math.round(o/2)?i[t][e]=Math.min(t,e):i[t][e]=Math.max(t,e)}for(let t=0;t<n;t++){h[t]=[];for(let e=0;e<r;e++)t<r&&e<n&&(h[t][e]=i[t][e])}let s=h.reverse();for(let t=0;t<o;t++)for(let e=0;e<l;e++)t>r-1&&e<n&&(i[t][e]=s[t-r][e]);for(let t=0;t<o;t++)for(let e=0;e<l;e++)e>n-1&&(i[t][e]=i[t][o-e-1]);return i}}},{}],21:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const o=t("./config.component"),l=t("./mapGenerationFunctions.component"),n=t("./colors.component");i.RenderElements=class{constructor(){this.config=new o.Config,this.calculations=new l.MapGenerationFunctions,this.tileW=this.config.tileWidth,this.tileL=this.config.tileLength,this.tileH=this.config.tileHeight,this.bleed=this.config.tileEdgeBleed,this.dimensions=this.calculations.calculateStraightLinesFromIsometricSquare(this.tileW,this.tileL),this.tileColor=this.config.groundColor}getPositions(t,e,i=0){return{top:{x:Math.ceil(t+this.dimensions.horizontalWidthFromTop),y:Math.ceil(e+i)},left:{x:Math.ceil(t),y:Math.ceil(e+this.dimensions.verticalHeightFromTop+i)},bottom:{x:Math.ceil(t+this.dimensions.horizontalWidthFromBottom),y:Math.ceil(e+this.dimensions.totalHeight+i)},right:{x:Math.ceil(t+this.dimensions.totalWidth),y:Math.ceil(e+this.dimensions.verticalHeightFromBottom+i)}}}createTile(t,e,i){const{top:o,left:l,bottom:n,right:r}=this.getPositions(t,e,0);let h=`${o.x} ${o.y-this.bleed}`,s=`${l.x-this.bleed} ${l.y}`,a=`${n.x} ${n.y+this.bleed}`,g=`${r.x+this.bleed} ${r.y}`,d=this.tileColor.hex();return"shade"===i&&(d=this.tileColor.changeColorLightingString(-50)),{html:`<path fill="${d}"\n\t\t\t\t\td="M${s} \n\t\t\t\t\tL${a} \n\t\t\t\t\tL${g} \n\t\t\t\t\tL${h} \n\t\t\t\t\tL${s} Z" />`,coords:{top:o,left:l,bottom:n,right:r}}}createPlane(t,e,i,o=this.config.groundColor){const l=i.id;i.h,this.tileH,this.tileH;let n=o.hex();const{top:r,left:h,bottom:s,right:a}=this.getPositions(t,e,this.config.topMargin);let g=`${h.x-this.bleed} ${h.y}`;return{html:`<g style="z-index:${l};">\n\t\t\t\t\t<path fill="${n}"\n\t\t\t\t\td="M${g} \n\t\t\t\t\tL${`${s.x} ${s.y}`} \n\t\t\t\t\tL${`${a.x+this.bleed} ${a.y}`} \n\t\t\t\t\tL${`${r.x} ${r.y}`} \n\t\t\t\t\tL${g} Z" /></g>`,coords:{top:r,left:h,bottom:s,right:a}}}createBlock(t,e,i,o=!1){const l=i.id,n=i.h*this.tileH-this.tileH;let r,h,s,a;i.tileColor.hex()!==this.config.buildingBaseColor.hex()?(r=i.tileColor.hex(),h=i.tileColor.changeColorLightingString(30),s=i.tileColor.changeColorLightingString(-60),a=i.tileColor.changeColorLightingString(15)):(r=this.config.buildingBaseColor.hex(),h=this.config.buildingBaseColor.changeColorLightingString(30),s=this.config.buildingBaseColor.changeColorLightingString(-60),a=this.config.buildingBaseColor.changeColorLightingString(15));const{top:g,left:d,bottom:c,right:u}=this.getPositions(t,e,this.config.topMargin),p=`${d.x-this.bleed} ${d.y-n-this.tileH}`,$=`${d.x-this.bleed} ${d.y-n+this.bleed}`,f=`${c.x} ${c.y-n+this.bleed}`,m=`${c.x} ${c.y-n-this.tileH}`,b=`${c.x} ${c.y-n-this.tileH}`,y=`${c.x} ${c.y-n+this.bleed}`,_=`${u.x+this.bleed} ${u.y-n+this.bleed}`,x=`${u.x+this.bleed} ${u.y-n-this.tileH}`,L=`${d.x-this.bleed} ${d.y-n-this.tileH}`,H=`${c.x} ${c.y-n-this.tileH}`,w=`${u.x+this.bleed} ${u.y-n-this.tileH}`,M=`${g.x} ${g.y-n-this.tileH}`;let k=`<g style="z-index:${l};">\n\t\t\t\t\t<path fill="${s}"\n\t\t\t\t\td="M${p} \n\t\t\t\t\tL${$} \n\t\t\t\t\tL${f} \n\t\t\t\t\tL${m} \n\t\t\t\t\tL${p} Z" />\n\t\t\t\t\t<path fill="${r}"\n\t\t\t\t\td="M${b} \n\t\t\t\t\tL${y} \n\t\t\t\t\tL${_} \n\t\t\t\t\tL${x} \n\t\t\t\t\tL${b} Z" />`;if("triangles"===o){const t=2,e=(d.x,this.bleed,d.y,this.tileH,c.x,c.y,this.tileH,u.x,this.bleed,u.y,this.tileH,g.x,g.y,this.tileH,{x:d.x+(u.x-d.x)/2,y:g.y+(c.y-g.y)/2});e.x,e.y,e.x,e.y,e.x,e.y,e.x,e.y,d.x,g.x,d.x,g.y,d.y,g.y,this.tileH,d.x,c.x,d.x,c.y,c.y,d.y,this.tileH,u.x,u.x,c.x,c.y,u.y,g.y,this.tileH,u.x,u.x,g.x,u.y,c.y,u.y,this.tileH;k+=`<path fill="${h}"\n\t\t\t\t\td="M${L} \n\t\t\t\t\tL${H} \n\t\t\t\t\tL${w} \n\t\t\t\t\tL${M} \n\t\t\t\t\tL${L} Z" />\n\t\t\t\t\t<path fill="transparent" stroke="${a}"\n\t\t\t\t\td="M${L} \n\t\t\t\t\tL${H} \n\t\t\t\t\tL${w} \n\t\t\t\t\tL${M} \n\t\t\t\t\tL${L} Z" />\n\t\t\t\t\t<path fill="transparent" stroke="${a}"\n\t\t\t\t\td="M${L} \n\t\t\t\t\tL${w}" />\n\t\t\t\t\t<path fill="transparent" stroke="${a}"\n\t\t\t\t\td="M${M} \n\t\t\t\t\tL${H}" />`}else if("squares"===o){const t=2,e=(d.x,this.bleed,d.y,this.tileH,c.x,c.y,this.tileH,u.x,this.bleed,u.y,this.tileH,g.x,g.y,this.tileH,{x:d.x+(u.x-d.x)/2,y:g.y+(c.y-g.y)/2});e.x,e.y,e.x,e.y,e.x,e.y,e.x,e.y,d.x,g.x,d.x,g.y,d.y,g.y,this.tileH,d.x,c.x,d.x,c.y,c.y,d.y,this.tileH,u.x,u.x,c.x,c.y,u.y,g.y,this.tileH,u.x,u.x,g.x,u.y,c.y,u.y,this.tileH;k+=`<path fill="${h}"\n\t\t\t\t\td="M${L} \n\t\t\t\t\tL${H} \n\t\t\t\t\tL${w} \n\t\t\t\t\tL${M} \n\t\t\t\t\tL${L} Z" />\n\t\t\t\t\t<path fill="transparent" stroke="${a}"\n\t\t\t\t\td="M${L} \n\t\t\t\t\tL${H} \n\t\t\t\t\tL${w} \n\t\t\t\t\tL${M} \n\t\t\t\t\tL${L} Z" />`}else k+=`<path fill="${h}"\n\t\t\t\t\td="M${L} \n\t\t\t\t\tL${H} \n\t\t\t\t\tL${w} \n\t\t\t\t\tL${M} \n\t\t\t\t\tL${L} Z" />`;return{html:k+="</g>",coords:{top:g,left:d,bottom:c,right:u}}}createHalfBlock(t,e,i){const o=i.id,l=i.h*this.tileH-this.tileH;let n,r,h,s;i.tileColor.hex()!==this.config.buildingBaseColor.hex()?(n=i.tileColor.hex(),r=i.tileColor.changeColorLightingString(30),h=i.tileColor.changeColorLightingString(-60),s=i.tileColor.changeColorLightingString(10)):(n=this.config.buildingBaseColor.hex(),r=this.config.buildingBaseColor.changeColorLightingString(30),h=this.config.buildingBaseColor.changeColorLightingString(-60),s=this.config.buildingBaseColor.changeColorLightingString(10));const{top:a,left:g,bottom:d,right:c}=this.getPositions(t,e,this.config.topMargin),u=`${g.x-this.bleed} ${g.y-l-this.tileH/2}`,p=`${g.x-this.bleed} ${g.y-l+this.bleed}`,$=`${d.x} ${d.y-l+this.bleed}`,f=`${d.x} ${d.y-l-this.tileH/2}`,m=`${d.x} ${d.y-l-this.tileH/2}`,b=`${d.x} ${d.y-l+this.bleed}`,y=`${c.x+this.bleed} ${c.y-l+this.bleed}`,_=`${c.x+this.bleed} ${c.y-l-this.tileH/2}`,x=`${g.x-this.bleed} ${g.y-l-this.tileH/2}`,L=`${d.x} ${d.y-l-this.tileH/2}`,H=`${c.x+this.bleed} ${c.y-l-this.tileH/2}`,w=`${a.x} ${a.y-l-this.tileH/2}`;g.x,c.x,g.x,a.y,d.y,a.y;return{html:`<g style="z-index:${o};"><path fill="${h}"\n\t\t\t\t\td="M${u} \n\t\t\t\t\tL${p} \n\t\t\t\t\tL${$} \n\t\t\t\t\tL${f} \n\t\t\t\t\tL${u} Z" />\n\t\t\t\t\t<path fill="${n}"\n\t\t\t\t\td="M${m} \n\t\t\t\t\tL${b} \n\t\t\t\t\tL${y} \n\t\t\t\t\tL${_} \n\t\t\t\t\tL${m} Z" />\n\t\t\t\t\t<path fill="${r}"\n\t\t\t\t\td="M${x} \n\t\t\t\t\tL${L} \n\t\t\t\t\tL${H} \n\t\t\t\t\tL${w} \n\t\t\t\t\tL${x} Z" />\n\t\t\t\t\t<path fill="transparent" stroke="${s}"\n\t\t\t\t\td="M${H}\n\t\t\t\t\tL${x}\n\t\t\t\t\tL${L}\n\t\t\t\t\tL${w}" />\n\t\t\t\t\t</g>`,coords:{top:a,left:g,bottom:d,right:c}}}createSlopeBlock(t,e,i,o){const l=i.id,n=i.h*this.tileH-this.tileH;let r,h,s,a,g,d,c,u,p,$,f;i.tileColor.hex()!==this.config.buildingBaseColor.hex()?(r=i.tileColor.hex(),h=i.tileColor.changeColorLightingString(-10),s=i.tileColor.changeColorLightingString(10),a=i.tileColor.changeColorLightingString(-20),g=i.tileColor.changeColorLightingString(20),d=i.tileColor.changeColorLightingString(-30),c=i.tileColor.changeColorLightingString(30),u=i.tileColor.changeColorLightingString(-40),p=i.tileColor.changeColorLightingString(40),$=i.tileColor.changeColorLightingString(-60),f=i.tileColor.changeColorLightingString(50)):(r=this.config.buildingBaseColor.hex(),h=this.config.buildingBaseColor.changeColorLightingString(-10),s=this.config.buildingBaseColor.changeColorLightingString(10),a=this.config.buildingBaseColor.changeColorLightingString(-20),g=this.config.buildingBaseColor.changeColorLightingString(20),d=this.config.buildingBaseColor.changeColorLightingString(-30),c=this.config.buildingBaseColor.changeColorLightingString(30),u=this.config.buildingBaseColor.changeColorLightingString(-40),p=this.config.buildingBaseColor.changeColorLightingString(40),$=this.config.buildingBaseColor.changeColorLightingString(-60),f=this.config.buildingBaseColor.changeColorLightingString(50));const{top:m,left:b,bottom:y,right:_}=this.getPositions(t,e);let x="",L={top:m,left:b,bottom:y,right:_};if("n"===o){let t=`${b.x-this.bleed} ${b.y-n-this.tileH}`,e=`${b.x-this.bleed} ${b.y-n+this.bleed}`,i=`${y.x} ${y.y-n+this.bleed}`,o=`${y.x} ${y.y-n-this.tileH}`,h=`${y.x} ${y.y-n-this.tileH}`,s=`${y.x} ${y.y-n+this.bleed}`,a=`${_.x+this.bleed} ${_.y-n+this.bleed}`,g=`${b.x-this.bleed} ${b.y-n-this.tileH}`;x=`<g style="z-index:${l};">\n\t\t\t\t\t\t\t<path fill="${d}"\n\t\t\t\t\t\t\td="M${t} \n\t\t\t\t\t\t\tL${e} \n\t\t\t\t\t\t\tL${i} \n\t\t\t\t\t\t\tL${o} \n\t\t\t\t\t\t\tL${t} Z" />\n\t\t\t\t\t\t\t<path fill="${r}"\n\t\t\t\t\t\t\td="M${h}\n\t\t\t\t\t\t\tL${s}\n\t\t\t\t\t\t\tL${a}\n\t\t\t\t\t\t\tL${h} Z" />\n\t\t\t\t\t\t\t<path fill="${f}"\n\t\t\t\t\t\t\td="M${g}\n\t\t\t\t\t\t\tL${`${y.x} ${y.y-n-this.tileH}`}\n\t\t\t\t\t\t\tL${`${_.x+this.bleed} ${_.y-n+this.bleed}`}\n\t\t\t\t\t\t\tL${`${m.x} ${m.y-n}`}\n\t\t\t\t\t\t\tL${g} Z" />\n\t\t\t\t\t\t</g>`}if("nw"===o){console.log("northwest");let t=`${b.x-this.bleed} ${b.y-n}`,e=`${b.x-this.bleed} ${b.y-n+this.bleed}`,i=`${y.x} ${y.y-n-this.tileH+this.bleed}`,o=`${b.x-this.bleed} ${b.y-n+this.bleed}`,r=`${y.x} ${y.y-n-this.tileH+this.bleed}`,s=`${m.x} ${m.y-n}`,a=`${y.x} ${y.y-n-this.tileH}`;x=`<g style="z-index:${l};">\n\t\t\t\t\t\t\t<path fill="${$}"\n\t\t\t\t\t\t\td="M${t}\n\t\t\t\t\t\t\tL${e}\n\t\t\t\t\t\t\tL${i}\n\t\t\t\t\t\t\tL${t} Z" />\n\t\t\t\t\t\t\t<path fill="${h}"\n\t\t\t\t\t\t\td="M${o}\n\t\t\t\t\t\t\tL${r}\n\t\t\t\t\t\t\tL${s}\n\t\t\t\t\t\t\tL${o} Z" />\n\t\t\t\t\t\t\t<path fill="${f}"\n\t\t\t\t\t\t\td="M${a}\n\t\t\t\t\t\t\tL${`${_.x+this.bleed} ${_.y-n+this.bleed}`}\n\t\t\t\t\t\t\tL${`${m.x} ${m.y-n}`}\n\t\t\t\t\t\t\tL${a} Z" />\n\t\t\t\t\t\t</g>`}if("s"===o){let t=`${y.x} ${y.y-n+this.bleed}`,e=`${_.x+this.bleed} ${_.y-n+this.bleed}`,i=`${_.x+this.bleed} ${_.y-n-this.tileH}`,o=`${b.x-this.bleed} ${b.y-n+this.bleed}`;x=`<g style="z-index:${l};">\n\t\t\t\t\t\t\t<path fill="${r}"\n\t\t\t\t\t\t\td="M${t}\n\t\t\t\t\t\t\tL${e}\n\t\t\t\t\t\t\tL${i}\n\t\t\t\t\t\t\tL${t} Z" />\n\t\t\t\t\t\t\t<path fill="${d}"\n\t\t\t\t\t\t\td="M${o}\n\t\t\t\t\t\t\tL${`${y.x} ${y.y-n+this.bleed}`}\n\t\t\t\t\t\t\tL${`${_.x+this.bleed} ${_.y-n-this.tileH+this.bleed}`}\n\t\t\t\t\t\t\tL${`${m.x} ${m.y-n-this.tileH}`}\n\t\t\t\t\t\t\tL${o} Z" />\n\t\t\t\t\t\t</g>`}if("se"===o){let t=`${b.x-this.bleed} ${b.y-n+this.bleed}`,e=`${y.x} ${y.y-n+this.bleed}`,i=`${m.x} ${m.y-n-this.tileH}`,o=`${y.x} ${y.y-n+this.bleed}`,r=`${_.x+this.bleed} ${_.y-n+this.bleed}`;x=`<g style="z-index:${l};">\n\t\t\t\t\t\t<path fill="${d}"\n\t\t\t\t\t\td="M${t}\n\t\t\t\t\t\tL${e}\n\t\t\t\t\t\tL${i}\n\t\t\t\t\t\tL${t} Z" />\n\t\t\t\t\t\t<path fill="${h}"\n\t\t\t\t\t\td="M${r}\n\t\t\t\t\t\tL${o}\n\t\t\t\t\t\tL${`${m.x} ${m.y-n-this.tileH}`}\n\t\t\t\t\t\tL${r} Z" />\n\t\t\t\t\t</g>`}if("e"===o){let t=`${b.x-this.bleed} ${b.y-n-this.tileH}`,e=`${b.x-this.bleed} ${b.y-n+this.bleed}`,i=`${y.x} ${y.y-n+this.bleed}`,o=`${b.x-this.bleed} ${b.y-n-this.tileH+this.bleed}`;x=`<g style="z-index:${l};">\n\t\t\t\t\t\t\t<path fill="${$}"\n\t\t\t\t\t\t\td="M${t}\n\t\t\t\t\t\t\tL${e}\n\t\t\t\t\t\t\tL${i}\n\t\t\t\t\t\t\tL${t} Z" />\n\t\t\t\t\t\t\t<path fill="${h}"\n\t\t\t\t\t\t\td="M${o}\n\t\t\t\t\t\t\tL${`${y.x} ${y.y-n+this.bleed}`}\n\t\t\t\t\t\t\tL${`${_.x+this.bleed} ${_.y-n+this.bleed}`}\n\t\t\t\t\t\t\tL${`${m.x} ${m.y-n-this.tileH}`}\n\t\t\t\t\t\t\tL${o} Z" />\n\t\t\t\t\t\t</g>`}if("ne"===o){let t=`${b.x-this.bleed} ${b.y-n-this.tileH}`,e=`${b.x-this.bleed} ${b.y-n+this.bleed}`,i=`${y.x} ${y.y-n+this.bleed}`,o=`${b.x-this.bleed} ${b.y-n-this.tileH+this.bleed}`,r=`${_.x+this.bleed} ${_.y-n+this.bleed}`,s=`${m.x} ${m.y-n}`,a=`${b.x-this.bleed} ${b.y-n-this.tileH+this.bleed}`;x=`<g style="z-index:${l};">\n\t\t\t\t\t\t<path fill="${$}"\n\t\t\t\t\t\td="M${t}\n\t\t\t\t\t\tL${e}\n\t\t\t\t\t\tL${i}\n\t\t\t\t\t\tL${t} Z" />\n\t\t\t\t\t\t<path fill="${h}"\n\t\t\t\t\t\td="M${a}\n\t\t\t\t\t\tL${`${y.x} ${y.y-n+this.bleed}`}\n\t\t\t\t\t\tL${`${_.x+this.bleed} ${_.y-n+this.bleed}`}\n\t\t\t\t\t\tL${a} Z" />\n\t\t\t\t\t\t<path fill="${f}"\n\t\t\t\t\t\td="M${o}\n\t\t\t\t\t\tL${s}\n\t\t\t\t\t\tL${r}\n\t\t\t\t\t\tL${o} Z" />\n\t\t\t\t\t</g>`}if("w"===o){let t=`${b.x-this.bleed} ${b.y-n}`,e=`${b.x-this.bleed} ${b.y-n+this.bleed}`,i=`${y.x} ${y.y-n-this.tileH+this.bleed}`,o=`${b.x-this.bleed} ${b.y-n+this.bleed}`;x=`<g style="z-index:${l};">\n\t\t\t\t\t\t\t<path fill="${$}"\n\t\t\t\t\t\t\td="M${t}\n\t\t\t\t\t\t\tL${e}\n\t\t\t\t\t\t\tL${i}\n\t\t\t\t\t\t\tL${t} Z" />\n\t\t\t\t\t\t\t<path fill="${h}"\n\t\t\t\t\t\t\td="M${o}\n\t\t\t\t\t\t\tL${`${y.x} ${y.y-n-this.tileH+this.bleed}`}\n\t\t\t\t\t\t\tL${`${_.x+this.bleed} ${_.y-n-this.tileH+this.bleed}`}\n\t\t\t\t\t\t\tL${`${m.x} ${m.y-n}`}\n\t\t\t\t\t\t\tL${o} Z" />\n\t\t\t\t\t\t</g>`}if("sw"===o){let t=`${y.x} ${y.y-n+this.bleed}`,e=`${_.x+this.bleed} ${_.y-n+this.bleed}`,i=`${_.x+this.bleed} ${_.y-n-this.tileH}`,o=`${b.x-this.bleed} ${b.y-n+this.bleed}`,s=`${y.x} ${y.y-n+this.bleed}`,a=`${_.x+this.bleed} ${_.y-n-this.tileH+this.bleed}`;x=`<g style="z-index:${l};">\n\t\t\t\t\t\t\t<path fill="${r}"\n\t\t\t\t\t\t\td="M${t}\n\t\t\t\t\t\t\tL${e}\n\t\t\t\t\t\t\tL${i}\n\t\t\t\t\t\t\tL${t} Z" />\n\t\t\t\t\t\t\t<path fill="${h}"\n\t\t\t\t\t\t\td="M${o}\n\t\t\t\t\t\t\tL${`${m.x} ${m.y-n}`}\n\t\t\t\t\t\t\tL${a}\n\t\t\t\t\t\t\tL${o} Z" />\n\t\t\t\t\t\t\t<path fill="${d}"\n\t\t\t\t\t\t\td="M${o}\n\t\t\t\t\t\t\tL${s}\n\t\t\t\t\t\t\tL${a}\n\t\t\t\t\t\t\tL${o} Z" />\n\t\t\t\t\t\t</g>`}return{html:x,coords:L}}createPillarBlock(t,e,i){let o,l,n,r=i.id,h=this.config.tileWidth,s=i.h*this.tileH-this.tileH;i.tileColor.hex()!==this.config.buildingBaseColor.hex()?(o=i.tileColor.hex(),l=i.tileColor.changeColorLightingString(30),n=i.tileColor.changeColorLightingString(-60)):(o=this.config.buildingBaseColor.hex(),l=this.config.buildingBaseColor.changeColorLightingString(30),n=this.config.buildingBaseColor.changeColorLightingString(-60));const{top:a,left:g,bottom:d,right:c}=this.getPositions(t,e,this.config.topMargin),u=`${g.x-this.bleed+h/2.7} ${g.y-s-this.tileH}`,p=`${g.x-this.bleed+h/2.7} ${g.y-s}`,$=`${c.x+this.bleed-h/2.7} ${c.y-s}`,f=`${c.x+this.bleed-h/2.7} ${c.y-s-this.tileH}`,m=`${g.x-this.bleed+h/2.7+h/12} ${d.y-s}`,b=`${c.x-this.bleed-h/2.7-h/12} ${d.y-s}`;g.x,this.bleed,g.y,this.tileH,d.x,d.y,this.tileH,c.x,this.bleed,c.y,this.tileH,a.x,a.y,this.tileH;return{html:`<g style="z-index:${r};">\n\t\t\t<defs>${this.calculations.addGradient("pillarGradient",n,o)}</defs> \n\t\t\t<path fill="url(#pillarGradient)"\n\t\t\t d="M ${u} \n\t\t\tL ${p} \n\t\t\tC ${m}, ${b}, ${$} \n\t\t\tL ${f} \n\t\t\tL ${u} Z" /></g>`,coords:{top:a,left:g,bottom:d,right:c}}}createWindow(t,e,i,o,l){let n=i.id,r=i.h*this.tileH-this.tileH;const{top:h,left:s,bottom:a,right:g}=this.getPositions(t,e,this.config.topMargin);let d={top:h,left:s,bottom:a,right:g},c=(h.x,s.x,`<g style="z-index:${n+o.height};">`);if(o.edge.bottom){const t=(a.x-s.x)/3,e=(a.y-s.y)/8,i=`${s.x+t} ${s.y-r-this.tileH+7*e}`,o=`${s.x+t} ${s.y-r+e}`,n=`${a.x-t} ${a.y-r-4*e}`,h=`${a.x-t} ${a.y-r-this.tileH+2*e}`,g=`${a.x-t} ${a.y-r-this.tileH-e}`,d=`${s.x+t} ${s.y-r-this.tileH+4*e}`;let u="#111";if(l){Math.round(20*Math.random())}c+=`<path fill="${u}"\n\t\t\t\t\t\td="M${i} \n\t\t\t\t\t\tL${o} \n\t\t\t\t\t\tL${n} \n\t\t\t\t\t\tL${h} \n\t\t\t\t\t\tC${g}, ${d}, ${i} Z" />`}if(o.edge.right){const t=(g.x-a.x)/3,e=(g.y-a.y)/8,i=`${a.x+t} ${a.y-r-this.tileH-2*e}`,o=`${a.x+t} ${a.y-r+3.6*e}`,n=`${g.x-t} ${g.y-r-1*e}`,h=`${g.x-t} ${g.y-r-this.tileH-6.5*e}`,s=`${g.x-t} ${g.y-r-this.tileH-3.2*e}`,d=`${a.x+t} ${a.y-r-this.tileH+.3*e}`;let u="#222";if(l){Math.round(20*Math.random())}c+=`<path fill="${u}"\n\t\t\t\t\t\td="M${i} \n\t\t\t\t\t\tL${o} \n\t\t\t\t\t\tL${n} \n\t\t\t\t\t\tL${h} \n\t\t\t\t\t\tC${s}, ${d}, ${i} Z" />`}return{html:c+="</g>",coords:d}}createDoor(t,e,i,o,l){const r=i.id,h=i.h*this.tileH-this.tileH;let s,a,g;i.tileColor.hex()!==this.config.buildingBaseColor.hex()?(g=new n.Color(i.tileColor.hex()).getColorByHue(110).changeColorLightingString(60),s=new n.Color(i.tileColor.hex()).getColorByHue(220).changeColorLightingString(-80),a=new n.Color(i.tileColor.hex()).getColorByHue(220).changeColorLightingString(-110)):(g=new n.Color(this.config.buildingBaseColor.hex()).getColorByHue(110).changeColorLightingString(60),s=new n.Color(this.config.buildingBaseColor.hex()).getColorByHue(220).changeColorLightingString(-80),a=new n.Color(this.config.buildingBaseColor.hex()).getColorByHue(220).changeColorLightingString(-110));const{top:d,left:c,bottom:u,right:p}=this.getPositions(t,e,this.config.topMargin),$={top:d,left:c,bottom:u,right:p};d.x,c.x;let f=`<g style="z-index:${r+o.height};">`;if("bottom"===l){let t=(u.x-c.x)/4,e=(u.y-c.y)/8;console.log(e);const i=`${c.x+t} ${c.y-h-this.tileH+4.5*e}`,o=`${c.x+t} ${c.y-h+2*e}`,l=`${u.x-t} ${u.y-h-2*e}`,n=`${u.x-t} ${u.y-h-this.tileH+.5*e}`,r=`${c.x+t} ${c.y-h-this.tileH+4.5*e}`,s=`${u.x-t} ${u.y-h-2*e}`;f+=`<path stroke="#111" stroke-width="1.3"\n\t\t\t\t\t\td="M${r}\n\t\t\t\t\t\tL${`${u.x-t} ${u.y-h-this.tileH+.5*e}`}\n\t\t\t\t\t\tL${s}" />\n\t\t\t\t\t<path fill="${a}"\n\t\t\t\t\t\td="M${i} \n\t\t\t\t\t\tL${o} \n\t\t\t\t\t\tL${l} \n\t\t\t\t\t\tL${n} \n\t\t\t\t\t\tL${i} Z" />\n\t\t\t\t\t<circle fill="${g}" \n\t\t\t\t\t\tcx="${c.x+1.4*t}" \n\t\t\t\t\t\tcy="${u.y-h-this.tileH+2.8*e}" \n\t\t\t\t\t\tr="0.8" />`}if("right"===l){const t=(p.x-u.x)/4,e=(p.y-u.y)/8,i=`${u.x+t} ${u.y-h-this.tileH-e}`,o=`${u.x+t} ${u.y-h+2*e}`,l=`${p.x-t} ${p.y-h-1.5*e}`,n=`${p.x-t} ${p.y-h-this.tileH-4.5*e}`;f+=`<path stroke="#444" stroke-width="1.3"\n\t\t\t\t\t\td="M${n}\n\t\t\t\t\t\tL${i}\n\t\t\t\t\t\tL${o}" />\n\t\t\t\t\t<path fill="${s}"\n\t\t\t\t\t\td="M${i} \n\t\t\t\t\t\tL${o} \n\t\t\t\t\t\tL${l} \n\t\t\t\t\t\tL${n} \n\t\t\t\t\t\tL${i} Z" />\n\t\t\t\t\t<circle fill="${g}" \n\t\t\t\t\t\tcx="${u.x+1.3*t}" \n\t\t\t\t\t\tcy="${u.y-h-this.tileH-4.5*e}" \n\t\t\t\t\t\tr="0.8" />`}return{html:f+="</g>",coords:$}}createHalfArch(t,e,i,o){const l=i.id,n=i.h*this.tileH-this.tileH;let r,h,s,a,g,d;i.tileColor.hex()!==this.config.buildingBaseColor.hex()?(r=i.tileColor.hex(),s=i.tileColor.changeColorLightingString(30),h=i.tileColor.changeColorLightingString(-60),a=i.tileColor.changeColorLightingString(15),g=i.tileColor.changeColorLightingString(30)):(r=this.config.buildingBaseColor.hex(),s=this.config.buildingBaseColor.changeColorLightingString(30),h=this.config.buildingBaseColor.changeColorLightingString(-60),a=this.config.buildingBaseColor.changeColorLightingString(15),g=this.config.buildingBaseColor.changeColorLightingString(30));const{top:c,left:u,bottom:p,right:$}=this.getPositions(t,e,this.config.topMargin),f=($.x-p.x)/3;if("right-bottom"===o){const t=`${u.x-this.bleed} ${u.y-n-this.tileH}`,e=`${u.x-this.bleed} ${u.y-n+this.bleed}`,i=`${p.x} ${p.y-n+this.bleed}`,o=`${p.x} ${p.y-n-this.tileH}`,a=`${p.x} ${p.y-n-this.tileH}`,g=`${p.x} ${p.y-n+this.bleed}`,m=`${p.x} ${p.y-n-.5*this.tileH}`,b=`${p.x+.4*f} ${p.y-n-this.tileH}`,y=`${$.x+this.bleed} ${$.y-n-this.tileH}`,_=`${u.x-this.bleed} ${u.y-n-this.tileH}`;d=`<g style="z-index:${l};">\n\t\t\t\t\t\t<path fill="${h}"\n\t\t\t\t\t\td="M${t} \n\t\t\t\t\t\tL${e} \n\t\t\t\t\t\tL${i} \n\t\t\t\t\t\tL${o} \n\t\t\t\t\t\tL${t} Z" />\n\t\t\t\t\t\t<path fill="${r}"\n\t\t\t\t\t\td="M${a} \n\t\t\t\t\t\tL${g}\n\t\t\t\t\t\tC${m}, ${b}, ${y}\n\t\t\t\t\t\tL${a} Z" />\n\t\t\t\t\t\t<path fill="${s}"\n\t\t\t\t\t\td="M${_} \n\t\t\t\t\t\tL${`${p.x} ${p.y-n-this.tileH}`} \n\t\t\t\t\t\tL${`${$.x+this.bleed} ${$.y-n-this.tileH}`} \n\t\t\t\t\t\tL${`${c.x} ${c.y-n-this.tileH}`} \n\t\t\t\t\t\tL${_} Z" />\n\t\t\t\t\t</g>`}if("right-top"===o){u.x,this.bleed,u.y,this.tileH,u.x,this.bleed,u.y,this.bleed,p.x,p.y,this.bleed,p.x,p.y,this.tileH;const t=`${p.x} ${p.y-n-this.tileH}`,e=`${$.x+this.bleed-.3*f} ${$.y-n-.7*this.tileH}`,i=`${$.x} ${$.y-n-.4*this.tileH}`,o=`${$.x+this.bleed} ${$.y-n+this.bleed}`,a=`${$.x+this.bleed} ${$.y-n-this.tileH}`,g=`${u.x-this.bleed} ${u.y-n-this.tileH}`,m=`${p.x} ${p.y-n-this.tileH}`,b=`${$.x+this.bleed} ${$.y-n-this.tileH}`,y=`${c.x} ${c.y-n-this.tileH}`,_=`${$.x+this.bleed} ${$.y-n+this.bleed}`;d=`<g style="z-index:${l};">\n\t\t\t\t\t\t<path fill="${h}"\n\t\t\t\t\t\td="M${_} \n\t\t\t\t\t\tL${`${$.x+this.bleed} ${$.y-n-this.tileH}`} \n\t\t\t\t\t\tL${`${c.x-this.bleed} ${c.y-n-this.tileH}`} \n\t\t\t\t\t\tL${`${c.x-this.bleed} ${c.y-n}`} \n\t\t\t\t\t\tL${_} Z" />\n\t\t\t\t\t\t<path fill="${r}"\n\t\t\t\t\t\td="M${t} \n\t\t\t\t\t\tC${e}, ${i}, ${o}\n\t\t\t\t\t\tL${a} \n\t\t\t\t\t\tL${t} Z" />\n\t\t\t\t\t\t<path fill="${s}"\n\t\t\t\t\t\td="M${g} \n\t\t\t\t\t\tL${m} \n\t\t\t\t\t\tL${b} \n\t\t\t\t\t\tL${y} \n\t\t\t\t\t\tL${g} Z" />\n\t\t\t\t\t</g>`}return{html:d,coords:{top:c,left:u,bottom:p,right:$}}}createTowerTop(t,e,i){console.log("tile",i)}createTree(t,e){const i=t,o=e;return{html:`\n\t\t<defs>${this.calculations.addGradient("woodGradient","#443422","#664c2c")}</defs> \n\t\t<defs>${this.calculations.addGradient("leafGradient","#007c36","#5fb875")}</defs>\n\t\t<defs>${this.calculations.addGradient("shadow","#02001e00","#00000744")}</defs>\n\t\t\t<path fill="url(#woodGradient)" \n\t\t\td="M${i+34.3} ${o+89.4}\n\t\t\tl-0.4 21.3\n\t\t\tc0,0,0.2 3.9,4.2 3.9\n\t\t\tc3.4 0 3.5-4.4 3.5-4.4\n\t\t\tl-0.5-20.8\n\t\t\tL${i+34.3} ${o+89.4} z"/>\t\t\t\n\t\t\t<path fill="url(#leafGradient)"\n\t\t\td="M${i+38.6} ${o+32.8}\n\t\t\tc-9.9 0-18.5 20-18.5 39.7\n\t\t\ts12.4 23.1 18.1 23.1\n\t\t\ts17.8-4.3 17.8-23.2\n\t\t\tS${i+45.5} ${o+32.8} ${i+38.6} ${o+32.8} z"/>\n\t\t\t<polygon fill="url(#shadow)" \n\t\t\tpoints="${i+34.8} ${o+111} ${i+25.7} ${o+115.7} ${i+32.8} ${o+118.8} ${i+41} ${o+113}"/>`}}}},{"./colors.component":2,"./config.component":4,"./mapGenerationFunctions.component":17}],22:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});i.Tile=class{constructor(t,e,i,o,l,n,r){this._id=t,this._x=e,this._y=i,this._h=o,this._tileType=l,this._tileColor=n,r&&(this._options=r)}get id(){return this._id}get x(){return this._x}get y(){return this._y}get h(){return this._h}get type(){return this._tileType}get options(){return this._options?this._options:void 0}getColor(){return this._tileColor}get tileColor(){return this._tileColor}set tileColor(t){this._tileColor=t}set type(t){this._tileType=t}}},{}]},{},[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22]);
//# sourceMappingURL=bundle.min.js.map

!function t(e,i,o){function r(l,h){if(!i[l]){if(!e[l]){var s="function"==typeof require&&require;if(!h&&s)return s(l,!0);if(n)return n(l,!0);var a=new Error("Cannot find module '"+l+"'");throw a.code="MODULE_NOT_FOUND",a}var g=i[l]={exports:{}};e[l][0].call(g.exports,function(t){return r(e[l][1][t]||t)},g,g.exports,t,e,i,o)}return i[l].exports}for(var n="function"==typeof require&&require,l=0;l<o.length;l++)r(o[l]);return r}({1:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const o=t("./mapGenerationFunctions.component"),r=t("./config.component");i.Renderer=class{constructor(){this.config=new r.Config,this.calculations=new o.MapGenerationFunctions}showData(t){let e='<div class="showData">';return e+=`map width: ${t.mapWidth} tiles<br>map length: ${t.mapLength} tiles<br>`,e+=`tile width: ${this.config.tileWidth}<br>tile length: ${this.config.tileLength}<br>`,e+="</div>"}build2DMap(t){let e=`<div class="map" style="width:${this.config.getMapWidth(t.mapWidth)}px;">`;for(let i=0;i<t.mapLength;i++)for(let o=0;o<t.mapWidth;o++)if(e+=`<div class="tile" style="width:${this.config.tileWidth}px;height:${this.config.tileLength}px;`,t.getColumn(o,i).isDefined){let r=t.getTopTile(o,i),n=r.getColor().rgb();e+=`background-color:${`rgb(${n.r}, ${n.g}, ${n.b})`}">${r.id}<br>(${o}, ${i})</div>`}else e+=`">${o}, ${i}</div>`;return e+="</div>"}buildMap(t){let e=t.mapWidth,i=t.mapLength,o=this.createTile(0,0),r=(o.coords.bottom.x,o.coords.top.x,o.coords.right.y-o.coords.left.y),n=o.coords.top.x-o.coords.left.x,l=o.coords.right.x-o.coords.top.x,h=o.coords.right.y,s=h*e,a=(o.coords.bottom.y-o.coords.right.y)*i,g=Math.round((n+l)*e),d=Math.round(s+a);console.log("map:",t.map);const c=t.map;let u='<svg width="'+g+'" height="'+d+'">',p=null,_=n*(e-1);for(let t=0;t<i;t++)for(let i=0;i<e;i++){let e=0,o=0;0===i&&0===t&&(o=_),null!=p&&(e=p.coords.right.y),t>0&&0===i&&(o=_-n*t,e=h*t-r*t),i>0&&(o=p.coords.right.x-(p.coords.right.x-p.coords.bottom.x));let l=this.createTile(o,e),s="";if(c[t][i].isDefined){console.log(c[t][i]);for(let r=0;r<c[t][i].height;r++){s+=this.createBlock(o,e-this.config.tileHeight,c[t][i].getTile(r)).html}}u+=l.html+s,p=l}return u+="</svg>"}createTile(t,e){let i=this.config.tileWidth,o=this.config.tileLength,r=this.config.tileEdgeBleed,n=this.config.groundColor.hex(),l=this.calculations.calculateStraightLinesFromIsometricSquare(i,o),h={x:t+l.horizontalWidthFromTop,y:e},s={x:t,y:e+l.verticalHeightFromTop},a={x:t+l.horizontalWidthFromBottom,y:e+l.totalHeight},g={x:t+l.totalWidth,y:e+l.verticalHeightFromBottom},d=`${s.x-r} ${s.y}`;return{html:`<path fill="${n}"\n\t\t\t\t\td="M${d} \n\t\t\t\t\tL${`${a.x} ${a.y+r}`} \n\t\t\t\t\tL${`${g.x+r} ${g.y}`} \n\t\t\t\t\tL${`${h.x} ${h.y-r}`} \n\t\t\t\t\tL${d} Z" />`,coords:{top:h,left:s,bottom:a,right:g}}}createBlock(t,e,i){let o=this.config.tileWidth,r=this.config.tileLength,n=this.config.tileHeight,l=this.config.tileEdgeBleed,h=i.id,s=i.h*n-n,a=this.config.buildingBaseColor.hex(),g=`rgb(${this.config.buildingBaseColor.getHighlightsRGB().r},${this.config.buildingBaseColor.getHighlightsRGB().g},${this.config.buildingBaseColor.getHighlightsRGB().b})`,d=`rgb(${this.config.buildingBaseColor.getShadowsRGB().r},${this.config.buildingBaseColor.getShadowsRGB().g},${this.config.buildingBaseColor.getShadowsRGB().b})`,c=this.calculations.calculateStraightLinesFromIsometricSquare(o,r),u={x:t+c.horizontalWidthFromTop,y:e},p={x:t,y:e+c.verticalHeightFromTop},_={x:t+c.horizontalWidthFromBottom,y:e+c.totalHeight},f={x:t+c.totalWidth,y:e+c.verticalHeightFromBottom},m=`${p.x-l} ${p.y-s-n}`,b=`${_.x} ${_.y-s-n}`,$=`${p.x-l} ${p.y-s-n}`;return{html:`<g style="z-index:${h};"><path fill="${d}"\n\t\t\t\t\td="M${m} \n\t\t\t\t\tL${`${p.x-l} ${p.y-s+l}`} \n\t\t\t\t\tL${`${_.x} ${_.y-s+l}`} \n\t\t\t\t\tL${`${_.x} ${_.y-s-n}`} \n\t\t\t\t\tL${m} Z" />\n\t\t\t\t\t<path fill="${a}"\n\t\t\t\t\td="M${b} \n\t\t\t\t\tL${`${_.x} ${_.y-s+l}`} \n\t\t\t\t\tL${`${f.x+l} ${f.y-s+l}`} \n\t\t\t\t\tL${`${f.x+l} ${f.y-s-n}`} \n\t\t\t\t\tL${b} Z" />\n\t\t\t\t\t<path fill="${g}"\n\t\t\t\t\td="M${$} \n\t\t\t\t\tL${`${_.x} ${_.y-s-n}`} \n\t\t\t\t\tL${`${f.x+l} ${f.y-s-n}`} \n\t\t\t\t\tL${`${u.x} ${u.y-s-n}`} \n\t\t\t\t\tL${$} Z" /></g>`,coords:{top:u,left:p,bottom:_,right:f}}}}},{"./config.component":2,"./mapGenerationFunctions.component":4}],2:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const o=t("./mapGenerationFunctions.component");i.Config=class{constructor(){this._tileWidth=35,this._tileLength=35,this._tileHeight=20,this._tileSmallAngle=85,this._tileLargeAngle=100,this._groundColor=new o.Color("f5f3e5"),this._buildingBaseColor=new o.Color(125+Math.floor(75*Math.random()),170+Math.floor(40*Math.random()),180+Math.floor(30*Math.random())),this._tileEdgeBleed=.38}get tileWidth(){return this._tileWidth}get tileLength(){return this._tileLength}get tileHeight(){return this._tileHeight}get tileSmallAngle(){return this._tileSmallAngle}get tileLargeAngle(){return this._tileLargeAngle}get groundColor(){return this._groundColor}get buildingBaseColor(){return this._buildingBaseColor}get tileEdgeBleed(){return this._tileEdgeBleed}getMapWidth(t){return t*this._tileWidth}getMapLength(t){return t*this._tileLength}}},{"./mapGenerationFunctions.component":4}],3:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const o=t("./mapper.component"),r=t("./builder.component"),n=t("./config.component");const l=new class{constructor(){this._builder=new r.Renderer,this.config=new n.Config,this._map=new o.default(20,20,10,2,4+Math.floor(7*Math.random()),2,4),document.querySelector("body").style.background=this.config.groundColor.hex()}get map(){return this._map}colorMap(){return this._builder.showData(this._map)+this._builder.build2DMap(this._map)}drawTileMap(){return this._builder.buildMap(this._map)}};document.querySelector("#world").innerHTML=l.drawTileMap()},{"./builder.component":1,"./config.component":2,"./mapper.component":5}],4:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const o=t("./config.component");i.MapGenerationFunctions=class{constructor(){this.config=new o.Config,this.smallAngle=this.config.tileSmallAngle,this.largeAngle=this.config.tileLargeAngle}calculateAdditionalBlockIterations(t){return 2+Math.floor(Math.random()*t)}calculateStraightLinesFromIsometricSquare(t,e){let i=(180-this.smallAngle)/2,o=(180-this.largeAngle)/2,r=this.getHorizontalBottomShortestWidth(t,i),n=this.getVerticalBottomShortestHeight(r,i),l=this.getHorizontalTopLongestWidth(e,o),h=this.getVerticalTopLongestHeight(l,o);return{totalWidth:r+l,totalHeight:n+h,horizontalWidthFromBottom:r,horizontalWidthFromTop:l,verticalHeightFromBottom:n,verticalHeightFromTop:h}}getHorizontalBottomShortestWidth(t,e){return t*Math.sin(this.toRadians(e))}getVerticalBottomShortestHeight(t,e){return t*Math.cos(this.toRadians(e))}getHorizontalTopLongestWidth(t,e){return t*Math.sin(this.toRadians(e))}getVerticalTopLongestHeight(t,e){return t*Math.cos(this.toRadians(e))}toRadians(t){return t*(Math.PI/180)}},function(t){t[t.Red=125+Math.floor(75*Math.random())]="Red",t[t.Green=170+Math.floor(40*Math.random())]="Green",t[t.Blue=180+Math.floor(30*Math.random())]="Blue"}(i.TileColor||(i.TileColor={})),function(t){t.TallCenter="tallCenter",t.TallSurrounds="tallSurrounds",t.Random="random"}(i.BuildingHeightVariations||(i.BuildingHeightVariations={}));i.Color=class{constructor(...t){let e=null;if(1===t.length)if("string"==typeof t[0])if(this.validateHex(t[0])){let e=t[0];"#"!==e.charAt(0)&&(e=`#${e}`),this.setHex(e),this.hexToRgb()}else e="Hexadecimal color is incorrect";else e="Length of 1 in parameters is not equal to string";else 3===t.length&&(this.validateRgb(t)?(this.setRgb(t[0],t[1],t[2]),this.rgbToHex()):e="Values of RGB exceed limits");if(null!==e)throw"Color type is incorrect. "+e+": "+t.toString()}setRgb(t,e,i){this._colorRgb={r:t,g:e,b:i}}setHex(t){if(t.length<7){let e=t.charAt(1),i=t.charAt(2),o=t.charAt(3);t="#"+e+e+i+i+o+o}this._colorHex=t}rgb(){return this._colorRgb}hex(){return this._colorHex}validateRgb(t){return t[0]>-1&&t[0]<256&&t[1]>-1&&t[1]<256&&t[2]>-1&&t[2]<256}validateHex(t){return!!t.match(/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/)}hexToRgb(){let t=this._colorHex.substr(1).split(""),e=parseInt(t[0]+t[1],16),i=parseInt(t[2]+t[3],16),o=parseInt(t[4]+t[5],16);this.setRgb(e,i,o),this.rgbToHex()}rgbToHex(){if("object"==typeof this._colorRgb){let t=this._colorRgb.r,e=this._colorRgb.b,i=this._colorRgb.g,o=Number(t).toString(16),r=Number(i).toString(16),n=Number(e).toString(16);this._colorHex="#"+o+r+n}}getHighlightsRGB(){let t=this._colorRgb.r,e=this._colorRgb.b,i=t+45,o=this._colorRgb.g+45;return i>255&&(i=255),o>255&&(o=255),i>255&&(i=255),{r:i,g:o,b:e+30}}getShadowsRGB(){let t=this._colorRgb.r,e=this._colorRgb.b,i=t-70,o=this._colorRgb.g-70;return i<0&&(i=0),o<0&&(o=0),i<0&&(i=0),{r:i,g:o,b:e-60}}}},{"./config.component":2}],5:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const o=t("./mapGenerationFunctions.component"),r=t("./tile.component"),n=t("./config.component");i.default=class{constructor(t,e,i,h,s,a,g){this._mapGen=new o.MapGenerationFunctions,this.config=new n.Config,this._blockHeightVariationLabels=[o.BuildingHeightVariations.TallCenter,o.BuildingHeightVariations.TallSurrounds,o.BuildingHeightVariations.Random],this._blockHeightVariation=this._blockHeightVariationLabels[Math.floor(3*Math.random())],this._mapWidth=t,this._mapLength=e,this._mapMaxHeight=i,this._mapEdgeWidth=h,this._averageBuildingSize=s,this._blockHeight=a,this._maximumBlockIterations=g,this._additionalBlockIterations=this._mapGen.calculateAdditionalBlockIterations(g),this._blockGroups=[];let d=Math.floor(e/2),c=(Math.floor(t/2),this._averageBuildingSize+1+Math.floor(6*Math.random())),u=this._averageBuildingSize+Math.floor(5*Math.random()),p=6+Math.floor(6*Math.random()),_=Math.floor(c/2),f=(Math.floor(u/2),Math.floor(this._mapWidth/2)-Math.floor(p/2));this._world=[];let m,b=0;this._blockHeightVariation==o.BuildingHeightVariations.TallCenter?m=2*a:this._blockHeightVariation==o.BuildingHeightVariations.TallSurrounds?a=m=1+Math.round(Math.random()):m=a,console.log("Block height variation: "+this._blockHeightVariation);for(let t=0;t<this.mapLength;t++){this._world[t]=[];for(let e=0;e<this.mapWidth;e++){let i=0,o=new l(!1,e,t,0);if(t>=d&&t<=d+_&&e>f&&e<=f+u){i=1;let n=[];for(let o=0;o<m;o++){let l=0,h=0,s=o===m-1;n.push(new r.Tile(b,e,t,o,r.TileType.Body,this.config.buildingBaseColor,{roof:s,pillar:l,windowed:h,tower:!1})),-1===this._blockGroups.indexOf(i)?this._blockGroups[i]=new Array([t,e]):this._blockGroups[i].push([t,e]),b++}(o=new l(!0,e,t,m)).blockGroup=i,o.height=m,o.corner=!1,o.tileStack=n}this._world[t][e]=o}}this.setEdges()}get mapWidth(){return this._mapWidth}get mapLength(){return this._mapLength}get map(){return this._world}getColumn(t,e){return this._world[e][t]}getTiles(t,e){return this._world[e][t].tileStack}getTile(t,e,i){return this._world[e][t].getTile(i)}getTopTile(t,e){let i=this._world[e][t].height;return this._world[e][t].getTile(i-1)}setEdges(){for(let t=0;t<this.mapLength;t++)for(let e=0;e<this.mapWidth;e++)t>0&&e>0&&t<this.mapLength-1&&e<this.mapWidth-1&&this._world[t][e].isDefined&&(this._world[t-1][e].isDefined||(this._world[t][e].edge.top=!0),this._world[t+1][e].isDefined||(this._world[t][e].edge.bottom=!0),this._world[t][e-1].isDefined||(this._world[t][e].edge.left=!0),this._world[t][e+1].isDefined||(this._world[t][e].edge.right=!0),(this._world[t][e].edge.top&&this._world[t][e].edge.right||this._world[t][e].edge.top&&this._world[t][e].edge.left||this._world[t][e].edge.bottom&&this._world[t][e].edge.right||this._world[t][e].edge.bottom&&this._world[t][e].edge.left)&&(this._world[t][e].corner=!0))}};class l{constructor(t,e,i,o){this.defined=t,this.colX=e,this.colY=i,this.colHeight=o,this._edge={top:!1,right:!1,bottom:!1,left:!1},this._tileStack=[],this._defined=t,this._x=e,this._y=i,this._height=o}set x(t){this._x=t}set y(t){this._y=t}set height(t){this._height=t}set blockGroup(t){this._blockGroup=t}set corner(t){this._corner=t}set edge(t){this._edge=t}set tileStack(t){this._tileStack=t}get isDefined(){return this._defined}get x(){return this._x}get y(){return this._y}get height(){return this._height}get blockGroup(){return this._blockGroup}get corner(){return this._corner}get edge(){return this._edge}get tileStack(){return this._tileStack}getTile(t){return this._tileStack[t]}}},{"./config.component":2,"./mapGenerationFunctions.component":4,"./tile.component":6}],6:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o;i.Tile=class{constructor(t,e,i,o,r,n,l){this._options={},this._id=t,this._x=e,this._y=i,this._h=o,this._tileType=r,this._tileColor=n,l&&(this._options=l)}get id(){return this._id}get x(){return this._x}get y(){return this._y}get h(){return this._h}get type(){return this._tileType}get options(){return this._tileType!=o.None?this._options:{defined:!1}}getColor(){return this._tileColor}},function(t){t.None="none",t.Body="body",t.Tower="tower",t.Roof="roof"}(o=i.TileType||(i.TileType={}))},{}]},{},[1,2,3,4,5,6]);
//# sourceMappingURL=bundle.min.js.map

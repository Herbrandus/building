!function t(i,e,o){function l(h,r){if(!e[h]){if(!i[h]){var s="function"==typeof require&&require;if(!r&&s)return s(h,!0);if(n)return n(h,!0);var a=new Error("Cannot find module '"+h+"'");throw a.code="MODULE_NOT_FOUND",a}var g=e[h]={exports:{}};i[h][0].call(g.exports,function(t){return l(i[h][1][t]||t)},g,g.exports,t,i,e,o)}return e[h].exports}for(var n="function"==typeof require&&require,h=0;h<o.length;h++)l(o[h]);return l}({1:[function(t,i,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=t("./mapGenerationFunctions.component"),l=t("./tile.component"),n=t("./config.component"),h=t("./renderelements.component");e.Renderer=class{constructor(){this.config=new n.Config,this.calculations=new o.MapGenerationFunctions,this.render=new h.RenderElements}showData(t){let i='<div class="showData">';return i+=`map width: ${t.mapWidth} tiles<br>map length: ${t.mapLength} tiles<br>`,i+=`tile width: ${this.config.tileWidth}<br>tile length: ${this.config.tileLength}<br>`,i+="</div>"}build2DMap(t){let i=`<div class="map" style="width:${this.config.getMapWidth(t.mapWidth+1)}px;">`;i+=`<div class="tile axis" style="width:${this.config.tileWidth}px;height:${this.config.tileLength}px;"></div>`;for(let e=0;e<t.mapWidth;e++)i+=`<div class="tile axis" style="width:${this.config.tileWidth}px;height:${this.config.tileLength}px;">${e}</div>`;for(let e=0;e<t.mapLength;e++){let o="";e===Math.round(t.mapLength/2)&&(o=" half"),i+=`<div class="tile axis${o}" style="width:${this.config.tileWidth}px;height:${this.config.tileLength}px;">${e}</div>`;for(let n=0;n<t.mapWidth;n++)if(i+=`<div class="tile${o}" style="width:${this.config.tileWidth}px;height:${this.config.tileLength}px;`,t.getColumn(n,e).isDefined&&t.getTopTile(n,e)){let o=t.getTopTile(n,e).getColor().rgb(),h=`rgb(${o.r}, ${o.g}, ${o.b})`,r=!1;for(let i=0;i<t.map[e][n].height;i++)if(t.map[e][n].tileStack[i].type===l.TileType.None){r=!0;break}let s=!!(t.map[e][n].edge.top||t.map[e][n].edge.right||t.map[e][n].edge.bottom||t.map[e][n].edge.left),a=t.map[e][n].blockGroup;i+=`background-color:${h}">${r?"x":""}<div class="tileInfo">x: ${n} y: ${e}<br>height: ${t.map[e][n].height}<br>edge: ${s}<br>group: ${a}</div></div>`}else i+='"></div>'}return i+="</div>"}buildMap(t){let i=t.mapWidth,e=t.mapLength;const o=this.config.tileHeight,n=this.config.lightInWindows;console.log("windowLights",n);let h=this.render.createTile(0,0,""),r=(h.coords.bottom.x,h.coords.top.x,h.coords.right.y-h.coords.left.y),s=h.coords.top.x-h.coords.left.x,a=h.coords.right.x-h.coords.top.x,g=h.coords.right.y,d=g*i,c=(h.coords.bottom.y-h.coords.right.y)*e,p=Math.round((s+a)*i),m=Math.round(d+c)+this.config.topMargin;const $=this.config.groundColor.changeColorLighting(-20),f=t.map;let u='<svg width="'+p+'" height="'+m+'">',b=null,y=s*(i-1);const _=Math.floor(5*Math.random()),x=Math.floor(5*Math.random());let M="";1===_?M="triangles":3===_&&(M="squares");for(let t=0;t<e;t++)for(let h=0;h<i;h++){let a=0,d=0;0===h&&0===t&&(d=y),null!=b&&(a=b.coords.right.y),t>0&&0===h&&(d=y-s*t,a=g*t-r*t),h>0&&(d=b.coords.right.x-(b.coords.right.x-b.coords.bottom.x));let c=this.render.createTile(d,a,"shade"),p="";if(f[t][h].isDefined){if(f[t][h].tileStack[0].type===l.TileType.Shadow){let i=$;p+=this.render.createPlane(d,a,f[t][h].tileStack[0],i).html}else if(f[t][h].tileStack[0].type===l.TileType.Grass){let i=f[t][h].tileStack[0].tileColor;p+=this.render.createPlane(d,a,f[t][h].tileStack[0],i).html}if(f[t][h].height>0){p+=this.render.createPlane(d,a,f[t][h].tileStack[0],$).html;let r=!1;for(let s=0;s<f[t][h].height;s++){let g,c=f[t][h].tileStack[s];if((g=c.options?c.options:{roof:!1,pillar:!1,slope:!1,windowed:0,tower:!1,stairs:!1,halfArch:!1,wholeArch:!1}).slope&&(r=!0),c.type===l.TileType.Body){if(c.options.slope){p+=this.render.createSlopeBlock(d,a+4.75*o,f[t][h].getTile(s),"e").html}else if(!r){let i="";if(f[t][h].blockGroup%2==1&&s===f[t][h].height-1&&(i=M,x>2&&(1===_?i="triangles":3===_&&(i="squares"))),p+=this.render.createBlock(d,a-o,c,i).html,c.options.windowed>0){if((f[t][h].edge.right||f[t][h].edge.bottom)&&Math.round(6*Math.random())>4){p+=this.render.createWindow(d,a-o,c,f[t][h],n).html}if(f[t][h].edge.bottom&&(s===f[t+1][h].height||0===s)&&Math.round(10*Math.random())>8){p+=this.render.createDoor(d,a-o,c,f[t][h],"bottom").html}else if(f[t][h].edge.right&&(s===f[t][h+1].height||0===s)&&Math.round(10*Math.random())>8){p+=this.render.createDoor(d,a-o,c,f[t][h],"right").html}}}}else if(g.tower||c.type!==l.TileType.HalfBlock){if(!g.tower&&c.type===l.TileType.None){if(c.options.pillar&&s<f[t][h].height&&(t<e/2-1||t>e/2)){p+=this.render.createPillarBlock(d,a-o,c).html}if(c.options.halfArch)if(f[t+1][h].isDefined&&f[t+1][h].height>0&&f[t+1][h].height>s&&f[t+1][h].tileStack[s].type===l.TileType.None){p+=this.render.createHalfArch(d,a-o,c,"right-top").html}else if(f[t-1][h].isDefined&&f[t-1][h].height>0&&f[t-1][h].height>s&&f[t-1][h].tileStack[s].type===l.TileType.None){p+=this.render.createHalfArch(d,a-o,c,"right-bottom").html}}}else{p+=this.render.createHalfBlock(d,a-o,c).html}if(s===f[t][h].height-1&&c.options.tower){let l="";if(t>0&&t<e&&h<i&&(f[t-1][h].tileStack[s]&&f[t-1][h].tileStack[s].options.tower&&(l="se"),f[t+1][h].tileStack[s]&&f[t+1][h].tileStack[s].options.tower&&(l="ne"),""!==l)){p+=this.render.createSlopeBlock(d,a=o,c,l).html}}}}}u+=p,b=c}return'<div id="debug"></div>'+(u+="</svg>")}addSlopedEdges(t,i,e,o,l,n){let h=null;return h=t[e][i].edge.top&&!t[e][i].corner&&o===t[e][i].height-1?this.render.createSlopeBlock(l,n-this.config.tileHeight,t[e][i].getTile(o),"n"):t[e][i].edge.bottom&&!t[e][i].corner&&o===t[e][i].height-1?this.render.createSlopeBlock(l,n-this.config.tileHeight,t[e][i].getTile(o),"s"):t[e][i].edge.right&&!t[e][i].corner&&o===t[e][i].height-1?this.render.createSlopeBlock(l,n-this.config.tileHeight,t[e][i].getTile(o),"e"):t[e][i].edge.left&&!t[e][i].corner&&o===t[e][i].height-1?this.render.createSlopeBlock(l,n-this.config.tileHeight,t[e][i].getTile(o),"w"):this.render.createBlock(l,n-this.config.tileHeight,t[e][i].getTile(o)),t[e][i].corner&&o===t[e][i].height-1&&(t[e][i].edge.top&&t[e][i].edge.left?h=this.render.createSlopeBlock(l,n-this.config.tileHeight,t[e][i].getTile(o),"nw"):t[e][i].edge.top&&t[e][i].edge.right?h=this.render.createSlopeBlock(l,n-this.config.tileHeight,t[e][i].getTile(o),"ne"):t[e][i].edge.bottom&&t[e][i].edge.left?h=this.render.createSlopeBlock(l,n-this.config.tileHeight,t[e][i].getTile(o),"sw"):t[e][i].edge.bottom&&t[e][i].edge.right&&(h=this.render.createSlopeBlock(l,n-this.config.tileHeight,t[e][i].getTile(o),"se"))),h}}},{"./config.component":2,"./mapGenerationFunctions.component":5,"./renderelements.component":9,"./tile.component":10}],2:[function(t,i,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=t("./mapGenerationFunctions.component");e.Config=class{constructor(){this._allowDebug=!0,this._tileWidth=16,this._tileLength=16,this._tileHeight=14,this._tileSmallAngle=85,this._tileLargeAngle=100,this._groundColor=new o.Color("#f5f3e5"),this._buildingBaseColor=new o.Color(125+Math.floor(75*Math.random()),125+Math.floor(40*Math.random()),160+Math.floor(30*Math.random())),this._tileEdgeBleed=.3,this._maxAllowedHeight=12,this._topMargin=80,this._allowSurroundingDecorations=!0,this._allowWindows=!1,this._lightInWindows=Math.round(8*Math.random())>6,this._goldenRatio=1.61803399,this._fibonacci=[1,2,3,5,8,13]}get allowDebug(){return this._allowDebug}get tileWidth(){return this._tileWidth}get tileLength(){return this._tileLength}get tileHeight(){return this._tileHeight}get tileSmallAngle(){return this._tileSmallAngle}get tileLargeAngle(){return this._tileLargeAngle}get groundColor(){return this._groundColor}get buildingBaseColor(){return this._buildingBaseColor}get tileEdgeBleed(){return this._tileEdgeBleed}get maxAllowedHeight(){return this._maxAllowedHeight}get topMargin(){return this._topMargin}get lightInWindows(){return this._lightInWindows}get allowWindows(){return this._allowWindows}get allowSurroundingDecorations(){return this._allowSurroundingDecorations}get goldenRatio(){return this._goldenRatio}get fibonacci(){return this._fibonacci}getMapWidth(t){return t*this._tileWidth}getMapLength(t){return t*this._tileLength}}},{"./mapGenerationFunctions.component":5}],3:[function(t,i,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=t("./mapper.component"),l=t("./config.component"),n=t("./tile.component");e.Decorations=class{constructor(){this.config=new l.Config}placeRandomTrees(t){const i=Math.floor(8*Math.random());let e=0;const l=[];for(let e=0;e<i;e++)l.push(Math.floor(5+Math.random()*(t.mapLength-5)));for(let l=0;l<t.mapLength;l++)for(let h=1;h<t.mapWidth;h++)if(!t.map[l][h].isDefined){if(Math.floor(20*Math.random())>10&&e<i){let i=new o.Column(!0,h,l,0);i.tileStack=[new n.Tile(1e4+e,h,l,0,n.TileType.None,this.config.groundColor,{roof:!1,pillar:!1,slope:!1,windowed:0,tower:!1,stairs:!1,halfArch:!1,wholeArch:!1,areaDecoration:"tree"})],t.map[l][h]=i,console.log("placed tree on y = "+l+", x = "+h),e++}}return t.map}}},{"./config.component":2,"./mapper.component":6,"./tile.component":10}],4:[function(t,i,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=t("./mapper.component"),l=t("./builder.component"),n=t("./config.component");class h{constructor(){this._builder=new l.Renderer,this.config=new n.Config,this._map=new o.Map(36,36,10,1,5,3,3,!1),document.querySelector("body").style.background=this.config.groundColor.hex(),console.log("this.config.lightInWindows",this.config.lightInWindows)}debug(){return this.config.allowDebug}get map(){return this._map}colorMap(){return this._builder.build2DMap(this._map)}addToBuildingAndRedraw(){return this._map.addToBuilding(),this._builder.build2DMap(this._map)}drawTileMap(){return this._builder.buildMap(this._map)}getBaseColor(){const t=this.map.getFirstDefinedColumn();return t.tileStack[t.tileStack.length-1].getColor()}getImageTag(){document.querySelector("#buildingimg")&&document.querySelector("#buildingimg").remove();let t=(new XMLSerializer).serializeToString(document.querySelector("svg")),i=window.btoa(t),e=document.createElement("img");e.setAttribute("id","buildingimg"),window.debug&&e.setAttribute("class","debug-active"),e.setAttribute("src","data:image/svg+xml;base64,"+i);let o=document.querySelector("#worldtest");document.querySelector("body").insertBefore(e,o)}}window.debug=!1,window.activateDebug=()=>{window.debug=!0,document.querySelector("#color").classList.remove("hide"),document.querySelector("#add").classList.remove("hide"),document.querySelector("#color-scheme").classList.remove("hide"),document.querySelector("#buildingimg")&&document.querySelector("#buildingimg").classList.add("debug-active"),document.querySelector("#color").innerHTML=r.colorMap()};let r=new h;function s(t){const i=t.getBaseColor(),e=i.changeColorLightingString(0),o=i.changeColorLightingString(20),l=(i.changeColorLightingString(-20),`\n\t\t<div class="color__tile" style="background-color:${e};"></div>\n\t\t<div class="color__tile" style="background-color:${o};"></div>\n\t\t<div class="color__tile" style="background-color:${i.getColorStringByHue(60)};"></div>\n\t\t<div class="color__tile" style="background-color:${i.getColorStringByHue(120)};"></div>\n\t\t<div class="color__tile" style="background-color:${i.getColorStringByHue(180)};"></div>\n\t\t<div class="color__tile" style="background-color:${i.getColorStringByHue(240)};"></div>\n\t\t<div class="color__tile" style="background-color:${i.getColorStringByHue(300)};"></div>`);document.querySelector("#color-scheme").innerHTML=l}r.debug()&&window.activateDebug(),document.querySelector("#worldtest").innerHTML=r.drawTileMap(),r.debug()||(r.getImageTag(),document.querySelector("#worldtest").classList.add("hide")),s(r),document.querySelector("#add").addEventListener("click",()=>{document.querySelector("#color").innerHTML=r.addToBuildingAndRedraw(),document.querySelector("#worldtest").innerHTML=r.drawTileMap()}),document.querySelector("#generate").addEventListener("click",()=>{r=new h,window.debug&&(document.querySelector("#color").innerHTML=r.colorMap()),document.querySelector("#worldtest").innerHTML=r.drawTileMap(),r.debug()||(r.getImageTag(),document.querySelector("#worldtest").classList.add("hide")),document.querySelectorAll(".point").forEach(t=>{t.addEventListener("click",()=>{console.log("toggled",t),t.parentElement.classList.toggle("active")})}),s(r)})},{"./builder.component":1,"./config.component":2,"./mapper.component":6}],5:[function(t,i,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=t("./config.component");e.MapGenerationFunctions=class{constructor(){this.config=new o.Config,this.smallAngle=this.config.tileSmallAngle,this.largeAngle=this.config.tileLargeAngle}calculateAdditionalBlockIterations(t){return 2+Math.floor(Math.random()*t)}calculateStraightLinesFromIsometricSquare(t,i){let e=(180-this.smallAngle)/2,o=(180-this.largeAngle)/2,l=this.getHorizontalBottomShortestWidth(t,e),n=this.getVerticalBottomShortestHeight(l,e),h=this.getHorizontalTopLongestWidth(i,o),r=this.getVerticalTopLongestHeight(h,o);return{totalWidth:l+h,totalHeight:n+r,horizontalWidthFromBottom:l,horizontalWidthFromTop:h,verticalHeightFromBottom:n,verticalHeightFromTop:r}}getHorizontalBottomShortestWidth(t,i){return t*Math.sin(this.toRadians(i))}getVerticalBottomShortestHeight(t,i){return t*Math.cos(this.toRadians(i))}getHorizontalTopLongestWidth(t,i){return t*Math.sin(this.toRadians(i))}getVerticalTopLongestHeight(t,i){return t*Math.cos(this.toRadians(i))}addGradient(t,i,e){let o='<linearGradient id="'+t+'">';return o+='<stop offset="5%" stop-color="'+i+'" />',o+='<stop offset="95%" stop-color="'+e+'" />',o+="</linearGradient>"}toRadians(t){return t*(Math.PI/180)}getHighestXfromArray(t){let i={x:0,y:0};return t.forEach(t=>{t.x>i.x&&(i=t)}),i}getHighestYfromArray(t){let i={x:0,y:0};return t.forEach(t=>{t.y>i.y&&(i=t)}),i}getLowestXfromArray(t){let i=this.getHighestXfromArray(t);return t.forEach(t=>{t.x<i.x&&(i=t)}),i}getLowestYfromArray(t){let i=this.getHighestYfromArray(t);return t.forEach(t=>{t.y<i.y&&(i=t)}),i}},function(t){t[t.Red=125+Math.floor(75*Math.random())]="Red",t[t.Green=170+Math.floor(40*Math.random())]="Green",t[t.Blue=180+Math.floor(30*Math.random())]="Blue"}(e.TileColor||(e.TileColor={})),function(t){t.TallCenter="tallCenter",t.TallSurrounds="tallSurrounds",t.Random="random"}(e.BuildingHeightVariations||(e.BuildingHeightVariations={}));e.Color=class{constructor(...t){let i=null;if(1===t.length)if("string"==typeof t[0])if(this.validateHex(t[0])){let i=t[0];"#"!==i.charAt(0)&&(i=`#${i}`),this.setHex(i),this.hexToRgb(),this.convertToHSL()}else i="Hexadecimal color is incorrect";else i="Length of 1 in parameters is not equal to string";else 3===t.length&&(this.validateRgb(t)?(this.setRgb(t[0],t[1],t[2]),this.rgbToHex(),this.convertToHSL()):i="Values of RGB exceed limits");if(null!==i)throw"Color type is incorrect. "+i+": "+t.toString()}setRgb(t,i,e){this._colorRgb={r:t,g:i,b:e}}setHsl(t,i,e){this._colorHsl={h:t,s:i,l:e}}setHex(t){if(t.length<7){let i=t.charAt(1),e=t.charAt(2),o=t.charAt(3);t="#"+i+i+e+e+o+o}this._colorHex=t}rgb(){return this._colorRgb}hex(){return this._colorHex}hsl(){return this._colorHsl}validateRgb(t){return t[0]>-1&&t[0]<256&&t[1]>-1&&t[1]<256&&t[2]>-1&&t[2]<256}validateHex(t){return!!t.match(/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/)}hexToRgb(){let t=this._colorHex.substr(1).split(""),i=parseInt(t[0]+t[1],16),e=parseInt(t[2]+t[3],16),o=parseInt(t[4]+t[5],16);this.setRgb(i,e,o),this.rgbToHex()}rgbToHex(){if("object"==typeof this._colorRgb){let t=this._colorRgb.r,i=this._colorRgb.b,e=this._colorRgb.g,o=Number(t).toString(16),l=Number(e).toString(16),n=Number(i).toString(16);this._colorHex="#"+o+l+n}}convertRGBtoHex(t){let i=t.r,e=t.b,o=t.g;return"#"+Number(i).toString(16)+Number(o).toString(16)+Number(e).toString(16)}changeColorLightingString(t){let i=this._colorRgb.r,e=this._colorRgb.b,o=i+t,l=this._colorRgb.g+t,n=e+(t-8);return o>255&&(o=255),l>255&&(l=255),o>255&&(o=255),"#"+Number(o).toString(16)+Number(l).toString(16)+Number(n).toString(16)}changeColorLighting(t){let i=this._colorRgb.r,e=(this._colorRgb.b,i+t),o=this._colorRgb.g+t;return e>255&&(e=255),o>255&&(o=255),e>255&&(e=255),this.setRgb(e,o,e),this.rgbToHex(),this.convertToHSL(),this}getLightestRGB(){let t=this._colorRgb.r,i=this._colorRgb.b,e=t+55,o=this._colorRgb.g+55;return e>255&&(e=255),o>255&&(o=255),e>255&&(e=255),{r:e,g:o,b:i+40}}getHighlightsRGB(){let t=this._colorRgb.r,i=this._colorRgb.b,e=t+45,o=this._colorRgb.g+45;return e>255&&(e=255),o>255&&(o=255),e>255&&(e=255),{r:e,g:o,b:i+30}}getDarkerRegularRGB(){let t=this._colorRgb.r,i=this._colorRgb.b,e=t+15,o=this._colorRgb.g+15;return e>255&&(e=255),o>255&&(o=255),e>255&&(e=255),{r:e,g:o,b:i+5}}getHalflightsRGB(){let t=this._colorRgb.r,i=this._colorRgb.b,e=t+25,o=this._colorRgb.g+25;return e>255&&(e=255),o>255&&(o=255),e>255&&(e=255),{r:e,g:o,b:i+15}}getShadowsRGB(){let t=this._colorRgb.r,i=this._colorRgb.b,e=t-55,o=this._colorRgb.g-55;return e<0&&(e=0),o<0&&(o=0),e<0&&(e=0),{r:e,g:o,b:i-35}}getDarkestRGB(){let t=this._colorRgb.r,i=this._colorRgb.b,e=t-70,o=this._colorRgb.g-70;return e<0&&(e=0),o<0&&(o=0),e<0&&(e=0),{r:e,g:o,b:i-60}}getColorStringByHue(t){let i=this._colorHsl.h,e=this._colorHsl.s,o=this._colorHsl.l,l=i+t;l>360&&(l%=360);let n=this.convertHSLtoRGB({h:l,s:e,l:o});return this.convertRGBtoHex(n)}getColorByHue(t){let i=this._colorHsl.h,e=this._colorHsl.s,o=this._colorHsl.l,l=i+t;l>360&&(l%=360);let n=this.convertHSLtoRGB({h:l,s:e,l:o});return this.setRgb(n.r,n.g,n.b),this.rgbToHex(),this}convertToHSL(){let t=this._colorRgb.r,i=this._colorRgb.b,e=this._colorRgb.g;t/=255,e/=255,i/=255;let o=Math.min(t,e,i),l=Math.max(t,e,i),n=l-o,h=0,r=0,s=0;h=0===n?0:l===t?(e-i)/n%6:l===e?(i-t)/n+2:(t-e)/n+4,(h=Math.round(60*h))<0&&(h+=360),s=(l+o)/2,r=+(100*(r=0===n?0:n/(1-Math.abs(2*s-1)))).toFixed(1),s=+(100*s).toFixed(1),this._colorHsl={h:h,s:r,l:s}}convertHSLtoRGB(t){let i=t.h,e=t.s,o=t.l;e/=100,o/=100;let l=(1-Math.abs(2*o-1))*e,n=l*(1-Math.abs(i/60%2-1)),h=o-l/2,r=0,s=0,a=0;return 0<=i&&i<60?(r=l,s=n,a=0):60<=i&&i<120?(r=n,s=l,a=0):120<=i&&i<180?(r=0,s=l,a=n):180<=i&&i<240?(r=0,s=n,a=l):240<=i&&i<300?(r=n,s=0,a=l):300<=i&&i<360&&(r=l,s=0,a=n),{r:r=Math.round(255*(r+h)),g:s=Math.round(255*(s+h)),b:a=Math.round(255*(a+h))}}}},{"./config.component":2}],6:[function(t,i,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=t("./mapGenerationFunctions.component"),l=t("./tile.component"),n=t("./config.component"),h=t("./primitives.component"),r=t("./modifiers.component"),s=t("./decorations.component");e.Map=class{constructor(t,i,e,g,d,c,p,m=!1){this.mapGen=new o.MapGenerationFunctions,this.config=new n.Config,this.primitives=new h.Primitives,this.mods=new r.Modifiers,this.deco=new s.Decorations,this._blockHeightVariationLabels=[o.BuildingHeightVariations.TallCenter,o.BuildingHeightVariations.TallSurrounds,o.BuildingHeightVariations.Random],this._blockHeightVariation=this._blockHeightVariationLabels[Math.floor(3*Math.random())],this._world=[],this._mapWidth=t,this._mapLength=i,this._mapMaxHeight=e,this._mapEdgeWidth=g,this._averageBuildingSize=d,this._blockHeight=c,this._mirrorAtCenter=m;let $;$=this._blockHeightVariation===o.BuildingHeightVariations.TallCenter?2:this._blockHeightVariation===o.BuildingHeightVariations.TallSurrounds?8:4,0===Math.round(Math.random())?(this._startBlockWidth=this._averageBuildingSize+Math.floor(Math.random()*$),this._startBlockLength=Math.floor(this._startBlockWidth*this.config.goldenRatio)):(this._startBlockLength=this._averageBuildingSize+Math.floor(Math.random()*$),this._startBlockWidth=Math.floor(this._startBlockLength*this.config.goldenRatio)),this._maximumBlockIterations=p,this._additionalBlockIterations=this.mapGen.calculateAdditionalBlockIterations(p),this._blockGroups=[],this._blockEdges=[],this._blockHeightsArray=[],this._mapHalfLength=Math.floor(i/2),this._blockIdIterator=0,this._blockAmountIterator=1,this._blockHeightIterator=1,this._decorationLineH=-1;let f=this.config.buildingBaseColor.getColorStringByHue(-120),u=new o.Color(f);this._defaultColor=new o.Color(this.config.buildingBaseColor.hex()),this._lineColor=u.changeColorLighting(-30),this._firstLevelColor=new o.Color(this.config.buildingBaseColor.getColorStringByHue(10)).changeColorLighting(-20),this._groundColor=this.config.groundColor,this._HorizontalRemainingEmptyBlocksMin=0,this._HorizontalRemainingEmptyBlocksMax=0,this._surroundingsGrassColor=new o.Color("#7bb376"),this._surroundingsWaterColor=new o.Color("#6fb9ca"),this._surroundingsSandColor=new o.Color("#e9e3ba"),this._surroundingsDefaultColor=this._surroundingsGrassColor,this._showWindows=this.config.allowWindows?Math.round(2*Math.random()):0;let b=0;this._mirrorAtCenter||(b=-8,0===Math.round(Math.random())&&(b=8),console.log("not mirrorred: dev:",b));let y=Math.floor(i/2),_=(Math.floor(t/2),4+Math.floor(7*Math.random())),x=Math.floor(this._startBlockLength/2),M=(Math.floor(this._startBlockWidth/2),Math.floor(this._mapWidth/2)-Math.floor(_/2)),L=!!Math.round(2*Math.random()),H=!1,w=Math.floor(Math.random()*this.config.fibonacci.length),k=this.config.fibonacci[w],C=0;this._defaultColor.rgb().g>=180&&this._defaultColor.rgb().b>=150&&Math.round(4*Math.random())>=3?(H=Math.round(10*Math.random())>6,this._surroundingsDefaultColor=this._surroundingsWaterColor):Math.round(10*Math.random())<=1&&(H=Math.round(10*Math.random())>3,this._surroundingsDefaultColor=this._surroundingsWaterColor),this._blockHeightVariation===o.BuildingHeightVariations.TallCenter?k=this.config.fibonacci[p]:this._blockHeightVariation===o.BuildingHeightVariations.TallSurrounds&&(k=2+this.config.fibonacci[0],this._blockHeight=k);let S=!1;3===k&&(S=!0),k>6?this._decorationLineH=4:k>3&&(this._decorationLineH=3),k<4&&Math.round(5*Math.random())>2&&(C=M+Math.ceil(Math.random()*this._startBlockWidth-2)),this._blockHeight=k;let T=1===Math.round(Math.random()),B=this._blockHeight>2&&1===Math.round(Math.random());for(let t=0;t<this.mapLength;t++){this._world[t]=[];for(let i=0;i<this.mapWidth;i++){let e,o=0,n=new a(!1,i,t,0),h=i>M&&i<=M+this._startBlockWidth;if((e=this._mirrorAtCenter?t>=y&&t<=y+x:t>=y+b&&t<=y+(b+this._startBlockLength))&&h){o=1;let e=[];for(let n=0;n<this._blockHeight;n++){let h=!1,r=l.TileType.Body;n<2&&B&&(t%2==0&&(h=!0),r=l.TileType.None),this._decorationLineH>3&&n+1===this._decorationLineH&&n+1<this._blockHeight&&(r=l.TileType.None,t%2==0&&(h=!0));let s=0;!h&&this._showWindows>0&&n%2==1&&(s=this._showWindows);let a=n===this._blockHeight-1,g=this._defaultColor;g=n===this._decorationLineH?this._lineColor:0===n?this._firstLevelColor:this._defaultColor;let d=!1;n<this._blockHeight&&t===C&&(0===n?i===M+this._startBlockWidth&&(d=!0):1===n?i===M+this._startBlockWidth-1?d=!0:i===M+this._startBlockWidth&&(r=l.TileType.None):2===n&&(i===M+this._startBlockWidth-2?d=!0:i>M+this._startBlockWidth-2&&(r=l.TileType.None))),S&&n<2&&(r=l.TileType.None,(t%2==0&&i%2==1||t%2==1&&i%2==0)&&(h=!0)),e.push(new l.Tile(this._blockIdIterator,i,t,n,r,g,{roof:a,pillar:h,slope:d,windowed:s,tower:!1,stairs:!1,halfArch:!1,wholeArch:!1,areaDecoration:""})),-1===this._blockGroups.indexOf(o)&&this._blockGroups.push(o),this._blockHeightsArray.push(this._blockHeight),this._blockIdIterator++}(n=new a(!0,i,t,this._blockHeight)).blockGroup=o,n.height=this._blockHeight,n.corner=!1,n.tileStack=e}this._world[t][i]=n}}if(this.setEdges(!1),T&&this._blockHeight>2)for(let t=0;t<this.mapLength;t++)for(let i=0;i<this.mapWidth;i++){if(this._world[t][i].edge.left)for(let e=0;e<this._blockHeight;e++)this._world[t][i].tileStack[e].type===l.TileType.None&&t%2==0&&(this._world[t][i].tileStack[e].options.pillar=!0);if(this._world[t][i].edge.bottom)for(let e=0;e<this._blockHeight;e++)this._world[t][i].tileStack[e].type===l.TileType.None&&i%2==0&&(this._world[t][i].tileStack[e].options.pillar=!0);if(this._world[t][i].edge.right)for(let e=0;e<this._blockHeight;e++)this._world[t][i].tileStack[e].type===l.TileType.None&&t%2==0&&(this._world[t][i].tileStack[e].options.pillar=!0);if(this._world[t][i].edge.top)for(let e=0;e<this._blockHeight;e++)this._world[t][i].tileStack[e].type===l.TileType.None&&i%2==0&&(this._world[t][i].tileStack[e].options.pillar=!0);let e=!!(this._world[t][i].edge.left||this._world[t][i].edge.bottom||this._world[t][i].edge.right);this._world[t][i].isDefined&&!e&&(this._world[t][i]=new a(!1,i,t,0))}for(let t=0;t<this._additionalBlockIterations;t++)this.getEdges(),this._world=this.mods.addBuildingComponent(this);if(console.log("remove excess arches"),this._world=this.mods.removeExcessArches(this),this.config.allowSurroundingDecorations&&L){if(this._HorizontalRemainingEmptyBlocksMin=this.getLeastOpenSpaceOnX().min,this._HorizontalRemainingEmptyBlocksMax=this.getLeastOpenSpaceOnX().max,this._HorizontalRemainingEmptyBlocksMin>7){let t=2*this._HorizontalRemainingEmptyBlocksMin;t>16&&(t=16);let i=this._mapLength-t;for(let t=Math.floor(i/2);t<this.mapLength-Math.floor(i/2);t++)for(let e=0;e<this._HorizontalRemainingEmptyBlocksMin-3;e++)if(!this._world[t][e].isDefined){let o=l.TileType.Grass,n=this._surroundingsDefaultColor,h=0;0===e||e===this._HorizontalRemainingEmptyBlocksMin-4?H?(n=this._defaultColor,o=l.TileType.HalfBlock,h=1):(n=this._surroundingsSandColor,o=l.TileType.Grass):t!==Math.floor(i/2)&&t!==this.mapLength-Math.floor(i/2)-1||(H?(n=this._defaultColor,o=l.TileType.HalfBlock,h=1):(n=this._surroundingsSandColor,o=l.TileType.Grass));let r=new a(!0,e,t,h);r.tileStack=[new l.Tile(this._blockIdIterator,e,t,0,o,n,{roof:!1,pillar:!1,slope:!1,windowed:0,tower:!1,stairs:!1,halfArch:!1,wholeArch:!1,areaDecoration:""})],this._world[t][e]=r,this._blockIdIterator++}}if(this._HorizontalRemainingEmptyBlocksMax>7){let t=2*this._HorizontalRemainingEmptyBlocksMax,i=this._mapLength-t;for(let t=Math.floor(i/2);t<this.mapLength-Math.floor(i/2);t++)for(let e=this._mapWidth-this._HorizontalRemainingEmptyBlocksMax+2;e<this._mapWidth;e++)if(!this._world[t][e].isDefined){let o=l.TileType.Grass,n=this._surroundingsDefaultColor,h=0;e===this._mapWidth-1||e===this._mapWidth-this._HorizontalRemainingEmptyBlocksMax+2?H?(n=this._defaultColor,o=l.TileType.HalfBlock,h=1):(n=this._surroundingsSandColor,o=l.TileType.Grass):t!==Math.floor(i/2)&&t!==this.mapLength-Math.floor(i/2)-1||(H?(n=this._defaultColor,o=l.TileType.HalfBlock,h=1):(n=this._surroundingsSandColor,o=l.TileType.Grass));let r=new a(!0,e,t,h);r.tileStack=[new l.Tile(this._blockIdIterator,e,t,0,o,n,{roof:!1,pillar:!1,slope:!1,windowed:0,tower:!1,stairs:!1,halfArch:!1,wholeArch:!1,areaDecoration:""})],this._world[t][e]=r,this._blockIdIterator++}}}for(let t=0;t<this._blockEdges.length;t++){let i=this._blockEdges[t].y,e=this._blockEdges[t].x,o=new a(!0,e,i,0);o.tileStack=[new l.Tile(this._blockIdIterator,e,i,0,l.TileType.Shadow,this._defaultColor,{roof:!1,pillar:!1,slope:!1,windowed:0,tower:!1,stairs:!1,halfArch:!1,wholeArch:!1,areaDecoration:""})],this._world[i][e].isDefined&&(this._world[i-1][e].isDefined||(this._world[i-1][e]=o),this._world[i+1][e].isDefined||(this._world[i+1][e]=o),this._world[i][e-1].isDefined||(this._world[i][e-1]=o),this._world[i][e+1].isDefined||(this._world[i][e+1]=o)),this._blockIdIterator++}this._world=this.mods.resetGrassTilesBelowPillars(this),this._world=this.mods.clearMapEdges(this),this._mirrorAtCenter&&(this._world=this.mods.mirrorMap(this)),this._world=this.deco.placeRandomTrees(this),console.log(this._world)}get mapWidth(){return this._mapWidth}get mapLength(){return this._mapLength}get mapHalfLength(){return this._mapHalfLength}get mapEdgeWidth(){return this._mapEdgeWidth}get map(){return this._world}get blockGroups(){return this._blockGroups}set blockGroups(t){this._blockGroups=t}get blockHeight(){return this._blockHeight}get mapMaxHeight(){return this._mapMaxHeight}get startBlockSize(){return{w:this._startBlockWidth,l:this._startBlockLength}}set blockHeight(t){this._blockHeight=t}get maxBlockIterations(){return this._maximumBlockIterations}get blockAmountIterator(){return this._blockAmountIterator}set blockAmountIterator(t){this._blockAmountIterator=t}get averageBuildingSize(){return this._averageBuildingSize}get blockEdges(){return this._blockEdges}set blockEdges(t){this._blockEdges=t}get blockHeightsArray(){return this._blockHeightsArray}set blockHeightsArray(t){this._blockHeightsArray=t}get blockIdIterator(){return this._blockIdIterator}set blockIdIterator(t){this._blockIdIterator=t}get blockHeightVariation(){return this._blockHeightVariation}get lineHeight(){return this._decorationLineH}get groundColor(){return this._groundColor}get defaultColor(){return this._defaultColor}get firstLevelColor(){return this._firstLevelColor}get decorativeColors(){return{lineColor:this._lineColor}}get showWindows(){return this._showWindows}getColumn(t,i){return this._world[i][t]}getTiles(t,i){return this._world[i][t].tileStack}getTile(t,i,e){return this._world[i][t].getTile(e)}getTopTile(t,i){let e=this._world[i][t].height;return this._world[i][t].getTile(e-1)}getFirstDefinedColumn(){let t;for(let i=0;i<this.mapLength;i++)for(let e=0;e<this.mapWidth;e++)if(this._world[i][e].isDefined&&this._world[i][e].height>0){t=this._world[i][e];break}return t}setEdges(t){for(let i=0;i<this.mapLength;i++)for(let e=0;e<this.mapWidth;e++)i>0&&e>0&&i<this.mapLength-1&&e<this.mapWidth-1&&this._world[i][e].isDefined&&(t?((this._world[i-1][e].height<this._world[i][e].height||0===i)&&(this._world[i][e].edge.top=!0),(this._world[i+1][e].height<this._world[i][e].height||i===this.mapLength-1)&&(this._world[i][e].edge.bottom=!0),this._world[i][e-1].height<this._world[i][e].height&&(this._world[i][e].edge.left=!0),this._world[i][e+1].height<this._world[i][e].height&&(this._world[i][e].edge.right=!0)):(this._world[i-1][e].isDefined&&0!==i||(this._world[i][e].edge.top=!0),this._world[i+1][e].isDefined&&i!==this.mapLength-1||(this._world[i][e].edge.bottom=!0),this._world[i][e-1].isDefined||(this._world[i][e].edge.left=!0),this._world[i][e+1].isDefined||(this._world[i][e].edge.right=!0)),(this._world[i][e].edge.top&&this._world[i][e].edge.right||this._world[i][e].edge.top&&this._world[i][e].edge.left||this._world[i][e].edge.bottom&&this._world[i][e].edge.right||this._world[i][e].edge.bottom&&this._world[i][e].edge.left)&&(this._world[i][e].corner=!0))}getEdges(){let t;this._blockEdges=[];for(let i=0;i<this._mapLength;i++)if(t=this._mirrorAtCenter?i>this._mapHalfLength+(this._blockAmountIterator-1)&&i<this._mapLength-2:i>2&&i<this._mapLength-2)for(let t=0;t<this._mapWidth;t++)if(t>this._mapEdgeWidth&&t<this._mapWidth-1&&this._world[i][t].isDefined)if(this._world[i][t+1].isDefined&&this._world[i][t-1].isDefined&&this._world[i+1][t].isDefined&&this._world[i-1][t+1].isDefined&&this._world[i-1][t-1].isDefined){if(!this._world[i-1][t].isDefined&&!this._world[i+1][t].isDefined||!this._world[i][t-1].isDefined&&!this._world[i][t+1].isDefined){i>this._mapLength-1&&(i=this._mapLength-1);let e={x:t,y:i};this._blockEdges.push(e)}}else{i>this._mapLength-1&&(i=this._mapLength-1);let e={x:t,y:i};this._blockEdges.push(e)}return this._blockEdges}getLeastOpenSpaceOnX(){let t=[],i=[];for(let e=0;e<this.mapLength;e++){let o=0,l=0;for(let t=0;t<this.mapWidth;t++)t<Math.floor(this.mapWidth/2)?this._world[e][t].isDefined||0!==this._world[e][t].height||o++:this._world[e][t].isDefined||0!==this._world[e][t].height||l++;t.push(o),i.push(l)}return{min:Math.min(...t),max:Math.min(...i)}}addToBuilding(){this._world=this.mods.addBuildingComponent(this),this._world=this.mods.clearMapEdges(this),this.setEdges(!1),console.log(this._world)}};class a{constructor(t,i,e,o){this.defined=t,this.colX=i,this.colY=e,this.colHeight=o,this._edge={top:!1,right:!1,bottom:!1,left:!1},this._tileStack=[],this._defined=t,this._x=i,this._y=e,this._height=o}set x(t){this._x=t}set y(t){this._y=t}set height(t){this._height=t}set blockGroup(t){this._blockGroup=t}set corner(t){this._corner=t}set edge(t){this._edge=t}set tileStack(t){this._tileStack=t}get isDefined(){return this._defined}get x(){return this._x}get y(){return this._y}get height(){return this._height}get blockGroup(){return this._blockGroup}get corner(){return this._corner}get edge(){return this._edge}get tileStack(){return this._tileStack}getTile(t){return this._tileStack[t]}removeTopTile(){this._tileStack.pop()}}e.Column=a},{"./config.component":2,"./decorations.component":3,"./mapGenerationFunctions.component":5,"./modifiers.component":7,"./primitives.component":8,"./tile.component":10}],7:[function(t,i,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=t("./mapper.component"),l=t("./mapGenerationFunctions.component"),n=t("./tile.component"),h=t("./config.component");e.Modifiers=class{constructor(){this.config=new h.Config,this.mapGen=new l.MapGenerationFunctions,this._lastBlockHollow=!1}mirrorMap(t){let i=[];t.blockGroups.forEach(t=>{i.push(t)});for(let e=0;e<t.mapHalfLength;e++)if(e<t.mapHalfLength)for(let l=0;l<t.mapWidth;l++)if(t.map[t.mapLength-e-1][l].isDefined){let h=t.map[t.mapLength-e-1][l],r=h.height;if(r>0){let s=i.length+h.blockGroup,a=[];for(let i=0;i<r;i++){let o,s,g,d,c,p,m,$,f=h.tileStack[i].tileColor;h.tileStack[i].options?(o=h.tileStack[i].options.pillar,s=h.tileStack[i].options.slope,g=h.tileStack[i].options.windowed,d=h.tileStack[i].options.tower,c=h.tileStack[i].options.stairs,p=i===r-1,m=h.tileStack[i].options.halfArch,$=h.tileStack[i].options.wholeArch,a.push(new n.Tile(t.blockIdIterator,l,e,i,h.tileStack[i].type,f,{roof:p,pillar:o,slope:s,windowed:g,tower:d,stairs:c,halfArch:m,wholeArch:$,areaDecoration:""}))):a.push(new n.Tile(t.blockIdIterator,l,e,i,h.tileStack[i].type,f,{roof:!1,pillar:!1,slope:!1,windowed:0,tower:!1,stairs:!1,halfArch:!1,wholeArch:!1,areaDecoration:""})),t.blockIdIterator++}t.blockHeightsArray.push(r),-1===t.blockGroups.indexOf(s)&&t.blockGroups.push(s),t.map[e][l]=null;let g=new o.Column(!0,l,e,r);g.blockGroup=s,g.height=r,g.corner=!1,g.tileStack=a,t.map[e][l]=g}else 0===r&&h.isDefined&&(t.map[e][l]=h)}return t.map}clearMapEdges(t){for(let i=0;i<t.mapLength;i++)for(let e=1;e<t.mapWidth;e++)if((e<t.mapEdgeWidth||e>=t.mapWidth||i<t.mapEdgeWidth||i>=t.mapLength-t.mapEdgeWidth)&&t.map[i][e].isDefined&&t.map[i][e].height>0){t.map[i][e]=null;let l=new o.Column(!1,e,i,0);l.tileStack=[],t.map[i][e]=l}return t.map}addBuildingComponent(t){const i=t.defaultColor;if(t.blockAmountIterator<t.maxBlockIterations+1){const e=i.changeColorLighting(-Math.floor(15*Math.random()));if(t.blockEdges=t.getEdges(),t.blockEdges.length>0){let i,h,r=0,s=t.showWindows;if(h=1===t.blockAmountIterator?Math.min(t.startBlockSize.w,t.startBlockSize.l):this._lastBlockShortestSide,t.blockHeightVariation===l.BuildingHeightVariations.TallCenter)i=this.config.fibonacci[t.maxBlockIterations-t.blockAmountIterator+1];else if(t.blockHeightVariation===l.BuildingHeightVariations.TallSurrounds)i=this.config.fibonacci[t.blockAmountIterator+1];else if(t.blockHeightVariation===l.BuildingHeightVariations.Random){let e=Math.ceil(4*Math.random());i=0===Math.round(Math.random())&&t.blockHeight>3?t.blockHeight-e:t.blockHeight+e}i<2?i=1:i>t.mapMaxHeight&&(i=t.mapMaxHeight),i>5&&(r=2+Math.floor(3*Math.random()));let a,g=this.mapGen.getHighestYfromArray(t.blockEdges),d=this.mapGen.getLowestXfromArray(t.blockEdges),c=this.mapGen.getHighestXfromArray(t.blockEdges),p=t.blockEdges.filter(t=>t.y===g.y),m=t.blockEdges.filter(t=>t.x===d.x),$=t.blockEdges.filter(t=>t.x===c.x),f=Math.floor(3*Math.random());g.y>t.mapLength-5&&(f=Math.floor(2*Math.random()));let u,b,y,_,x=h-t.blockAmountIterator,M=Math.floor(x*this.config.goldenRatio);if(0===f){let t=Math.floor(Math.random()*m.length);m.length>4&&(t=2+Math.floor(Math.random()*(m.length-2))),u=(a=m[t]).y-Math.round(M/2)-1,b=a.y+Math.round(M/2)+1,y=a.x-x,_=a.x}else if(1===f){let t=Math.floor(Math.random()*$.length);$.length>4&&(t=2+Math.floor(Math.random()*($.length-2))),u=(a=$[t]).y-Math.round(M/2)-1,b=a.y+Math.round(M/2)+1,y=a.x,_=a.x+x}else if(2===f){u=(a=p[Math.floor(Math.random()*p.length)]).y,b=a.y+M,y=a.x-Math.round(x/2)+1,_=a.x+Math.round(x/2)-1}this._lastBlockShortestSide=Math.min(x,M);let L=t.blockGroups.length+1,H=(Math.round(Math.random()),0),w=1===Math.round(Math.random());a.y+M>t.mapLength-1&&(M=t.mapLength-(a.y+H)-1),x>4&&M>4?(this._lastBlockHollow?(w=!1,this._lastBlockHollow=!1):(w=Math.round(8*Math.random())>5,this._lastBlockHollow=!0),w=!0):w=!1;let k=Math.round(8*Math.random()),C=!0,S=!1,T=!1,B=i<7&&Math.round(8*Math.random())>5,W=0;B&&(W=Math.round(2*Math.random()));let v;t.getFirstDefinedColumn().tileStack[0].tileColor;i<4&&Math.round(5*Math.random())>0&&(v=a.x+Math.ceil(Math.random()*Math.round(x/2)-2));for(let h=0;h<t.mapLength;h++){u===h?S=!0:b===h?T=!0:(S=!1,T=!1);let g=!1,d=!1;for(let c=0;c<t.mapWidth;c++)if(c===y?g=!0:c===_&&(d=!0),h>=u&&h<=b&&c>=y&&c<=_){let g=!0;if(w&&h>u&&h<b&&c>y+1&&c<_-1&&(g=!1),g){let g=!1;B&&(0===W?h<=u+1&&c<=y+1&&(g=!0):1===W?h<=u+1&&c>=_-2&&(g=!0):2===W&&h>=b-1&&c>=_-2&&t.blockHeightVariation!==l.BuildingHeightVariations.TallCenter&&(g=!0));let d=i;g&&(console.log("tower built"),d=i+5);let p=[];for(let o=0;o<d;o++){let l=!1,m=0;s>0&&o%2==1&&(m=s);let $=o===d-1,f=!1;o<i&&h===v&&c===a.x+Math.round(x/2)-o&&(f=!0);let L=e,H=n.TileType.Body,w=!1;g&&(w=!0);let S=!1,T=!1,B=!1;if(d>4)if(C){if(M>4&&M<6){let t=a.y+5;a.y+5>a.y+M/2&&(t=a.y+4),h>a.y+1&&h<t&&o<d-2&&(H=n.TileType.None,a.y+5>27&&h%2==0&&c%2!=0&&(l=!0),o===d-3&&(T=!0))}6===M&&(h!==u+1&&h!==u+2&&h!==b-2&&h!==b-3||(o<d-2&&(H=n.TileType.None),o===d-3&&(T=!0))),8===M&&(h===u+1||h===u+2||h===u+4||h===u+5?(o<d-2&&(H=n.TileType.None),o===d-3&&(T=!0)):h!==u+3&&h!==u+6||(H=n.TileType.Body,T=!1)),6===x&&(c!==y+1&&c!==y+2&&c!==_-2&&c!==_-3||(o<d-2&&(H=n.TileType.None),o===d-3&&(T=!0))),8===x&&(c===y+1||c===y+2||c===y+4||c===y+5?(o<d-2&&(H=n.TileType.None),o===d-3&&(T=!0)):c!==y+3&&c!==y+6||(H=n.TileType.Body,T=!1))}else k>4?r>0&&(o===r||o+1===r)&&(H=n.TileType.None,h%2==0&&c%2!=0&&(l=!0)):d>7&&r>0&&o>r&&o<r+4&&(H=n.TileType.None,h%2==0&&c%2!=0&&(l=!0));L=o===t.lineHeight?t.decorativeColors.lineColor:0===o?t.firstLevelColor:e,t.map[h][c].isDefined&&t.map[h][c].tileStack[0].type===n.TileType.Grass&&0===o&&H===n.TileType.None&&(H=n.TileType.Grass,L=t.map[h][c].tileStack[0].tileColor),p.push(new n.Tile(t.blockIdIterator,c,h,o,H,L,{roof:$,pillar:l,slope:f,windowed:m,tower:w,stairs:S,halfArch:T,wholeArch:B,areaDecoration:""})),t.blockHeightsArray.push(d),t.blockIdIterator++,L=void 0}-1===t.blockGroups.indexOf(L)&&t.blockGroups.push(L),t.map[h][c]=null;let m=new o.Column(!0,c,h,d);m.blockGroup=L,m.height=d,m.corner=!1,m.tileStack=p,t.map[h][c]=m}}}t.blockHeight=i,t.blockAmountIterator++}else console.warn("Block edges array is empty.")}else console.warn("Cannot add more building components, maximum block iterations reached.");return t.map}removeExcessArches(t){for(let i=0;i<t.mapLength;i++)for(let e=0;e<t.mapWidth;e++)if(i>0&&e>0&&i<t.mapLength-2&&e<t.mapWidth-2&&t.map[i][e].isDefined)for(let o=0;o<t.map[i][e].height;o++)t.map[i][e].tileStack[o].type===n.TileType.None&&t.map[i][e].tileStack[o].options.halfArch&&(t.map[i-1][e].isDefined&&t.map[i-1][e].height>0&&t.map[i-1][e].height===t.map[i][e].height&&t.map[i-1][e].tileStack[o].options.halfArch&&(console.log("y + 1",t.map[i+1][e]),t.map[i+1][e].isDefined&&t.map[i+1][e].height>0&&t.map[i+1][e].height===t.map[i][e].height&&t.map[i+1][e].tileStack[o].options.halfArch&&(t.map[i][e].tileStack[o].options.halfArch=!1),console.log("y + 2",t.map[i+2][e]),t.map[i+2][e].isDefined&&t.map[i+2][e].height>0&&t.map[i+2][e].height===t.map[i][e].height&&t.map[i+2][e].tileStack[o].options.halfArch&&(t.map[i+1][e].tileStack[o].options.halfArch=!1)),e>1&&e<t.mapWidth-3&&t.map[i][e-1].isDefined&&t.map[i][e-1].height===t.map[i][e].height&&t.map[i][e-1].tileStack[o].options.halfArch&&(t.map[i][e+1].isDefined&&t.map[i][e+1].height===t.map[i][e].height&&t.map[i][e+1].tileStack[o].options.halfArch&&(t.map[i][e].tileStack[o].options.halfArch=!1),console.log("x + 2",t.map[i+2][e]),t.map[i][e+2].isDefined&&t.map[i][e+1].height===t.map[i][e].height&&t.map[i][e+2].height===t.map[i][e].height&&t.map[i][e+2].tileStack[o].options.halfArch&&(t.map[i][e+1].tileStack[o].options.halfArch=!1)));return t.map}resetGrassTilesBelowPillars(t){for(let i=0;i<t.mapLength;i++)for(let e=0;e<t.mapWidth;e++)i>0&&e>0&&i<t.mapLength-1&&e<t.mapWidth-1&&t.map[i][e].isDefined&&t.map[i][e].height>0&&t.map[i][e].tileStack[0].type===n.TileType.None&&(t.map[i-1][e].isDefined&&t.map[i-1][e].tileStack[0].type===n.TileType.Grass||t.map[i+1][e].isDefined&&t.map[i+1][e].tileStack[0].type===n.TileType.Grass||t.map[i][e-1].isDefined&&t.map[i][e-1].tileStack[0].type===n.TileType.Grass||t.map[i][e+1].isDefined&&t.map[i][e+1].tileStack[0].type===n.TileType.Grass)&&console.log("should be grass tile!");return t.map}}},{"./config.component":2,"./mapGenerationFunctions.component":5,"./mapper.component":6,"./tile.component":10}],8:[function(t,i,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Primitives=class{getPyramid(t,i){let e=[],o=Math.min(t,i),l=Math.min(t,i),n=Math.floor(o/2),h=Math.floor(l/2),r=[];for(let t=0;t<o;t++){e[t]=[];for(let i=0;i<l;i++)t<Math.round(l/2)&&i<Math.round(o/2)?e[t][i]=Math.min(t,i):e[t][i]=Math.max(t,i)}for(let t=0;t<n;t++){r[t]=[];for(let i=0;i<h;i++)t<h&&i<n&&(r[t][i]=e[t][i])}let s=r.reverse();for(let t=0;t<o;t++)for(let i=0;i<l;i++)t>h-1&&i<n&&(e[t][i]=s[t-h][i]);for(let t=0;t<o;t++)for(let i=0;i<l;i++)i>n-1&&(e[t][i]=e[t][o-i-1]);return e}}},{}],9:[function(t,i,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=t("./config.component"),l=t("./mapGenerationFunctions.component");e.RenderElements=class{constructor(){this.config=new o.Config,this.calculations=new l.MapGenerationFunctions,this.tileW=this.config.tileWidth,this.tileL=this.config.tileLength,this.tileH=this.config.tileHeight,this.bleed=this.config.tileEdgeBleed,this.dimensions=this.calculations.calculateStraightLinesFromIsometricSquare(this.tileW,this.tileL),this.tileColor=this.config.groundColor}createTile(t,i,e){let o={x:t+this.dimensions.horizontalWidthFromTop,y:i},l={x:t,y:i+this.dimensions.verticalHeightFromTop},n={x:t+this.dimensions.horizontalWidthFromBottom,y:i+this.dimensions.totalHeight},h={x:t+this.dimensions.totalWidth,y:i+this.dimensions.verticalHeightFromBottom},r=`${o.x} ${o.y-this.bleed}`,s=`${l.x-this.bleed} ${l.y}`,a=`${n.x} ${n.y+this.bleed}`,g=`${h.x+this.bleed} ${h.y}`,d=this.tileColor.hex();return"shade"===e&&(d=this.tileColor.changeColorLightingString(-50)),{html:`<path fill="${d}"\n\t\t\t\t\td="M${s} \n\t\t\t\t\tL${a} \n\t\t\t\t\tL${g} \n\t\t\t\t\tL${r} \n\t\t\t\t\tL${s} Z" />`,coords:{top:o,left:l,bottom:n,right:h}}}createPlane(t,i,e,o){let l,n=e.id;e.h,this.tileH,this.tileH;l=o?o.hex():this.config.groundColor.hex();let h={x:Math.ceil(t+this.dimensions.horizontalWidthFromTop),y:Math.ceil(i+this.config.topMargin)},r={x:Math.ceil(t),y:Math.ceil(i+this.dimensions.verticalHeightFromTop+this.config.topMargin)},s={x:Math.ceil(t+this.dimensions.horizontalWidthFromBottom),y:Math.ceil(i+this.dimensions.totalHeight+this.config.topMargin)},a={x:Math.ceil(t+this.dimensions.totalWidth),y:Math.ceil(i+this.dimensions.verticalHeightFromBottom+this.config.topMargin)},g=`${r.x-this.bleed} ${r.y}`;return{html:`<g style="z-index:${n};">\n\t\t\t\t\t<path fill="${l}"\n\t\t\t\t\td="M${g} \n\t\t\t\t\tL${`${s.x} ${s.y}`} \n\t\t\t\t\tL${`${a.x+this.bleed} ${a.y}`} \n\t\t\t\t\tL${`${h.x} ${h.y}`} \n\t\t\t\t\tL${g} Z" /></g>`,coords:{top:h,left:r,bottom:s,right:a}}}createBlock(t,i,e,o=!1){let l,n,h,r,s=e.id,a=e.h*this.tileH-this.tileH;e.tileColor.hex()!==this.config.buildingBaseColor.hex()?(l=e.tileColor.hex(),n=e.tileColor.changeColorLightingString(30),h=e.tileColor.changeColorLightingString(-60),r=e.tileColor.changeColorLightingString(15)):(l=this.config.buildingBaseColor.hex(),n=this.config.buildingBaseColor.changeColorLightingString(30),h=this.config.buildingBaseColor.changeColorLightingString(-60),r=this.config.buildingBaseColor.changeColorLightingString(15));const g={x:Math.ceil(t+this.dimensions.horizontalWidthFromTop),y:Math.ceil(i+this.config.topMargin)},d={x:Math.ceil(t),y:Math.ceil(i+this.dimensions.verticalHeightFromTop+this.config.topMargin)},c={x:Math.ceil(t+this.dimensions.horizontalWidthFromBottom),y:Math.ceil(i+this.dimensions.totalHeight+this.config.topMargin)},p={x:Math.ceil(t+this.dimensions.totalWidth),y:Math.ceil(i+this.dimensions.verticalHeightFromBottom+this.config.topMargin)},m=`${d.x-this.bleed} ${d.y-a-this.tileH}`,$=`${d.x-this.bleed} ${d.y-a+this.bleed}`,f=`${c.x} ${c.y-a+this.bleed}`,u=`${c.x} ${c.y-a-this.tileH}`,b=`${c.x} ${c.y-a-this.tileH}`,y=`${c.x} ${c.y-a+this.bleed}`,_=`${p.x+this.bleed} ${p.y-a+this.bleed}`,x=`${p.x+this.bleed} ${p.y-a-this.tileH}`,M=`${d.x-this.bleed} ${d.y-a-this.tileH}`,L=`${c.x} ${c.y-a-this.tileH}`,H=`${p.x+this.bleed} ${p.y-a-this.tileH}`,w=`${g.x} ${g.y-a-this.tileH}`;let k=`<g style="z-index:${s};">\n\t\t\t\t\t<path fill="${h}"\n\t\t\t\t\td="M${m} \n\t\t\t\t\tL${$} \n\t\t\t\t\tL${f} \n\t\t\t\t\tL${u} \n\t\t\t\t\tL${m} Z" />\n\t\t\t\t\t<path fill="${l}"\n\t\t\t\t\td="M${b} \n\t\t\t\t\tL${y} \n\t\t\t\t\tL${_} \n\t\t\t\t\tL${x} \n\t\t\t\t\tL${b} Z" />`;if("triangles"===o){const t=2,i=(this.bleed,this.tileH,this.tileH,this.bleed,this.tileH,this.tileH,{x:d.x+(p.x-d.x)/2,y:g.y+(c.y-g.y)/2});i.x,i.y,i.x,i.y,i.x,i.y,i.x,i.y,this.tileH,this.tileH,this.tileH,this.tileH;k+=`<path fill="${n}"\n\t\t\t\t\td="M${M} \n\t\t\t\t\tL${L} \n\t\t\t\t\tL${H} \n\t\t\t\t\tL${w} \n\t\t\t\t\tL${M} Z" />\n\t\t\t\t\t<path fill="transparent" stroke="${r}"\n\t\t\t\t\td="M${M} \n\t\t\t\t\tL${L} \n\t\t\t\t\tL${H} \n\t\t\t\t\tL${w} \n\t\t\t\t\tL${M} Z" />\n\t\t\t\t\t<path fill="transparent" stroke="${r}"\n\t\t\t\t\td="M${M} \n\t\t\t\t\tL${H}" />\n\t\t\t\t\t<path fill="transparent" stroke="${r}"\n\t\t\t\t\td="M${w} \n\t\t\t\t\tL${L}" />`}else if("squares"===o){const t=2,i=(this.bleed,this.tileH,this.tileH,this.bleed,this.tileH,this.tileH,{x:d.x+(p.x-d.x)/2,y:g.y+(c.y-g.y)/2});i.x,i.y,i.x,i.y,i.x,i.y,i.x,i.y,this.tileH,this.tileH,this.tileH,this.tileH;k+=`<path fill="${n}"\n\t\t\t\t\td="M${M} \n\t\t\t\t\tL${L} \n\t\t\t\t\tL${H} \n\t\t\t\t\tL${w} \n\t\t\t\t\tL${M} Z" />\n\t\t\t\t\t<path fill="transparent" stroke="${r}"\n\t\t\t\t\td="M${M} \n\t\t\t\t\tL${L} \n\t\t\t\t\tL${H} \n\t\t\t\t\tL${w} \n\t\t\t\t\tL${M} Z" />`}else k+=`<path fill="${n}"\n\t\t\t\t\td="M${M} \n\t\t\t\t\tL${L} \n\t\t\t\t\tL${H} \n\t\t\t\t\tL${w} \n\t\t\t\t\tL${M} Z" />`;return{html:k+="</g>",coords:{top:g,left:d,bottom:c,right:p}}}createHalfBlock(t,i,e){let o,l,n,h,r=e.id,s=e.h*this.tileH-this.tileH;e.tileColor.hex()!==this.config.buildingBaseColor.hex()?(o=e.tileColor.hex(),l=e.tileColor.changeColorLightingString(30),n=e.tileColor.changeColorLightingString(-60),h=e.tileColor.changeColorLightingString(10)):(o=this.config.buildingBaseColor.hex(),l=this.config.buildingBaseColor.changeColorLightingString(30),n=this.config.buildingBaseColor.changeColorLightingString(-60),h=this.config.buildingBaseColor.changeColorLightingString(10));let a={x:Math.ceil(t+this.dimensions.horizontalWidthFromTop),y:Math.ceil(i+this.config.topMargin)},g={x:Math.ceil(t),y:Math.ceil(i+this.dimensions.verticalHeightFromTop+this.config.topMargin)},d={x:Math.ceil(t+this.dimensions.horizontalWidthFromBottom),y:Math.ceil(i+this.dimensions.totalHeight+this.config.topMargin)},c={x:Math.ceil(t+this.dimensions.totalWidth),y:Math.ceil(i+this.dimensions.verticalHeightFromBottom+this.config.topMargin)},p=`${g.x-this.bleed} ${g.y-s-this.tileH/2}`,m=`${g.x-this.bleed} ${g.y-s+this.bleed}`,$=`${d.x} ${d.y-s+this.bleed}`,f=`${d.x} ${d.y-s-this.tileH/2}`,u=`${d.x} ${d.y-s-this.tileH/2}`,b=`${d.x} ${d.y-s+this.bleed}`,y=`${c.x+this.bleed} ${c.y-s+this.bleed}`,_=`${c.x+this.bleed} ${c.y-s-this.tileH/2}`,x=`${g.x-this.bleed} ${g.y-s-this.tileH/2}`,M=`${d.x} ${d.y-s-this.tileH/2}`,L=`${c.x+this.bleed} ${c.y-s-this.tileH/2}`,H=`${a.x} ${a.y-s-this.tileH/2}`;return{html:`<g style="z-index:${r};"><path fill="${n}"\n\t\t\t\t\td="M${p} \n\t\t\t\t\tL${m} \n\t\t\t\t\tL${$} \n\t\t\t\t\tL${f} \n\t\t\t\t\tL${p} Z" />\n\t\t\t\t\t<path fill="${o}"\n\t\t\t\t\td="M${u} \n\t\t\t\t\tL${b} \n\t\t\t\t\tL${y} \n\t\t\t\t\tL${_} \n\t\t\t\t\tL${u} Z" />\n\t\t\t\t\t<path fill="${l}"\n\t\t\t\t\td="M${x} \n\t\t\t\t\tL${M} \n\t\t\t\t\tL${L} \n\t\t\t\t\tL${H} \n\t\t\t\t\tL${x} Z" />\n\t\t\t\t\t<path fill="transparent" stroke="${h}"\n\t\t\t\t\td="M${L}\n\t\t\t\t\tL${x}\n\t\t\t\t\tL${M}\n\t\t\t\t\tL${H}" />\n\t\t\t\t\t</g>`,coords:{top:a,left:g,bottom:d,right:c}}}createSlopeBlock(t,i,e,o){let l,n,h,r,s,a,g,d,c,p,m,$=e.id,f=e.h*this.tileH-this.tileH;e.tileColor.hex()!==this.config.buildingBaseColor.hex()?(l=e.tileColor.hex(),n=e.tileColor.changeColorLightingString(-10),h=e.tileColor.changeColorLightingString(10),r=e.tileColor.changeColorLightingString(-20),s=e.tileColor.changeColorLightingString(20),a=e.tileColor.changeColorLightingString(-30),g=e.tileColor.changeColorLightingString(30),d=e.tileColor.changeColorLightingString(-40),c=e.tileColor.changeColorLightingString(40),p=e.tileColor.changeColorLightingString(-60),m=e.tileColor.changeColorLightingString(50)):(l=this.config.buildingBaseColor.hex(),n=this.config.buildingBaseColor.changeColorLightingString(-10),h=this.config.buildingBaseColor.changeColorLightingString(10),r=this.config.buildingBaseColor.changeColorLightingString(-20),s=this.config.buildingBaseColor.changeColorLightingString(20),a=this.config.buildingBaseColor.changeColorLightingString(-30),g=this.config.buildingBaseColor.changeColorLightingString(30),d=this.config.buildingBaseColor.changeColorLightingString(-40),c=this.config.buildingBaseColor.changeColorLightingString(40),p=this.config.buildingBaseColor.changeColorLightingString(-60),m=this.config.buildingBaseColor.changeColorLightingString(50));let u={x:Math.ceil(t+this.dimensions.horizontalWidthFromTop),y:Math.ceil(i)},b={x:Math.ceil(t),y:Math.ceil(i+this.dimensions.verticalHeightFromTop)},y={x:Math.ceil(t+this.dimensions.horizontalWidthFromBottom),y:Math.ceil(i+this.dimensions.totalHeight)},_={x:Math.ceil(t+this.dimensions.totalWidth),y:Math.ceil(i+this.dimensions.verticalHeightFromBottom)},x="",M={top:u,left:b,bottom:y,right:_};if("n"===o){let t=`${b.x-this.bleed} ${b.y-f-this.tileH}`,i=`${b.x-this.bleed} ${b.y-f+this.bleed}`,e=`${y.x} ${y.y-f+this.bleed}`,o=`${y.x} ${y.y-f-this.tileH}`,n=`${y.x} ${y.y-f-this.tileH}`,h=`${y.x} ${y.y-f+this.bleed}`,r=`${_.x+this.bleed} ${_.y-f+this.bleed}`,s=`${b.x-this.bleed} ${b.y-f-this.tileH}`;x=`<g style="z-index:${$};">\n\t\t\t\t\t\t\t<path fill="${a}"\n\t\t\t\t\t\t\td="M${t} \n\t\t\t\t\t\t\tL${i} \n\t\t\t\t\t\t\tL${e} \n\t\t\t\t\t\t\tL${o} \n\t\t\t\t\t\t\tL${t} Z" />\n\t\t\t\t\t\t\t<path fill="${l}"\n\t\t\t\t\t\t\td="M${n}\n\t\t\t\t\t\t\tL${h}\n\t\t\t\t\t\t\tL${r}\n\t\t\t\t\t\t\tL${n} Z" />\n\t\t\t\t\t\t\t<path fill="${m}"\n\t\t\t\t\t\t\td="M${s}\n\t\t\t\t\t\t\tL${`${y.x} ${y.y-f-this.tileH}`}\n\t\t\t\t\t\t\tL${`${_.x+this.bleed} ${_.y-f+this.bleed}`}\n\t\t\t\t\t\t\tL${`${u.x} ${u.y-f}`}\n\t\t\t\t\t\t\tL${s} Z" />\n\t\t\t\t\t\t</g>`}if("nw"===o){console.log("northwest");let t=`${b.x-this.bleed} ${b.y-f}`,i=`${b.x-this.bleed} ${b.y-f+this.bleed}`,e=`${y.x} ${y.y-f-this.tileH+this.bleed}`,o=`${b.x-this.bleed} ${b.y-f+this.bleed}`,l=`${y.x} ${y.y-f-this.tileH+this.bleed}`,h=`${u.x} ${u.y-f}`,r=`${y.x} ${y.y-f-this.tileH}`;x=`<g style="z-index:${$};">\n\t\t\t\t\t\t\t<path fill="${p}"\n\t\t\t\t\t\t\td="M${t}\n\t\t\t\t\t\t\tL${i}\n\t\t\t\t\t\t\tL${e}\n\t\t\t\t\t\t\tL${t} Z" />\n\t\t\t\t\t\t\t<path fill="${n}"\n\t\t\t\t\t\t\td="M${o}\n\t\t\t\t\t\t\tL${l}\n\t\t\t\t\t\t\tL${h}\n\t\t\t\t\t\t\tL${o} Z" />\n\t\t\t\t\t\t\t<path fill="${m}"\n\t\t\t\t\t\t\td="M${r}\n\t\t\t\t\t\t\tL${`${_.x+this.bleed} ${_.y-f+this.bleed}`}\n\t\t\t\t\t\t\tL${`${u.x} ${u.y-f}`}\n\t\t\t\t\t\t\tL${r} Z" />\n\t\t\t\t\t\t</g>`}if("s"===o){let t=`${y.x} ${y.y-f+this.bleed}`,i=`${_.x+this.bleed} ${_.y-f+this.bleed}`,e=`${_.x+this.bleed} ${_.y-f-this.tileH}`,o=`${b.x-this.bleed} ${b.y-f+this.bleed}`;x=`<g style="z-index:${$};">\n\t\t\t\t\t\t\t<path fill="${l}"\n\t\t\t\t\t\t\td="M${t}\n\t\t\t\t\t\t\tL${i}\n\t\t\t\t\t\t\tL${e}\n\t\t\t\t\t\t\tL${t} Z" />\n\t\t\t\t\t\t\t<path fill="${a}"\n\t\t\t\t\t\t\td="M${o}\n\t\t\t\t\t\t\tL${`${y.x} ${y.y-f+this.bleed}`}\n\t\t\t\t\t\t\tL${`${_.x+this.bleed} ${_.y-f-this.tileH+this.bleed}`}\n\t\t\t\t\t\t\tL${`${u.x} ${u.y-f-this.tileH}`}\n\t\t\t\t\t\t\tL${o} Z" />\n\t\t\t\t\t\t</g>`}if("se"===o){let t=`${b.x-this.bleed} ${b.y-f+this.bleed}`,i=`${y.x} ${y.y-f+this.bleed}`,e=`${u.x} ${u.y-f-this.tileH}`,o=`${y.x} ${y.y-f+this.bleed}`,l=`${_.x+this.bleed} ${_.y-f+this.bleed}`;x=`<g style="z-index:${$};">\n\t\t\t\t\t\t<path fill="${a}"\n\t\t\t\t\t\td="M${t}\n\t\t\t\t\t\tL${i}\n\t\t\t\t\t\tL${e}\n\t\t\t\t\t\tL${t} Z" />\n\t\t\t\t\t\t<path fill="${n}"\n\t\t\t\t\t\td="M${l}\n\t\t\t\t\t\tL${o}\n\t\t\t\t\t\tL${`${u.x} ${u.y-f-this.tileH}`}\n\t\t\t\t\t\tL${l} Z" />\n\t\t\t\t\t</g>`}if("e"===o){let t=`${b.x-this.bleed} ${b.y-f-this.tileH}`,i=`${b.x-this.bleed} ${b.y-f+this.bleed}`,e=`${y.x} ${y.y-f+this.bleed}`,o=`${b.x-this.bleed} ${b.y-f-this.tileH+this.bleed}`;x=`<g style="z-index:${$};">\n\t\t\t\t\t\t\t<path fill="${p}"\n\t\t\t\t\t\t\td="M${t}\n\t\t\t\t\t\t\tL${i}\n\t\t\t\t\t\t\tL${e}\n\t\t\t\t\t\t\tL${t} Z" />\n\t\t\t\t\t\t\t<path fill="${n}"\n\t\t\t\t\t\t\td="M${o}\n\t\t\t\t\t\t\tL${`${y.x} ${y.y-f+this.bleed}`}\n\t\t\t\t\t\t\tL${`${_.x+this.bleed} ${_.y-f+this.bleed}`}\n\t\t\t\t\t\t\tL${`${u.x} ${u.y-f-this.tileH}`}\n\t\t\t\t\t\t\tL${o} Z" />\n\t\t\t\t\t\t</g>`}if("ne"===o){let t=`${b.x-this.bleed} ${b.y-f-this.tileH}`,i=`${b.x-this.bleed} ${b.y-f+this.bleed}`,e=`${y.x} ${y.y-f+this.bleed}`,o=`${b.x-this.bleed} ${b.y-f-this.tileH+this.bleed}`,l=`${_.x+this.bleed} ${_.y-f+this.bleed}`,h=`${u.x} ${u.y-f}`,r=`${b.x-this.bleed} ${b.y-f-this.tileH+this.bleed}`;x=`<g style="z-index:${$};">\n\t\t\t\t\t\t<path fill="${p}"\n\t\t\t\t\t\td="M${t}\n\t\t\t\t\t\tL${i}\n\t\t\t\t\t\tL${e}\n\t\t\t\t\t\tL${t} Z" />\n\t\t\t\t\t\t<path fill="${n}"\n\t\t\t\t\t\td="M${r}\n\t\t\t\t\t\tL${`${y.x} ${y.y-f+this.bleed}`}\n\t\t\t\t\t\tL${`${_.x+this.bleed} ${_.y-f+this.bleed}`}\n\t\t\t\t\t\tL${r} Z" />\n\t\t\t\t\t\t<path fill="${m}"\n\t\t\t\t\t\td="M${o}\n\t\t\t\t\t\tL${h}\n\t\t\t\t\t\tL${l}\n\t\t\t\t\t\tL${o} Z" />\n\t\t\t\t\t</g>`}if("w"===o){let t=`${b.x-this.bleed} ${b.y-f}`,i=`${b.x-this.bleed} ${b.y-f+this.bleed}`,e=`${y.x} ${y.y-f-this.tileH+this.bleed}`,o=`${b.x-this.bleed} ${b.y-f+this.bleed}`;x=`<g style="z-index:${$};">\n\t\t\t\t\t\t\t<path fill="${p}"\n\t\t\t\t\t\t\td="M${t}\n\t\t\t\t\t\t\tL${i}\n\t\t\t\t\t\t\tL${e}\n\t\t\t\t\t\t\tL${t} Z" />\n\t\t\t\t\t\t\t<path fill="${n}"\n\t\t\t\t\t\t\td="M${o}\n\t\t\t\t\t\t\tL${`${y.x} ${y.y-f-this.tileH+this.bleed}`}\n\t\t\t\t\t\t\tL${`${_.x+this.bleed} ${_.y-f-this.tileH+this.bleed}`}\n\t\t\t\t\t\t\tL${`${u.x} ${u.y-f}`}\n\t\t\t\t\t\t\tL${o} Z" />\n\t\t\t\t\t\t</g>`}if("sw"===o){let t=`${y.x} ${y.y-f+this.bleed}`,i=`${_.x+this.bleed} ${_.y-f+this.bleed}`,e=`${_.x+this.bleed} ${_.y-f-this.tileH}`,o=`${b.x-this.bleed} ${b.y-f+this.bleed}`,h=`${y.x} ${y.y-f+this.bleed}`,r=`${_.x+this.bleed} ${_.y-f-this.tileH+this.bleed}`;x=`<g style="z-index:${$};">\n\t\t\t\t\t\t\t<path fill="${l}"\n\t\t\t\t\t\t\td="M${t}\n\t\t\t\t\t\t\tL${i}\n\t\t\t\t\t\t\tL${e}\n\t\t\t\t\t\t\tL${t} Z" />\n\t\t\t\t\t\t\t<path fill="${n}"\n\t\t\t\t\t\t\td="M${o}\n\t\t\t\t\t\t\tL${`${u.x} ${u.y-f}`}\n\t\t\t\t\t\t\tL${r}\n\t\t\t\t\t\t\tL${o} Z" />\n\t\t\t\t\t\t\t<path fill="${a}"\n\t\t\t\t\t\t\td="M${o}\n\t\t\t\t\t\t\tL${h}\n\t\t\t\t\t\t\tL${r}\n\t\t\t\t\t\t\tL${o} Z" />\n\t\t\t\t\t\t</g>`}return{html:x,coords:M}}createPillarBlock(t,i,e){let o,l,n,h=e.id,r=this.config.tileWidth,s=e.h*this.tileH-this.tileH;e.tileColor.hex()!==this.config.buildingBaseColor.hex()?(o=e.tileColor.hex(),l=e.tileColor.changeColorLightingString(30),n=e.tileColor.changeColorLightingString(-60)):(o=this.config.buildingBaseColor.hex(),l=this.config.buildingBaseColor.changeColorLightingString(30),n=this.config.buildingBaseColor.changeColorLightingString(-60));let a={x:Math.ceil(t+this.dimensions.horizontalWidthFromTop),y:Math.ceil(i+this.config.topMargin)},g={x:Math.ceil(t),y:Math.ceil(i+this.dimensions.verticalHeightFromTop+this.config.topMargin)},d={x:Math.ceil(t+this.dimensions.horizontalWidthFromBottom),y:Math.ceil(i+this.dimensions.totalHeight+this.config.topMargin)},c={x:Math.ceil(t+this.dimensions.totalWidth),y:Math.ceil(i+this.dimensions.verticalHeightFromBottom+this.config.topMargin)},p=`${g.x-this.bleed+r/2.7} ${g.y-s-this.tileH}`,m=`${g.x-this.bleed+r/2.7} ${g.y-s}`,$=`${c.x+this.bleed-r/2.7} ${c.y-s}`,f=`${c.x+this.bleed-r/2.7} ${c.y-s-this.tileH}`,u=`${g.x-this.bleed+r/2.7+r/12} ${d.y-s}`,b=`${c.x-this.bleed-r/2.7-r/12} ${d.y-s}`,y=(this.bleed,this.tileH,this.tileH,this.bleed,this.tileH,this.tileH,`<g style="z-index:${h};">`);return y+=`<defs>${this.calculations.addGradient("pillarGradient",n,o)}</defs>`,y+='<path fill="url(#pillarGradient)"',y+=` d="M ${p} `,y+=`L ${m} `,y+=`C ${u}, ${b}, ${$} `,y+=`L ${f} `,{html:y+=`L ${p} Z" /></g>`,coords:{top:a,left:g,bottom:d,right:c}}}createWindow(t,i,e,o,l){let n=e.id,h=e.h*this.tileH-this.tileH,r={x:Math.ceil(t+this.dimensions.horizontalWidthFromTop),y:Math.ceil(i+this.config.topMargin)},s={x:Math.ceil(t),y:Math.ceil(i+this.dimensions.verticalHeightFromTop+this.config.topMargin)},a={x:Math.ceil(t+this.dimensions.horizontalWidthFromBottom),y:Math.ceil(i+this.dimensions.totalHeight+this.config.topMargin)},g={x:Math.ceil(t+this.dimensions.totalWidth),y:Math.ceil(i+this.dimensions.verticalHeightFromBottom+this.config.topMargin)},d={top:r,left:s,bottom:a,right:g},c=`<g style="z-index:${n+o.height};">`;if(o.edge.bottom){let t=(a.x-s.x)/3,i=(a.y-s.y)/8,e=`${s.x+t} ${s.y-h-this.tileH+7*i}`,o=`${s.x+t} ${s.y-h+i}`,n=`${a.x-t} ${a.y-h-4*i}`,r=`${a.x-t} ${a.y-h-this.tileH+2*i}`,g=`${a.x-t} ${a.y-h-this.tileH-i}`,d=`${s.x+t} ${s.y-h-this.tileH+4*i}`,p="#111";if(l){Math.round(20*Math.random())}c+=`<path fill="${p}"\n\t\t\t\t\t\td="M${e} \n\t\t\t\t\t\tL${o} \n\t\t\t\t\t\tL${n} \n\t\t\t\t\t\tL${r} \n\t\t\t\t\t\tC${g}, ${d}, ${e} Z" />`}if(o.edge.right){let t=(g.x-a.x)/3,i=(g.y-a.y)/8,e=`${a.x+t} ${a.y-h-this.tileH-2*i}`,o=`${a.x+t} ${a.y-h+3.6*i}`,n=`${g.x-t} ${g.y-h-1*i}`,r=`${g.x-t} ${g.y-h-this.tileH-6.5*i}`,s=`${g.x-t} ${g.y-h-this.tileH-3.2*i}`,d=`${a.x+t} ${a.y-h-this.tileH+.3*i}`,p="#222";if(l){Math.round(20*Math.random())}c+=`<path fill="${p}"\n\t\t\t\t\t\td="M${e} \n\t\t\t\t\t\tL${o} \n\t\t\t\t\t\tL${n} \n\t\t\t\t\t\tL${r} \n\t\t\t\t\t\tC${s}, ${d}, ${e} Z" />`}return{html:c+="</g>",coords:d}}createDoor(t,i,e,o,n){let h,r,s,a=e.id,g=e.h*this.tileH-this.tileH;e.tileColor.hex()!==this.config.buildingBaseColor.hex()?(s=new l.Color(e.tileColor.hex()).getColorByHue(110).changeColorLightingString(60),h=new l.Color(e.tileColor.hex()).getColorByHue(220).changeColorLightingString(-80),r=new l.Color(e.tileColor.hex()).getColorByHue(220).changeColorLightingString(-110)):(s=new l.Color(this.config.buildingBaseColor.hex()).getColorByHue(110).changeColorLightingString(60),h=new l.Color(this.config.buildingBaseColor.hex()).getColorByHue(220).changeColorLightingString(-80),r=new l.Color(this.config.buildingBaseColor.hex()).getColorByHue(220).changeColorLightingString(-110));let d={x:Math.ceil(t+this.dimensions.horizontalWidthFromTop),y:Math.ceil(i+this.config.topMargin)},c={x:Math.ceil(t),y:Math.ceil(i+this.dimensions.verticalHeightFromTop+this.config.topMargin)},p={x:Math.ceil(t+this.dimensions.horizontalWidthFromBottom),y:Math.ceil(i+this.dimensions.totalHeight+this.config.topMargin)},m={x:Math.ceil(t+this.dimensions.totalWidth),y:Math.ceil(i+this.dimensions.verticalHeightFromBottom+this.config.topMargin)},$={top:d,left:c,bottom:p,right:m},f=`<g style="z-index:${a+o.height};">`;if("bottom"===n){let t=(p.x-c.x)/4,i=(p.y-c.y)/8;console.log(i);let e=`${c.x+t} ${c.y-g-this.tileH+4.5*i}`,o=`${c.x+t} ${c.y-g+2*i}`,l=`${p.x-t} ${p.y-g-2*i}`,n=`${p.x-t} ${p.y-g-this.tileH+.5*i}`,h=`${c.x+t} ${c.y-g-this.tileH+4.5*i}`,a=`${p.x-t} ${p.y-g-2*i}`;f+=`<path stroke="#111" stroke-width="1.3"\n\t\t\t\t\t\td="M${h}\n\t\t\t\t\t\tL${`${p.x-t} ${p.y-g-this.tileH+.5*i}`}\n\t\t\t\t\t\tL${a}" />\n\t\t\t\t\t<path fill="${r}"\n\t\t\t\t\t\td="M${e} \n\t\t\t\t\t\tL${o} \n\t\t\t\t\t\tL${l} \n\t\t\t\t\t\tL${n} \n\t\t\t\t\t\tL${e} Z" />\n\t\t\t\t\t<circle fill="${s}" \n\t\t\t\t\t\tcx="${c.x+1.4*t}" \n\t\t\t\t\t\tcy="${p.y-g-this.tileH+2.8*i}" \n\t\t\t\t\t\tr="0.8" />`}if("right"===n){let t=(m.x-p.x)/4,i=(m.y-p.y)/8,e=`${p.x+t} ${p.y-g-this.tileH-i}`,o=`${p.x+t} ${p.y-g+2*i}`,l=`${m.x-t} ${m.y-g-1.5*i}`,n=`${m.x-t} ${m.y-g-this.tileH-4.5*i}`;f+=`<path stroke="#444" stroke-width="1.3"\n\t\t\t\t\t\td="M${n}\n\t\t\t\t\t\tL${e}\n\t\t\t\t\t\tL${o}" />\n\t\t\t\t\t<path fill="${h}"\n\t\t\t\t\t\td="M${e} \n\t\t\t\t\t\tL${o} \n\t\t\t\t\t\tL${l} \n\t\t\t\t\t\tL${n} \n\t\t\t\t\t\tL${e} Z" />\n\t\t\t\t\t<circle fill="${s}" \n\t\t\t\t\t\tcx="${p.x+1.3*t}" \n\t\t\t\t\t\tcy="${p.y-g-this.tileH-4.5*i}" \n\t\t\t\t\t\tr="0.8" />`}return{html:f+="</g>",coords:$}}createHalfArch(t,i,e,o){let l,n,h,r,s,a,g=e.id,d=e.h*this.tileH-this.tileH;e.tileColor.hex()!==this.config.buildingBaseColor.hex()?(l=e.tileColor.hex(),h=e.tileColor.changeColorLightingString(30),n=e.tileColor.changeColorLightingString(-60),r=e.tileColor.changeColorLightingString(15),s=e.tileColor.changeColorLightingString(30)):(l=this.config.buildingBaseColor.hex(),h=this.config.buildingBaseColor.changeColorLightingString(30),n=this.config.buildingBaseColor.changeColorLightingString(-60),r=this.config.buildingBaseColor.changeColorLightingString(15),s=this.config.buildingBaseColor.changeColorLightingString(30));let c={x:Math.ceil(t+this.dimensions.horizontalWidthFromTop),y:Math.ceil(i+this.config.topMargin)},p={x:Math.ceil(t),y:Math.ceil(i+this.dimensions.verticalHeightFromTop+this.config.topMargin)},m={x:Math.ceil(t+this.dimensions.horizontalWidthFromBottom),y:Math.ceil(i+this.dimensions.totalHeight+this.config.topMargin)},$={x:Math.ceil(t+this.dimensions.totalWidth),y:Math.ceil(i+this.dimensions.verticalHeightFromBottom+this.config.topMargin)},f=($.x-m.x)/3;if("right-bottom"===o){let t=`${p.x-this.bleed} ${p.y-d-this.tileH}`,i=`${p.x-this.bleed} ${p.y-d+this.bleed}`,e=`${m.x} ${m.y-d+this.bleed}`,o=`${m.x} ${m.y-d-this.tileH}`,r=`${m.x} ${m.y-d-this.tileH}`,s=`${m.x} ${m.y-d+this.bleed}`,u=`${m.x} ${m.y-d-.5*this.tileH}`,b=`${m.x+.4*f} ${m.y-d-this.tileH}`,y=`${$.x+this.bleed} ${$.y-d-this.tileH}`,_=`${p.x-this.bleed} ${p.y-d-this.tileH}`;a=`<g style="z-index:${g};">\n\t\t\t\t\t\t<path fill="${n}"\n\t\t\t\t\t\td="M${t} \n\t\t\t\t\t\tL${i} \n\t\t\t\t\t\tL${e} \n\t\t\t\t\t\tL${o} \n\t\t\t\t\t\tL${t} Z" />\n\t\t\t\t\t\t<path fill="${l}"\n\t\t\t\t\t\td="M${r} \n\t\t\t\t\t\tL${s}\n\t\t\t\t\t\tC${u}, ${b}, ${y}\n\t\t\t\t\t\tL${r} Z" />\n\t\t\t\t\t\t<path fill="${h}"\n\t\t\t\t\t\td="M${_} \n\t\t\t\t\t\tL${`${m.x} ${m.y-d-this.tileH}`} \n\t\t\t\t\t\tL${`${$.x+this.bleed} ${$.y-d-this.tileH}`} \n\t\t\t\t\t\tL${`${c.x} ${c.y-d-this.tileH}`} \n\t\t\t\t\t\tL${_} Z" />\n\t\t\t\t\t</g>`}if("right-top"===o){this.bleed,this.tileH,this.bleed,this.bleed,this.bleed,this.tileH;let t=`${m.x} ${m.y-d-this.tileH}`,i=`${$.x+this.bleed-.3*f} ${$.y-d-.7*this.tileH}`,e=`${$.x} ${$.y-d-.4*this.tileH}`,o=`${$.x+this.bleed} ${$.y-d+this.bleed}`,r=`${$.x+this.bleed} ${$.y-d-this.tileH}`,s=`${p.x-this.bleed} ${p.y-d-this.tileH}`,u=`${m.x} ${m.y-d-this.tileH}`,b=`${$.x+this.bleed} ${$.y-d-this.tileH}`,y=`${c.x} ${c.y-d-this.tileH}`,_=`${$.x+this.bleed} ${$.y-d+this.bleed}`;a=`<g style="z-index:${g};">\n\t\t\t\t\t\t<path fill="${n}"\n\t\t\t\t\t\td="M${_} \n\t\t\t\t\t\tL${`${$.x+this.bleed} ${$.y-d-this.tileH}`} \n\t\t\t\t\t\tL${`${c.x-this.bleed} ${c.y-d-this.tileH}`} \n\t\t\t\t\t\tL${`${c.x-this.bleed} ${c.y-d}`} \n\t\t\t\t\t\tL${_} Z" />\n\t\t\t\t\t\t<path fill="${l}"\n\t\t\t\t\t\td="M${t} \n\t\t\t\t\t\tC${i}, ${e}, ${o}\n\t\t\t\t\t\tL${r} \n\t\t\t\t\t\tL${t} Z" />\n\t\t\t\t\t\t<path fill="${h}"\n\t\t\t\t\t\td="M${s} \n\t\t\t\t\t\tL${u} \n\t\t\t\t\t\tL${b} \n\t\t\t\t\t\tL${y} \n\t\t\t\t\t\tL${s} Z" />\n\t\t\t\t\t</g>`}return{html:a,coords:{top:c,left:p,bottom:m,right:$}}}createTowerTop(t,i,e){console.log("tile",e)}}},{"./config.component":2,"./mapGenerationFunctions.component":5}],10:[function(t,i,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Tile=class{constructor(t,i,e,o,l,n,h){this._id=t,this._x=i,this._y=e,this._h=o,this._tileType=l,this._tileColor=n,h&&(this._options=h)}get id(){return this._id}get x(){return this._x}get y(){return this._y}get h(){return this._h}get type(){return this._tileType}get options(){return this._options?this._options:void 0}getColor(){return this._tileColor}get tileColor(){return this._tileColor}set tileColor(t){this._tileColor=t}set type(t){this._tileType=t}},function(t){t.None="none",t.Body="body",t.Tower="tower",t.HalfBlock="halfBlock",t.Roof="roof",t.Grass="grass",t.Shadow="shadow"}(e.TileType||(e.TileType={}))},{}]},{},[1,2,3,4,5,6,7,8,9,10]);
//# sourceMappingURL=bundle.min.js.map

{"version":3,"sources":["node_modules/browser-pack/_prelude.js","bundle.min.js","src/ts/builder.component.ts","src/ts/colors.component.ts","src/ts/column.component.ts","src/ts/config.component.ts","src/ts/decorations.component.ts","src/ts/enums/building-height-variations.enum.ts","src/ts/enums/tile-type.enum.ts","src/ts/interfaces/tile-options.interface.ts","src/ts/main.ts","src/ts/mapGenerationFunctions.component.ts","src/ts/mapper.component.ts","src/ts/modifiers.component.ts","src/ts/primitives.component.ts","src/ts/renderelements.component.ts","src/ts/tile.component.ts"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","Object","defineProperty","value","mapGenerationFunctions_component_1","config_component_1","tile_type_enum_1","renderelements_component_1","tile_options_interface_1","Renderer","[object Object]","this","config","Config","calculations","MapGenerationFunctions","tileOptionFuncs","TileOptionsFunctions","render","RenderElements","tileW","tileWidth","tileL","tileLength","tileH","tileHeight","bleed","tileEdgeBleed","dimensions","calculateStraightLinesFromIsometricSquare","map","html","mapWidth","mapLength","htmlMap","getMapWidth","y","halfWay","Math","round","x","getColumn","isDefined","getTopTile","tileTopColor","tileColor","rgb","emptyBlocksPresent","slopePresent","h","height","tileStack","type","TileType","None","options","slope","edge","top","right","bottom","left","blockGroup","tower","mapToBuild","mapTotalWidth","mapTotalLength","windowLights","lightInWindows","testTile","createTile","yDeviation","coords","tileHalfWidthLeft","tileHalfWidthRight","tileHalfLengthTop","tileHalfLengthBottom","mapLengthTop","mapLengthBottom","mapWidthPx","mapLengthPx","topMargin","shadowColor","groundColor","changeColorLighting","lastTile","startTileX","topPavementType","floor","random","randomPaving","pavementType","towersByGroup","allowBuildingDecorations","thisPosY","thisPosX","newTile","newData","Shadow","color","createPlane","Grass","areaDecoration","createTree","slopeInCol","currentTile","getDefaultTileOptions","Body","createSlopeBlock","getTile","isTop","roof","createBlock","windowed","createWindow","createDoor","HalfBlock","pillar","createPillarBlock","halfArch","createHalfArch","createHalfBlock","push","nextYblockDefined","nextXblockDefined","towerGroup","lowestY","highestY","lowestX","highestX","forEach","coord","ceil","horizontalWidthFromTop","verticalHeightFromTop","horizontalWidthFromBottom","totalHeight","totalWidth","verticalHeightFromBottom","mostLeft","mostRight","mostTop","createTowerTop","xPos","yPos","tile","corner","./config.component","./enums/tile-type.enum","./interfaces/tile-options.interface","./mapGenerationFunctions.component","./renderelements.component","2","Color","params","error","validateHex","hexColor","charAt","setHex","hexToRgb","convertToHSL","validateRgb","setRgb","rgbToHex","toString","g","b","_colorRgb","s","l","_colorHsl","hexadecimal","hexVal1","hexVal2","hexVal3","_colorHex","hex","match","hexValues","substr","split","hexPair1","parseInt","hexPair2","hexPair3","hexR","Number","hexG","hexB","amount","newR","newG","newB","hue","newHue","convertHSLtoRGB","convertRGBtoHex","cmin","min","cmax","max","delta","abs","toFixed","m","3","Column","defined","colX","colY","colHeight","_edge","_tileStack","_defined","_x","_y","_height","groupNum","_blockGroup","_corner","tiles","pop","4","colors_component_1","_allowDebug","_tileWidth","_tileLength","_tileHeight","_tileSmallAngle","_tileLargeAngle","_groundColor","_buildingBaseColor","_maxDarkenValue","_maxLightenValue","_tileEdgeBleed","_maxAllowedHeight","_topMargin","_allowBuildingDecorations","_allowSurroundingDecorations","_allowWindows","_lightInWindows","_goldenRatio","_fibonacci","allowDebug","tileSmallAngle","tileLargeAngle","buildingBaseColor","maxDarkenValue","maxLightenValue","maxAllowedHeight","allowWindows","allowSurroundingDecorations","goldenRatio","fibonacci","mapArrayWidth","mapArrayLength","./colors.component","5","column_component_1","tile_component_1","Decorations","world","randomAmount","yPlacement","xPlacement","loopCount","includes","indexOf","decoration","Tile","stairs","wholeArch","./column.component","./tile.component","6","BuildingHeightVariations","7","8","9","10","11","12","13","14","15","16","mapper_component_1","builder_component_1","RandomBuilding","_builder","_map","Map","document","querySelector","style","background","build2DMap","addToBuilding","buildMap","col","getFirstDefinedColumn","remove","svg","XMLSerializer","serializeToString","base64","window","btoa","newImg","createElement","setAttribute","beforeElement","insertBefore","classList","add","innerHTML","building","colorMap","querySelectorAll","addEventListener","event","evtTarget","target","getAttribute","console","log","debug","drawTileMap","getImageTag","setColors","addToBuildingAndRedraw","item","parentElement","toggle","getBaseColor","shade0","changeColorLightingString","shade1","colorDivs","getColorStringByHue","./builder.component","./mapper.component","17","smallAngle","largeAngle","maximumBlockIterations","blockWidth","blockHeight","smallOuterAngle","largeOuterAngle","getHorizontalBottomShortestWidth","getVerticalBottomShortestHeight","getHorizontalTopLongestWidth","getVerticalTopLongestHeight","diagonalWidth","sin","toRadians","diagonalHeight","cos","id","colorLeft","colorRight","gradient","angle","PI","array","highest","lowest","getHighestXfromArray","getHighestYfromArray","18","building_height_variations_enum_1","primitives_component_1","modifiers_component_1","decorations_component_1","mapMaxHeight","mapEdgeWidth","averageBuildingSize","mirrorAtCenter","mapGen","primitives","Primitives","mods","Modifiers","deco","_blockHeightVariationLabels","TallCenter","TallSurrounds","Random","_blockHeightVariation","_world","_mapWidth","_mapLength","_mapMaxHeight","_mapEdgeWidth","_averageBuildingSize","_blockHeight","_mirrorAtCenter","scaleFactor","_startBlockWidth","_startBlockLength","_maximumBlockIterations","_additionalBlockIterations","calculateAdditionalBlockIterations","_blockGroups","_blockEdges","_blockHeightsArray","_mapHalfLength","_blockIdIterator","_blockAmountIterator","_blockHeightIterator","_decorationLineH","newLineHue","lineColor","_defaultColor","_lineColor","_firstLevelColor","_HorizontalRemainingEmptyBlocksMin","_HorizontalRemainingEmptyBlocksMax","_surroundingsGrassColor","_surroundingsWaterColor","_surroundingsSandColor","_surroundingsDefaultColor","_showWindows","startblockYfromCenterDeviation","mapLengthHalf","startblockXfromCenter","startblockLengthHalf","startingPositionX","buildGardens","useWaterGarden","firstBlockHeightRandom","firstBlockHeight","slopeY","hollowArchWays","hollowBuildingBlock","openGroundLevel","yConditions","thisBlockGroup","column","xConditions","thisPillar","tileType","thisWindowed","isRoof","setEdges","hasEdge","getEdges","addBuildingComponent","removeExcessArches","getLeastOpenSpaceOnX","landsLength","landsEdge","defaultHeight","gardenBlock","edgePointY","edgePointX","grass","resetGrassTilesBelowPillars","refactorLargeWalls","clearMapEdges","mirrorMap","placeRandomTrees","mapHalfLength","blockGroups","startBlockSize","w","maxBlockIterations","blockAmountIterator","blockEdges","blockHeightsArray","heightsArray","blockIdIterator","blockHeightVariation","lineHeight","defaultColor","firstLevelColor","decorativeColors","showWindows","considerLowerEdges","isPhysicalBlock","pos","xMinValues","xMaxValues","xMin","xMax","./decorations.component","./enums/building-height-variations.enum","./modifiers.component","./primitives.component","19","_lastBlockHollow","oldBlockGroups","activeCol","isTower","halfArches","newBuildingBlockColor","nextHeight","shortestSide","openFloor","_lastBlockShortestSide","randomNum","creationPoint","yHigh","xLow","getLowestXfromArray","xHigh","yHighEdges","filter","edgePoint","xLowEdges","xHighEdges","sideSelectionForGeneration","yLowEdge","yHighEdge","xLowEdge","xHighEdge","nextBlockWidth","nextBlockLength","randomEdgePoint","yStartOffset","chanceForHigherSpace","changeForHighCorridor","yEdgeLowActive","yEdgeHighActive","createTower","towerLocation","xEdgeLowActive","xEdgeHighActive","createCol","buildTowerHere","thisHeight","thisHalfArch","thisWholeArch","maxWallPoint","undefined","warn","walls","row","keys","key","slice","20","width","widthHalf","heightHalf","quarter","quarterRev","reverse","21","_maxDarken","_maxLighten","shadow","getPositions","pointTop","pointLeft","pointBottom","pointRight","regularColor","blockTopLeft","topTile","highlight","darkestColor","patternColor","leftWallLeftTop","leftWallLeftBottom","leftWallRightBottom","leftWallRightTop","rightWallLeftTop","rightWallLeftBottom","rightWallRightBottom","rightWallRightTop","blockTopBottom","blockTopRight","blockTopTop","margin","blockTopCenter","circleRadiusY","circleRadiusX","strokeColor","slopeDirection","regularDarkerColor","regularLighterColor","shadowLight","shadowHighlight","almostDarkestColor","almostLightestColor","lightestColor","blockRightBottom","blockLeftLeft","blockLeftBottom","blockLeftTop","blockRightRight","blockBottomLeft","blockBottomRight","blockBottomTop","leftWallBezier","rightWallBezier","addGradient","columnInfo","xEdge","yEdge","leftWindowLeftTop","leftWindowLeftBottom","leftWindowRightBottom","leftWindowRightTop","leftWindowRightBezier","leftWindowLeftBezier","windowColor","rightWindowLeftTop","rightWindowLeftBottom","rightWindowRightBottom","rightWindowRightTop","rightWindowRightBezier","rightWindowLeftBezier","direction","doorHandleColor","getColorByHue","leftWindowBorderLeftTop","leftWindowBorderRightBottom","orientation","highlightLeft","highlightRight","halfTileWidth","rightWallLeftBottomBezier","rightWallRightTopBezier","rightWallLeftTopBezier","rightWallRightBottomBezier","blockBackRightBottom","centerTop","22","_id","_h","_tileType","_tileColor","_options"],"mappings":"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","file":"bundle.min.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()",null,"import { MapGenerationFunctions } from './mapGenerationFunctions.component'\r\nimport { Color } from './colors.component'\r\nimport { Map } from './mapper.component'\r\nimport { Tile } from './tile.component'\r\nimport { Config } from './config.component'\r\nimport { TileType } from './enums/tile-type.enum'\r\nimport { Coords } from './interfaces/coords.interface'\r\nimport { TileTemplate } from './interfaces/tiletemplate.interface'\r\nimport { Position } from './interfaces/position.interface'\r\nimport { RenderElements } from './renderelements.component'\r\nimport { TileOptionsFunctions } from './interfaces/tile-options.interface'\r\n\r\nexport class Renderer {\t\r\n\r\n\tprivate config: Config = new Config()\r\n\tprivate calculations: MapGenerationFunctions = new MapGenerationFunctions()\r\n\tprivate tileOptionFuncs: TileOptionsFunctions = new TileOptionsFunctions()\r\n\tprivate render: RenderElements = new RenderElements()\r\n\tprivate tileW: number = this.config.tileWidth\r\n\tprivate tileL: number = this.config.tileLength\r\n\tprivate tileH: number = this.config.tileHeight\r\n\tprivate bleed: number = this.config.tileEdgeBleed\r\n\tprivate dimensions = this.calculations.calculateStraightLinesFromIsometricSquare(this.tileW, this.tileL)\r\n\r\n\tconstructor() {\t}\r\n\r\n\tshowData(map: Map): string {\r\n\r\n\t\tlet html = '<div class=\"showData\">'\r\n\t\thtml += `map width: ${map.mapWidth} tiles<br>map length: ${map.mapLength} tiles<br>`\r\n\t\thtml += `tile width: ${this.config.tileWidth}<br>tile length: ${this.config.tileLength}<br>`\r\n\t\thtml += '</div>'\r\n\r\n\t\treturn html\r\n\t}\r\n\r\n\tbuild2DMap(map: Map): string {\r\n\r\n\t\tlet htmlMap = `<div class=\"map\" style=\"width:${this.config.getMapWidth(map.mapWidth+1)}px;\">`\r\n\r\n\t\thtmlMap += `<div class=\"tile axis\" style=\"width:${this.config.tileWidth}px;height:${this.config.tileLength}px;\"></div>`\r\n\r\n\t\tfor (let i = 0; i < map.mapWidth; i++) {\r\n\t\t\thtmlMap += `<div class=\"tile axis\" style=\"width:${this.config.tileWidth}px;height:${this.config.tileLength}px;\">${i}</div>`\r\n\t\t}\r\n\r\n\t\tfor (let y = 0; y < map.mapLength; y++) {\r\n\r\n\t\t\tlet halfWay = ''\r\n\r\n\t\t\tif (y === Math.round(map.mapLength / 2)) {\r\n\t\t\t\thalfWay = ' half'\r\n\t\t\t}\r\n\r\n\t\t\thtmlMap += `<div class=\"tile axis${halfWay}\" style=\"width:${this.config.tileWidth}px;height:${this.config.tileLength}px;\">${y}</div>`\r\n\r\n\t\t\tfor (let x = 0; x < map.mapWidth; x++) {\r\n\r\n\t\t\t\thtmlMap += `<div data-y=\"${y}\" data-x=\"${x}\" class=\"tile${halfWay}\" style=\"width:${this.config.tileWidth}px;height:${this.config.tileLength}px;`\r\n\r\n\t\t\t\tif (map.getColumn(x, y).isDefined && map.getTopTile(x, y)) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tlet tile = map.getTopTile(x, y)\r\n\t\t\t\t\tlet tileTopColor = tile.tileColor.rgb()\r\n\t\t\t\t\tlet tileColor = `rgb(${tileTopColor['r']}, ${tileTopColor['g']}, ${tileTopColor['b']})`\r\n\t\t\t\t\tlet emptyBlocksPresent = false\r\n\t\t\t\t\tlet slopePresent = false\r\n\t\t\t\t\tfor (let h = 0; h < map.map[y][x].height; h++) {\r\n\t\t\t\t\t\tif (map.map[y][x].tileStack[h].type === TileType.None) {\r\n\t\t\t\t\t\t\temptyBlocksPresent = true\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (let h = 0; h < map.map[y][x].height; h++) {\r\n\t\t\t\t\t\tif (map.map[y][x].tileStack[h].options.slope) {\r\n\t\t\t\t\t\t\tslopePresent = true\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlet edge = (map.map[y][x].edge.top || map.map[y][x].edge.right || map.map[y][x].edge.bottom || map.map[y][x].edge.left) ? true : false\r\n\t\t\t\t\tlet blockGroup = map.map[y][x].blockGroup\r\n\t\t\t\t\tlet tower = false\r\n\t\t\t\t\tfor (let h = 0; h < map.map[y][x].height; h++) {\r\n\t\t\t\t\t\tif (map.map[y][x].tileStack[h].options.tower) {\r\n\t\t\t\t\t\t\ttower = true\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet indicateEmptyBlocks = emptyBlocksPresent ? 'x' : (slopePresent ? 'S' : '')\r\n\r\n\t\t\t\t\thtmlMap += `background-color:${tileColor}\">${indicateEmptyBlocks}<div class=\"tileInfo\">x: ${x} y: ${y}<br>height: ${map.map[y][x].height}<br>edge: ${edge}<br>group: ${blockGroup}<br>tower: ${tower}</div></div>`\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\thtmlMap += `\"></div>`\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\thtmlMap += `</div>`\r\n\r\n\t\treturn htmlMap\r\n\t}\r\n\r\n\tbuildMap(mapToBuild: Map): string {\r\n\r\n\t\tconst mapTotalWidth = mapToBuild.mapWidth\r\n\t\tconst mapTotalLength = mapToBuild.mapLength\r\n\t\tconst tileHeight = this.config.tileHeight\r\n\t\tconst windowLights = this.config.lightInWindows\r\n\r\n\t\tconst testTile = this.render.createTile(0, 0, '')\r\n\r\n\t\tconst xDeviation = testTile.coords.bottom.x - testTile.coords.top.x\r\n\t\tconst yDeviation = testTile.coords.right.y - testTile.coords.left.y\r\n\t\tlet tileHalfWidthLeft = testTile.coords.top.x - testTile.coords.left.x\r\n\t\tlet tileHalfWidthRight = testTile.coords.right.x - testTile.coords.top.x\r\n\t\tlet tileBottomToTop = testTile.coords.bottom.y - testTile.coords.top.y\r\n\t\tlet mapWidthLeft = tileHalfWidthLeft * mapTotalLength\r\n\t\tlet mapWidthRight = tileHalfWidthRight * mapTotalWidth\r\n\t\tlet tileHalfLengthTop = testTile.coords.right.y\r\n\t\tlet tileHalfLengthBottom = testTile.coords.bottom.y - testTile.coords.right.y\r\n\t\tlet mapLengthTop = tileHalfLengthTop * mapTotalWidth\r\n\t\tlet mapLengthBottom = tileHalfLengthBottom * mapTotalLength\r\n\t\tlet mapWidthPx = Math.round((tileHalfWidthLeft + tileHalfWidthRight) * (mapTotalWidth ))\r\n\t\tlet mapLengthPx = Math.round(mapLengthTop + mapLengthBottom) + this.config.topMargin\r\n\r\n\t\tconst shadowColor = this.config.groundColor.changeColorLighting(-20)\r\n\r\n\t\tconst map = mapToBuild.map\r\n\r\n\t\tlet detailsHtml = ''\r\n\t\tlet html = '<svg width=\"'+mapWidthPx+'\" height=\"'+mapLengthPx+'\">'\r\n\r\n\t\tlet lastTile = null\r\n\t\tlet startTileX = tileHalfWidthLeft * (mapTotalWidth - 1)\r\n\r\n\t\tconst topPavementType = Math.floor(Math.random() * 5)\r\n\t\tconst randomPaving = Math.floor(Math.random() * 5)\r\n\t\tlet pavementType = ''\r\n\r\n\t\tconst towersByGroup = {}\r\n\r\n\t\tif (this.config.allowBuildingDecorations) {\r\n\t\t\tif (topPavementType === 1) {\r\n\t\t\t\tpavementType = 'triangles'\r\n\t\t\t} else if (topPavementType === 2) {\r\n\t\t\t\tpavementType = 'circles'\t\r\n\t\t\t} else if (topPavementType === 3) {\r\n\t\t\t\tpavementType = 'squares'\t\r\n\t\t\t}\r\n\t\t}\t\t\t\r\n\r\n\t\tfor (let y = 0; y < mapTotalLength; y++) {\r\n\r\n\t\t\tfor (let x = 0; x < mapTotalWidth; x++) {\r\n\r\n\t\t\t\tlet thisPosY = 0\r\n\t\t\t\tlet thisPosX = 0\r\n\r\n\t\t\t\tif (x === 0 && y === 0) {\r\n\t\t\t\t\tthisPosX = startTileX\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (lastTile != null) {\r\n\t\t\t\t\tthisPosY = lastTile.coords.right.y\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (y > 0 && x === 0) {\r\n\t\t\t\t\tthisPosX = startTileX - (tileHalfWidthLeft * y)\r\n\t\t\t\t\tthisPosY = (tileHalfLengthTop * y) - (yDeviation * y)\r\n\t\t\t\t}\t\r\n\t\t\t\t\r\n\t\t\t\tif (x > 0) {\r\n\t\t\t\t\tthisPosX = (lastTile.coords.right.x - (lastTile.coords.right.x - lastTile.coords.bottom.x))\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet newTile = this.render.createTile(thisPosX, thisPosY, 'shade')\r\n\t\t\t\tlet newData = ''\r\n\t\t\t\t\r\n\t\t\t\tif (map[y][x].isDefined) {\r\n\r\n\t\t\t\t\tif (map[y][x].tileStack[0].type === TileType.Shadow) {\r\n\t\t\t\t\t\tlet color = shadowColor\r\n\t\t\t\t\t\tnewData += this.render.createPlane(thisPosX, thisPosY, map[y][x].tileStack[0], color).html\r\n\t\t\t\t\t} else if (map[y][x].tileStack[0].type === TileType.Grass) {\r\n\t\t\t\t\t\tlet color = map[y][x].tileStack[0].tileColor\r\n\t\t\t\t\t\tnewData += this.render.createPlane(thisPosX, thisPosY, map[y][x].tileStack[0], color).html\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (map[y][x].height === 0) {\r\n\r\n\t\t\t\t\t\tif (map[y][x].tileStack[0].type === TileType.None && map[y][x].tileStack[0].options.areaDecoration !== '') {\r\n\r\n\t\t\t\t\t\t\tif (map[y][x].tileStack[0].options.areaDecoration === 'tree') {\r\n\t\t\t\t\t\t\t\tconst treeData = this.render.createTree(thisPosX, thisPosY)\r\n\t\t\t\t\t\t\t\tnewData += treeData.html\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (map[y][x].height > 0) {\r\n\r\n\t\t\t\t\t\tnewData += this.render.createPlane(thisPosX, thisPosY, map[y][x].tileStack[0], shadowColor).html\r\n\r\n\t\t\t\t\t\tlet slopeInCol = false\r\n\r\n\t\t\t\t\t\tfor (let h = 0; h < map[y][x].height; h++) {\r\n\r\n\t\t\t\t\t\t\tlet currentTile = map[y][x].tileStack[h]\r\n\t\t\t\t\t\t\tlet options\r\n\r\n\t\t\t\t\t\t\tif (currentTile.options) {\r\n\t\t\t\t\t\t\t\toptions = currentTile.options\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\toptions = this.tileOptionFuncs.getDefaultTileOptions()\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif (options.slope) {\r\n\t\t\t\t\t\t\t\tslopeInCol = true\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif (currentTile.type === TileType.Body) {\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tif (currentTile.options.slope) {\r\n\t\t\t\t\t\t\t\t\tlet slope = this.render.createSlopeBlock(thisPosX, thisPosY + (tileHeight * 7), map[y][x].getTile(h), 'e')\r\n\t\t\t\t\t\t\t\t\tnewData += slope.html\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tif (!slopeInCol) {\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tlet isTop = ''\r\n\t\t\t\t\t\t\t\t\t\tif (map[y][x].blockGroup % 2 === 1 && map[y][x].tileStack[h].options.roof) {\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\tisTop = pavementType\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tif (randomPaving > 2) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (topPavementType === 1) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tisTop = 'triangles'\r\n\t\t\t\t\t\t\t\t\t\t\t\t} else if (topPavementType === 2) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tisTop = 'circles'\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t} else if (topPavementType === 3) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tisTop = 'squares'\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\tlet tile = this.render.createBlock(thisPosX, thisPosY - tileHeight, currentTile, isTop)\r\n\t\t\t\t\t\t\t\t\t\tnewData += tile.html\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (currentTile.options.windowed > 0) {\r\n\t\t\t\t\t\t\t\t\t\t\tif (map[y][x].edge.right || map[y][x].edge.bottom) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (Math.round(Math.random() * 6) > 4) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tlet window = this.render.createWindow(thisPosX, thisPosY - tileHeight, currentTile, map[y][x], windowLights)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tnewData += window.html\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\tif (map[y][x].edge.bottom && (h === map[y+1][x].height || h === 0) && Math.round(Math.random() * 10) > 8) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tlet door = this.render.createDoor(thisPosX, thisPosY - tileHeight, currentTile, map[y][x], 'bottom')\r\n\t\t\t\t\t\t\t\t\t\t\t\tnewData += door.html\r\n\t\t\t\t\t\t\t\t\t\t\t} else if (map[y][x].edge.right && (h === map[y][x+1].height || h === 0) && Math.round(Math.random() * 10) > 8) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tlet door = this.render.createDoor(thisPosX, thisPosY - tileHeight, currentTile, map[y][x], 'right')\r\n\t\t\t\t\t\t\t\t\t\t\t\tnewData += door.html\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t} else if (!options.tower && currentTile.type === TileType.HalfBlock) {\r\n\r\n\t\t\t\t\t\t\t\tlet tile = this.render.createHalfBlock(thisPosX, thisPosY - tileHeight, currentTile)\r\n\t\t\t\t\t\t\t\tnewData += tile.html\r\n\r\n\t\t\t\t\t\t\t} else if (!options.tower && currentTile.type === TileType.None) {\r\n\r\n\t\t\t\t\t\t\t\tif (currentTile.options.pillar && h < map[y][x].height) {\r\n\t\t\t\t\t\t\t\t\tif (y < (mapTotalLength/2)-1 || y > (mapTotalLength/2)) {\r\n\t\t\t\t\t\t\t\t\t\tlet pillar = this.render.createPillarBlock(thisPosX, thisPosY - tileHeight, currentTile)\r\n\t\t\t\t\t\t\t\t\t\tnewData += pillar.html\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tif (currentTile.options.halfArch) {\r\n\r\n\t\t\t\t\t\t\t\t\tif (y > 1 && y < mapTotalLength - 1) {\r\n\t\t\t\t\t\t\t\t\t\tif (map[y+1][x].isDefined && map[y+1][x].height > 0 && map[y+1][x].height > h && map[y+1][x].tileStack[h].type === TileType.None) {\r\n\t\t\t\t\t\t\t\t\t\t\tlet arch = this.render.createHalfArch(thisPosX, thisPosY - tileHeight, currentTile, 'right-top')\r\n\t\t\t\t\t\t\t\t\t\t\tnewData += arch.html\r\n\t\t\t\t\t\t\t\t\t\t} else if (map[y-1][x].isDefined && map[y-1][x].height > 0 && map[y-1][x].height > h && map[y-1][x].tileStack[h].type === TileType.None) {\r\n\t\t\t\t\t\t\t\t\t\t\tlet arch = this.render.createHalfArch(thisPosX, thisPosY - tileHeight, currentTile, 'right-bottom')\r\n\t\t\t\t\t\t\t\t\t\t\tnewData += arch.html\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif (h === map[y][x].height - 1 && currentTile.options.tower) {\r\n\r\n\t\t\t\t\t\t\t\tif (y < mapTotalLength - 1 && x < mapTotalWidth - 1) {\r\n\r\n\t\t\t\t\t\t\t\t\tif (map[y][x].blockGroup in towersByGroup) {\r\n\t\t\t\t\t\t\t\t\t\ttowersByGroup[`${map[y][x].blockGroup}`].push({ y, x })\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\ttowersByGroup[`${map[y][x].blockGroup}`] = [{ y, x }]\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tconst nextYblockDefined = map[y + 1][x].isDefined\r\n\t\t\t\t\t\t\t\t\tconst nextXblockDefined = map[y][x + 1].isDefined\r\n\r\n\t\t\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\t\t\t((nextYblockDefined && !map[y + 1][x].tileStack[0].options.tower) || !nextYblockDefined) \r\n\t\t\t\t\t\t\t\t\t\t&& \r\n\t\t\t\t\t\t\t\t\t\t((nextXblockDefined && !map[y][x + 1].tileStack[0].options.tower) || !nextXblockDefined)\r\n\t\t\t\t\t\t\t\t\t\t) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tconst towerGroup = towersByGroup[map[y][x].blockGroup]\r\n\t\t\t\t\t\t\t\t\t\tlet lowestY = mapTotalLength\r\n\t\t\t\t\t\t\t\t\t\tlet highestY = 0\r\n\t\t\t\t\t\t\t\t\t\tlet lowestX = mapTotalWidth\r\n\t\t\t\t\t\t\t\t\t\tlet highestX = 0\r\n\r\n\t\t\t\t\t\t\t\t\t\ttowerGroup.forEach(coord => {\r\n\t\t\t\t\t\t\t\t\t\t\tif (lowestY > coord.y) lowestY = coord.y\r\n\t\t\t\t\t\t\t\t\t\t\tif (highestY < coord.y) highestY = coord.y\r\n\t\t\t\t\t\t\t\t\t\t\tif (lowestX > coord.x) lowestX = coord.x\r\n\t\t\t\t\t\t\t\t\t\t\tif (highestX < coord.x) highestX = coord.x\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t\t\t\t\tconst top: Position = { \"x\": Math.ceil(thisPosX + this.dimensions.horizontalWidthFromTop), \"y\": Math.ceil(thisPosY + this.config.topMargin ) }\r\n\t\t\t\t\t\t\t\t\t\tconst left: Position = { \"x\": Math.ceil(thisPosX), \"y\": Math.ceil(thisPosY + this.dimensions.verticalHeightFromTop + this.config.topMargin ) }\r\n\t\t\t\t\t\t\t\t\t\tconst bottom: Position = { \"x\": Math.ceil(thisPosX + this.dimensions.horizontalWidthFromBottom), \"y\": Math.ceil(thisPosY + this.dimensions.totalHeight + this.config.topMargin ) }\r\n\t\t\t\t\t\t\t\t\t\tconst right: Position = { \"x\": Math.ceil(thisPosX + this.dimensions.totalWidth), \"y\": Math.ceil(thisPosY + this.dimensions.verticalHeightFromBottom + this.config.topMargin ) }\r\n\r\n\t\t\t\t\t\t\t\t\t\tconst mostLeft = {\r\n\t\t\t\t\t\t\t\t\t\t\tx: (lowestX < x) ? left.x - (tileHalfWidthRight * (x - lowestX)) : left.x,\r\n\t\t\t\t\t\t\t\t\t\t\ty: (lowestX < x) ? left.y - (tileHalfLengthBottom * (x - lowestX)) : left.y\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\tconst mostRight = {\r\n\t\t\t\t\t\t\t\t\t\t\tx: (lowestY < y) ? right.x + (tileHalfWidthRight * (y - lowestY)) : right.x,\r\n\t\t\t\t\t\t\t\t\t\t\ty: (lowestY < y) ? right.y - (tileHalfLengthBottom * (y - lowestY)) : right.y\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\tconst mostTop = {\r\n\t\t\t\t\t\t\t\t\t\t\tx: (lowestX < x) ? mostRight.x - (tileHalfWidthRight * (x - lowestX + 1)) : mostRight.x - tileHalfWidthRight,\r\n\t\t\t\t\t\t\t\t\t\t\ty: (lowestX < x) ? mostRight.y - (tileHalfLengthBottom * (x - lowestX + 1)) : mostRight.y - tileHalfLengthBottom\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\tnewData += this.render.createTowerTop(\r\n\t\t\t\t\t\t\t\t\t\t\t{ x: mostLeft.x, y: mostLeft.y - (tileHeight * map[y][x].height) },\r\n\t\t\t\t\t\t\t\t\t\t\t{ x: bottom.x, y: bottom.y - (tileHeight * map[y][x].height) },\r\n\t\t\t\t\t\t\t\t\t\t\t{ x: mostRight.x, y: mostRight.y - (tileHeight * map[y][x].height) },\r\n\t\t\t\t\t\t\t\t\t\t\t{ x: mostTop.x, y: mostTop.y - (tileHeight * map[y][x].height) },\r\n\t\t\t\t\t\t\t\t\t\t\tMath.floor(2 + Math.random() * 5),\r\n\t\t\t\t\t\t\t\t\t\t\tmap[y][x].tileStack[h])\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\t\t\t\t\t\r\n\t\t\t\t}\r\n\r\n\t\t\t\thtml += newData\r\n\r\n\t\t\t\tlastTile = newTile\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\thtml += '</svg>'\r\n\r\n\t\t// document.querySelector('#debug').innerHTML = detailsHtml\r\n\r\n\t\treturn '<div id=\"debug\">' + detailsHtml + '</div>' + html\r\n\t}\r\n\r\n\taddSlopedEdges(map: any[], x: number, y: number, h: number, xPos: number, yPos: number) {\r\n\r\n\t\tlet tile = null\r\n\r\n\t\tif (map[y][x].edge.top && !map[y][x].corner && h === map[y][x].height-1) {\r\n\t\t\ttile = this.render.createSlopeBlock(xPos, yPos - this.config.tileHeight, map[y][x].getTile(h), 'n')\r\n\t\t} else if (map[y][x].edge.bottom && !map[y][x].corner && h === map[y][x].height-1) {\r\n\t\t\ttile = this.render.createSlopeBlock(xPos, yPos - this.config.tileHeight, map[y][x].getTile(h), 's')\r\n\t\t} else if (map[y][x].edge.right && !map[y][x].corner && h === map[y][x].height-1) {\r\n\t\t\ttile = this.render.createSlopeBlock(xPos, yPos - this.config.tileHeight, map[y][x].getTile(h), 'e')\r\n\t\t} else if (map[y][x].edge.left && !map[y][x].corner && h === map[y][x].height-1) {\r\n\t\t\ttile = this.render.createSlopeBlock(xPos, yPos - this.config.tileHeight, map[y][x].getTile(h), 'w')\r\n\t\t} else {\r\n\t\t\ttile = this.render.createBlock(xPos, yPos - this.config.tileHeight, map[y][x].getTile(h))\t\r\n\t\t}\r\n\r\n\t\tif (map[y][x].corner && h === map[y][x].height-1) {\r\n\t\t\tif (map[y][x].edge.top && map[y][x].edge.left) {\r\n\t\t\t\ttile = this.render.createSlopeBlock(xPos, yPos - this.config.tileHeight, map[y][x].getTile(h), 'nw')\r\n\t\t\t} else if (map[y][x].edge.top && map[y][x].edge.right) {\r\n\t\t\t\ttile = this.render.createSlopeBlock(xPos, yPos - this.config.tileHeight, map[y][x].getTile(h), 'ne')\r\n\t\t\t} else if (map[y][x].edge.bottom && map[y][x].edge.left) {\r\n\t\t\t\ttile = this.render.createSlopeBlock(xPos, yPos - this.config.tileHeight, map[y][x].getTile(h), 'sw')\r\n\t\t\t} else if (map[y][x].edge.bottom && map[y][x].edge.right) {\r\n\t\t\t\ttile = this.render.createSlopeBlock(xPos, yPos - this.config.tileHeight, map[y][x].getTile(h), 'se')\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn tile\r\n\t}\r\n}\r\n","import { RGB } from './interfaces/color-rgb.interface'\r\nimport { HSL } from './interfaces/color-hsl.interface'\r\n\r\nexport class Color {\r\n\tprivate _colorRgb: RGB\r\n\tprivate _colorHex: string\r\n\tprivate _colorHsl: HSL\r\n\r\n\tconstructor(...params: any[]) {\r\n\t\tlet error = null\r\n\t\tif (params.length === 1) {\r\n\t\t\tif (typeof params[0] === 'string') {\r\n\t\t\t\tif (this.validateHex(params[0])) {\r\n\t\t\t\t\tlet hexColor = params[0]\r\n\t\t\t\t\tif (hexColor.charAt(0) !== '#') {\r\n\t\t\t\t\t\thexColor = `#${hexColor}`\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.setHex(hexColor)\r\n\t\t\t\t\tthis.hexToRgb()\r\n\t\t\t\t\tthis.convertToHSL()\r\n\t\t\t\t} else {\r\n\t\t\t\t\terror = \"Hexadecimal color is incorrect\"\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\terror = \"Length of 1 in parameters is not equal to string\"\r\n\t\t\t}\r\n\t\t} else if (params.length === 3) {\r\n\t\t\tif (this.validateRgb(params)) {\r\n\t\t\t\tthis.setRgb(params[0], params[1], params[2])\r\n\t\t\t\tthis.rgbToHex()\r\n\t\t\t\tthis.convertToHSL()\r\n\t\t\t} else {\r\n\t\t\t\terror = \"Values of RGB exceed limits\"\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (error !== null) {\r\n\t\t\tthrow \"Color type is incorrect. \" + error + \": \" + params.toString()\r\n\t\t}\r\n\t}\r\n\r\n\tpublic setRgb(r: number, g: number, b: number) {\r\n\t\tthis._colorRgb = {r: r, g: g, b: b} as RGB\r\n\t}\r\n\r\n\tpublic setHsl(h: number, s: number, l: number) {\r\n\t\tthis._colorHsl = {h: h, s: s, l: l} as HSL\r\n\t}\r\n\r\n\tpublic setHex(hexadecimal: string) {\r\n\t\tif (hexadecimal.length < 7) {\r\n\t\t\tconst hexVal1 = hexadecimal.charAt(1)\r\n\t\t\tconst hexVal2 = hexadecimal.charAt(2)\r\n\t\t\tconst hexVal3 = hexadecimal.charAt(3)\r\n\t\t\thexadecimal = \"#\" + hexVal1 + hexVal1 + hexVal2 + hexVal2 + hexVal3 + hexVal3\r\n\t\t}\r\n\t\tthis._colorHex = hexadecimal\r\n\t}\r\n\r\n\tpublic rgb(): RGB {\r\n\t\treturn this._colorRgb\r\n\t}\r\n\r\n\tpublic hex(): string {\r\n\t\treturn this._colorHex\r\n\t}\r\n\r\n\tpublic hsl(): HSL {\r\n\t\treturn this._colorHsl\r\n\t}\r\n\r\n\tvalidateRgb(rgb: number[]): boolean {\r\n\t\treturn (rgb[0] > -1 && rgb[0] < 256 &&\r\n\t\t\trgb[1] > -1 && rgb[1] < 256 &&\r\n\t\t\trgb[2] > -1 && rgb[2] < 256)\r\n\t}\r\n\r\n\tvalidateHex(hex: string): boolean {\r\n\t\tconst regex = /^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/\r\n\t\tif (hex.match(regex)) {\r\n\t\t\treturn true\r\n\t\t} else {\r\n\t\t\treturn false\r\n\t\t}\r\n\t}\r\n\r\n\thexToRgb() {\r\n\t\tconst hexValues: string[] = this._colorHex.substr(1).split('')\r\n\t\tconst hexPair1 = parseInt(hexValues[0]+hexValues[1], 16)\r\n\t\tconst hexPair2 = parseInt(hexValues[2]+hexValues[3], 16)\r\n\t\tconst hexPair3 = parseInt(hexValues[4]+hexValues[5], 16)\r\n\t\tthis.setRgb(hexPair1, hexPair2, hexPair3)\r\n\t\tthis.rgbToHex()\r\n\t}\r\n\r\n\trgbToHex() {\r\n\t\tif (typeof this._colorRgb === 'object') {\r\n\t\t\tconst r = this._colorRgb.r\r\n\t\t\tconst b = this._colorRgb.b\r\n\t\t\tconst g = this._colorRgb.g\r\n\t\t\tconst hexR = Number(r).toString(16)\r\n\t\t\tconst hexG = Number(g).toString(16)\r\n\t\t\tconst hexB = Number(b).toString(16)\r\n\t\t\tthis._colorHex = \"#\" + hexR + hexG + hexB\t\t\t\r\n\t\t}\r\n\t}\r\n\r\n\tconvertRGBtoHex(color: RGB): string {\r\n\t\tconst r = color.r\r\n\t\tconst b = color.b\r\n\t\tconst g = color.g\r\n\t\tconst hexR = Number(r).toString(16)\r\n\t\tconst hexG = Number(g).toString(16)\r\n\t\tconst hexB = Number(b).toString(16)\r\n\t\treturn \"#\" + hexR + hexG + hexB\r\n\t}\r\n\r\n\tpublic changeColorLightingString(amount: number): string {\r\n\t\tconst r = this._colorRgb.r\r\n\t\tconst b = this._colorRgb.b\r\n\t\tconst g = this._colorRgb.g\r\n\t\tlet newR = r + amount\r\n\t\tlet newG = g + amount\r\n\t\tlet newB = b + (amount - 8)\r\n\t\tif (newR > 255) newR = 255\r\n\t\tif (newG > 255) newG = 255\r\n\t\tif (newR > 255) newR = 255\r\n\r\n\t\tconst hexR = Number(newR).toString(16)\r\n\t\tconst hexG = Number(newG).toString(16)\r\n\t\tconst hexB = Number(newB).toString(16)\r\n\t\tconst result = \"#\" + hexR + hexG + hexB\r\n\r\n\t\treturn result\r\n\t}\r\n\r\n\tpublic changeColorLighting(amount: number): Color {\r\n\t\tconst r = this._colorRgb.r\r\n\t\tconst b = this._colorRgb.b\r\n\t\tconst g = this._colorRgb.g\r\n\t\tlet newR = r + amount\r\n\t\tlet newG = g + amount\r\n\t\tlet newB = b + (amount - 8)\r\n\t\tif (newR > 255) newR = 255\r\n\t\tif (newG > 255) newG = 255\r\n\t\tif (newR > 255) newR = 255\r\n\t\t\r\n\t\tthis.setRgb(newR, newG, newR)\r\n\t\tthis.rgbToHex()\r\n\t\tthis.convertToHSL()\r\n\r\n\t\treturn this\r\n\t}\r\n\r\n\tpublic getColorStringByHue(hue: number): string {\r\n\r\n\t\tconst h = this._colorHsl.h,\r\n\t\t\ts = this._colorHsl.s,\r\n\t\t\tl = this._colorHsl.l\r\n\r\n\t\tlet newHue = h + hue\r\n\r\n\t\tif (newHue > 360) {\r\n\t\t\tnewHue = newHue % 360\r\n\t\t}\r\n\r\n\t\tconst rgb = this.convertHSLtoRGB({h: newHue, s: s, l: l})\r\n\r\n\t\treturn this.convertRGBtoHex(rgb)\r\n\t}\r\n\r\n\tpublic getColorByHue(hue: number): Color {\r\n\r\n\t\tconst h = this._colorHsl.h,\r\n\t\t\ts = this._colorHsl.s,\r\n\t\t\tl = this._colorHsl.l\r\n\r\n\t\tlet newHue = h + hue\r\n\r\n\t\tif (newHue > 360) {\r\n\t\t\tnewHue = newHue % 360\r\n\t\t}\r\n\r\n\t\tlet rgb = this.convertHSLtoRGB({h: newHue, s: s, l: l})\r\n\r\n\t\tthis.setRgb(rgb.r, rgb.g, rgb.b)\r\n\t\tthis.rgbToHex()\r\n\r\n\t\treturn this\r\n\t}\r\n\r\n\tconvertToHSL(): void {\r\n\t\tlet r = this._colorRgb.r\r\n\t\tlet b = this._colorRgb.b\r\n\t\tlet g = this._colorRgb.g\r\n\r\n\t\tr /= 255\r\n\t\tg /= 255\r\n\t\tb /= 255\r\n\r\n\t\tlet cmin = Math.min(r,g,b),\r\n\t\t\tcmax = Math.max(r,g,b),\r\n\t\t\tdelta = cmax - cmin,\r\n\t\t\th = 0,\r\n\t\t\ts = 0,\r\n\t\t\tl = 0\r\n\r\n\t\t// calculate hue\r\n\t\tif (delta === 0) {\r\n\t\t\th = 0\r\n\t\t} else if (cmax === r) {\r\n\t\t\th = ((g - b) / delta) % 6\r\n\t\t} else if (cmax === g) {\r\n\t\t\th = (b - r) / delta + 2\r\n\t\t} else {\r\n\t\t\th = (r - g) / delta + 4\r\n\t\t}\r\n\r\n\t\th = Math.round(h * 60)\r\n\r\n\t\tif (h < 0) {\r\n\t\t\th += 360\r\n\t\t}\r\n\r\n\t\t// calculate lightness\r\n\t\tl = (cmax + cmin) / 2 \r\n\r\n\t\t// calculate saturation\r\n\t\ts = delta === 0 ? 0 : delta / (1 - Math.abs(2 * l - 1))\r\n\r\n\t\ts = +(s * 100).toFixed(1)\r\n\t\tl = +(l * 100).toFixed(1)\r\n\r\n\t\tthis._colorHsl = { h: h, s: s, l: l }\r\n\t}\r\n\r\n\tconvertHSLtoRGB(color: HSL): RGB {\r\n\r\n\t\tlet h = color.h\r\n\t\tlet s = color.s\r\n\t\tlet l = color.l\r\n\r\n\t\ts /= 100\r\n\t\tl /= 100\r\n\r\n\t\tlet c = (1 - Math.abs(2 * l - 1)) * s,\r\n\t\t\tx = c * (1 - Math.abs((h / 60) % 2 - 1)),\r\n\t\t\tm = l - c / 2,\r\n\t\t\tr = 0,\r\n\t\t\tg = 0,\r\n\t\t\tb = 0\r\n\r\n\t\tif (0 <= h && h < 60) {\r\n\t\t\tr = c; g = x; b = 0;\r\n\t\t} else if (60 <= h && h < 120) {\r\n\t\t\tr = x; g = c; b = 0;\r\n\t\t} else if (120 <= h && h < 180) {\r\n\t\t\tr = 0; g = c; b = x;\r\n\t\t} else if (180 <= h && h < 240) {\r\n\t\t\tr = 0; g = x; b = c;\r\n\t\t} else if (240 <= h && h < 300) {\r\n\t\t\tr = x; g = 0; b = c;\r\n\t\t} else if (300 <= h && h < 360) {\r\n\t\t\tr = c; g = 0; b = x;\r\n\t\t}\r\n\t\t\r\n\t\tr = Math.round((r + m) * 255)\r\n\t\tg = Math.round((g + m) * 255)\r\n\t\tb = Math.round((b + m) * 255)\r\n\r\n\t\treturn {r: r, g: g, b: b}\r\n\t}\r\n}","import { Tile } from './tile.component'\r\nimport { ColumnEdge } from './interfaces/column-edge.interface'\r\n\r\nexport class Column {\r\n\r\n\tprivate _defined: boolean\r\n\tprivate _x: number\r\n\tprivate _y: number\r\n\tprivate _height: number\r\n\tprivate _blockGroup: number\r\n\tprivate _corner: boolean\r\n\tprivate _edge: ColumnEdge = { top: false, right: false, bottom: false, left: false }\r\n\tprivate _tileStack: Tile[] = []\r\n\r\n\tconstructor(private defined: boolean, private colX: number, private colY: number, private colHeight: number) {\r\n\t\tthis._defined = defined\r\n\t\tthis._x = colX\r\n\t\tthis._y = colY\r\n\t\tthis._height = colHeight\r\n\t}\r\n\r\n\tset x(x: number) {\r\n\t\tthis._x = x\r\n\t}\r\n\r\n\tset y(y: number) {\r\n\t\tthis._y = y\r\n\t}\r\n\r\n\tset height(h: number) {\r\n\t\tthis._height = h\r\n\t}\r\n\r\n\tset blockGroup(groupNum: number) {\r\n\t\tthis._blockGroup = groupNum\r\n\t}\r\n\r\n\tset corner(corner: boolean) {\r\n\t\tthis._corner = corner\r\n\t}\r\n\r\n\tset edge(edge: ColumnEdge) {\r\n\t\tthis._edge = edge\r\n\t}\r\n\r\n\tset tileStack(tiles: Tile[]) {\r\n\t\tthis._tileStack = tiles\r\n\t}\r\n\r\n\tget isDefined(): boolean {\r\n\t\treturn this._defined\r\n\t}\r\n\r\n\tget x(): number {\r\n\t\treturn this._x\r\n\t}\r\n\r\n\tget y(): number {\r\n\t\treturn this._y\r\n\t}\r\n\r\n\tget height(): number {\r\n\t\treturn this._height\r\n\t}\r\n\r\n\tget blockGroup(): number {\r\n\t\treturn this._blockGroup\r\n\t}\r\n\r\n\tget corner(): boolean {\r\n\t\treturn this._corner\r\n\t}\r\n\r\n\tget edge(): ColumnEdge {\r\n\t\treturn this._edge\r\n\t}\r\n\r\n\tget tileStack(): Tile[] {\r\n\t\treturn this._tileStack\r\n\t}\r\n\r\n\tpublic getTile(height: number): Tile {\r\n\t\treturn this._tileStack[height]\r\n\t}\r\n\r\n\tpublic removeTopTile(): void {\r\n\t\tthis._tileStack.pop()\r\n\t}\r\n}","import { Color } from './colors.component'\r\n\r\nexport class Config {\r\n\r\n\tprivate _allowDebug: boolean = true\r\n\tprivate _tileWidth: number = 20\r\n\tprivate _tileLength: number = 20\r\n\tprivate _tileHeight: number = 10\r\n\tprivate _tileSmallAngle: number = 85\r\n\tprivate _tileLargeAngle: number = 100\r\n\tprivate _groundColor: Color = new Color('#f5f3e5')\r\n\tprivate _buildingBaseColor: Color = new Color(\r\n\t\t125 + Math.floor(Math.random() * 75),\r\n\t\t125 + Math.floor(Math.random() * 40),\r\n\t\t160 + Math.floor(Math.random() * 30)\r\n\t)\r\n\tprivate _maxDarkenValue: number = -70\r\n\tprivate _maxLightenValue: number = 40\r\n\tprivate _tileEdgeBleed: number = 0.05\r\n\tprivate _maxAllowedHeight: number = 12\r\n\tprivate _topMargin: number = 80\r\n\tprivate _allowBuildingDecorations: boolean = false\r\n\tprivate _allowSurroundingDecorations: boolean = true\r\n\tprivate _allowWindows: boolean = false\r\n\tprivate _lightInWindows: boolean = Math.round(Math.random() * 8) > 6 ? true : false\r\n\tprivate _goldenRatio: number = 1.61803399\r\n\tprivate _fibonacci: number[] = [1, 2, 3, 5, 8, 13]\r\n\r\n\tconstructor() {\t}\r\n\r\n\tpublic get allowDebug(): boolean {\r\n\t\treturn this._allowDebug\r\n\t}\r\n\r\n\tpublic get tileWidth(): number {\r\n\t\treturn this._tileWidth\r\n\t}\r\n\r\n\tpublic get tileLength(): number {\r\n\t\treturn this._tileLength\r\n\t}\r\n\r\n\tpublic get tileHeight(): number {\r\n\t\treturn this._tileHeight\r\n\t}\r\n\r\n\tpublic get tileSmallAngle(): number {\r\n\t\treturn this._tileSmallAngle\r\n\t}\r\n\r\n\tpublic get tileLargeAngle(): number {\r\n\t\treturn this._tileLargeAngle\r\n\t}\r\n\r\n\tpublic get groundColor(): Color {\r\n\t\treturn this._groundColor\r\n\t}\r\n\r\n\tpublic get buildingBaseColor(): Color {\r\n\t\treturn this._buildingBaseColor\r\n\t}\r\n\r\n\tpublic get maxDarkenValue(): number {\r\n\t\treturn this._maxDarkenValue\r\n\t}\r\n\r\n\tpublic get maxLightenValue(): number {\r\n\t\treturn this._maxLightenValue\r\n\t}\r\n\r\n\tpublic get tileEdgeBleed(): number {\r\n\t\treturn this._tileEdgeBleed\r\n\t}\r\n\r\n\tpublic get maxAllowedHeight(): number {\r\n\t\treturn this._maxAllowedHeight\r\n\t}\r\n\r\n\tpublic get topMargin(): number {\r\n\t\treturn this._topMargin\r\n\t}\r\n\r\n\tpublic get lightInWindows(): boolean {\r\n\t\treturn this._lightInWindows\r\n\t}\r\n\r\n\tpublic get allowWindows(): boolean {\r\n\t\treturn this._allowWindows\r\n\t}\r\n\r\n\tpublic get allowBuildingDecorations(): boolean {\r\n\t\treturn this._allowBuildingDecorations\r\n\t}\r\n\r\n\tpublic get allowSurroundingDecorations(): boolean {\r\n\t\treturn this._allowSurroundingDecorations\r\n\t}\r\n\r\n\tpublic get goldenRatio(): number {\r\n\t\treturn this._goldenRatio\r\n\t}\r\n\r\n\tpublic get fibonacci(): number[] {\r\n\t\treturn this._fibonacci\r\n\t}\r\n\r\n\tpublic getMapWidth(mapArrayWidth: number): number {\r\n\t\treturn mapArrayWidth * this._tileWidth\r\n\t}\r\n\r\n\tpublic getMapLength(mapArrayLength: number): number {\r\n\t\treturn mapArrayLength * this._tileLength\r\n\t}\r\n}","import { Map } from './mapper.component'\r\nimport { Column } from './column.component'\r\nimport { Config } from './config.component'\r\nimport { Tile } from './tile.component'\r\nimport { TileType } from './enums/tile-type.enum'\r\nimport { TileOptions } from './interfaces/tile-options.interface'\r\n\r\nexport class Decorations {\r\n\r\n\tprivate config: Config = new Config()\r\n\r\n\tconstructor() {}\r\n\r\n\tpublic placeRandomTrees(world: Map) {\r\n\r\n\t\tconst randomAmount = Math.floor(Math.random() * 6)\t\t\r\n\t\tconst yPlacement = []\r\n\t\tconst xPlacement = []\r\n\r\n\t\tfor (let t = 0; t < randomAmount; t++) {\r\n\t\t\tyPlacement.push(Math.floor(5 + Math.random() * (world.mapLength - 5)))\r\n\t\t}\r\n\r\n\t\tfor (let y = 0; y < world.mapLength; y++) {\r\n\r\n\t\t\tif (y > 1 && y < world.mapLength - 2) {\r\n\r\n\t\t\t\tlet loopCount = 0\r\n\t\t\t\tlet i = 0\r\n\r\n\t\t\t\tif (yPlacement.includes(y)) {\r\n\t\t\t\t\tyPlacement.forEach(value => {\r\n\t\t\t\t\t\tif (value === y) {\r\n\t\t\t\t\t\t\tloopCount++\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor (let x = 1; x < world.mapWidth; x++) {\r\n\r\n\t\t\t\t\tif (x > 2 && x < world.mapWidth - 3) {\r\n\r\n\t\t\t\t\t\tif (!world.map[y][x].isDefined &&\r\n\t\t\t\t\t\t\t!world.map[y-1][x].isDefined &&\r\n\t\t\t\t\t\t\t!world.map[y+1][x].isDefined &&\r\n\t\t\t\t\t\t\t!world.map[y][x-2].isDefined &&\r\n\t\t\t\t\t\t\t!world.map[y][x+2].isDefined) {\r\n\r\n\t\t\t\t\t\t\tconst chance = Math.floor(Math.random() * 200)\r\n\r\n\t\t\t\t\t\t\tif (chance > 160 && i < loopCount && xPlacement.indexOf(x) === -1) {\r\n\r\n\t\t\t\t\t\t\t\tlet decoration = new Column(true, x, y, 0)\r\n\t\t\t\t\t\t\t\t\tdecoration.tileStack = [new Tile(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t10000 + i, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tx, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ty, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t0, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tTileType.None,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.config.groundColor,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\troof:\t\tfalse,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tpillar: \tfalse,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tslope:\t\tfalse,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twindowed: \t0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttower: \t\tfalse,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstairs:\t\tfalse,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thalfArch: \tfalse,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twholeArch:\tfalse,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tareaDecoration: 'tree'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t})]\r\n\t\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t\tworld.map[y][x] = decoration\r\n\r\n\t\t\t\t\t\t\t\txPlacement.push(x)\r\n\r\n\t\t\t\t\t\t\t\ti++;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\t\t\t\r\n\t\t}\r\n\r\n\t\treturn world.map\r\n\t}\r\n}","export enum BuildingHeightVariations {\r\n\tTallCenter = 'tallCenter',\r\n\tTallSurrounds = 'tallSurrounds',\r\n\tRandom = 'random'\r\n}","export enum TileType {\r\n\tNone = 'none',\r\n\tBody = 'body',\r\n\tTower = 'tower',\r\n\tHalfBlock = 'halfBlock',\r\n\tRoof = 'roof',\r\n\tGrass = 'grass',\r\n\tShadow = 'shadow'\r\n}","export interface TileOptions {\r\n\troof: boolean,\r\n\tpillar: boolean,\r\n\tslope: string | boolean,\r\n\twindowed: number,\r\n\ttower: boolean,\r\n\tstairs:\tboolean,\r\n\thalfArch: boolean,\r\n\twholeArch: boolean,\r\n\tareaDecoration: string\r\n}\r\n\r\nexport class TileOptionsFunctions {\r\n\r\n\tgetDefaultTileOptions(\r\n\t\troof: boolean = false,\r\n\t\tpillar: boolean = false,\r\n\t\tslope: string | boolean = false,\r\n\t\twindowed: number = 0,\r\n\t\ttower: boolean = false,\r\n\t\tstairs:\tboolean = false,\r\n\t\thalfArch: boolean = false,\r\n\t\twholeArch: boolean = false,\r\n\t\tareaDecoration: string = ''\r\n\t): TileOptions {\r\n\t\treturn {\r\n\t\t\troof,\r\n\t\t\tpillar,\r\n\t\t\tslope,\r\n\t\t\twindowed,\r\n\t\t\ttower,\r\n\t\t\tstairs,\r\n\t\t\thalfArch,\r\n\t\t\twholeArch,\r\n\t\t\tareaDecoration\r\n\t\t}\r\n\t}\r\n\r\n}","import { Map } from './mapper.component'\r\nimport { Renderer } from './builder.component'\r\nimport { Color } from './colors.component'\r\nimport { Config } from './config.component'\r\n\r\nclass RandomBuilding {\r\n\r\n\tprivate _map: Map\r\n\tprivate _builder: Renderer = new Renderer\r\n\tprivate config: Config = new Config\r\n\r\n\tconstructor() {\r\n\t\t// !!Math.round(Math.random())\r\n\t\tthis._map = new Map(32, 32, 12, 1, 5, 3, 3, !!0)\r\n\t\tdocument.querySelector('body').style.background = this.config.groundColor.hex()\r\n\t}\r\n\r\n\tpublic debug(): boolean {\r\n\t\treturn this.config.allowDebug\r\n\t}\r\n\r\n\tget map() {\r\n\t\treturn this._map\r\n\t}\r\n\r\n\tpublic colorMap(): string {\r\n\t\treturn this._builder.build2DMap(this._map)\r\n\t}\r\n\r\n\tpublic addToBuildingAndRedraw(): string {\r\n\t\tthis._map.addToBuilding()\r\n\t\treturn this._builder.build2DMap(this._map)\r\n\t}\r\n\r\n\tpublic drawTileMap(): string {\r\n\t\treturn this._builder.buildMap(this._map)\r\n\t}\r\n\r\n\tpublic getBaseColor(): Color {\r\n\t\tconst col = this.map.getFirstDefinedColumn()\r\n\t\tif (col.height > 0) {\r\n\t\t\tconst tile = col.tileStack[col.tileStack.length-1]\r\n\t\t\treturn tile.tileColor\t\r\n\t\t}\r\n\t\treturn new Color('#fff')\r\n\t}\r\n\r\n\tpublic getImageTag(): void {\r\n\t\tif (document.querySelector('#buildingimg')) {\r\n\t\t\tdocument.querySelector('#buildingimg').remove()\r\n\t\t}\r\n\r\n\t\tlet svg = new XMLSerializer().serializeToString(document.querySelector('svg'))\r\n\t\tlet base64 = window.btoa(svg)\r\n\r\n\t\tlet newImg = document.createElement('img')\r\n\t\tnewImg.setAttribute('id', 'buildingimg')\r\n\t\tif (window['debug']) {\r\n\t\t\tnewImg.setAttribute('class', 'debug-active')\r\n\t\t}\r\n\t\tnewImg.setAttribute('src', 'data:image/svg+xml;base64,'+base64)\r\n\t\t\r\n\t\tlet beforeElement = document.querySelector('#worldtest')\r\n\t\tlet parent = document.querySelector(\"body\")\r\n\t\tparent.insertBefore(newImg, beforeElement)\t\t\r\n\t}\r\n}\r\n\r\nwindow['debug'] = false\r\nlet world\r\n\r\nwindow['activateDebug'] = () => { \r\n\twindow['debug'] = true\r\n\tdocument.querySelector('#color').classList.remove('hide')\r\n\tdocument.querySelector('#add').classList.remove('hide')\r\n\tdocument.querySelector('#color-scheme').classList.remove('hide')\r\n\tif (document.querySelector('#buildingimg')) {\r\n\t\tdocument.querySelector('#buildingimg').classList.add('debug-active')\r\n\t}\t\r\n\tdocument.querySelector('#color').innerHTML = building.colorMap()\r\n\r\n\tconst tiles = document.querySelector('#color').querySelectorAll('.tile')\r\n\tworld = building.map\r\n\r\n\ttiles.forEach(tile => {\r\n\t\ttile.addEventListener('click', event => {\r\n\t\t\tconst evtTarget = event.target as HTMLElement\r\n\t\t\tconst y = evtTarget.getAttribute('data-y')\r\n\t\t\tconst x = evtTarget.getAttribute('data-x')\r\n\r\n\t\t\tconsole.log(world.map[y][x])\r\n\t\t})\r\n\t})\r\n}\r\n\r\nlet building = new RandomBuilding()\r\n\r\nif (building.debug()) {\r\n\twindow['activateDebug']();\r\n}\r\n\r\ndocument.querySelector(\"#worldtest\").innerHTML = building.drawTileMap()\r\nif (!building.debug()) {\r\n\tbuilding.getImageTag()\r\n\tdocument.querySelector(\"#worldtest\").classList.add('hide')\r\n}\r\n\r\nsetColors(building)\r\n\r\ndocument.querySelector('#add').addEventListener('click', () => {\r\n\tdocument.querySelector('#color').innerHTML = building.addToBuildingAndRedraw()\r\n\tdocument.querySelector(\"#worldtest\").innerHTML = building.drawTileMap()\r\n})\r\n\r\ndocument.querySelector('#generate').addEventListener('click', () => {\r\n\tbuilding = new RandomBuilding()\r\n\tif (window['debug']) {\r\n\t\tdocument.querySelector('#color').innerHTML = building.colorMap()\r\n\t}\t\r\n\tdocument.querySelector(\"#worldtest\").innerHTML = building.drawTileMap()\r\n\tif (!building.debug()) {\r\n\t\tbuilding.getImageTag()\r\n\t\tdocument.querySelector(\"#worldtest\").classList.add('hide')\r\n\t}\r\n\r\n\tdocument.querySelectorAll('.point').forEach((item) => {\r\n\t\titem.addEventListener('click', () => {\r\n\t\t\tconsole.log('toggled', item)\r\n\t\t\titem.parentElement.classList.toggle('active')\r\n\t\t})\t\t\r\n\t})\r\n\r\n\tsetColors(building)\r\n})\r\n\r\nconst getTileInfo = (y, x) => {\r\n\r\n}\r\n\r\n/*\r\ndocument.querySelector('#debugActive').addEventListener('click', () => {\r\n\tdocument.querySelector('#debug').classList.toggle('show')\r\n\tdocument.querySelector('#debugActive').classList.toggle('active')\r\n})\r\n\r\ndocument.querySelectorAll('.blockLabel').forEach((item) => {\r\n\titem.addEventListener('click', () => {\r\n\t\titem.classList.toggle('active')\r\n\t})\r\n}) */\r\n\r\nfunction setColors(building: RandomBuilding) {\r\n\r\n\tconst color = building.getBaseColor()\r\n\tconst shade0 = color.changeColorLightingString(0)\r\n\tconst shade1 = color.changeColorLightingString(20)\r\n\tconst shade2 = color.changeColorLightingString(-20)\r\n\tconst shade3 = color.getColorStringByHue(60)\r\n\tconst shade4 = color.getColorStringByHue(120)\r\n\tconst shade5 = color.getColorStringByHue(180)\r\n\tconst shade6 = color.getColorStringByHue(240)\r\n\tconst shade7 = color.getColorStringByHue(300)\r\n\r\n\tconst colorDivs = `\r\n\t\t<div class=\"color__tile\" style=\"background-color:${shade0};\"></div>\r\n\t\t<div class=\"color__tile\" style=\"background-color:${shade1};\"></div>\r\n\t\t<div class=\"color__tile\" style=\"background-color:${shade3};\"></div>\r\n\t\t<div class=\"color__tile\" style=\"background-color:${shade4};\"></div>\r\n\t\t<div class=\"color__tile\" style=\"background-color:${shade5};\"></div>\r\n\t\t<div class=\"color__tile\" style=\"background-color:${shade6};\"></div>\r\n\t\t<div class=\"color__tile\" style=\"background-color:${shade7};\"></div>`\r\n\r\n\tdocument.querySelector('#color-scheme').innerHTML = colorDivs\r\n}\r\n/*\r\ndocument.querySelector('#download').addEventListener('click', () => {\r\n\tlet svg = new XMLSerializer().serializeToString(document.querySelector('svg'))\r\n\tlet base64 = window.btoa(svg)\r\n\r\n\tlet newImg = document.createElement('img')\r\n\tnewImg.setAttribute('src', 'data:image/svg+xml;base64,'+base64)\r\n\tdocument.querySelector('body').appendChild(newImg)\r\n}); */","import { Config } from './config.component'\r\nimport { Position } from './interfaces/position.interface'\r\n\r\nexport class MapGenerationFunctions {\r\n\r\n\tprivate config: Config = new Config();\r\n\tsmallAngle = this.config.tileSmallAngle;\r\n\tlargeAngle = this.config.tileLargeAngle;\r\n\r\n\tconstructor() { }\r\n\r\n\tpublic calculateAdditionalBlockIterations(maximumBlockIterations: number) {\r\n\t\treturn 2 + Math.floor(Math.random() * maximumBlockIterations);\r\n\t}\r\n\r\n\t// calculate the dimensions to draw the isometric perspective tile with the parameters as if it were a straight square tile\r\n\tpublic calculateStraightLinesFromIsometricSquare (blockWidth: number, blockHeight: number) {\r\n\t\t// lengths this function returns when it comes to positions of longest and shortest sides as array\r\n\t\t/*           [0]\r\n\t\t *   _________________ \r\n\t\t *   |    [3]  |      |\r\n\t\t *   | [5]            |\r\n\t\t *   |               -|\r\n\t\t *   |-               | [1]\r\n\t\t *   | [4]            |\r\n\t\t *   |    [2]         |\r\n\t\t *   |_______|________|\r\n\t\t */  \r\n\r\n\t\tlet smallOuterAngle = (180 - this.smallAngle) / 2;\r\n\t\tlet largeOuterAngle = (180 - this.largeAngle) / 2;\r\n\r\n\t\tlet horizontalWidthFromBottom = this.getHorizontalBottomShortestWidth(blockWidth, smallOuterAngle);\r\n\t\tlet verticalHeightFromBottom = this.getVerticalBottomShortestHeight(horizontalWidthFromBottom, smallOuterAngle);\r\n\r\n\t\tlet horizontalWidthFromTop = this.getHorizontalTopLongestWidth(blockHeight, largeOuterAngle);\r\n\t\tlet verticalHeightFromTop = this.getVerticalTopLongestHeight(horizontalWidthFromTop, largeOuterAngle);\r\n\r\n\t\tlet totalHeight = verticalHeightFromBottom + verticalHeightFromTop;\r\n\t\tlet totalWidth = horizontalWidthFromBottom + horizontalWidthFromTop;\r\n\r\n\t\treturn {\t'totalWidth': totalWidth, // 0\r\n\t\t\t\t\t'totalHeight': totalHeight,  // 1\r\n\t\t\t\t\t'horizontalWidthFromBottom': horizontalWidthFromBottom,  // 2\r\n\t\t\t\t\t'horizontalWidthFromTop': horizontalWidthFromTop,  // 3\r\n\t\t\t\t\t'verticalHeightFromBottom': verticalHeightFromBottom,  // 4\r\n\t\t\t\t\t'verticalHeightFromTop': verticalHeightFromTop } // 5\r\n\t}\r\n\r\n\t// calculate the amount of pixels from the bottom left side of a straight square to the point at the bottom \r\n\t// .. where the tip of the tile meets the border of the square\r\n\tpublic getHorizontalBottomShortestWidth (diagonalWidth: number, smallAngle: number): number {\r\n\t\treturn diagonalWidth * Math.sin(this.toRadians(smallAngle));\r\n\t}\r\n\r\n\tpublic getVerticalBottomShortestHeight (diagonalHeight: number, smallAngle: number): number {\r\n\t\treturn diagonalHeight * Math.cos(this.toRadians(smallAngle));\r\n\t}\r\n\r\n\tpublic getHorizontalTopLongestWidth (diagonalWidth: number, largeAngle: number): number {\r\n\t\treturn diagonalWidth * Math.sin(this.toRadians(largeAngle));\r\n\t}\r\n\r\n\tpublic getVerticalTopLongestHeight (diagonalHeight: number, largeAngle: number): number {\r\n\t\treturn diagonalHeight * Math.cos(this.toRadians(largeAngle));\r\n\t}\r\n\r\n\tpublic addGradient(id: string, colorLeft: string, colorRight: string) {\r\n\r\n\t\tlet gradient = '<linearGradient id=\"'+id+'\">'\r\n\t\t\tgradient += '<stop offset=\"5%\" stop-color=\"'+colorLeft+'\" />'\r\n\t\t\tgradient += '<stop offset=\"95%\" stop-color=\"'+colorRight+'\" />'\r\n\t\t\tgradient += '</linearGradient>'\r\n\r\n\t\treturn gradient\r\n\t}\r\n\r\n\ttoRadians (angle: number): number {\r\n\t\treturn angle * (Math.PI / 180);\r\n\t}\r\n\r\n\tpublic getHighestXfromArray(array: Position[]): Position {\r\n\t\tlet highest: Position = {x: 0, y: 0}\r\n\r\n\t\tarray.forEach(item => {\r\n\t\t\tif (item.x > highest.x) {\r\n\t\t\t\thighest = item\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\treturn highest\r\n\t}\r\n\r\n\tpublic getHighestYfromArray(array: Position[]): Position {\r\n\t\tlet highest: Position = {x: 0, y: 0}\r\n\r\n\t\tarray.forEach(item => {\r\n\t\t\tif (item.y > highest.y) {\r\n\t\t\t\thighest = item\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\treturn highest\r\n\t}\r\n\r\n\tpublic getLowestXfromArray(array: Position[]): Position {\r\n\t\tlet highest = this.getHighestXfromArray(array)\r\n\t\tlet lowest: Position = highest\r\n\r\n\t\tarray.forEach(item => {\r\n\t\t\tif (item.x < lowest.x) {\r\n\t\t\t\tlowest = item\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\treturn lowest\r\n\t}\r\n\r\n\tpublic getLowestYfromArray(array: Position[]): Position {\r\n\t\tlet highest = this.getHighestYfromArray(array)\r\n\t\tlet lowest: Position = highest\r\n\r\n\t\tarray.forEach(item => {\r\n\t\t\tif (item.y < lowest.y) {\r\n\t\t\t\tlowest = item\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\treturn lowest\r\n\t}\r\n}\r\n","import { MapGenerationFunctions } from './mapGenerationFunctions.component'\r\nimport { BuildingHeightVariations } from './enums/building-height-variations.enum'\r\nimport { Color } from './colors.component'\r\nimport { Column } from './column.component'\r\nimport { Tile } from './tile.component'\r\nimport { TileOptions, TileOptionsFunctions } from './interfaces/tile-options.interface'\r\nimport { TileType } from './enums/tile-type.enum'\r\nimport { Config } from './config.component'\r\nimport { Position } from './interfaces/position.interface'\r\nimport { Dimensions } from './interfaces/dimensions.interface'\r\nimport { Primitives } from './primitives.component'\r\nimport { Modifiers } from './modifiers.component'\r\nimport { Decorations } from './decorations.component'\r\n\r\nexport class Map {\r\n\r\n\tprivate mapGen: MapGenerationFunctions = new MapGenerationFunctions()\r\n\tprivate config: Config = new Config()\r\n\tprivate primitives: Primitives = new Primitives()\r\n\tprivate mods: Modifiers = new Modifiers()\r\n\tprivate deco: Decorations = new Decorations()\r\n\tprivate tileOptionFuncs: TileOptionsFunctions = new TileOptionsFunctions()\r\n\r\n\tprivate _mapWidth: number\r\n\tprivate _mapLength: number\r\n\tprivate _mapMaxHeight: number\r\n\tprivate _averageBuildingSize: number\r\n\tprivate _blockHeight: number\r\n\tprivate _maximumBlockIterations: number\r\n\tprivate _additionalBlockIterations: number\r\n\tprivate _mapEdgeWidth: number\r\n\tprivate _highestPoint: number\r\n\tprivate _startBlockXfromCenterDeviation: number\r\n\tprivate _startBlockWidth: number\r\n\tprivate _startBlockLength: number\r\n\tprivate _mapHalfLength: number\r\n\tprivate _world: any[][]\r\n\tprivate _mirrorAtCenter: boolean\r\n\tprivate _blockHeightsArray: number[]\r\n\tprivate _blockGroups: number[]\r\n\tprivate _blockEdges: Position[]\t\r\n\tprivate _blockHeightVariationLabels = [BuildingHeightVariations.TallCenter, BuildingHeightVariations.TallSurrounds, BuildingHeightVariations.Random]\r\n\tprivate _blockHeightVariation = this._blockHeightVariationLabels[Math.floor(Math.random() * 3)]\r\n\tprivate _blockIdIterator: number\r\n\tprivate _blockHeightIterator: number\r\n\tprivate _blockAmountIterator: number\r\n\tprivate _HorizontalRemainingEmptyBlocksMin: number\r\n\tprivate _HorizontalRemainingEmptyBlocksMax: number\r\n\tprivate _decorationLineH: number\r\n\tprivate _groundColor: Color\r\n\tprivate _defaultColor: Color\r\n\tprivate _lineColor: Color\r\n\tprivate _firstLevelColor: Color\r\n\tprivate _surroundingsGrassColor: Color\r\n\tprivate _surroundingsWaterColor: Color\r\n\tprivate _surroundingsSandColor: Color\r\n\tprivate _surroundingsDefaultColor: Color\r\n\tprivate _showWindows: number\r\n\r\n\tconstructor(\t\r\n\t\t\tmapWidth: number, \r\n\t\t\tmapLength: number, \r\n\t\t\tmapMaxHeight: number, \r\n\t\t\tmapEdgeWidth: number,\r\n\t\t\taverageBuildingSize: number,\r\n\t\t\tblockHeight: number,\r\n\t\t\tmaximumBlockIterations: number,\r\n\t\t\tmirrorAtCenter: boolean = false)\r\n\t{\r\n\t\tthis._world = []\r\n\t\tthis._mapWidth = mapWidth\r\n\t\tthis._mapLength = mapLength\r\n\t\tthis._mapMaxHeight = mapMaxHeight\r\n\t\tthis._mapEdgeWidth = mapEdgeWidth\r\n\t\tthis._averageBuildingSize = averageBuildingSize \r\n\t\tthis._blockHeight = blockHeight\r\n\t\tthis._mirrorAtCenter = mirrorAtCenter\r\n\t\tlet baseHeight = 2\r\n\t\tlet scaleFactor\r\n\t\tif (this._blockHeightVariation === BuildingHeightVariations.TallCenter) {\r\n\t\t\tscaleFactor = 2\r\n\t\t} else if (this._blockHeightVariation === BuildingHeightVariations.TallSurrounds) {\r\n\t\t\tscaleFactor = 8\r\n\t\t} else {\r\n\t\t\tscaleFactor = 4\r\n\t\t}\r\n\t\tif (Math.round(Math.random()) === 0) {\r\n\t\t\tthis._startBlockWidth = this._averageBuildingSize + Math.floor(Math.random() * scaleFactor)\r\n\t\t\tthis._startBlockLength = Math.floor(this._startBlockWidth * this.config.goldenRatio)\r\n\t\t} else {\r\n\t\t\tthis._startBlockLength = this._averageBuildingSize + Math.floor(Math.random() * scaleFactor)\r\n\t\t\tthis._startBlockWidth = Math.floor(this._startBlockLength * this.config.goldenRatio)\r\n\t\t}\t\t\r\n\t\tthis._maximumBlockIterations = maximumBlockIterations\r\n\t\tthis._additionalBlockIterations = this.mapGen.calculateAdditionalBlockIterations(maximumBlockIterations)\r\n\t\tthis._blockGroups = []\r\n\t\tthis._blockEdges = []\r\n\t\tthis._blockHeightsArray = []\r\n\t\tthis._mapHalfLength = Math.floor(mapLength / 2)\r\n\t\tthis._blockIdIterator = 0\r\n\t\tthis._blockAmountIterator = 1\r\n\t\tthis._blockHeightIterator = 1\r\n\t\tthis._decorationLineH = -1\r\n\t\tlet newLineHue = this.config.buildingBaseColor.getColorStringByHue(-120)\r\n\t\tlet lineColor = new Color(newLineHue)\r\n\t\tthis._defaultColor = new Color(this.config.buildingBaseColor.hex())\r\n\t\tthis._lineColor = lineColor.changeColorLighting(-30)\r\n\t\tthis._firstLevelColor = new Color(this.config.buildingBaseColor.getColorStringByHue(10)).changeColorLighting(-20)\r\n\t\tthis._groundColor = this.config.groundColor\r\n\t\tthis._HorizontalRemainingEmptyBlocksMin = 0\r\n\t\tthis._HorizontalRemainingEmptyBlocksMax = 0\r\n\t\tthis._surroundingsGrassColor = new Color('#7bb376')\r\n\t\tthis._surroundingsWaterColor = new Color('#6fb9ca')\r\n\t\tthis._surroundingsSandColor = new Color('#e9e3ba')\r\n\t\tthis._surroundingsDefaultColor = this._surroundingsGrassColor\r\n\t\tthis._showWindows = this.config.allowWindows ? Math.round(Math.random() * 2) : 0\r\n\r\n\t\tlet startblockYfromCenterDeviation = 0\r\n\t\tif (!this._mirrorAtCenter) {\t\t\t\r\n\t\t\tstartblockYfromCenterDeviation = -6\r\n\t\t\tif (Math.round(Math.random()) === 0) {\r\n\t\t\t\tstartblockYfromCenterDeviation = 3\r\n\t\t\t}\r\n\t\t\tconsole.log('not mirrorred: dev:', startblockYfromCenterDeviation)\r\n\t\t}\r\n\r\n\t\tlet mapLengthHalf = Math.floor(mapLength / 2) \r\n\t\tlet mapWidthHalf = Math.floor(mapWidth / 2)\r\n\t\tlet startBlockXfromCenterDeviation = 7\t\t\r\n\t\tlet startblockXfromCenter = 4 + Math.floor(Math.random() * startBlockXfromCenterDeviation)\r\n\t\tlet startblockLengthHalf = Math.floor(this._startBlockLength / 2)\r\n\t\tlet startblockWidthHalf = Math.floor(this._startBlockWidth / 2)\r\n\t\tlet startingPositionX = Math.floor(this._mapWidth / 2) - Math.floor(startblockXfromCenter / 2)\r\n\t\tlet buildGardens = !!(Math.round(Math.random() * 2))\r\n\t\tlet useWaterGarden = false\r\n\t\tlet tileHeight = 0\r\n\t\tlet firstBlockHeightRandom = Math.floor(Math.random() * this.config.fibonacci.length)\r\n\t\tlet firstBlockHeight = this.config.fibonacci[firstBlockHeightRandom]\r\n\t\tlet slopeY = 0\r\n\r\n\t\tif (this._defaultColor.rgb().g >= 180 && this._defaultColor.rgb().b >= 150 && Math.round(Math.random() * 4) >= 3) {\r\n\t\t\tuseWaterGarden = (Math.round(Math.random() * 10) > 6) ? true : false\r\n\t\t\tthis._surroundingsDefaultColor = this._surroundingsWaterColor\r\n\t\t} else if (Math.round(Math.random() * 10) <= 1) {\r\n\t\t\tuseWaterGarden = (Math.round(Math.random() * 10) > 3) ? true : false\r\n\t\t\tthis._surroundingsDefaultColor = this._surroundingsWaterColor\r\n\t\t}\r\n\r\n\t\tif (this._blockHeightVariation === BuildingHeightVariations.TallCenter) {\r\n\t\t\tfirstBlockHeight = this.config.fibonacci[maximumBlockIterations]\r\n\t\t} else if (this._blockHeightVariation === BuildingHeightVariations.TallSurrounds) {\r\n\t\t\tfirstBlockHeight = baseHeight + this.config.fibonacci[0]\r\n\t\t\tthis._blockHeight = firstBlockHeight\r\n\t\t}\r\n\r\n\t\tlet hollowArchWays = false\r\n\r\n\t\tif (firstBlockHeight === 3) {\r\n\t\t\thollowArchWays = true\r\n\t\t}\r\n\r\n\t\tif (firstBlockHeight > 6) {\r\n\t\t\tthis._decorationLineH = 4\r\n\t\t} else if (firstBlockHeight > 3) {\r\n\t\t\tthis._decorationLineH = 3\r\n\t\t}\r\n\r\n\t\tif (firstBlockHeight < 4) {\r\n\t\t\tif (Math.round(Math.random() * 5) > 2) {\r\n\t\t\t\tslopeY = startingPositionX + Math.ceil(Math.random() * this._startBlockWidth - 2)\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis._blockHeight = firstBlockHeight\r\n\r\n\t\tlet hollowBuildingBlock = (Math.round(Math.random()) === 1 ? true : false) \r\n\t\tlet openGroundLevel = (this._blockHeight > 2) ? (Math.round(Math.random()) === 1 ? true : false) : false\r\n\r\n\t\tfor (let y = 0; y < this.mapLength; y++) {\r\n\r\n\t\t\tthis._world[y] = []\r\n\r\n\t\t\tfor (let x = 0; x < this.mapWidth; x++) {\r\n\r\n\t\t\t\tlet thisBlockGroup = 0\r\n\r\n\t\t\t\tlet column = new Column(false, x, y, 0)\r\n\t\t\t\tlet yConditions\r\n\t\t\t\tlet xConditions = (x > startingPositionX && x <= (startingPositionX + this._startBlockWidth))\r\n\r\n\t\t\t\tif (!this._mirrorAtCenter) {\r\n\t\t\t\t\tyConditions = (y >= mapLengthHalf + startblockYfromCenterDeviation && y <= mapLengthHalf + (startblockYfromCenterDeviation + this._startBlockLength))\r\n\t\t\t\t} else {\r\n\t\t\t\t\tyConditions = (y >= mapLengthHalf && y <= (mapLengthHalf + startblockLengthHalf))\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\r\n\t\t\t\tif (yConditions) {\r\n\r\n\t\t\t\t\tif (xConditions) {\r\n\r\n\t\t\t\t\t\tthisBlockGroup = 1\r\n\t\t\t\t\t\tlet tileStack = []\r\n\r\n\t\t\t\t\t\tfor (let h = 0; h < this._blockHeight; h++) {\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tlet thisPillar = false\r\n\t\t\t\t\t\t\tlet tileType = TileType.Body\r\n\t\t\t\t\t\t\tif (h < 2 && openGroundLevel) {\r\n\t\t\t\t\t\t\t\tif (y % 2 === 0) {\r\n\t\t\t\t\t\t\t\t\tthisPillar = true\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\ttileType = TileType.None\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (this._decorationLineH > 3 && h+1 === this._decorationLineH && h+1 < this._blockHeight) {\r\n\t\t\t\t\t\t\t\ttileType = TileType.None\r\n\t\t\t\t\t\t\t\tif (y % 2 === 0) {\r\n\t\t\t\t\t\t\t\t\tthisPillar = true\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tlet thisWindowed = 0\r\n\t\t\t\t\t\t\tif (!thisPillar && this._showWindows > 0 && h % 2 === 1) {\r\n\t\t\t\t\t\t\t\tthisWindowed = this._showWindows\r\n\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tlet isRoof = (h === this._blockHeight-1) ? true : false\r\n\t\t\t\t\t\t\tlet tileColor = this._defaultColor\r\n\r\n\t\t\t\t\t\t\tif (h === this._decorationLineH) {\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\ttileColor = this._lineColor\r\n\t\t\t\t\t\t\t} else if (h === 0) { \r\n\t\t\t\t\t\t\t\ttileColor = this._firstLevelColor\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttileColor = this._defaultColor\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tlet slope = false\r\n\t\t\t\t\t\t\tif (h < this._blockHeight && y === slopeY) {\r\n\t\t\t\t\t\t\t\tif (h === 0) {\r\n\t\t\t\t\t\t\t\t\tif (x === startingPositionX + this._startBlockWidth) {\r\n\t\t\t\t\t\t\t\t\t\tslope = true\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t} else if (h === 1) {\r\n\t\t\t\t\t\t\t\t\tif (x === startingPositionX + this._startBlockWidth - 1) {\r\n\t\t\t\t\t\t\t\t\t\tslope = true\r\n\t\t\t\t\t\t\t\t\t} else if (x === startingPositionX + this._startBlockWidth) {\r\n\t\t\t\t\t\t\t\t\t\ttileType = TileType.None\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t} else if (h === 2) {\r\n\t\t\t\t\t\t\t\t\tif (x === startingPositionX + this._startBlockWidth - 2) {\r\n\t\t\t\t\t\t\t\t\t\tslope = true\r\n\t\t\t\t\t\t\t\t\t} else if (x > startingPositionX + this._startBlockWidth - 2) {\r\n\t\t\t\t\t\t\t\t\t\ttileType = TileType.None\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif (hollowArchWays && h < 2) {\r\n\t\t\t\t\t\t\t\ttileType = TileType.None\r\n\t\t\t\t\t\t\t\tif ((y % 2 === 0 && x % 2 === 1) || (y % 2 === 1 && x % 2 === 0)) {\r\n\t\t\t\t\t\t\t\t\tthisPillar = true\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\t\t\t\t\r\n\r\n\t\t\t\t\t\t\ttileStack.push(\r\n\t\t\t\t\t\t\t\tnew Tile(\r\n\t\t\t\t\t\t\t\t\tthis._blockIdIterator, \r\n\t\t\t\t\t\t\t\t\tx, \r\n\t\t\t\t\t\t\t\t\ty, \r\n\t\t\t\t\t\t\t\t\th, \r\n\t\t\t\t\t\t\t\t\ttileType,\r\n\t\t\t\t\t\t\t\t\ttileColor,\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\troof:\t\tisRoof,\r\n\t\t\t\t\t\t\t\t\t\tpillar: \tthisPillar,\r\n\t\t\t\t\t\t\t\t\t\tslope:\t\tslope,\r\n\t\t\t\t\t\t\t\t\t\twindowed: \tthisWindowed,\r\n\t\t\t\t\t\t\t\t\t\ttower: \t\tfalse,\r\n\t\t\t\t\t\t\t\t\t\tstairs:\t\tfalse,\r\n\t\t\t\t\t\t\t\t\t\thalfArch: \tfalse,\r\n\t\t\t\t\t\t\t\t\t\twholeArch:\tfalse,\r\n\t\t\t\t\t\t\t\t\t\tareaDecoration: ''\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t)\r\n\r\n\t\t\t\t\t\t\tif (this._blockGroups.indexOf(thisBlockGroup) === -1) {\r\n\t\t\t\t\t\t\t\tthis._blockGroups.push(thisBlockGroup)\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tthis._blockHeightsArray.push(this._blockHeight)\r\n\r\n\t\t\t\t\t\t\tthis._blockIdIterator++\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tcolumn = new Column(true, x, y, this._blockHeight)\r\n\r\n\t\t\t\t\t\tcolumn.blockGroup = thisBlockGroup\r\n\t\t\t\t\t\tcolumn.height = this._blockHeight\r\n\t\t\t\t\t\tcolumn.corner = false\r\n\t\t\t\t\t\tcolumn.tileStack = tileStack\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._world[y][x] = column\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.setEdges(false)\r\n\r\n\t\t/* Make hollow */\r\n\t\tif (hollowBuildingBlock && this._blockHeight > 2) {\r\n\r\n\t\t\tfor (let y = 0; y < this.mapLength; y++) {\r\n\t\t\t\tfor (let x = 0; x < this.mapWidth; x++) {\r\n\r\n\t\t\t\t\tif (!!this._world[y][x].edge.left) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tfor (let h = 0; h < this._blockHeight; h++) {\r\n\t\t\t\t\t\t\tif (this._world[y][x].tileStack[h].type === TileType.None) {\r\n\t\t\t\t\t\t\t\tif (y % 2 === 0) {\r\n\t\t\t\t\t\t\t\t\tthis._world[y][x].tileStack[h].options.pillar = true\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} \r\n\t\t\t\t\tif (!!this._world[y][x].edge.bottom) {\r\n\t\t\t\t\t\t// console.log('bottom? ', this._world[y][x].edge.bottom)\r\n\t\t\t\t\t\tfor (let h = 0; h < this._blockHeight; h++) {\r\n\t\t\t\t\t\t\tif (this._world[y][x].tileStack[h].type === TileType.None) {\r\n\t\t\t\t\t\t\t\tif (x % 2 === 0) {\r\n\t\t\t\t\t\t\t\t\tthis._world[y][x].tileStack[h].options.pillar = true\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!!this._world[y][x].edge.right) {\r\n\t\t\t\t\t\t// console.log('right? ', this._world[y][x].edge.right)\r\n\t\t\t\t\t\tfor (let h = 0; h < this._blockHeight; h++) {\r\n\t\t\t\t\t\t\tif (this._world[y][x].tileStack[h].type === TileType.None) {\r\n\t\t\t\t\t\t\t\tif (y % 2 === 0) {\r\n\t\t\t\t\t\t\t\t\tthis._world[y][x].tileStack[h].options.pillar = true\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!!this._world[y][x].edge.top) {\r\n\t\t\t\t\t\t// console.log('top? ', this._world[y][x].edge.top)\r\n\t\t\t\t\t\tfor (let h = 0; h < this._blockHeight; h++) {\r\n\t\t\t\t\t\t\tif (this._world[y][x].tileStack[h].type === TileType.None) {\r\n\t\t\t\t\t\t\t\tif (x % 2 === 0) {\r\n\t\t\t\t\t\t\t\t\tthis._world[y][x].tileStack[h].options.pillar = true\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet hasEdge = (this._world[y][x].edge.left || this._world[y][x].edge.bottom || this._world[y][x].edge.right) ? true : false\r\n\r\n\t\t\t\t\tif (this._world[y][x].isDefined && !hasEdge) {\r\n\t\t\t\t\t\tthis._world[y][x] = new Column(false, x, y, 0)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t\r\n\t\tfor (let i = 0; i < this._additionalBlockIterations; i++) {\r\n\t\t\tthis.getEdges()\r\n\t\t\tthis._world = this.mods.addBuildingComponent(this)\r\n\t\t}\r\n\t\tthis.setEdges(false)\r\n\r\n\t\tthis._world = this.mods.removeExcessArches(this);\r\n\r\n\t\t/*\t\r\n\t\t *\tAdd gardens or other ornamental features around the building */\t\t\r\n\r\n\t\tif (this.config.allowSurroundingDecorations && buildGardens) {\r\n\r\n\t\t\tthis._HorizontalRemainingEmptyBlocksMin = this.getLeastOpenSpaceOnX()['min']\r\n\t\t\tthis._HorizontalRemainingEmptyBlocksMax = this.getLeastOpenSpaceOnX()['max']\r\n\r\n\t\t\tif (this._HorizontalRemainingEmptyBlocksMin > 7) {\r\n\r\n\t\t\t\tlet landsLength = this._HorizontalRemainingEmptyBlocksMin * 2\r\n\t\t\t\tif (landsLength > 16) landsLength = 16\r\n\t\t\t\tlet landsEdge = this._mapLength - landsLength\r\n\r\n\t\t\t\tfor (let y = Math.floor(landsEdge / 2); y < this.mapLength - Math.floor(landsEdge / 2); y++) {\t\t\t\t\r\n\t\t\t\t\tfor (let x = 0; x < this._HorizontalRemainingEmptyBlocksMin - 3; x++) {\r\n\t\t\t\t\t\tif (!this._world[y][x].isDefined) {\r\n\t\t\t\t\t\t\tlet edgeOfGarden = false\r\n\t\t\t\t\t\t\tlet tileType: TileType = TileType.Grass\r\n\t\t\t\t\t\t\tlet tileColor = this._surroundingsDefaultColor\r\n\t\t\t\t\t\t\tlet defaultHeight = 0\r\n\t\t\t\t\t\t\tif (x === 0 || \r\n\t\t\t\t\t\t\t\tx === this._HorizontalRemainingEmptyBlocksMin - 4) {\r\n\t\t\t\t\t\t\t\tif (useWaterGarden) {\r\n\t\t\t\t\t\t\t\t\ttileColor = this._defaultColor\r\n\t\t\t\t\t\t\t\t\ttileType = TileType.HalfBlock\r\n\t\t\t\t\t\t\t\t\tdefaultHeight = 1\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\ttileColor = this._surroundingsSandColor\r\n\t\t\t\t\t\t\t\t\ttileType = TileType.Grass\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else if (\r\n\t\t\t\t\t\t\t\t\t(y === Math.floor(landsEdge / 2)) ||\r\n\t\t\t\t\t\t\t\t\t(y === this.mapLength - Math.floor(landsEdge / 2) - 1) ) {\r\n\t\t\t\t\t\t\t\tif (useWaterGarden) {\r\n\t\t\t\t\t\t\t\t\ttileColor = this._defaultColor\r\n\t\t\t\t\t\t\t\t\ttileType = TileType.HalfBlock\r\n\t\t\t\t\t\t\t\t\tdefaultHeight = 1\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\ttileColor = this._surroundingsSandColor\r\n\t\t\t\t\t\t\t\t\ttileType = TileType.Grass\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tlet gardenBlock = new Column(true, x, y, defaultHeight)\r\n\t\t\t\t\t\t\t\tgardenBlock.tileStack = [new Tile(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis._blockIdIterator, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\tx, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\ty, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t0, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttileType,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttileColor,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.tileOptionFuncs.getDefaultTileOptions()\r\n\t\t\t\t\t\t\t\t\t\t\t\t)]\r\n\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\tthis._world[y][x] = gardenBlock\r\n\t\t\t\t\t\t\tthis._blockIdIterator++\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (this._HorizontalRemainingEmptyBlocksMax > 7) {\r\n\r\n\t\t\t\tlet landsLength = this._HorizontalRemainingEmptyBlocksMax * 2\r\n\t\t\t\tlet landsEdge = this._mapLength - landsLength\r\n\r\n\t\t\t\tfor (let y = Math.floor(landsEdge / 2); y < this.mapLength - Math.floor(landsEdge / 2); y++) {\r\n\t\t\t\t\tfor (let x = this._mapWidth - this._HorizontalRemainingEmptyBlocksMax + 2; x < this._mapWidth; x++) {\r\n\t\t\t\t\t\tif (!this._world[y][x].isDefined) {\r\n\t\t\t\t\t\t\tlet edgeOfGarden = false\r\n\t\t\t\t\t\t\tlet tileType: TileType = TileType.Grass\r\n\t\t\t\t\t\t\tlet tileColor = this._surroundingsDefaultColor\r\n\t\t\t\t\t\t\tlet defaultHeight = 0\r\n\t\t\t\t\t\t\tif (x === this._mapWidth - 1 || \r\n\t\t\t\t\t\t\t\tx === this._mapWidth - this._HorizontalRemainingEmptyBlocksMax + 2) {\r\n\t\t\t\t\t\t\t\tif (useWaterGarden) {\r\n\t\t\t\t\t\t\t\t\ttileColor = this._defaultColor\r\n\t\t\t\t\t\t\t\t\ttileType = TileType.HalfBlock\r\n\t\t\t\t\t\t\t\t\tdefaultHeight = 1\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\ttileColor = this._surroundingsSandColor\r\n\t\t\t\t\t\t\t\t\ttileType = TileType.Grass\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else if (\r\n\t\t\t\t\t\t\t\t\ty === Math.floor(landsEdge / 2) ||\r\n\t\t\t\t\t\t\t\t\ty === this.mapLength - Math.floor(landsEdge / 2) - 1) {\r\n\t\t\t\t\t\t\t\tif (useWaterGarden) {\r\n\t\t\t\t\t\t\t\t\ttileColor = this._defaultColor\r\n\t\t\t\t\t\t\t\t\ttileType = TileType.HalfBlock\r\n\t\t\t\t\t\t\t\t\tdefaultHeight = 1\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\ttileColor = this._surroundingsSandColor\r\n\t\t\t\t\t\t\t\t\ttileType = TileType.Grass\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tlet gardenBlock = new Column(true, x, y, defaultHeight)\r\n\t\t\t\t\t\t\t\tgardenBlock.tileStack = [new Tile(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis._blockIdIterator, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\tx, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\ty, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t0, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttileType,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttileColor,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.tileOptionFuncs.getDefaultTileOptions()\r\n\t\t\t\t\t\t\t\t\t\t\t\t)]\r\n\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\tthis._world[y][x] = gardenBlock\r\n\t\t\t\t\t\t\tthis._blockIdIterator++\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfor (let e = 0; e < this._blockEdges.length; e++) {\r\n\t\t\tlet edgePointY = this._blockEdges[e].y\r\n\t\t\tlet edgePointX = this._blockEdges[e].x\r\n\t\t\tlet grass = new Column(true, edgePointX, edgePointY, 0)\r\n\t\t\t\tgrass.tileStack = [new Tile(\r\n\t\t\t\t\t\t\t\t\tthis._blockIdIterator, \r\n\t\t\t\t\t\t\t\t\tedgePointX, \r\n\t\t\t\t\t\t\t\t\tedgePointY, \r\n\t\t\t\t\t\t\t\t\t0, \r\n\t\t\t\t\t\t\t\t\tTileType.Shadow,\r\n\t\t\t\t\t\t\t\t\tthis._defaultColor,\r\n\t\t\t\t\t\t\t\t\tthis.tileOptionFuncs.getDefaultTileOptions()\r\n\t\t\t\t\t\t\t\t)]\r\n\r\n\t\t\tif (this._world[edgePointY][edgePointX].isDefined) {\r\n\t\t\t\t\r\n\t\t\t\tif (!this._world[edgePointY - 1][edgePointX].isDefined) {\r\n\t\t\t\t\tthis._world[edgePointY - 1][edgePointX] = grass\r\n\t\t\t\t}\r\n\t\t\t\tif (!this._world[edgePointY + 1][edgePointX].isDefined) {\r\n\t\t\t\t\tthis._world[edgePointY + 1][edgePointX] = grass\r\n\t\t\t\t}\r\n\t\t\t\tif (!this._world[edgePointY][edgePointX - 1].isDefined) {\r\n\t\t\t\t\tthis._world[edgePointY][edgePointX - 1] = grass\r\n\t\t\t\t}\r\n\t\t\t\tif (!this._world[edgePointY][edgePointX + 1].isDefined) {\r\n\t\t\t\t\tthis._world[edgePointY][edgePointX + 1] = grass\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis._blockIdIterator++\r\n\t\t}\r\n\r\n\t\tfor (let y = 0; y < this.mapLength; y++) {\r\n\t\t\tfor (let x = 0; x < this.mapWidth; x++) {\r\n\t\t\t\tif (this._world[y][x].isDefined && this._world[y][x].height > 3) {\r\n\r\n\t\t\t\t\t// if column is corner\r\n\t\t\t\t\tif ((this._world[y][x].edge.right && this._world[y][x].edge.bottom) ||\r\n\t\t\t\t\t\t(this._world[y][x].edge.left && this._world[y][x].edge.bottom) ||\r\n\t\t\t\t\t\t(this._world[y][x].edge.right && this._world[y][x].edge.top)) {\r\n\t\t\t\t\t\tfor (let h = 0; h < this._world[y][x].height; h++) {\r\n\t\t\t\t\t\t\tif (h < 4 && this._world[y][x].tileStack[h].type === TileType.None) {\r\n\t\t\t\t\t\t\t\tthis._world[y][x].tileStack[h].options.pillar = true\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/*\r\n\t\t *\tReset grass tiles beneath pillars and empty tiles below building blocks that\r\n\t\t *\tshould be grass tiles\r\n\t\t */\r\n\r\n\t\tthis._world = this.mods.resetGrassTilesBelowPillars(this)\r\n\r\n\t\t/*\r\n\t\t *\tIf there are any large walls, make them more interesting by creating some see-through to it\r\n\t\t */\r\n\t\tthis._world = this.mods.refactorLargeWalls(this)\r\n\r\n\t\t/* \t\r\n\t\t *\tClear the edges and mirror the building\r\n\t\t */\r\n\r\n\t\tthis._world = this.mods.clearMapEdges(this)\r\n\t\tif (this._mirrorAtCenter) {\r\n\t\t\tthis._world = this.mods.mirrorMap(this)\r\n\t\t}\t\t\r\n\t\t// this.setEdges(true)\r\n\r\n\t\tthis._world = this.deco.placeRandomTrees(this)\r\n\r\n\t\tconsole.log(this._world)\r\n\t}\t\r\n\r\n\tget mapWidth(): number {\r\n\t\treturn this._mapWidth\r\n\t}\r\n\r\n\tget mapLength(): number {\r\n\t\treturn this._mapLength\r\n\t}\r\n\r\n\tget mapHalfLength(): number {\r\n\t\treturn this._mapHalfLength\r\n\t}\r\n\r\n\tget mapEdgeWidth(): number {\r\n\t\treturn this._mapEdgeWidth\r\n\t}\r\n\r\n\tget map(): any[] {\r\n\t\treturn this._world\r\n\t}\r\n\r\n\tget blockGroups(): number[] {\r\n\t\treturn this._blockGroups\r\n\t}\r\n\r\n\tset blockGroups(blockGroups: number[]) {\r\n\t\tthis._blockGroups = blockGroups\r\n\t}\r\n\r\n\tget blockHeight(): number {\r\n\t\treturn this._blockHeight\r\n\t}\r\n\r\n\tget mapMaxHeight(): number {\r\n\t\treturn this._mapMaxHeight\r\n\t}\r\n\r\n\tget startBlockSize(): Dimensions {\r\n\t\treturn { w: this._startBlockWidth, l: this._startBlockLength }\r\n\t}\r\n\r\n\tset blockHeight(height: number) {\r\n\t\tthis._blockHeight = height\r\n\t}\r\n\r\n\tget maxBlockIterations(): number {\r\n\t\treturn this._maximumBlockIterations\r\n\t}\r\n\r\n\tget blockAmountIterator(): number {\r\n\t\treturn this._blockAmountIterator\r\n\t}\r\n\r\n\tset blockAmountIterator(i: number) {\r\n\t\tthis._blockAmountIterator = i\r\n\t}\r\n\r\n\tget averageBuildingSize(): number {\r\n\t\treturn this._averageBuildingSize\r\n\t}\r\n\r\n\tget blockEdges(): object[] {\r\n\t\treturn this._blockEdges\r\n\t}\r\n\r\n\tset blockEdges(blockEdges: object[]) {\r\n\t\tthis._blockEdges = blockEdges\r\n\t}\r\n\r\n\tget blockHeightsArray(): number[] {\r\n\t\treturn this._blockHeightsArray\r\n\t}\r\n\r\n\tset blockHeightsArray(heightsArray: number[]) {\r\n\t\tthis._blockHeightsArray = heightsArray\r\n\t}\r\n\r\n\tget blockIdIterator(): number {\r\n\t\treturn this._blockIdIterator\r\n\t}\r\n\r\n\tset blockIdIterator(i: number) {\r\n\t\tthis._blockIdIterator = i\r\n\t}\r\n\r\n\tget blockHeightVariation(): BuildingHeightVariations {\r\n\t\treturn this._blockHeightVariation\r\n\t}\r\n\r\n\tget lineHeight(): number {\r\n\t\treturn this._decorationLineH\r\n\t}\r\n\r\n\tget groundColor(): Color {\r\n\t\treturn this._groundColor\r\n\t}\r\n\r\n\tget defaultColor(): Color {\r\n\t\treturn this._defaultColor\r\n\t}\r\n\r\n\tget firstLevelColor(): Color {\r\n\t\treturn this._firstLevelColor\r\n\t}\r\n\r\n\tget decorativeColors(): object {\r\n\t\treturn { lineColor: this._lineColor }\r\n\t}\r\n\r\n\tget showWindows(): number {\r\n\t\treturn this._showWindows\r\n\t}\r\n\r\n\tpublic getColumn(x, y): Column {\r\n\t\treturn this._world[y][x]\r\n\t}\r\n\r\n\tpublic getTiles(x, y): Tile[] {\r\n\t\treturn this._world[y][x].tileStack\r\n\t}\r\n\r\n\tpublic getTile(x, y, h): Tile {\r\n\t\treturn this._world[y][x].getTile(h)\r\n\t}\r\n\r\n\tpublic getTopTile(x, y): Tile {\r\n\t\tlet height = this._world[y][x].height\r\n\t\treturn this._world[y][x].getTile(height-1)\r\n\t}\r\n\r\n\tpublic getFirstDefinedColumn(): Column {\r\n\t\tlet column\r\n\r\n\t\tfor (let y = 0; y < this.mapLength; y++) {\r\n\t\t\tfor (let x = 0; x < this.mapWidth; x++) {\r\n\t\t\t\tif (this._world[y][x].isDefined && this._world[y][x].height > 0) {\r\n\t\t\t\t\tcolumn = this._world[y][x]\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn column\r\n\t}\t\r\n\r\n\tsetEdges(considerLowerEdges: boolean): void {\r\n\r\n\t\tfor (let y = 0; y < this.mapLength; y++) {\r\n\t\t\tfor (let x = 0; x < this.mapWidth; x++) {\r\n\t\t\t\t\r\n\t\t\t\tif (y > 0 && x > 0 && y < this.mapLength - 1 && x < this.mapWidth - 1 && this._world[y][x].isDefined) {\r\n\r\n\t\t\t\t\tif (considerLowerEdges) {\r\n\r\n\t\t\t\t\t\tif (this._world[y-1][x].height < this._world[y][x].height || y === 0) {\r\n\t\t\t\t\t\t\tthis._world[y][x].edge.top = true\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (this._world[y+1][x].height < this._world[y][x].height || y === this.mapLength - 1) {\r\n\t\t\t\t\t\t\tthis._world[y][x].edge.bottom = true\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (this._world[y][x-1].height < this._world[y][x].height) {\r\n\t\t\t\t\t\t\tthis._world[y][x].edge.left = true\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (this._world[y][x+1].height < this._world[y][x].height) {\r\n\t\t\t\t\t\t\tthis._world[y][x].edge.right = true\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tif (!this.isPhysicalBlock(y-1, x) || y === 0) {\r\n\t\t\t\t\t\t\tthis._world[y][x].edge.top = true\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (!this.isPhysicalBlock(y+1, x) || y === this.mapLength - 1) {\r\n\t\t\t\t\t\t\tthis._world[y][x].edge.bottom = true\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (!this.isPhysicalBlock(y, x-1)) {\r\n\t\t\t\t\t\t\tthis._world[y][x].edge.left = true\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (!this.isPhysicalBlock(y, x+1)) {\r\n\t\t\t\t\t\t\tthis._world[y][x].edge.right = true\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( (this._world[y][x].edge.top && this._world[y][x].edge.right) ||\r\n\t\t\t\t\t\t (this._world[y][x].edge.top && this._world[y][x].edge.left) ||\r\n\t\t\t\t\t\t (this._world[y][x].edge.bottom && this._world[y][x].edge.right) ||\r\n\t\t\t\t\t\t (this._world[y][x].edge.bottom && this._world[y][x].edge.left) ) {\r\n\t\t\t\t\t\tthis._world[y][x].corner = true\r\n\t\t\t\t\t}\r\n\t\t\t\t}\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getEdges(): Position[] {\r\n\r\n\t\tthis._blockEdges = []\r\n\t\tlet yConditions\t\t\r\n\r\n\t\tfor (let y = 0; y < this._mapLength; y++) {\r\n\t\t\t// only check second half of map\r\n\r\n\t\t\tif (!this._mirrorAtCenter) {\t\r\n\t\t\t\tyConditions = y > 2 && y < this._mapLength - 2\r\n\t\t\t} else {\r\n\t\t\t\tyConditions = y > this._mapHalfLength + (this._blockAmountIterator - 1) && y < this._mapLength - 2\r\n\t\t\t}\r\n\r\n\t\t\tif (yConditions) {\r\n\r\n\t\t\t\tfor (let x = 0; x < this._mapWidth; x++) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (x > this._mapEdgeWidth && x < this._mapWidth - 1) {\r\n\r\n\t\t\t\t\t\tif (this._world[y][x].isDefined) {\r\n\r\n\t\t\t\t\t\t\tif (!this._world[y][x+1].isDefined || \r\n\t\t\t\t\t\t\t\t!this._world[y][x-1].isDefined || \r\n\t\t\t\t\t\t\t\t!this._world[y+1][x].isDefined || \r\n\t\t\t\t\t\t\t\t!this._world[y-1][x+1].isDefined || \r\n\t\t\t\t\t\t\t\t!this._world[y-1][x-1].isDefined) {\r\n\r\n\t\t\t\t\t\t\t\tif (y > this._mapLength - 1) {\r\n\t\t\t\t\t\t\t\t\ty = this._mapLength - 1\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tlet pos: Position = {x: x, y: y}\r\n\r\n\t\t\t\t\t\t\t\tthis._blockEdges.push(pos)\r\n\r\n\t\t\t\t\t\t\t} else if ((!this._world[y-1][x].isDefined && !this._world[y+1][x].isDefined) ||\r\n\t\t\t\t\t\t\t\t(!this._world[y][x-1].isDefined && !this._world[y][x+1].isDefined)) {\r\n\r\n\t\t\t\t\t\t\t\tif (y > this._mapLength - 1) {\r\n\t\t\t\t\t\t\t\t\ty = this._mapLength - 1\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tlet pos: Position = {x: x, y: y}\r\n\r\n\t\t\t\t\t\t\t\tthis._blockEdges.push(pos)\t\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this._blockEdges\r\n\t}\r\n\r\n\tisPhysicalBlock(y: number, x: number): boolean {\r\n\r\n\t\tif (!this._world[y][x].isDefined) {\r\n\t\t\treturn false\r\n\t\t} else if (this._world[y][x].isDefined && this._world[y][x].height === 0) {\r\n\t\t\tconsole.log('this block is undefined', this._world[y][x])\r\n\t\t\treturn false\r\n\t\t}\r\n\r\n\t\tconsole.log('this is a physical block', this._world[y][x])\r\n\r\n\t\treturn true\r\n\t}\r\n\r\n\tgetLeastOpenSpaceOnX(): object {\r\n\t\tlet xMinValues = []\r\n\t\tlet xMaxValues = []\r\n\r\n\t\tfor (let y = 0; y < this.mapLength; y++) {\r\n\t\t\t\r\n\t\t\tlet xMin = 0\r\n\t\t\tlet xMax = 0\r\n\t\t\t\r\n\t\t\tfor (let x = 0; x < this.mapWidth; x++) {\r\n\t\t\t\tif (x < Math.floor(this.mapWidth / 2)) {\r\n\t\t\t\t\tif (!this._world[y][x].isDefined && this._world[y][x].height === 0) {\r\n\t\t\t\t\t\txMin++\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (!this._world[y][x].isDefined && this._world[y][x].height === 0) {\r\n\t\t\t\t\t\txMax++\r\n\t\t\t\t\t}\r\n\t\t\t\t}\t\t\t\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\txMinValues.push(xMin)\r\n\t\t\txMaxValues.push(xMax)\r\n\t\t}\r\n\r\n\t\treturn {'min': Math.min(...xMinValues), 'max': Math.min(...xMaxValues) }\t\t\r\n\t}\r\n\r\n\tpublic addToBuilding(): void {\r\n\t\tthis._world = this.mods.addBuildingComponent(this)\r\n\t\t// this._world = this.mods.mirrorMap(this)\r\n\t\tthis._world = this.mods.clearMapEdges(this)\r\n\t\tthis.setEdges(false)\r\n\t\tconsole.log(this._world)\t\r\n\t}\r\n}","import { Map } from './mapper.component'\r\nimport { Column } from './column.component'\r\nimport { MapGenerationFunctions } from './mapGenerationFunctions.component'\r\nimport { BuildingHeightVariations } from './enums/building-height-variations.enum'\r\nimport { Color } from './colors.component'\r\nimport { Tile } from './tile.component'\r\nimport { TileOptions, TileOptionsFunctions } from './interfaces/tile-options.interface'\r\nimport { TileType } from './enums/tile-type.enum'\r\nimport { Config } from './config.component'\r\nimport { Position } from './interfaces/position.interface'\r\n\r\nexport class Modifiers {\r\n\r\n\tprivate config: Config = new Config()\r\n\tprivate mapGen: MapGenerationFunctions = new MapGenerationFunctions()\r\n\tprivate tileOptionFuncs: TileOptionsFunctions = new TileOptionsFunctions()\r\n\tprivate _lastBlockHollow: boolean = false\r\n\tprivate _lastBlockShortestSide: number\r\n\r\n\tpublic mirrorMap(world: Map): any[][] {\r\n\r\n\t\tlet oldBlockGroups = []\r\n\t\tworld.blockGroups.forEach(id => {\r\n\t\t\toldBlockGroups.push(id)\r\n\t\t})\r\n\r\n\t\tfor (let y = 0; y < world.mapHalfLength; y++) {\r\n\t\t\tif (y < world.mapHalfLength) {\r\n\t\t\t\t\t\t\t\r\n\t\t\t\tfor (let x = 0; x < world.mapWidth; x++) {\r\n\r\n\t\t\t\t\tif (world.map[world.mapLength - y - 1][x].isDefined) {\r\n\r\n\t\t\t\t\t\tlet activeCol = world.map[world.mapLength - y - 1][x]\r\n\t\t\t\t\t\tlet height = activeCol.height\r\n\r\n\t\t\t\t\t\tif (height > 0) {\r\n\t\t\t\t\t\t\tlet blockGroup = oldBlockGroups.length + activeCol.blockGroup\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tlet tileStack = []\r\n\r\n\t\t\t\t\t\t\tfor (let h = 0; h < height; h++) {\r\n\r\n\t\t\t\t\t\t\t\tlet tileColor = activeCol.tileStack[h].tileColor\r\n\r\n\t\t\t\t\t\t\t\tlet thisPillar\r\n\t\t\t\t\t\t\t\tlet slope\r\n\t\t\t\t\t\t\t\tlet thisWindowed\r\n\t\t\t\t\t\t\t\tlet isTower\r\n\t\t\t\t\t\t\t\tlet stairs\r\n\t\t\t\t\t\t\t\tlet isRoof\r\n\t\t\t\t\t\t\t\tlet halfArches\r\n\t\t\t\t\t\t\t\tlet wholeArch\r\n\r\n\t\t\t\t\t\t\t\tif (activeCol.tileStack[h].options) {\r\n\t\t\t\t\t\t\t\t\tthisPillar = activeCol.tileStack[h].options.pillar\r\n\t\t\t\t\t\t\t\t\tslope = activeCol.tileStack[h].options.slope\r\n\t\t\t\t\t\t\t\t\tthisWindowed = activeCol.tileStack[h].options.windowed\r\n\t\t\t\t\t\t\t\t\tisTower = activeCol.tileStack[h].options.tower\r\n\t\t\t\t\t\t\t\t\tstairs = activeCol.tileStack[h].options.stairs\r\n\t\t\t\t\t\t\t\t\tisRoof = (h === height-1) ? true : false\r\n\t\t\t\t\t\t\t\t\thalfArches = activeCol.tileStack[h].options.halfArch\r\n\t\t\t\t\t\t\t\t\twholeArch = activeCol.tileStack[h].options.wholeArch\r\n\r\n\t\t\t\t\t\t\t\t\ttileStack.push(\r\n\t\t\t\t\t\t\t\t\t\tnew Tile(\r\n\t\t\t\t\t\t\t\t\t\t\tworld.blockIdIterator, \r\n\t\t\t\t\t\t\t\t\t\t\tx, \r\n\t\t\t\t\t\t\t\t\t\t\ty, \r\n\t\t\t\t\t\t\t\t\t\t\th, \r\n\t\t\t\t\t\t\t\t\t\t\tactiveCol.tileStack[h].type,\r\n\t\t\t\t\t\t\t\t\t\t\ttileColor,\r\n\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\troof: isRoof,\r\n\t\t\t\t\t\t\t\t\t\t\t\tpillar: thisPillar,\r\n\t\t\t\t\t\t\t\t\t\t\t\tslope: slope,\r\n\t\t\t\t\t\t\t\t\t\t\t\twindowed: thisWindowed,\r\n\t\t\t\t\t\t\t\t\t\t\t\ttower: isTower,\r\n\t\t\t\t\t\t\t\t\t\t\t\tstairs:\tstairs,\r\n\t\t\t\t\t\t\t\t\t\t\t\thalfArch: halfArches,\r\n\t\t\t\t\t\t\t\t\t\t\t\twholeArch: wholeArch,\r\n\t\t\t\t\t\t\t\t\t\t\t\tareaDecoration: ''\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\ttileStack.push(\r\n\t\t\t\t\t\t\t\t\t\tnew Tile(\r\n\t\t\t\t\t\t\t\t\t\t\tworld.blockIdIterator, \r\n\t\t\t\t\t\t\t\t\t\t\tx, \r\n\t\t\t\t\t\t\t\t\t\t\ty, \r\n\t\t\t\t\t\t\t\t\t\t\th, \r\n\t\t\t\t\t\t\t\t\t\t\tactiveCol.tileStack[h].type,\r\n\t\t\t\t\t\t\t\t\t\t\ttileColor,\r\n\t\t\t\t\t\t\t\t\t\t\tthis.tileOptionFuncs.getDefaultTileOptions()\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t\tworld.blockIdIterator++\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tworld.blockHeightsArray.push(height)\r\n\r\n\t\t\t\t\t\t\tif (world.blockGroups.indexOf(blockGroup) === -1) {\r\n\t\t\t\t\t\t\t\tworld.blockGroups.push(blockGroup)\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tworld.map[y][x] = null\r\n\r\n\t\t\t\t\t\t\tlet column = new Column(true, x, y, height)\r\n\r\n\t\t\t\t\t\t\tcolumn.blockGroup = blockGroup\r\n\t\t\t\t\t\t\tcolumn.height = height\r\n\t\t\t\t\t\t\tcolumn.corner = false\r\n\t\t\t\t\t\t\tcolumn.tileStack = tileStack\r\n\r\n\t\t\t\t\t\t\tworld.map[y][x] = column\r\n\t\t\t\t\t\t} else if(height === 0 && activeCol.isDefined) {\r\n\t\t\t\t\t\t\tworld.map[y][x] = activeCol\r\n\t\t\t\t\t\t}\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn world.map\r\n\t}\r\n\t\r\n\tpublic clearMapEdges(world: Map): any[][] {\r\n\r\n\t\tfor (let y = 0; y < world.mapLength; y++) {\r\n\t\t\tfor (let x = 1; x < world.mapWidth; x++) {\r\n\t\t\t\tif (x < world.mapEdgeWidth || x >= world.mapWidth ||\r\n\t\t\t\t\ty < world.mapEdgeWidth || y >= world.mapLength - world.mapEdgeWidth) {\r\n\t\t\t\t\tif (world.map[y][x].isDefined && world.map[y][x].height > 0) {\r\n\t\t\t\t\t\tworld.map[y][x] = null\r\n\t\t\t\t\t\tlet column = new Column(false, x, y, 0)\r\n\t\t\t\t\t\tcolumn.tileStack = []\r\n\t\t\t\t\t\tworld.map[y][x] = column\r\n\t\t\t\t\t}\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn world.map\r\n\t}\r\n\r\n\tpublic addBuildingComponent(world: Map): any[][] {\r\n\r\n\t\tconst defaultColor = world.defaultColor\r\n\r\n\t\tif (world.blockAmountIterator < world.maxBlockIterations + 1) {\r\n\r\n\t\t\tconst newBuildingBlockColor = new Color(defaultColor.changeColorLightingString(-Math.floor(Math.random() * 15)))\r\n\r\n\t\t\tworld.blockEdges = world.getEdges()\r\n\r\n\t\t\tif (world.blockEdges.length > 0) {\t\t\t\r\n\r\n\t\t\t\tlet nextHeight\r\n\t\t\t\tlet openFloor = 0\r\n\t\t\t\tlet showWindows = world.showWindows\r\n\t\t\t\tlet shortestSide\r\n\r\n\t\t\t\tif (world.blockAmountIterator === 1) {\r\n\t\t\t\t\tshortestSide = Math.min(world.startBlockSize.w, world.startBlockSize.l)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tshortestSide = this._lastBlockShortestSide\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (world.blockHeightVariation === BuildingHeightVariations.TallCenter) {\r\n\t\t\t\t\tnextHeight = this.config.fibonacci[ world.maxBlockIterations - world.blockAmountIterator + 1 ]\r\n\t\t\t\t} else if (world.blockHeightVariation === BuildingHeightVariations.TallSurrounds) {\r\n\t\t\t\t\tnextHeight = this.config.fibonacci[world.blockAmountIterator + 1]\r\n\t\t\t\t} else if (world.blockHeightVariation === BuildingHeightVariations.Random) {\r\n\t\t\t\t\tlet randomNum = Math.ceil(Math.random() * 4)\r\n\t\t\t\t\tlet randomAdd = Math.round(Math.random())\r\n\t\t\t\t\tif (randomAdd === 0 && world.blockHeight > 3) {\r\n\t\t\t\t\t\tnextHeight = world.blockHeight - randomNum\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tnextHeight = world.blockHeight + randomNum\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (nextHeight < 2) {\r\n\t\t\t\t\tnextHeight = 1\r\n\t\t\t\t} else if (nextHeight > world.mapMaxHeight) {\r\n\t\t\t\t\tnextHeight = world.mapMaxHeight\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (nextHeight > 5) {\r\n\t\t\t\t\topenFloor = 2 + Math.floor(Math.random() * 3)\r\n\t\t\t\t}\r\n\r\n\t\t\t\t/* determine which side for placement */\r\n\t\t\t\tlet yHigh = this.mapGen.getHighestYfromArray(world.blockEdges)\r\n\t\t\t\tlet xLow = this.mapGen.getLowestXfromArray(world.blockEdges)\r\n\t\t\t\tlet xHigh = this.mapGen.getHighestXfromArray(world.blockEdges)\r\n\t\t\t\t\r\n\t\t\t\tlet yHighEdges = world.blockEdges.filter((edgePoint: Position) => edgePoint.y === yHigh.y)\r\n\t\t\t\tlet xLowEdges = world.blockEdges.filter((edgePoint: Position) => edgePoint.x === xLow.x)\r\n\t\t\t\tlet xHighEdges = world.blockEdges.filter((edgePoint: Position) => edgePoint.x === xHigh.x)\r\n\r\n\t\t\t\tlet sideSelectionForGeneration = Math.floor(Math.random() * 3)\t\r\n\t\t\t\tif (yHigh.y > world.mapLength - 5) {\r\n\t\t\t\t\tsideSelectionForGeneration = Math.floor(Math.random() * 2)\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tlet creationPoint: Position\r\n\t\t\t\tlet nextBlockWidth = shortestSide - world.blockAmountIterator\r\n\t\t\t\tlet nextBlockLength = Math.floor(nextBlockWidth * this.config.goldenRatio)\r\n\t\t\t\tlet yLowEdge, yHighEdge, xLowEdge, xHighEdge\r\n\r\n\t\t\t\t// maybe function to build next block inside last block if too little space?\r\n\r\n\t\t\t\tif (sideSelectionForGeneration === 0) {\r\n\t\t\t\t\t// lowest x point\r\n\t\t\t\t\tlet randomEdgePoint = Math.floor(Math.random() * (xLowEdges.length))\r\n\t\t\t\t\tif (xLowEdges.length > 4) {\r\n\t\t\t\t\t\trandomEdgePoint = 2 + Math.floor(Math.random() * (xLowEdges.length - 2))\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tcreationPoint = xLowEdges[randomEdgePoint]\r\n\r\n\t\t\t\t\tyLowEdge = creationPoint.y - Math.round(nextBlockLength / 2) - 1\r\n\t\t\t\t\tyHighEdge = creationPoint.y + Math.round(nextBlockLength / 2) + 1\r\n\t\t\t\t\txLowEdge = creationPoint.x - nextBlockWidth\r\n\t\t\t\t\txHighEdge = creationPoint.x\r\n\r\n\t\t\t\t} else if (sideSelectionForGeneration === 1) {\r\n\t\t\t\t\t// highest x point\r\n\t\t\t\t\tlet randomEdgePoint = Math.floor(Math.random() * (xHighEdges.length))\r\n\t\t\t\t\tif (xHighEdges.length > 4) {\r\n\t\t\t\t\t\trandomEdgePoint = 2 + Math.floor(Math.random() * (xHighEdges.length - 2))\r\n\t\t\t\t\t}\t\t\t\t\t\r\n\t\t\t\t\tcreationPoint = xHighEdges[randomEdgePoint]\r\n\r\n\t\t\t\t\tyLowEdge = creationPoint.y - Math.round(nextBlockLength / 2) - 1\r\n\t\t\t\t\tyHighEdge = creationPoint.y + Math.round(nextBlockLength / 2) + 1\r\n\t\t\t\t\txLowEdge = creationPoint.x\r\n\t\t\t\t\txHighEdge = creationPoint.x + nextBlockWidth\r\n\r\n\t\t\t\t} else if (sideSelectionForGeneration === 2) {\r\n\t\t\t\t\t// highest y point\r\n\t\t\t\t\tlet randomEdgePoint = Math.floor(Math.random() * yHighEdges.length)\r\n\t\t\t\t\tcreationPoint = yHighEdges[randomEdgePoint]\r\n\r\n\t\t\t\t\tyLowEdge = creationPoint.y\r\n\t\t\t\t\tyHighEdge = creationPoint.y + nextBlockLength\r\n\t\t\t\t\txLowEdge = creationPoint.x - Math.round(nextBlockWidth / 2) + 1\r\n\t\t\t\t\txHighEdge = creationPoint.x + Math.round(nextBlockWidth / 2) - 1\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._lastBlockShortestSide = Math.min(nextBlockWidth, nextBlockLength)\r\n\t\t\t\tlet blockGroup = world.blockGroups.length + 1\r\n\t\t\t\tlet manipulateExistingCols = (Math.round(Math.random()) < 1) ? false : true\t\t\t\t\r\n\t\t\t\tlet yStartOffset = 0\r\n\t\t\t\tlet hollowBuildingBlock = Math.round(Math.random()) === 1 ? true : false\r\n\r\n\t\t\t\tif (creationPoint.y + nextBlockLength > world.mapLength - 1) {\r\n\t\t\t\t\tnextBlockLength = world.mapLength - (creationPoint.y + yStartOffset) - 1\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif (nextBlockWidth > 4 && nextBlockLength > 4) {\r\n\t\t\t\t\tif (!this._lastBlockHollow) {\r\n\t\t\t\t\t\thollowBuildingBlock = Math.round(Math.random() * 8) > 5 ? true : false\r\n\t\t\t\t\t\tthis._lastBlockHollow = true\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\thollowBuildingBlock = false\r\n\t\t\t\t\t\tthis._lastBlockHollow = false\r\n\t\t\t\t\t}\r\n\t\t\t\t\thollowBuildingBlock = true\t\t\t\t\r\n\t\t\t\t} else {\r\n\t\t\t\t\thollowBuildingBlock = false\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet chanceForHigherSpace = Math.round(Math.random() * 8)\r\n\t\t\t\tlet changeForHighCorridor = true // Math.round(Math.random() * 8) > 5 ? true : false\r\n\t\t\t\t\r\n\t\t\t\tlet yEdgeLowActive = false\r\n\t\t\t\tlet yEdgeHighActive = false\r\n\r\n\t\t\t\tlet createTower = (nextHeight < 7 && Math.round(Math.random() * 8) > 5) ? true : false\r\n\t\t\t\tlet towerLocation = 0\r\n\t\t\t\tif (createTower) {\r\n\t\t\t\t\ttowerLocation = Math.round(Math.random() * 2)\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet defaultTileColor = world.getFirstDefinedColumn().tileStack[0].tileColor\t\t\t\t\t\t\t\r\n\r\n\t\t\t\tlet slopeY\r\n\t\t\t\tif (nextHeight < 4) {\r\n\t\t\t\t\tif (Math.round(Math.random() * 5) > 0) {\r\n\t\t\t\t\t\tslopeY = creationPoint.x + Math.ceil(Math.random() * Math.round(nextBlockWidth / 2) - 2)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor (let y = 0; y < world.mapLength; y++) {\t\r\n\r\n\t\t\t\t\tif (yLowEdge === y) {\r\n\t\t\t\t\t\tyEdgeLowActive = true\r\n\t\t\t\t\t} else if (yHighEdge === y) {\r\n\t\t\t\t\t\tyEdgeHighActive = true\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tyEdgeLowActive = false\r\n\t\t\t\t\t\tyEdgeHighActive = false\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet xEdgeLowActive = false\r\n\t\t\t\t\tlet xEdgeHighActive = false\r\n\r\n\t\t\t\t\tfor (let x = 0; x < world.mapWidth; x++) {\r\n\r\n\t\t\t\t\t\tif (x === xLowEdge) {\r\n\t\t\t\t\t\t\txEdgeLowActive = true\r\n\t\t\t\t\t\t} else if (x === xHighEdge) {\r\n\t\t\t\t\t\t\txEdgeHighActive = true\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (y >= yLowEdge && y <= yHighEdge) {\r\n\r\n\t\t\t\t\t\t\tif (x >= xLowEdge && x <= xHighEdge) {\r\n\r\n\t\t\t\t\t\t\t\tlet createCol = true\r\n\r\n\t\t\t\t\t\t\t\tif (hollowBuildingBlock) {\r\n\t\t\t\t\t\t\t\t\tif (y > yLowEdge && y < yHighEdge && x > xLowEdge+1 && x < xHighEdge-1) {\r\n\t\t\t\t\t\t\t\t\t\tcreateCol = false\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tif (createCol) {\r\n\r\n\t\t\t\t\t\t\t\t\tlet buildTowerHere = false\r\n\r\n\t\t\t\t\t\t\t\t\tif (createTower) {\r\n\t\t\t\t\t\t\t\t\t\tif (towerLocation === 0) {\r\n\t\t\t\t\t\t\t\t\t\t\tif (y <= yLowEdge + 1 && x <= xLowEdge + 1) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tbuildTowerHere = true\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t} else if (towerLocation === 1) {\r\n\t\t\t\t\t\t\t\t\t\t\tif (y <= yLowEdge + 1 && x >= xHighEdge - 1) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tbuildTowerHere = true\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t} else if (towerLocation === 2) {\r\n\t\t\t\t\t\t\t\t\t\t\tif (y >= yHighEdge - 1 && x >= xHighEdge - 1) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tif ((world.blockHeightVariation !== BuildingHeightVariations.TallCenter)) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tbuildTowerHere = true\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tlet thisHeight = nextHeight\r\n\t\t\t\t\t\t\t\t\tif (buildTowerHere) {\r\n\t\t\t\t\t\t\t\t\t\tthisHeight = nextHeight + 5\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tlet tileStack = []\r\n\r\n\t\t\t\t\t\t\t\t\tfor (let h = 0; h < thisHeight; h++) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tlet thisPillar = false\r\n\t\t\t\t\t\t\t\t\t\tlet thisWindowed = 0\r\n\t\t\t\t\t\t\t\t\t\tif (showWindows > 0 && h % 2 === 1) {\r\n\t\t\t\t\t\t\t\t\t\t\tthisWindowed = showWindows\r\n\t\t\t\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t\t\t\tlet isRoof = (h === thisHeight-1) ? true : false\r\n\t\t\t\t\t\t\t\t\t\tlet slope = false\r\n\t\t\t\t\t\t\t\t\t\tif (h < nextHeight) {\r\n\t\t\t\t\t\t\t\t\t\t\tif (y === slopeY && x === creationPoint.x + Math.round(nextBlockWidth / 2) - h) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tslope = true\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t\t\t\tlet tileColor = newBuildingBlockColor\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tlet tileType = TileType.Body\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tlet isTower = false\r\n\t\t\t\t\t\t\t\t\t\tif (buildTowerHere) {\r\n\t\t\t\t\t\t\t\t\t\t\tisTower = true\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tlet stairs = false\r\n\t\t\t\t\t\t\t\t\t\tlet thisHalfArch = false\r\n\t\t\t\t\t\t\t\t\t\tlet thisWholeArch = false\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (thisHeight > 4 && !slope && !isTower) {\r\n\t\t\t\t\t\t\t\t\t\t\tif (changeForHighCorridor) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (nextBlockLength > 4 && nextBlockLength < 6) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tlet maxWallPoint = creationPoint.y + 5\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (creationPoint.y + 5 > creationPoint.y + (nextBlockLength / 2)) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tmaxWallPoint = creationPoint.y + 4\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (y > creationPoint.y + 1 && y < maxWallPoint) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (h < thisHeight - 2) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttileType = TileType.None\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (creationPoint.y + 5 > 27) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (y % 2 === 0 && x % 2 !== 0) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthisPillar = true\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (h === thisHeight - 3) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthisHalfArch = true\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t} \r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (nextBlockLength === 6) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (y === yLowEdge + 1 || \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ty === yLowEdge + 2 ||\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ty === yHighEdge - 2 ||\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ty === yHighEdge - 3) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (h < thisHeight - 2) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttileType = TileType.None\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (h === thisHeight - 3) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthisHalfArch = true\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (nextBlockLength === 8) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (y === yLowEdge + 1 || \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ty === yLowEdge + 2 ||\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ty === yLowEdge + 4 ||\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ty === yLowEdge + 5) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (h < thisHeight - 2) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttileType = TileType.None\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (h === thisHeight - 3) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthisHalfArch = true\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t} else if (y === yLowEdge + 3 || y === yLowEdge + 6) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttileType = TileType.Body\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthisHalfArch = false\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (nextBlockWidth === 6) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (x === xLowEdge + 1 || \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tx === xLowEdge + 2 ||\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tx === xHighEdge - 2 ||\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tx === xHighEdge - 3) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (h < thisHeight - 2) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttileType = TileType.None\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (h === thisHeight - 3) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthisHalfArch = true\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (nextBlockWidth === 8) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (x === xLowEdge + 1 || \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tx === xLowEdge + 2 ||\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tx === xLowEdge + 4 ||\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tx === xLowEdge + 5) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (h < thisHeight - 2) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttileType = TileType.None\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (h === thisHeight - 3) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthisHalfArch = true\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t} else if (x === xLowEdge + 3 || x === xLowEdge + 6) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttileType = TileType.Body\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthisHalfArch = false\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (chanceForHigherSpace > 4) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (openFloor > 0 && (h === openFloor || h+1 === openFloor)) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttileType = TileType.None\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (y % 2 === 0 && x % 2 !== 0) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthisPillar = true\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (thisHeight > 7 && openFloor > 0 && h > openFloor && h < openFloor + 4) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttileType = TileType.None\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (y % 2 === 0 && x % 2 !== 0) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthisPillar = true\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (h === world.lineHeight) {\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\ttileColor = world.decorativeColors['lineColor']\r\n\t\t\t\t\t\t\t\t\t\t} else if (h === 0) {\r\n\t\t\t\t\t\t\t\t\t\t\ttileColor = world.firstLevelColor\r\n\t\t\t\t\t\t\t\t\t\t} else if (h === thisHeight - 1) {\r\n\t\t\t\t\t\t\t\t\t\t\tif (nextBlockLength > 5) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (y % 2 === 0) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttileColor = new Color(newBuildingBlockColor.getColorStringByHue(-10))\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t} else if (nextBlockWidth > 6) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (x % 2 === 0) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttileColor = new Color(newBuildingBlockColor.getColorStringByHue(-10))\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\ttileColor = newBuildingBlockColor\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (world.map[y][x].isDefined) {\r\n\t\t\t\t\t\t\t\t\t\t\tif (world.map[y][x].tileStack[0].type === TileType.Grass) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (h === 0 && tileType === TileType.None) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttileType = TileType.Grass\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttileColor = world.map[y][x].tileStack[0].tileColor\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t\t\t\ttileStack.push(\r\n\t\t\t\t\t\t\t\t\t\t\tnew Tile(\r\n\t\t\t\t\t\t\t\t\t\t\t\tworld.blockIdIterator, \r\n\t\t\t\t\t\t\t\t\t\t\t\tx, \r\n\t\t\t\t\t\t\t\t\t\t\t\ty, \r\n\t\t\t\t\t\t\t\t\t\t\t\th, \r\n\t\t\t\t\t\t\t\t\t\t\t\ttileType,\r\n\t\t\t\t\t\t\t\t\t\t\t\ttileColor,\r\n\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\troof: isRoof,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tpillar: thisPillar,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tslope: slope,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twindowed: thisWindowed,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttower: isTower,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstairs:\tstairs,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\thalfArch: thisHalfArch,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twholeArch: thisWholeArch,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tareaDecoration: ''\r\n\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t)\t\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t\t\t\tworld.blockHeightsArray.push(thisHeight)\r\n\r\n\t\t\t\t\t\t\t\t\t\tworld.blockIdIterator++\r\n\r\n\t\t\t\t\t\t\t\t\t\ttileColor = undefined\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tif (world.blockGroups.indexOf(blockGroup) === -1) {\r\n\t\t\t\t\t\t\t\t\t\tworld.blockGroups.push(blockGroup)\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tworld.map[y][x] = null\r\n\r\n\t\t\t\t\t\t\t\t\tlet column = new Column(true, x, y, thisHeight)\r\n\r\n\t\t\t\t\t\t\t\t\tcolumn.blockGroup = blockGroup\r\n\t\t\t\t\t\t\t\t\tcolumn.height = thisHeight\r\n\t\t\t\t\t\t\t\t\tcolumn.corner = false\r\n\t\t\t\t\t\t\t\t\tcolumn.tileStack = tileStack\r\n\r\n\t\t\t\t\t\t\t\t\tworld.map[y][x] = column\t\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tworld.blockHeight = nextHeight\r\n\t\t\t\tworld.blockAmountIterator++\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif (this.config.allowDebug) {\r\n\t\t\t\t\tconsole.warn(\"Block edges array is empty.\")\r\n\t\t\t\t}\t\t\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\t\t\tif (this.config.allowDebug) {\r\n\t\t\t\tconsole.warn(\"Cannot add more building components, maximum block iterations reached.\")\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn world.map\r\n\t}\r\n\r\n\tpublic removeExcessArches(world: Map) {\r\n\r\n\t\tfor (let y = 0; y < world.mapLength; y++) {\r\n\r\n\t\t\tfor (let x = 0; x < world.mapWidth; x++) {\r\n\r\n\t\t\t\tif (y > 0 && x > 0 && y < world.mapLength - 2 && x < world.mapWidth - 2) {\r\n\r\n\t\t\t\t\tif (world.map[y][x].isDefined) {\r\n\r\n\t\t\t\t\t\tfor (let h = 0; h < world.map[y][x].height; h++) {\r\n\r\n\t\t\t\t\t\t\tif (world.map[y][x].tileStack[h].type === TileType.None && world.map[y][x].tileStack[h].options.halfArch) {\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tif (world.map[y - 1][x].isDefined && world.map[y - 1][x].height > 0 && world.map[y - 1][x].height === world.map[y][x].height) {\r\n\r\n\t\t\t\t\t\t\t\t\tif (world.map[y - 1][x].tileStack[h].options.halfArch) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (world.map[y + 1][x].isDefined && world.map[y + 1][x].height > 0 && world.map[y + 1][x].height === world.map[y][x].height) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tif (world.map[y + 1][x].tileStack[h].options.halfArch) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tworld.map[y][x].tileStack[h].options.halfArch = false;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (world.map[y + 2][x].isDefined && world.map[y + 2][x].height > 0 && world.map[y + 2][x].height === world.map[y][x].height) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tif (world.map[y + 2][x].tileStack[h].options.halfArch) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tworld.map[y + 1][x].tileStack[h].options.halfArch = false;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tif (x > 1 && x < world.mapWidth - 3) {\r\n\r\n\t\t\t\t\t\t\t\t\tif (world.map[y][x - 1].isDefined && world.map[y][x - 1].height === world.map[y][x].height) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (world.map[y][x - 1].tileStack[h].options.halfArch) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tif (world.map[y][x + 1].isDefined && world.map[y][x + 1].height === world.map[y][x].height) {\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (world.map[y][x + 1].tileStack[h].options.halfArch) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tworld.map[y][x].tileStack[h].options.halfArch = false;\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tif (world.map[y][x + 2].isDefined && \r\n\t\t\t\t\t\t\t\t\t\t\t\tworld.map[y][x + 1].height === world.map[y][x].height && \r\n\t\t\t\t\t\t\t\t\t\t\t\tworld.map[y][x + 2].height === world.map[y][x].height) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (world.map[y][x + 2].tileStack[h].options.halfArch) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tworld.map[y][x + 1].tileStack[h].options.halfArch = false;\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\t\t\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn world.map;\r\n\r\n\t}\r\n\r\n\tpublic resetGrassTilesBelowPillars (world: Map) {\r\n\r\n\t\tfor (let y = 0; y < world.mapLength; y++) {\r\n\t\t\tfor (let x = 0; x < world.mapWidth; x++) {\r\n\r\n\t\t\t\tif (y > 0 && x > 0 && y < world.mapLength - 1 && x < world.mapWidth - 1) {\r\n\r\n\t\t\t\t\tif (world.map[y][x].isDefined && world.map[y][x].height > 0 && world.map[y][x].tileStack[0].type === TileType.None) {\r\n\r\n\t\t\t\t\t\tif ((world.map[y - 1][x].isDefined && world.map[y - 1][x].tileStack[0].type === TileType.Grass) ||\r\n\t\t\t\t\t\t\t(world.map[y + 1][x].isDefined && world.map[y + 1][x].tileStack[0].type === TileType.Grass) ||\r\n\t\t\t\t\t\t\t(world.map[y][x - 1].isDefined && world.map[y][x - 1].tileStack[0].type === TileType.Grass) ||\r\n\t\t\t\t\t\t\t(world.map[y][x + 1].isDefined && world.map[y][x + 1].tileStack[0].type === TileType.Grass)) {\r\n\r\n\t\t\t\t\t\t\tconsole.log('should be grass tile!')\r\n\t\t\t\t\t\t\tworld.map[y][x].tileStack[0].type = TileType.Grass\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn world.map\r\n\t}\r\n\r\n\tpublic refactorLargeWalls (world: Map) {\r\n\r\n\t\tconst walls = {}\r\n\t\tconst minWidth = 4\r\n\t\tconst minHeight = 5\r\n\r\n\t\tfor (let y = 0; y < world.mapLength; y++) {\r\n\t\t\tfor (let x = 0; x < world.mapWidth; x++) {\r\n\r\n\t\t\t\tif (y > 1 && y < world.mapLength - 1) {\r\n\r\n\t\t\t\t\tif (world.map[y][x].height > 0 && world.map[y][x].edge.top && world.map[y][x].edge.bottom) {\r\n\r\n\t\t\t\t\t\tif (y in walls) {\r\n\t\t\t\t\t\t\twalls[`${y}`].row.push(x)\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\twalls[`${y}`] = { y, height: world.map[y][x].height, row: [x]}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (Object.keys(walls).length) {\r\n\t\t\tObject.keys(walls).forEach(key => {\r\n\t\t\t\tif (walls[key].height > minHeight && walls[key].row.length > minWidth) {\r\n\t\t\t\t\tconst y = walls[key].y\r\n\t\t\t\t\tconst cols = walls[key].row.slice(1, walls[key].row.length - 1)\r\n\r\n\t\t\t\t\tcols.forEach(x => {\r\n\t\t\t\t\t\tfor (let h = 0; h < walls[key].height; h++) {\r\n\t\t\t\t\t\t\tif (h > walls[key].height - (minHeight + 2) && h < walls[key].height - 2) {\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t\tif (world.map[y][x].height > h) {\r\n\t\t\t\t\t\t\t\t\t\tworld.map[y][x].tileStack[h].type = TileType.None\r\n\t\t\t\t\t\t\t\t\t\tworld.map[y][x].tileStack[h].options.pillar = false\t\r\n\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t\t\tif (world.map[y][x].tileStack[walls[key].height - (minHeight + 2)-1].type === TileType.None) {\r\n\t\t\t\t\t\t\t\t\t\tworld.map[y][x].tileStack[walls[key].height - (minHeight + 2)-1].pillar = false\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t} catch (error) {\r\n\t\t\t\t\t\t\t\t\tconsole.error(error)\r\n\t\t\t\t\t\t\t\t\tconsole.error('tiles undefined', world.map[y][x])\r\n\t\t\t\t\t\t\t\t\tconsole.error('height = ' + h + ' / ' + walls[key].height)\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\t\t\t\t\t\t\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t\tconsole.log('wall changed:', walls[key])\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t\t\r\n\t\treturn world.map\r\n\t}\r\n}","export class Primitives {\r\n\r\n\tgetPyramid(mapWidth: number, mapLength: number): number[][] {\r\n\r\n\t\tlet map = [],\r\n\t\t\twidth = Math.min(mapWidth, mapLength),\r\n\t\t\theight = Math.min(mapWidth, mapLength),\r\n\t\t\twidthHalf = Math.floor(width / 2),\r\n\t\t\theightHalf = Math.floor(height / 2),\r\n\t\t\tquarter = [];\r\n\r\n\t\tfor (let y = 0; y < width; y++) {\r\n\t\t\tmap[y] = []\r\n\t\t\tfor (let x = 0; x < height; x++) {\r\n\t\t\t\tif (y < Math.round(height / 2) && x < Math.round(width / 2)) {  \r\n\t\t\t\t\tmap[y][x] = Math.min(y, x)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmap[y][x] = Math.max(y, x)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfor (let y = 0; y < widthHalf; y++) {\r\n\t\t\tquarter[y] = []\r\n\t\t\tfor (let x = 0; x < heightHalf; x++) {\r\n\t\t\t\tif (y < heightHalf && x < widthHalf) { \r\n\t\t\t\t\tquarter[y][x] = map[y][x]\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet quarterRev = quarter.reverse()\r\n\r\n\t\tfor (let y = 0; y < width; y++) {\r\n\t\t\tfor (let x = 0; x < height; x++) {\r\n\t\t\t  \tif (y > heightHalf - 1 && x < widthHalf) {\r\n\t\t\t    \tmap[y][x] = quarterRev[y - heightHalf][x]\r\n\t\t\t    }\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfor (let y = 0; y < width; y++) {\r\n\t\t\tfor (let x = 0; x < height; x++) {\r\n\t\t\t  \tif (x > widthHalf - 1) {\r\n\t\t\t    \tmap[y][x] = map[y][width - x - 1]\r\n\t\t\t    }\r\n\t\t  \t}\r\n\t\t}\r\n\r\n\t\treturn map\r\n\t}\r\n}","import { Config } from './config.component'\r\nimport { MapGenerationFunctions } from './mapGenerationFunctions.component'\r\nimport { Color } from './colors.component'\r\nimport { Tile } from './tile.component'\r\nimport { TileType } from './enums/tile-type.enum'\r\nimport { Coords } from './interfaces/coords.interface'\r\nimport { TileTemplate } from './interfaces/tiletemplate.interface'\r\nimport { Position } from './interfaces/position.interface'\r\nimport { Column } from './column.component'\r\nimport { ColumnEdge } from './interfaces/column-edge.interface'\r\n\r\nexport class RenderElements {\r\n\r\n\tprivate config: Config = new Config()\r\n\tprivate calculations: MapGenerationFunctions = new MapGenerationFunctions()\r\n\r\n\tprivate tileW: number = this.config.tileWidth\r\n\tprivate tileL: number = this.config.tileLength\r\n\tprivate tileH: number = this.config.tileHeight\r\n\tprivate bleed: number = this.config.tileEdgeBleed\r\n\tprivate _maxDarken: number = this.config.maxDarkenValue\r\n\tprivate _maxLighten: number = this.config.maxLightenValue\r\n\tprivate dimensions = this.calculations.calculateStraightLinesFromIsometricSquare(this.tileW, this.tileL)\r\n\r\n\tprivate tileColor: Color = this.config.groundColor\r\n\r\n\tgetPositions(xPos: number, yPos: number, topMargin: number = 0) {\t\t\r\n\t\tconst top: Position = { \"x\": xPos + this.dimensions.horizontalWidthFromTop, \"y\": yPos + topMargin }\r\n\t\tconst left: Position = { \"x\": xPos, \"y\": yPos + this.dimensions.verticalHeightFromTop + topMargin }\r\n\t\tconst bottom: Position = { \"x\": xPos + this.dimensions.horizontalWidthFromBottom, \"y\": yPos + this.dimensions.totalHeight + topMargin }\r\n\t\tconst right: Position = { \"x\": xPos + this.dimensions.totalWidth, \"y\": yPos + this.dimensions.verticalHeightFromBottom + topMargin }\r\n\r\n\t\treturn { top, left, bottom, right }\r\n\t}\r\n\r\n\tcreateTile(xPos: number, yPos: number, shadow: string): TileTemplate {\r\n\r\n\t\tconst { top, left, bottom, right } = this.getPositions(xPos, yPos, 0)\r\n\r\n\t\tlet pointTop = `${top.x} ${top.y-this.bleed}`\r\n\t\tlet pointLeft = `${left.x-this.bleed} ${left.y}`\r\n\t\tlet pointBottom = `${bottom.x} ${bottom.y+this.bleed}`\r\n\t\tlet pointRight = `${right.x+this.bleed} ${right.y}`\r\n\r\n\t\tlet tileColor = this.tileColor.hex()\r\n\t\tif (shadow === 'shade') {\r\n\t\t\ttileColor = this.tileColor.changeColorLightingString(-50)\r\n\t\t}\r\n\r\n\t\tvar html = `<path fill=\"${tileColor}\"\r\n\t\t\t\t\td=\"M${pointLeft} \r\n\t\t\t\t\tL${pointBottom} \r\n\t\t\t\t\tL${pointRight} \r\n\t\t\t\t\tL${pointTop} \r\n\t\t\t\t\tL${pointLeft} Z\" />`\r\n\r\n\t\tlet coords: Coords = { \"top\": top, \"left\": left, \"bottom\": bottom, \"right\": right }\r\n\r\n\t\treturn { html: html, coords: coords }\r\n\t}\r\n\r\n\tcreatePlane(xPos: number, yPos: number, tile: Tile, color: Color = this.config.groundColor): TileTemplate {\r\n\r\n\t\tconst id = tile.id\r\n\t\tconst height = (tile.h * this.tileH) - this.tileH\r\n\r\n\t\tlet regularColor = color.hex()\r\n\r\n\t\tconst { top, left, bottom, right } = this.getPositions(xPos, yPos, this.config.topMargin)\r\n\r\n\t\tlet blockTopLeft = `${left.x-this.bleed} ${left.y}`\r\n\t\tlet blockTopBottom = `${bottom.x} ${bottom.y}`\r\n\t\tlet blockTopRight = `${right.x+this.bleed} ${right.y}`\r\n\t\tlet blockTopTop = `${top.x} ${top.y}`\r\n\r\n\t\tlet html = `<g style=\"z-index:${id};\">\r\n\t\t\t\t\t<path fill=\"${regularColor}\"\r\n\t\t\t\t\td=\"M${blockTopLeft} \r\n\t\t\t\t\tL${blockTopBottom} \r\n\t\t\t\t\tL${blockTopRight} \r\n\t\t\t\t\tL${blockTopTop} \r\n\t\t\t\t\tL${blockTopLeft} Z\" /></g>`\r\n\r\n\t\tlet coords: Coords = { \"top\": top, \"left\": left, \"bottom\": bottom, \"right\": right }\r\n\r\n\t\treturn { html: html, coords: coords }\r\n\t}\r\n\r\n\tcreateBlock(xPos: number, yPos: number, tile: Tile, topTile: boolean | string = false): TileTemplate {\r\n\r\n\t\tconst id = tile.id\r\n\t\tconst height = (tile.h * this.tileH) - this.tileH\r\n\r\n\t\tlet regularColor\r\n\t\tlet highlight\r\n\t\tlet darkestColor\r\n\t\tlet patternColor\r\n\r\n\t\tif (tile.tileColor.hex() !== this.config.buildingBaseColor.hex()) {\r\n\t\t\tregularColor = tile.tileColor.hex()\r\n\t\t\thighlight = tile.tileColor.changeColorLightingString(this._maxLighten)\r\n\t\t\tdarkestColor = tile.tileColor.changeColorLightingString(this._maxDarken)\r\n\t\t\tpatternColor = tile.tileColor.changeColorLightingString(15)\r\n\t\t} else {\r\n\t\t\tregularColor = this.config.buildingBaseColor.hex()\r\n\t\t\thighlight = this.config.buildingBaseColor.changeColorLightingString(this._maxLighten)\r\n\t\t\tdarkestColor = this.config.buildingBaseColor.changeColorLightingString(this._maxDarken)\r\n\t\t\tpatternColor = this.config.buildingBaseColor.changeColorLightingString(15)\r\n\t\t}\r\n\r\n\t\tconst { top, left, bottom, right } = this.getPositions(xPos, yPos, this.config.topMargin)\r\n\r\n\t\tconst leftWallLeftTop = `${left.x-this.bleed} ${left.y-height-this.tileH}`\r\n\t\tconst leftWallLeftBottom = `${left.x-this.bleed} ${left.y-height+this.bleed}`\r\n\t\tconst leftWallRightBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\tconst leftWallRightTop = `${bottom.x} ${bottom.y-height-this.tileH}`\r\n\r\n\t\tconst rightWallLeftTop = `${bottom.x} ${bottom.y-height-this.tileH}`\r\n\t\tconst rightWallLeftBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\tconst rightWallRightBottom = `${right.x+this.bleed} ${right.y-height+this.bleed}`\r\n\t\tconst rightWallRightTop = `${right.x+this.bleed} ${right.y-height-this.tileH}`\r\n\r\n\t\tconst blockTopLeft = `${left.x-this.bleed} ${left.y-height-this.tileH}`\r\n\t\tconst blockTopBottom = `${bottom.x} ${bottom.y-height-this.tileH}`\r\n\t\tconst blockTopRight = `${right.x+this.bleed} ${right.y-height-this.tileH}`\r\n\t\tconst blockTopTop = `${top.x} ${top.y-height-this.tileH}`\r\n\r\n\t\tlet html = `<g style=\"z-index:${id};\">\r\n\t\t\t\t\t<path fill=\"${darkestColor}\"\r\n\t\t\t\t\td=\"M${leftWallLeftTop} \r\n\t\t\t\t\tL${leftWallLeftBottom} \r\n\t\t\t\t\tL${leftWallRightBottom} \r\n\t\t\t\t\tL${leftWallRightTop} \r\n\t\t\t\t\tL${leftWallLeftTop} Z\" />\r\n\t\t\t\t\t<path fill=\"${regularColor}\"\r\n\t\t\t\t\td=\"M${rightWallLeftTop} \r\n\t\t\t\t\tL${rightWallLeftBottom} \r\n\t\t\t\t\tL${rightWallRightBottom} \r\n\t\t\t\t\tL${rightWallRightTop} \r\n\t\t\t\t\tL${rightWallLeftTop} Z\" />`\r\n\r\n\t\tif (topTile === 'triangles') {\r\n\r\n\t\t\tconst margin = 2;\r\n\r\n\t\t\tconst blockTopTileLeft = `${left.x-this.bleed+margin} ${left.y-height-this.tileH}`\r\n\t\t\tconst blockTopTileBottom = `${bottom.x} ${bottom.y-height-this.tileH-(margin/2)}`\r\n\t\t\tconst blockTopTileRight = `${right.x+this.bleed-margin} ${right.y-height-this.tileH}`\r\n\t\t\tconst blockTopTileTop = `${top.x} ${top.y-height-this.tileH+(margin/1.5)}`\r\n\r\n\t\t\tconst blockTopCenter = { x: left.x + ((right.x - left.x) / 2), y: (top.y + ((bottom.y - top.y) / 2)) }\r\n\r\n\t\t\tconst blockTopCenterLeftMargin = `${blockTopCenter.x - (margin /2)} ${blockTopCenter.y}`\r\n\t\t\tconst blockTopCenterBottomMargin = `${blockTopCenter.x} ${blockTopCenter.y + (margin /2)}`\r\n\t\t\tconst blockTopCenterRightMargin = `${blockTopCenter.x + (margin /2)} ${blockTopCenter.y}`\r\n\t\t\tconst blockTopCenterTopMargin = `${blockTopCenter.x} ${blockTopCenter.y - (margin /2)}`\r\n\r\n\t\t\tconst blockTopLeftTopCenter = `${left.x + ((top.x - left.x) / 2)} ${top.y + ((left.y - top.y) / 2) - height - this.tileH}`\r\n\t\t\tconst blockTopLeftBottomCenter = `${left.x + ((bottom.x - left.x) / 2)} ${bottom.y - ((bottom.y - left.y) / 2) - height - this.tileH}`\r\n\t\t\tconst blockTopRightBottomCenter = `${right.x - ((right.x - bottom.x) / 2)} ${bottom.y - ((right.y - top.y) / 2) - height - this.tileH}`\r\n\t\t\tconst blockTopRightTopCenter = `${right.x - ((right.x - top.x) / 2)} ${right.y + ((bottom.y - right.y) / 2) - height - this.tileH}`\r\n\r\n\t\t\thtml += `<path fill=\"${highlight}\"\r\n\t\t\t\t\td=\"M${blockTopLeft} \r\n\t\t\t\t\tL${blockTopBottom} \r\n\t\t\t\t\tL${blockTopRight} \r\n\t\t\t\t\tL${blockTopTop} \r\n\t\t\t\t\tL${blockTopLeft} Z\" />\r\n\t\t\t\t\t<path fill=\"transparent\" stroke=\"${patternColor}\" stroke-linecap=\"round\"\r\n\t\t\t\t\td=\"M${blockTopLeft} \r\n\t\t\t\t\tL${blockTopBottom} \r\n\t\t\t\t\tL${blockTopRight} \r\n\t\t\t\t\tL${blockTopTop} \r\n\t\t\t\t\tL${blockTopLeft} Z\" />\r\n\t\t\t\t\t<path fill=\"transparent\" stroke=\"${patternColor}\" stroke-linecap=\"round\"\r\n\t\t\t\t\td=\"M${blockTopLeft} \r\n\t\t\t\t\tL${blockTopRight}\" />\r\n\t\t\t\t\t<path fill=\"transparent\" stroke=\"${patternColor}\" stroke-linecap=\"round\"\r\n\t\t\t\t\td=\"M${blockTopTop} \r\n\t\t\t\t\tL${blockTopBottom}\" />`\r\n\r\n\t\t} else if (topTile === 'circles') {\r\n\r\n\t\t\tconst margin = 2;\r\n\r\n\t\t\tconst blockTopTileLeft = `${left.x-this.bleed+margin} ${left.y-height-this.tileH}`\r\n\t\t\tconst blockTopTileBottom = `${bottom.x} ${bottom.y-height-this.tileH-(margin/2)}`\r\n\t\t\tconst blockTopTileRight = `${right.x+this.bleed-margin} ${right.y-height-this.tileH}`\r\n\t\t\tconst blockTopTileTop = `${top.x} ${top.y-height-this.tileH+(margin/1.5)}`\r\n\r\n\t\t\tconst blockTopCenter = { x: left.x + ((right.x - left.x) / 2), y: (top.y + ((bottom.y - top.y) / 2))-height-this.tileH }\r\n\r\n\t\t\tconst blockTopCenterLeftMargin = `${blockTopCenter.x - (margin /2)} ${blockTopCenter.y}`\r\n\t\t\tconst blockTopCenterBottomMargin = `${blockTopCenter.x} ${blockTopCenter.y + (margin /2)}`\r\n\t\t\tconst blockTopCenterRightMargin = `${blockTopCenter.x + (margin /2)} ${blockTopCenter.y}`\r\n\t\t\tconst blockTopCenterTopMargin = `${blockTopCenter.x} ${blockTopCenter.y - (margin /2)}`\r\n\r\n\t\t\tconst blockTopLeftTopCenter = `${left.x + ((top.x - left.x) / 2)} ${top.y + ((left.y - top.y) / 2) - height - this.tileH}`\r\n\t\t\tconst blockTopLeftBottomCenter = `${left.x + ((bottom.x - left.x) / 2)} ${bottom.y - ((bottom.y - left.y) / 2) - height - this.tileH}`\r\n\t\t\tconst blockTopRightBottomCenter = `${right.x - ((right.x - bottom.x) / 2)} ${bottom.y - ((right.y - top.y) / 2) - height - this.tileH}`\r\n\t\t\tconst blockTopRightTopCenter = `${right.x - ((right.x - top.x) / 2)} ${right.y + ((bottom.y - right.y) / 2) - height - this.tileH}`\r\n\r\n\t\t\tconst circleRadiusY = (bottom.y - top.y) / 4\r\n\t\t\tconst circleRadiusX = (bottom.y - top.y) / 3\r\n\r\n\t\t\thtml += `<path fill=\"${highlight}\"\r\n\t\t\t\t\td=\"M${blockTopLeft} \r\n\t\t\t\t\tL${blockTopBottom} \r\n\t\t\t\t\tL${blockTopRight} \r\n\t\t\t\t\tL${blockTopTop} \r\n\t\t\t\t\tL${blockTopLeft} Z\" />\r\n\t\t\t\t\t<path fill=\"transparent\" stroke=\"${patternColor}\" stroke-linecap=\"round\"\r\n\t\t\t\t\td=\"M${blockTopLeft} \r\n\t\t\t\t\tL${blockTopBottom} \r\n\t\t\t\t\tL${blockTopRight} \r\n\t\t\t\t\tL${blockTopTop} \r\n\t\t\t\t\tL${blockTopLeft} Z\" />\r\n\t\t\t\t\t<path fill=\"transparent\" stroke=\"${patternColor}\" stroke-linecap=\"round\"\r\n\t\t\t\t\td=\"M${blockTopLeft} \r\n\t\t\t\t\tL${blockTopRight}\" />\r\n\t\t\t\t\t<path fill=\"transparent\" stroke=\"${patternColor}\" stroke-linecap=\"round\"\r\n\t\t\t\t\td=\"M${blockTopTop} \r\n\t\t\t\t\tL${blockTopBottom}\" />\r\n\t\t\t\t\t<ellipse cx=\"${blockTopCenter.x}\" cy=\"${blockTopCenter.y}\" rx=\"${circleRadiusX}\" ry=\"${circleRadiusY}\" fill=\"transparent\" stroke=\"${patternColor}\" stroke-linecap=\"round\" />`\r\n\r\n\t\t} else if (topTile === 'squares') {\r\n\r\n\t\t\tconst margin = 2;\r\n\r\n\t\t\tconst blockTopTileLeft = `${left.x-this.bleed+margin} ${left.y-height-this.tileH}`\r\n\t\t\tconst blockTopTileBottom = `${bottom.x} ${bottom.y-height-this.tileH-(margin/2)}`\r\n\t\t\tconst blockTopTileRight = `${right.x+this.bleed-margin} ${right.y-height-this.tileH}`\r\n\t\t\tconst blockTopTileTop = `${top.x} ${top.y-height-this.tileH+(margin/1.5)}`\r\n\r\n\t\t\tconst blockTopCenter = { x: left.x + ((right.x - left.x) / 2), y: (top.y + ((bottom.y - top.y) / 2)) }\r\n\r\n\t\t\tconst blockTopCenterLeftMargin = `${blockTopCenter.x - (margin /2)} ${blockTopCenter.y}`\r\n\t\t\tconst blockTopCenterBottomMargin = `${blockTopCenter.x} ${blockTopCenter.y + (margin /2)}`\r\n\t\t\tconst blockTopCenterRightMargin = `${blockTopCenter.x + (margin /2)} ${blockTopCenter.y}`\r\n\t\t\tconst blockTopCenterTopMargin = `${blockTopCenter.x} ${blockTopCenter.y - (margin /2)}`\r\n\r\n\t\t\tconst blockTopLeftTopCenter = `${left.x + ((top.x - left.x) / 2)} ${top.y + ((left.y - top.y) / 2) - height - this.tileH}`\r\n\t\t\tconst blockTopLeftBottomCenter = `${left.x + ((bottom.x - left.x) / 2)} ${bottom.y - ((bottom.y - left.y) / 2) - height - this.tileH}`\r\n\t\t\tconst blockTopRightBottomCenter = `${right.x - ((right.x - bottom.x) / 2)} ${bottom.y - ((right.y - top.y) / 2) - height - this.tileH}`\r\n\t\t\tconst blockTopRightTopCenter = `${right.x - ((right.x - top.x) / 2)} ${right.y + ((bottom.y - right.y) / 2) - height - this.tileH}`\r\n\r\n\t\t\thtml += `<path fill=\"${highlight}\"\r\n\t\t\t\t\td=\"M${blockTopLeft} \r\n\t\t\t\t\tL${blockTopBottom} \r\n\t\t\t\t\tL${blockTopRight} \r\n\t\t\t\t\tL${blockTopTop} \r\n\t\t\t\t\tL${blockTopLeft} Z\" />\r\n\t\t\t\t\t<path fill=\"transparent\" stroke=\"${patternColor}\" stroke-linecap=\"round\"\r\n\t\t\t\t\td=\"M${blockTopLeft} \r\n\t\t\t\t\tL${blockTopBottom} \r\n\t\t\t\t\tL${blockTopRight} \r\n\t\t\t\t\tL${blockTopTop} \r\n\t\t\t\t\tL${blockTopLeft} Z\" />`\r\n\t\t} else {\r\n\r\n\t\t\thtml += `<path fill=\"${highlight}\"\r\n\t\t\t\t\td=\"M${blockTopLeft} \r\n\t\t\t\t\tL${blockTopBottom} \r\n\t\t\t\t\tL${blockTopRight} \r\n\t\t\t\t\tL${blockTopTop} \r\n\t\t\t\t\tL${blockTopLeft} Z\" />`\r\n\t\t}\r\n\t\t\t\t\t\r\n\t\thtml +=\t`</g>`\r\n\r\n\t\tconst coords: Coords = { \"top\": top, \"left\": left, \"bottom\": bottom, \"right\": right }\r\n\r\n\t\treturn { html: html, coords: coords }\r\n\t}\r\n\r\n\tcreateHalfBlock(xPos: number, yPos: number, tile: Tile): TileTemplate {\r\n\r\n\t\tconst id = tile.id\r\n\t\tconst height = (tile.h * this.tileH) - this.tileH\r\n\r\n\t\tlet regularColor\r\n\t\tlet highlight\r\n\t\tlet darkestColor\r\n\t\tlet strokeColor\r\n\r\n\t\tif (tile.tileColor.hex() !== this.config.buildingBaseColor.hex()) {\r\n\t\t\tregularColor = tile.tileColor.hex()\r\n\t\t\thighlight = tile.tileColor.changeColorLightingString(this._maxLighten)\r\n\t\t\tdarkestColor = tile.tileColor.changeColorLightingString(this._maxDarken)\r\n\t\t\tstrokeColor = tile.tileColor.changeColorLightingString(10)\r\n\t\t} else {\r\n\t\t\tregularColor = this.config.buildingBaseColor.hex()\r\n\t\t\thighlight = this.config.buildingBaseColor.changeColorLightingString(this._maxLighten)\r\n\t\t\tdarkestColor = this.config.buildingBaseColor.changeColorLightingString(this._maxDarken)\r\n\t\t\tstrokeColor = this.config.buildingBaseColor.changeColorLightingString(10)\r\n\t\t}\t\r\n\r\n\t\tconst { top, left, bottom, right } = this.getPositions(xPos, yPos, this.config.topMargin)\r\n\r\n\t\tconst leftWallLeftTop = `${left.x-this.bleed} ${left.y-height-(this.tileH / 2)}`\r\n\t\tconst leftWallLeftBottom = `${left.x-this.bleed} ${left.y-height+this.bleed}`\r\n\t\tconst leftWallRightBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\tconst leftWallRightTop = `${bottom.x} ${bottom.y-height-(this.tileH / 2)}`\r\n\r\n\t\tconst rightWallLeftTop = `${bottom.x} ${bottom.y-height-(this.tileH / 2)}`\r\n\t\tconst rightWallLeftBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\tconst rightWallRightBottom = `${right.x+this.bleed} ${right.y-height+this.bleed}`\r\n\t\tconst rightWallRightTop = `${right.x+this.bleed} ${right.y-height-(this.tileH / 2)}`\r\n\r\n\t\tconst blockTopLeft = `${left.x-this.bleed} ${left.y-height-(this.tileH / 2)}`\r\n\t\tconst blockTopBottom = `${bottom.x} ${bottom.y-height-(this.tileH / 2)}`\r\n\t\tconst blockTopRight = `${right.x+this.bleed} ${right.y-height-(this.tileH / 2)}`\r\n\t\tconst blockTopTop = `${top.x} ${top.y-height-(this.tileH / 2)}`\r\n\r\n\t\tconst blockTopCenter = `${(left.x + ((right.x - left.x) / 2))} ${(top.y + ((bottom.y - top.y) / 2))}`\r\n\r\n\t\tconst html = `<g style=\"z-index:${id};\"><path fill=\"${darkestColor}\"\r\n\t\t\t\t\td=\"M${leftWallLeftTop} \r\n\t\t\t\t\tL${leftWallLeftBottom} \r\n\t\t\t\t\tL${leftWallRightBottom} \r\n\t\t\t\t\tL${leftWallRightTop} \r\n\t\t\t\t\tL${leftWallLeftTop} Z\" />\r\n\t\t\t\t\t<path fill=\"${regularColor}\"\r\n\t\t\t\t\td=\"M${rightWallLeftTop} \r\n\t\t\t\t\tL${rightWallLeftBottom} \r\n\t\t\t\t\tL${rightWallRightBottom} \r\n\t\t\t\t\tL${rightWallRightTop} \r\n\t\t\t\t\tL${rightWallLeftTop} Z\" />\r\n\t\t\t\t\t<path fill=\"${highlight}\"\r\n\t\t\t\t\td=\"M${blockTopLeft} \r\n\t\t\t\t\tL${blockTopBottom} \r\n\t\t\t\t\tL${blockTopRight} \r\n\t\t\t\t\tL${blockTopTop} \r\n\t\t\t\t\tL${blockTopLeft} Z\" />\r\n\t\t\t\t\t<path fill=\"transparent\" stroke=\"${strokeColor}\" stroke-linecap=\"round\"\r\n\t\t\t\t\td=\"M${blockTopRight}\r\n\t\t\t\t\tL${blockTopLeft}\r\n\t\t\t\t\tL${blockTopBottom}\r\n\t\t\t\t\tL${blockTopTop}\" />\r\n\t\t\t\t\t</g>`\r\n\r\n\t\tconst coords: Coords = { \"top\": top, \"left\": left, \"bottom\": bottom, \"right\": right }\r\n\r\n\t\treturn { html: html, coords: coords }\r\n\t}\r\n\r\n\tcreateSlopeBlock(xPos: number, yPos: number, tile: Tile, slopeDirection: string): TileTemplate {\r\n\r\n\t\tconst id = tile.id\r\n\t\tconst height = (tile.h * this.tileH) - this.tileH\r\n\t\tlet regularColor: string\r\n\t\tlet regularDarkerColor: string\r\n\t\tlet regularLighterColor: string\r\n\t\tlet shadowLight: string\r\n\t\tlet shadowHighlight: string\r\n\t\tlet shadow: string\r\n\t\tlet highlight: string\r\n\t\tlet almostDarkestColor: string\r\n\t\tlet almostLightestColor: string\r\n\t\tlet darkestColor: string\r\n\t\tlet lightestColor: string\r\n\r\n\t\tif (tile.tileColor.hex() !== this.config.buildingBaseColor.hex()) {\r\n\t\t\tregularColor = tile.tileColor.hex()\r\n\t\t\tregularDarkerColor = tile.tileColor.changeColorLightingString(-10)\r\n\t\t\tregularLighterColor = tile.tileColor.changeColorLightingString(this._maxLighten / 3)\r\n\t\t\tshadowLight = tile.tileColor.changeColorLightingString(-20)\r\n\t\t\tshadowHighlight = tile.tileColor.changeColorLightingString(20)\r\n\t\t\tshadow = tile.tileColor.changeColorLightingString(this._maxDarken / 2)\r\n\t\t\thighlight = tile.tileColor.changeColorLightingString(this._maxLighten)\r\n\t\t\talmostDarkestColor = tile.tileColor.changeColorLightingString(-40)\r\n\t\t\talmostLightestColor = tile.tileColor.changeColorLightingString(40)\r\n\t\t\tdarkestColor = tile.tileColor.changeColorLightingString(this._maxDarken)\r\n\t\t\tlightestColor = tile.tileColor.changeColorLightingString(this._maxLighten * 2)\r\n\t\t} else {\r\n\t\t\tregularColor = this.config.buildingBaseColor.hex()\r\n\t\t\tregularDarkerColor = this.config.buildingBaseColor.changeColorLightingString(-10)\r\n\t\t\tregularLighterColor = this.config.buildingBaseColor.changeColorLightingString(this._maxLighten / 3)\r\n\t\t\tshadowLight = this.config.buildingBaseColor.changeColorLightingString(-20)\r\n\t\t\tshadowHighlight = this.config.buildingBaseColor.changeColorLightingString(20)\r\n\t\t\tshadow = this.config.buildingBaseColor.changeColorLightingString(this._maxDarken / 2)\r\n\t\t\thighlight = this.config.buildingBaseColor.changeColorLightingString(this._maxLighten)\r\n\t\t\talmostDarkestColor = this.config.buildingBaseColor.changeColorLightingString(-40)\r\n\t\t\talmostLightestColor = this.config.buildingBaseColor.changeColorLightingString(40)\r\n\t\t\tdarkestColor = this.config.buildingBaseColor.changeColorLightingString(this._maxDarken)\r\n\t\t\tlightestColor = this.config.buildingBaseColor.changeColorLightingString(this._maxLighten * 2)\r\n\t\t}\r\n\r\n\t\tconst { top, left, bottom, right } = this.getPositions(xPos, yPos)\r\n\r\n\t\tlet html = ''\r\n\t\tlet coords: Coords = { \"top\": top, \"left\": left, \"bottom\": bottom, \"right\": right }\r\n\r\n\t\tif (slopeDirection === 'n') {\r\n\r\n\t\t\tlet leftWallLeftTop = `${left.x-this.bleed} ${left.y-height-this.tileH}`\r\n\t\t\tlet leftWallLeftBottom = `${left.x-this.bleed} ${left.y-height+this.bleed}`\r\n\t\t\tlet leftWallRightBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\t\tlet leftWallRightTop = `${bottom.x} ${bottom.y-height-this.tileH}`\r\n\r\n\t\t\tlet rightWallLeftTop = `${bottom.x} ${bottom.y-height-this.tileH}`\r\n\t\t\tlet rightWallLeftBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\t\tlet rightWallRightBottom = `${right.x+this.bleed} ${right.y-height+this.bleed}`\r\n\r\n\t\t\tlet blockTopLeft = `${left.x-this.bleed} ${left.y-height-this.tileH}`\r\n\t\t\tlet blockTopBottom = `${bottom.x} ${bottom.y-height-this.tileH}`\r\n\t\t\tlet blockTopRight = `${right.x+this.bleed} ${right.y-height+this.bleed}`\r\n\t\t\tlet blockTopTop = `${top.x} ${top.y-height}`\r\n\r\n\t\t\thtml = `<g style=\"z-index:${id};\">\r\n\t\t\t\t\t\t\t<path fill=\"${shadow}\"\r\n\t\t\t\t\t\t\td=\"M${leftWallLeftTop} \r\n\t\t\t\t\t\t\tL${leftWallLeftBottom} \r\n\t\t\t\t\t\t\tL${leftWallRightBottom} \r\n\t\t\t\t\t\t\tL${leftWallRightTop} \r\n\t\t\t\t\t\t\tL${leftWallLeftTop} Z\" />\r\n\t\t\t\t\t\t\t<path fill=\"${regularColor}\"\r\n\t\t\t\t\t\t\td=\"M${rightWallLeftTop}\r\n\t\t\t\t\t\t\tL${rightWallLeftBottom}\r\n\t\t\t\t\t\t\tL${rightWallRightBottom}\r\n\t\t\t\t\t\t\tL${rightWallLeftTop} Z\" />\r\n\t\t\t\t\t\t\t<path fill=\"${lightestColor}\"\r\n\t\t\t\t\t\t\td=\"M${blockTopLeft}\r\n\t\t\t\t\t\t\tL${blockTopBottom}\r\n\t\t\t\t\t\t\tL${blockTopRight}\r\n\t\t\t\t\t\t\tL${blockTopTop}\r\n\t\t\t\t\t\t\tL${blockTopLeft} Z\" />\r\n\t\t\t\t\t\t</g>`\r\n\t\t}\r\n\r\n\t\tif (slopeDirection === 'nw') {\r\n\r\n\t\t\tconsole.log('northwest')\r\n\r\n\t\t\tlet leftWallLeftTop = `${left.x-this.bleed} ${left.y-height}`\r\n\t\t\tlet leftWallLeftBottom = `${left.x-this.bleed} ${left.y-height+this.bleed}`\r\n\t\t\tlet leftWallRightBottom = `${bottom.x} ${bottom.y-height-this.tileH+this.bleed}`\r\n\r\n\t\t\tlet blockTopLeft = `${left.x-this.bleed} ${left.y-height+this.bleed}`\r\n\t\t\tlet blockTopBottom = `${bottom.x} ${bottom.y-height-this.tileH+this.bleed}`\r\n\t\t\tlet blockTopTop = `${top.x} ${top.y-height}`\r\n\r\n\t\t\tlet blockRightBottom = `${bottom.x} ${bottom.y-height-this.tileH}`\r\n\t\t\tlet blockRightRight = `${right.x+this.bleed} ${right.y-height+this.bleed}`\r\n\t\t\tlet blockRightTop = `${top.x} ${top.y-height}`\r\n\r\n\t\t\thtml = `<g style=\"z-index:${id};\">\r\n\t\t\t\t\t\t\t<path fill=\"${darkestColor}\"\r\n\t\t\t\t\t\t\td=\"M${leftWallLeftTop}\r\n\t\t\t\t\t\t\tL${leftWallLeftBottom}\r\n\t\t\t\t\t\t\tL${leftWallRightBottom}\r\n\t\t\t\t\t\t\tL${leftWallLeftTop} Z\" />\r\n\t\t\t\t\t\t\t<path fill=\"${regularDarkerColor}\"\r\n\t\t\t\t\t\t\td=\"M${blockTopLeft}\r\n\t\t\t\t\t\t\tL${blockTopBottom}\r\n\t\t\t\t\t\t\tL${blockTopTop}\r\n\t\t\t\t\t\t\tL${blockTopLeft} Z\" />\r\n\t\t\t\t\t\t\t<path fill=\"${lightestColor}\"\r\n\t\t\t\t\t\t\td=\"M${blockRightBottom}\r\n\t\t\t\t\t\t\tL${blockRightRight}\r\n\t\t\t\t\t\t\tL${blockRightTop}\r\n\t\t\t\t\t\t\tL${blockRightBottom} Z\" />\r\n\t\t\t\t\t\t</g>`\r\n\t\t}\r\n\r\n\t\tif (slopeDirection === 's') {\r\n\r\n\t\t\tlet rightWallLeftBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\t\tlet rightWallRightBottom = `${right.x+this.bleed} ${right.y-height+this.bleed}`\r\n\t\t\tlet rightWallRightTop = `${right.x+this.bleed} ${right.y-height-this.tileH}`\r\n\r\n\t\t\tlet blockTopLeft = `${left.x-this.bleed} ${left.y-height+this.bleed}`\r\n\t\t\tlet blockTopBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\t\tlet blockTopRight = `${right.x+this.bleed} ${right.y-height-this.tileH+this.bleed}`\r\n\t\t\tlet blockTopTop = `${top.x} ${top.y-height-this.tileH}`\r\n\r\n\t\t\thtml = `<g style=\"z-index:${id};\">\r\n\t\t\t\t\t\t\t<path fill=\"${regularColor}\"\r\n\t\t\t\t\t\t\td=\"M${rightWallLeftBottom}\r\n\t\t\t\t\t\t\tL${rightWallRightBottom}\r\n\t\t\t\t\t\t\tL${rightWallRightTop}\r\n\t\t\t\t\t\t\tL${rightWallLeftBottom} Z\" />\r\n\t\t\t\t\t\t\t<path fill=\"${shadow}\"\r\n\t\t\t\t\t\t\td=\"M${blockTopLeft}\r\n\t\t\t\t\t\t\tL${blockTopBottom}\r\n\t\t\t\t\t\t\tL${blockTopRight}\r\n\t\t\t\t\t\t\tL${blockTopTop}\r\n\t\t\t\t\t\t\tL${blockTopLeft} Z\" />\r\n\t\t\t\t\t\t</g>`\r\n\t\t}\r\n\r\n\t\tif (slopeDirection === 'se') {\r\n\r\n\t\t\tlet blockLeftLeft = `${left.x-this.bleed} ${left.y-height+this.bleed}`\r\n\t\t\tlet blockLeftBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\t\tlet blockLeftTop = `${top.x} ${top.y-height-this.tileH}`\r\n\r\n\t\t\tlet blockRightBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\t\tlet blockRightRight = `${right.x+this.bleed} ${right.y-height+this.bleed}`\r\n\t\t\tlet blockRightTop = `${top.x} ${top.y-height-this.tileH}`\r\n\r\n\t\t\thtml = `<g style=\"z-index:${id};\">\r\n\t\t\t\t\t\t<path fill=\"${shadow}\"\r\n\t\t\t\t\t\td=\"M${blockLeftLeft}\r\n\t\t\t\t\t\tL${blockLeftBottom}\r\n\t\t\t\t\t\tL${blockLeftTop}\r\n\t\t\t\t\t\tL${blockLeftLeft} Z\" />\r\n\t\t\t\t\t\t<path fill=\"${regularDarkerColor}\"\r\n\t\t\t\t\t\td=\"M${blockRightRight}\r\n\t\t\t\t\t\tL${blockRightBottom}\r\n\t\t\t\t\t\tL${blockRightTop}\r\n\t\t\t\t\t\tL${blockRightRight} Z\" />\r\n\t\t\t\t\t</g>`\r\n\t\t}\r\n\r\n\t\tif (slopeDirection === 'e') {\r\n\r\n\t\t\tlet leftWallLeftTop = `${left.x-this.bleed} ${left.y-height-this.tileH}`\r\n\t\t\tlet leftWallLeftBottom = `${left.x-this.bleed} ${left.y-height+this.bleed}`\r\n\t\t\tlet leftWallRightBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\r\n\t\t\tlet blockTopLeft = `${left.x-this.bleed} ${left.y-height-this.tileH+this.bleed}`\r\n\t\t\tlet blockTopBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\t\tlet blockTopRight = `${right.x+this.bleed} ${right.y-height+this.bleed}`\r\n\t\t\tlet blockTopTop = `${top.x} ${top.y-height-this.tileH}`\r\n\r\n\t\t\thtml = `<g style=\"z-index:${id};\">\r\n\t\t\t\t\t\t\t<path fill=\"${darkestColor}\"\r\n\t\t\t\t\t\t\td=\"M${leftWallLeftTop}\r\n\t\t\t\t\t\t\tL${leftWallLeftBottom}\r\n\t\t\t\t\t\t\tL${leftWallRightBottom}\r\n\t\t\t\t\t\t\tL${leftWallLeftTop} Z\" />\r\n\t\t\t\t\t\t\t<path fill=\"${regularDarkerColor}\"\r\n\t\t\t\t\t\t\td=\"M${blockTopLeft}\r\n\t\t\t\t\t\t\tL${blockTopBottom}\r\n\t\t\t\t\t\t\tL${blockTopRight}\r\n\t\t\t\t\t\t\tL${blockTopTop}\r\n\t\t\t\t\t\t\tL${blockTopLeft} Z\" />\r\n\t\t\t\t\t\t</g>`\r\n\t\t}\r\n\r\n\t\tif (slopeDirection === 'ne') {\r\n\r\n\t\t\tlet leftWallLeftTop = `${left.x-this.bleed} ${left.y-height-this.tileH}`\r\n\t\t\tlet leftWallLeftBottom = `${left.x-this.bleed} ${left.y-height+this.bleed}`\r\n\t\t\tlet leftWallRightBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\r\n\t\t\tlet blockBottomLeft = `${left.x-this.bleed} ${left.y-height-this.tileH+this.bleed}`\r\n\t\t\tlet blockBottomRight = `${right.x+this.bleed} ${right.y-height+this.bleed}`\r\n\t\t\tlet blockBottomTop = `${top.x} ${top.y-height}`\r\n\r\n\t\t\tlet blockTopLeft = `${left.x-this.bleed} ${left.y-height-this.tileH+this.bleed}`\r\n\t\t\tlet blockTopBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\t\tlet blockTopRight = `${right.x+this.bleed} ${right.y-height+this.bleed}`\r\n\r\n\t\t\thtml = `<g style=\"z-index:${id};\">\r\n\t\t\t\t\t\t<path fill=\"${darkestColor}\"\r\n\t\t\t\t\t\td=\"M${leftWallLeftTop}\r\n\t\t\t\t\t\tL${leftWallLeftBottom}\r\n\t\t\t\t\t\tL${leftWallRightBottom}\r\n\t\t\t\t\t\tL${leftWallLeftTop} Z\" />\r\n\t\t\t\t\t\t<path fill=\"${regularDarkerColor}\"\r\n\t\t\t\t\t\td=\"M${blockTopLeft}\r\n\t\t\t\t\t\tL${blockTopBottom}\r\n\t\t\t\t\t\tL${blockTopRight}\r\n\t\t\t\t\t\tL${blockTopLeft} Z\" />\r\n\t\t\t\t\t\t<path fill=\"${lightestColor}\"\r\n\t\t\t\t\t\td=\"M${blockBottomLeft}\r\n\t\t\t\t\t\tL${blockBottomTop}\r\n\t\t\t\t\t\tL${blockBottomRight}\r\n\t\t\t\t\t\tL${blockBottomLeft} Z\" />\r\n\t\t\t\t\t</g>`\r\n\t\t}\r\n\r\n\t\tif (slopeDirection === 'w') {\r\n\r\n\t\t\tlet leftWallLeftTop = `${left.x-this.bleed} ${left.y-height}`\r\n\t\t\tlet leftWallLeftBottom = `${left.x-this.bleed} ${left.y-height+this.bleed}`\r\n\t\t\tlet leftWallRightBottom = `${bottom.x} ${bottom.y-height-this.tileH+this.bleed}`\r\n\r\n\t\t\tlet blockTopLeft = `${left.x-this.bleed} ${left.y-height+this.bleed}`\r\n\t\t\tlet blockTopBottom = `${bottom.x} ${bottom.y-height-this.tileH+this.bleed}`\r\n\t\t\tlet blockTopRight = `${right.x+this.bleed} ${right.y-height-this.tileH+this.bleed}`\r\n\t\t\tlet blockTopTop = `${top.x} ${top.y-height}`\r\n\r\n\t\t\thtml = `<g style=\"z-index:${id};\">\r\n\t\t\t\t\t\t\t<path fill=\"${darkestColor}\"\r\n\t\t\t\t\t\t\td=\"M${leftWallLeftTop}\r\n\t\t\t\t\t\t\tL${leftWallLeftBottom}\r\n\t\t\t\t\t\t\tL${leftWallRightBottom}\r\n\t\t\t\t\t\t\tL${leftWallLeftTop} Z\" />\r\n\t\t\t\t\t\t\t<path fill=\"${regularDarkerColor}\"\r\n\t\t\t\t\t\t\td=\"M${blockTopLeft}\r\n\t\t\t\t\t\t\tL${blockTopBottom}\r\n\t\t\t\t\t\t\tL${blockTopRight}\r\n\t\t\t\t\t\t\tL${blockTopTop}\r\n\t\t\t\t\t\t\tL${blockTopLeft} Z\" />\r\n\t\t\t\t\t\t</g>`\r\n\t\t}\r\n\r\n\t\tif (slopeDirection === 'sw') {\r\n\r\n\t\t\tlet rightWallLeftBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\t\tlet rightWallRightBottom = `${right.x+this.bleed} ${right.y-height+this.bleed}`\r\n\t\t\tlet rightWallRightTop = `${right.x+this.bleed} ${right.y-height-this.tileH}`\r\n\r\n\t\t\tlet blockTopLeft = `${left.x-this.bleed} ${left.y-height+this.bleed}`\r\n\t\t\tlet blockTopBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\t\tlet blockTopRight = `${right.x+this.bleed} ${right.y-height-this.tileH+this.bleed}`\r\n\t\t\tlet blockTopTop = `${top.x} ${top.y-height}`\r\n\r\n\t\t\thtml = `<g style=\"z-index:${id};\">\r\n\t\t\t\t\t\t\t<path fill=\"${regularColor}\"\r\n\t\t\t\t\t\t\td=\"M${rightWallLeftBottom}\r\n\t\t\t\t\t\t\tL${rightWallRightBottom}\r\n\t\t\t\t\t\t\tL${rightWallRightTop}\r\n\t\t\t\t\t\t\tL${rightWallLeftBottom} Z\" />\r\n\t\t\t\t\t\t\t<path fill=\"${regularDarkerColor}\"\r\n\t\t\t\t\t\t\td=\"M${blockTopLeft}\r\n\t\t\t\t\t\t\tL${blockTopTop}\r\n\t\t\t\t\t\t\tL${blockTopRight}\r\n\t\t\t\t\t\t\tL${blockTopLeft} Z\" />\r\n\t\t\t\t\t\t\t<path fill=\"${shadow}\"\r\n\t\t\t\t\t\t\td=\"M${blockTopLeft}\r\n\t\t\t\t\t\t\tL${blockTopBottom}\r\n\t\t\t\t\t\t\tL${blockTopRight}\r\n\t\t\t\t\t\t\tL${blockTopLeft} Z\" />\r\n\t\t\t\t\t\t</g>`\r\n\t\t}\r\n\r\n\t\treturn { html: html, coords: coords }\r\n\t}\r\n\r\n\tcreatePillarBlock(xPos: number, yPos: number, tile: Tile): TileTemplate {\r\n\r\n\t\tlet id = tile.id\r\n\t\tlet tileWidth = this.config.tileWidth\r\n\t\tlet height = (tile.h * this.tileH) - this.tileH\r\n\r\n\t\tlet regularColor\r\n\t\tlet highlight\r\n\t\tlet darkestColor\r\n\r\n\t\tif (tile.tileColor.hex() !== this.config.buildingBaseColor.hex()) {\r\n\t\t\tregularColor = tile.tileColor.hex()\r\n\t\t\thighlight = tile.tileColor.changeColorLightingString(this._maxLighten)\r\n\t\t\tdarkestColor = tile.tileColor.changeColorLightingString(this._maxDarken)\r\n\t\t} else {\r\n\t\t\tregularColor = this.config.buildingBaseColor.hex()\r\n\t\t\thighlight = this.config.buildingBaseColor.changeColorLightingString(this._maxLighten)\r\n\t\t\tdarkestColor = this.config.buildingBaseColor.changeColorLightingString(this._maxDarken)\r\n\t\t}\t\r\n\r\n\t\tconst { top, left, bottom, right } = this.getPositions(xPos, yPos, this.config.topMargin)\r\n\r\n\t\tconst leftWallLeftTop = `${left.x-this.bleed + (tileWidth / 2.7)} ${left.y-height-this.tileH}`\r\n\t\tconst leftWallLeftBottom = `${left.x-this.bleed + (tileWidth / 2.7)} ${left.y-height}`\r\n\r\n\t\tconst rightWallRightBottom = `${right.x+this.bleed - (tileWidth / 2.7)} ${right.y-height}`\r\n\t\tconst rightWallRightTop = `${right.x+this.bleed - (tileWidth / 2.7)} ${right.y-height-this.tileH}`\r\n\r\n\t\tconst leftWallBezier = `${left.x-this.bleed + (tileWidth / 2.7) + (tileWidth / 12)} ${bottom.y-height}`\r\n\t\tconst rightWallBezier = `${right.x-this.bleed - (tileWidth / 2.7) - (tileWidth / 12)} ${bottom.y-height}`\r\n\r\n\t\tconst blockTopLeft = `${left.x-this.bleed} ${left.y-height-this.tileH}`\r\n\t\tconst blockTopBottom = `${bottom.x} ${bottom.y-height-this.tileH}`\r\n\t\tconst blockTopRight = `${right.x+this.bleed} ${right.y-height-this.tileH}`\r\n\t\tconst blockTopTop = `${top.x} ${top.y-height-this.tileH}`\r\n\r\n\t\tlet html = `<g style=\"z-index:${id};\">\r\n\t\t\t<defs>${this.calculations.addGradient(\"pillarGradient\", darkestColor, regularColor)}</defs> \r\n\t\t\t<path fill=\"url(#pillarGradient)\"\r\n\t\t\t d=\"M${leftWallLeftTop} \r\n\t\t\tL${leftWallLeftBottom} \r\n\t\t\tC${leftWallBezier}, ${rightWallBezier}, ${rightWallRightBottom} \r\n\t\t\tL${rightWallRightTop} \r\n\t\t\tL${leftWallLeftTop} Z\" />\r\n\t\t\t\r\n\t\t\t</g>`\r\n\r\n\t\tlet coords: Coords = { \"top\": top, \"left\": left, \"bottom\": bottom, \"right\": right }\r\n\r\n\t\treturn { html: html, coords: coords }\r\n\t}\r\n\r\n\tcreateWindow(xPos: number, yPos: number, tile: Tile, columnInfo: Column, windowLights: boolean): TileTemplate {\r\n\r\n\t\tlet id = tile.id\r\n\t\tlet height = (tile.h * this.tileH) - this.tileH\r\n\t\tlet regularColor = '#222'\r\n\t\tlet darkestColor = '#111'\r\n\t\tlet light = '#f3ef76'\r\n\r\n\t\tconst { top, left, bottom, right } = this.getPositions(xPos, yPos, this.config.topMargin)\r\n\r\n\t\tlet coords: Coords = { top: top, left: left, bottom: bottom, right: right }\r\n\r\n\t\tlet windowBorderWidth = (top.x - left.x) / 10\r\n\r\n\t\tlet html = `<g style=\"z-index:${id+columnInfo.height};\">`\r\n\r\n\t\tif (columnInfo.edge.bottom) {\r\n\r\n\t\t\tconst xEdge = (bottom.x - left.x) / 3\r\n\t\t\tconst yEdge = (bottom.y - left.y) / 8\r\n\r\n\t\t\tconst leftWindowLeftTop = `${left.x + xEdge} ${left.y - height - this.tileH + (yEdge * 7)}`\r\n\t\t\tconst leftWindowLeftBottom = `${left.x + xEdge} ${left.y - height + (yEdge)}`\r\n\t\t\tconst leftWindowRightBottom = `${bottom.x - xEdge} ${bottom.y - height - (yEdge * 4)}`\r\n\t\t\tconst leftWindowRightTop = `${bottom.x - xEdge} ${bottom.y - height - this.tileH + (yEdge * 2)}`\r\n\t\t\tconst leftWindowRightBezier = `${bottom.x - xEdge} ${bottom.y - height - this.tileH - yEdge}`\r\n\t\t\tconst leftWindowLeftBezier = `${left.x + xEdge} ${left.y - height - this.tileH + (yEdge * 4)}`\r\n\r\n\t\t\tlet windowColor = darkestColor\r\n\t\t\tif (windowLights) {\r\n\t\t\t\tlet windowColor = (Math.round(Math.random() * 20) > 18) ? light : darkestColor\r\n\t\t\t}\t\t\r\n\r\n\t\t\thtml += `<path fill=\"${windowColor}\"\r\n\t\t\t\t\t\td=\"M${leftWindowLeftTop} \r\n\t\t\t\t\t\tL${leftWindowLeftBottom} \r\n\t\t\t\t\t\tL${leftWindowRightBottom} \r\n\t\t\t\t\t\tL${leftWindowRightTop} \r\n\t\t\t\t\t\tC${leftWindowRightBezier}, ${leftWindowLeftBezier}, ${leftWindowLeftTop} Z\" />`\r\n\t\t}\r\n\r\n\t\t\r\n\t\tif (columnInfo.edge.right) {\r\n\r\n\t\t\tconst xEdge = (right.x - bottom.x) / 3\r\n\t\t\tconst yEdge = (right.y - bottom.y) / 8\r\n\r\n\t\t\tconst rightWindowLeftTop = `${bottom.x + xEdge} ${bottom.y - height - this.tileH - (yEdge * 2)}`\r\n\t\t\tconst rightWindowLeftBottom = `${bottom.x + xEdge} ${bottom.y - height + (yEdge * 3.6)}`\r\n\t\t\tconst rightWindowRightBottom = `${right.x - xEdge} ${right.y - height - (yEdge * 1)}`\r\n\t\t\tconst rightWindowRightTop = `${right.x - xEdge} ${right.y - height - this.tileH - (yEdge * 6.5)}`\r\n\t\t\tconst rightWindowRightBezier = `${right.x - xEdge} ${right.y - height - this.tileH - (yEdge * 3.2)}`\r\n\t\t\tconst rightWindowLeftBezier = `${bottom.x + xEdge} ${bottom.y - height - this.tileH + (yEdge * 0.3)}`\r\n\t\t\t\r\n\t\t\tlet windowColor = regularColor\r\n\t\t\tif (windowLights) {\r\n\t\t\t\tlet windowColor = (Math.round(Math.random() * 20) > 18) ? light : regularColor\r\n\t\t\t}\t\r\n\r\n\t\t\thtml += `<path fill=\"${windowColor}\"\r\n\t\t\t\t\t\td=\"M${rightWindowLeftTop} \r\n\t\t\t\t\t\tL${rightWindowLeftBottom} \r\n\t\t\t\t\t\tL${rightWindowRightBottom} \r\n\t\t\t\t\t\tL${rightWindowRightTop} \r\n\t\t\t\t\t\tC${rightWindowRightBezier}, ${rightWindowLeftBezier}, ${rightWindowLeftTop} Z\" />`\r\n\t\t}\r\n\r\n\t\thtml += `</g>`\t\t\r\n\r\n\t\treturn { html: html, coords: coords }\r\n\t}\r\n\r\n\tcreateDoor(xPos: number, yPos: number, tile: Tile, columnInfo: Column, direction?: string): TileTemplate {\r\n\r\n\t\tconst id = tile.id\r\n\t\tconst height = (tile.h * this.tileH) - this.tileH\r\n\t\tlet regularColor\r\n\t\tlet darkestColor\r\n\t\tlet doorHandleColor\r\n\r\n\t\tif (tile.tileColor.hex() !== this.config.buildingBaseColor.hex()) {\r\n\t\t\tdoorHandleColor = new Color(tile.tileColor.hex()).getColorByHue(110).changeColorLightingString(60)\r\n\t\t\tregularColor = new Color(tile.tileColor.hex()).getColorByHue(220).changeColorLightingString(-80)\r\n\t\t\tdarkestColor = new Color(tile.tileColor.hex()).getColorByHue(220).changeColorLightingString(-110)\r\n\t\t} else {\r\n\t\t\tdoorHandleColor = new Color(this.config.buildingBaseColor.hex()).getColorByHue(110).changeColorLightingString(60)\r\n\t\t\tregularColor = new Color(this.config.buildingBaseColor.hex()).getColorByHue(220).changeColorLightingString(-80)\r\n\t\t\tdarkestColor = new Color(this.config.buildingBaseColor.hex()).getColorByHue(220).changeColorLightingString(-110)\r\n\t\t}\r\n\r\n\t\tconst { top, left, bottom, right } = this.getPositions(xPos, yPos, this.config.topMargin)\r\n\r\n\t\tconst coords: Coords = { top: top, left: left, bottom: bottom, right: right }\r\n\r\n\t\tconst windowBorderWidth = (top.x - left.x) / 10\r\n\r\n\t\tlet html = `<g style=\"z-index:${id+columnInfo.height};\">`\r\n\r\n\t\tif (direction === 'bottom') {\r\n\r\n\t\t\tlet xEdge = (bottom.x - left.x) / 4\r\n\t\t\tlet yEdge = (bottom.y - left.y) / 8\r\n\r\n\t\t\tconsole.log(yEdge)\r\n\r\n\t\t\tconst leftWindowLeftTop = `${left.x + xEdge} ${left.y - height - this.tileH + (yEdge * 4.5)}`\r\n\t\t\tconst leftWindowLeftBottom = `${left.x + xEdge} ${left.y - height + (yEdge * 2)}`\r\n\t\t\tconst leftWindowRightBottom = `${bottom.x - xEdge} ${bottom.y - height - (yEdge * 2)}`\r\n\t\t\tconst leftWindowRightTop = `${bottom.x - xEdge} ${bottom.y - height - this.tileH + (yEdge * 0.5)}`\r\n\r\n\t\t\tconst leftWindowBorderLeftTop = `${left.x + xEdge} ${left.y - height - this.tileH + (yEdge * 4.5)}`\r\n\t\t\tconst leftWindowBorderRightBottom = `${bottom.x - xEdge} ${bottom.y - height - (yEdge * 2)}`\r\n\t\t\tconst leftWindowBorderRightTop = `${bottom.x - xEdge} ${bottom.y - height - this.tileH + (yEdge * 0.5)}`\r\n\r\n\t\t\thtml += `<path stroke=\"#111\" stroke-width=\"1.3\"\r\n\t\t\t\t\t\td=\"M${leftWindowBorderLeftTop}\r\n\t\t\t\t\t\tL${leftWindowBorderRightTop}\r\n\t\t\t\t\t\tL${leftWindowBorderRightBottom}\" />\r\n\t\t\t\t\t<path fill=\"${darkestColor}\"\r\n\t\t\t\t\t\td=\"M${leftWindowLeftTop} \r\n\t\t\t\t\t\tL${leftWindowLeftBottom} \r\n\t\t\t\t\t\tL${leftWindowRightBottom} \r\n\t\t\t\t\t\tL${leftWindowRightTop} \r\n\t\t\t\t\t\tL${leftWindowLeftTop} Z\" />\r\n\t\t\t\t\t<circle fill=\"${doorHandleColor}\" \r\n\t\t\t\t\t\tcx=\"${left.x + (xEdge * 1.4)}\" \r\n\t\t\t\t\t\tcy=\"${bottom.y - height - this.tileH + (yEdge * 2.8)}\" \r\n\t\t\t\t\t\tr=\"0.8\" />`\r\n\t\t}\r\n\r\n\t\t\r\n\t\tif (direction === 'right') {\r\n\r\n\t\t\tconst xEdge = (right.x - bottom.x) / 4\r\n\t\t\tconst yEdge = (right.y - bottom.y) / 8\r\n\r\n\t\t\tconst rightWindowLeftTop = `${bottom.x + xEdge} ${bottom.y - height - this.tileH - (yEdge)}`\r\n\t\t\tconst rightWindowLeftBottom = `${bottom.x + xEdge} ${bottom.y - height + (yEdge * 2)}`\r\n\t\t\tconst rightWindowRightBottom = `${right.x - xEdge} ${right.y - height - (yEdge * 1.5)}`\r\n\t\t\tconst rightWindowRightTop = `${right.x - xEdge} ${right.y - height - this.tileH - (yEdge * 4.5)}`\r\n\r\n\t\t\thtml += `<path stroke=\"#444\" stroke-width=\"1.3\"\r\n\t\t\t\t\t\td=\"M${rightWindowRightTop}\r\n\t\t\t\t\t\tL${rightWindowLeftTop}\r\n\t\t\t\t\t\tL${rightWindowLeftBottom}\" />\r\n\t\t\t\t\t<path fill=\"${regularColor}\"\r\n\t\t\t\t\t\td=\"M${rightWindowLeftTop} \r\n\t\t\t\t\t\tL${rightWindowLeftBottom} \r\n\t\t\t\t\t\tL${rightWindowRightBottom} \r\n\t\t\t\t\t\tL${rightWindowRightTop} \r\n\t\t\t\t\t\tL${rightWindowLeftTop} Z\" />\r\n\t\t\t\t\t<circle fill=\"${doorHandleColor}\" \r\n\t\t\t\t\t\tcx=\"${bottom.x + (xEdge * 1.3)}\" \r\n\t\t\t\t\t\tcy=\"${bottom.y - height - this.tileH - (yEdge * 4.5)}\" \r\n\t\t\t\t\t\tr=\"0.8\" />`\r\n\t\t}\r\n\r\n\t\thtml += `</g>`\t\t\r\n\r\n\t\treturn { html: html, coords: coords }\r\n\t}\r\n\r\n\tcreateHalfArch(xPos: number, yPos: number, tile: Tile, orientation: string): TileTemplate {\r\n\r\n\t\tconst id = tile.id\r\n\t\tconst height = (tile.h * this.tileH) - this.tileH\r\n\t\tlet regularColor\r\n\t\tlet darkestColor\r\n\t\tlet highlight\r\n\t\tlet highlightLeft\r\n\t\tlet highlightRight\r\n\t\tlet html\r\n\r\n\t\tif (tile.tileColor.hex() !== this.config.buildingBaseColor.hex()) {\r\n\t\t\tregularColor = tile.tileColor.hex()\r\n\t\t\thighlight = tile.tileColor.changeColorLightingString(this._maxLighten)\r\n\t\t\tdarkestColor = tile.tileColor.changeColorLightingString(this._maxDarken)\r\n\t\t\thighlightLeft = tile.tileColor.changeColorLightingString(this._maxLighten / 2)\r\n\t\t\thighlightRight = tile.tileColor.changeColorLightingString(this._maxLighten)\r\n\t\t} else {\r\n\t\t\tregularColor = this.config.buildingBaseColor.hex()\r\n\t\t\thighlight = this.config.buildingBaseColor.changeColorLightingString(this._maxLighten)\r\n\t\t\tdarkestColor = this.config.buildingBaseColor.changeColorLightingString(this._maxDarken)\r\n\t\t\thighlightLeft = this.config.buildingBaseColor.changeColorLightingString(this._maxLighten / 2)\r\n\t\t\thighlightRight = this.config.buildingBaseColor.changeColorLightingString(this._maxLighten)\r\n\t\t}\r\n\r\n\t\tconst { top, left, bottom, right } = this.getPositions(xPos, yPos, this.config.topMargin)\r\n\r\n\t\tconst halfTileWidth = ((right.x - bottom.x) / 3)\r\n\r\n\t\tif (orientation === 'right-bottom') {\r\n\r\n\t\t\tconst leftWallLeftTop = `${left.x-this.bleed} ${left.y-height-this.tileH}`\r\n\t\t\tconst leftWallLeftBottom = `${left.x-this.bleed} ${left.y-height+this.bleed}`\r\n\t\t\tconst leftWallRightBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\t\tconst leftWallRightTop = `${bottom.x} ${bottom.y-height-this.tileH}`\r\n\r\n\t\t\tconst rightWallLeftTop = `${bottom.x} ${bottom.y-height-this.tileH}`\r\n\t\t\tconst rightWallLeftBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\t\tconst rightWallLeftBottomBezier = `${bottom.x} ${bottom.y-height-(this.tileH * 0.5)}`\r\n\t\t\tconst rightWallRightTopBezier = `${bottom.x + (halfTileWidth*0.4)} ${bottom.y-height-this.tileH}`\r\n\t\t\tconst rightWallRightTop = `${right.x+this.bleed} ${right.y-height-this.tileH}`\r\n\r\n\t\t\tconst blockTopLeft = `${left.x-this.bleed} ${left.y-height-this.tileH}`\r\n\t\t\tconst blockTopBottom = `${bottom.x} ${bottom.y-height-this.tileH}`\r\n\t\t\tconst blockTopRight = `${right.x+this.bleed} ${right.y-height-this.tileH}`\r\n\t\t\tconst blockTopTop = `${top.x} ${top.y-height-this.tileH}`\r\n\r\n\t\t\thtml = `<g style=\"z-index:${id};\">\r\n\t\t\t\t\t\t<path fill=\"${darkestColor}\"\r\n\t\t\t\t\t\td=\"M${leftWallLeftTop} \r\n\t\t\t\t\t\tL${leftWallLeftBottom} \r\n\t\t\t\t\t\tL${leftWallRightBottom} \r\n\t\t\t\t\t\tL${leftWallRightTop} \r\n\t\t\t\t\t\tL${leftWallLeftTop} Z\" />\r\n\t\t\t\t\t\t<path fill=\"${regularColor}\"\r\n\t\t\t\t\t\td=\"M${rightWallLeftTop} \r\n\t\t\t\t\t\tL${rightWallLeftBottom}\r\n\t\t\t\t\t\tC${rightWallLeftBottomBezier}, ${rightWallRightTopBezier}, ${rightWallRightTop}\r\n\t\t\t\t\t\tL${rightWallLeftTop} Z\" />\r\n\t\t\t\t\t\t<path fill=\"${highlight}\"\r\n\t\t\t\t\t\td=\"M${blockTopLeft} \r\n\t\t\t\t\t\tL${blockTopBottom} \r\n\t\t\t\t\t\tL${blockTopRight} \r\n\t\t\t\t\t\tL${blockTopTop} \r\n\t\t\t\t\t\tL${blockTopLeft} Z\" />\r\n\t\t\t\t\t</g>`\r\n\r\n\t\t} \r\n\r\n\t\tif (orientation === 'right-top') {\r\n\r\n\t\t\tconst leftWallLeftTop = `${left.x-this.bleed} ${left.y-height-this.tileH}`\r\n\t\t\tconst leftWallLeftBottom = `${left.x-this.bleed} ${left.y-height+this.bleed}`\r\n\t\t\tconst leftWallRightBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\t\tconst leftWallRightTop = `${bottom.x} ${bottom.y-height-this.tileH}`\r\n\r\n\t\t\tconst rightWallLeftTop = `${bottom.x} ${bottom.y-height-this.tileH}`\r\n\t\t\tconst rightWallLeftTopBezier = `${right.x+this.bleed-(halfTileWidth*0.3)} ${right.y-height-(this.tileH*0.7)}`\r\n\t\t\tconst rightWallRightBottomBezier = `${right.x} ${right.y-height-(this.tileH*0.4)}`\r\n\t\t\tconst rightWallRightBottom = `${right.x+this.bleed} ${right.y-height+this.bleed}`\r\n\t\t\tconst rightWallRightTop = `${right.x+this.bleed} ${right.y-height-this.tileH}`\r\n\r\n\t\t\tconst blockTopLeft = `${left.x-this.bleed} ${left.y-height-this.tileH}`\r\n\t\t\tconst blockTopBottom = `${bottom.x} ${bottom.y-height-this.tileH}`\r\n\t\t\tconst blockTopRight = `${right.x+this.bleed} ${right.y-height-this.tileH}`\r\n\t\t\tconst blockTopTop = `${top.x} ${top.y-height-this.tileH}`\r\n\r\n\t\t\tconst blockBackRightBottom = `${right.x+this.bleed} ${right.y-height+this.bleed}`\r\n\t\t\tconst blockBackLeftBottom = `${right.x+this.bleed} ${right.y-height-this.tileH}`\r\n\t\t\tconst blockBackLeftTop = `${top.x-this.bleed} ${top.y-height-this.tileH}`\r\n\t\t\tconst blockBackRightTop = `${top.x-this.bleed} ${top.y-height}`\r\n\r\n\t\t\thtml = `<g style=\"z-index:${id};\">\r\n\t\t\t\t\t\t<path fill=\"${darkestColor}\"\r\n\t\t\t\t\t\td=\"M${blockBackRightBottom} \r\n\t\t\t\t\t\tL${blockBackLeftBottom} \r\n\t\t\t\t\t\tL${blockBackLeftTop} \r\n\t\t\t\t\t\tL${blockBackRightTop} \r\n\t\t\t\t\t\tL${blockBackRightBottom} Z\" />\r\n\t\t\t\t\t\t<path fill=\"${regularColor}\"\r\n\t\t\t\t\t\td=\"M${rightWallLeftTop} \r\n\t\t\t\t\t\tC${rightWallLeftTopBezier}, ${rightWallRightBottomBezier}, ${rightWallRightBottom}\r\n\t\t\t\t\t\tL${rightWallRightTop} \r\n\t\t\t\t\t\tL${rightWallLeftTop} Z\" />\r\n\t\t\t\t\t\t<path fill=\"${highlight}\"\r\n\t\t\t\t\t\td=\"M${blockTopLeft} \r\n\t\t\t\t\t\tL${blockTopBottom} \r\n\t\t\t\t\t\tL${blockTopRight} \r\n\t\t\t\t\t\tL${blockTopTop} \r\n\t\t\t\t\t\tL${blockTopLeft} Z\" />\r\n\t\t\t\t\t</g>`\r\n\t\t}\r\n\r\n\t\tconst coords: Coords = { top: top, left: left, bottom: bottom, right: right }\r\n\r\n\t\treturn { html: html, coords: coords }\r\n\t}\r\n\r\n\tcreateTowerTop(left: Position, bottom: Position, right: Position, top: Position, height: number, tile: Tile) {\r\n\r\n\t\tlet regularColor\r\n\t\tlet highlightLeft\r\n\t\tlet highlightRight\r\n\t\tlet html\r\n\r\n\t\tif (tile.tileColor.hex() !== this.config.buildingBaseColor.hex()) {\r\n\t\t\tregularColor = tile.tileColor.hex()\r\n\t\t\thighlightLeft = tile.tileColor.changeColorLightingString(-25)\r\n\t\t\thighlightRight = tile.tileColor.changeColorLightingString(this._maxLighten / 2)\r\n\t\t} else {\r\n\t\t\tregularColor = this.config.buildingBaseColor.hex()\r\n\t\t\thighlightLeft = this.config.buildingBaseColor.changeColorLightingString(-25)\r\n\t\t\thighlightRight = this.config.buildingBaseColor.changeColorLightingString(this._maxLighten / 2)\r\n\t\t}\r\n\r\n\t\tconst centerTop = {\r\n\t\t\tx: left.x + ((right.x - left.x) / 2),\r\n\t\t\ty: left.y - (this.tileH * height)\r\n\t\t}\r\n\r\n\t\thtml = `<g id=\"towerTop_${tile.id}\">\r\n\t\t\t\t<path fill=\"${highlightLeft}\"\r\n\t\t\t\t\td=\"M${left.x} ${left.y+this.bleed}\r\n\t\t\t\t\tL${bottom.x} ${bottom.y+this.bleed}\r\n\t\t\t\t\tL${centerTop.x} ${centerTop.y}\r\n\t\t\t\t\tL${left.x} ${left.y+this.bleed} Z\" \r\n\t\t\t\t/>\r\n\t\t\t\t<path fill=\"${highlightRight}\"\r\n\t\t\t\t\td=\"M${bottom.x} ${bottom.y+this.bleed}\r\n\t\t\t\t\tL${right.x} ${right.y+this.bleed}\r\n\t\t\t\t\tL${centerTop.x} ${centerTop.y}\r\n\t\t\t\t\tL${bottom.x} ${bottom.y+this.bleed} Z\" \r\n\t\t\t\t/>\r\n\t\t\t</g>`\r\n\r\n\t\treturn html\r\n\t}\r\n\r\n\r\n\tcreateTree(xPos: number, yPos: number) {\r\n\r\n\t\tconst x = xPos\r\n\t\tconst y = yPos\r\n\r\n\t\tconst darkGreen = '#007c36'\r\n\t\tconst lightGreen = '#5fb875'\r\n\t\tconst darkBrown = '#443422'\r\n\t\tconst lightBrown = '#664c2c'\r\n\t\tconst shadowFull = '#00000744'\r\n\t\tconst shadowEmpty = '#02001e00'\r\n\r\n\t\tconst treeHtml = `\r\n\t\t<defs>${this.calculations.addGradient(\"woodGradient\", darkBrown, lightBrown)}</defs> \r\n\t\t<defs>${this.calculations.addGradient(\"leafGradient\", darkGreen, lightGreen)}</defs>\r\n\t\t<defs>${this.calculations.addGradient(\"shadow\", shadowEmpty, shadowFull)}</defs>\r\n\t\t\t<path fill=\"url(#woodGradient)\" \r\n\t\t\td=\"M${x+34.3} ${y+89.4}\r\n\t\t\tl-0.4 21.3\r\n\t\t\tc0,0,0.2 3.9,4.2 3.9\r\n\t\t\tc3.4 0 3.5-4.4 3.5-4.4\r\n\t\t\tl-0.5-20.8\r\n\t\t\tL${x+34.3} ${y+89.4} z\"/>\t\t\t\r\n\t\t\t<path fill=\"url(#leafGradient)\"\r\n\t\t\td=\"M${x+38.6} ${y+32.8}\r\n\t\t\tc-9.9 0-18.5 20-18.5 39.7\r\n\t\t\ts12.4 23.1 18.1 23.1\r\n\t\t\ts17.8-4.3 17.8-23.2\r\n\t\t\tS${x+45.5} ${y+32.8} ${x+38.6} ${y+32.8} z\"/>\r\n\t\t\t<polygon fill=\"url(#shadow)\" \r\n\t\t\tpoints=\"${x+34.8} ${y+111} ${x+25.7} ${y+115.7} ${x+32.8} ${y+118.8} ${x+41} ${y+113}\"/>`\r\n\r\n\t\treturn { html: treeHtml }\r\n\t}\r\n}","import { Color } from './colors.component'\r\nimport { TileType } from './enums/tile-type.enum'\r\nimport { TileOptions } from './interfaces/tile-options.interface'\r\n\r\nexport class Tile {\r\n\t\r\n\t_id: number\r\n\t_x: number\r\n\t_y: number\r\n\t_h: number\r\n\t_tileType: TileType\r\n\t_tileColor: Color\r\n\t_options?: TileOptions\r\n\r\n\tconstructor(\r\n\t\t\tid: number,\r\n\t\t\tx: number,\r\n\t\t\ty: number,\r\n\t\t\th: number,\r\n\t\t\ttileType: TileType,\r\n\t\t\ttileColor: Color,\r\n\t\t\toptions?: TileOptions)\r\n\t{\r\n\t\tthis._id = id\r\n\t\tthis._x = x\r\n\t\tthis._y = y\r\n\t\tthis._h = h\r\n\t\tthis._tileType = tileType\r\n\t\tthis._tileColor = tileColor\r\n\r\n\t\tif (options) {\r\n\t\t\tthis._options = options\r\n\t\t}\r\n\t}\r\n\r\n\tget id(): number {\r\n\t\treturn this._id\r\n\t}\r\n\r\n\tget x(): number {\r\n\t\treturn this._x\r\n\t}\r\n\r\n\tget y(): number {\r\n\t\treturn this._y\r\n\t}\r\n\r\n\tget h(): number {\r\n\t\treturn this._h\r\n\t}\r\n\r\n\tget type(): TileType {\r\n\t\treturn this._tileType\r\n\t}\r\n\r\n\tget options(): TileOptions | undefined {\r\n\t\tif (this._options) {\r\n\t\t\treturn this._options\r\n\t\t} else {\r\n\t\t\treturn undefined\r\n\t\t}\r\n\t}\r\n\r\n\tget tileColor(): Color {\r\n\t\treturn this._tileColor\r\n\t}\r\n\r\n\tset tileColor(color: Color) {\r\n\t\tthis._tileColor = color\r\n\t}\r\n\r\n\tset type(type: TileType) {\r\n\t\tthis._tileType = type\r\n\t}\r\n}"]}
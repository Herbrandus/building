{"version":3,"sources":["node_modules/browser-pack/_prelude.js","bundle.min.js","src/ts/builder.component.ts","src/ts/config.component.ts","src/ts/main.ts","src/ts/mapGenerationFunctions.component.ts","src/ts/mapper.component.ts","src/ts/modifiers.component.ts","src/ts/primitives.component.ts","src/ts/renderelements.component.ts","src/ts/tile.component.ts"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","Object","defineProperty","value","mapGenerationFunctions_component_1","config_component_1","renderelements_component_1","Renderer","[object Object]","this","config","Config","calculations","MapGenerationFunctions","render","RenderElements","map","html","mapWidth","mapLength","tileWidth","tileLength","htmlMap","getMapWidth","y","halfWay","Math","round","x","getColumn","isDefined","tileTopColor","getTopTile","getColor","rgb","tileColor","edge","top","right","bottom","left","blockGroup","height","mapToBuild","mapTotalWidth","mapTotalLength","testTile","createTile","yDeviation","coords","tileHalfWidthLeft","tileHalfWidthRight","tileHalfLengthTop","mapLengthTop","mapLengthBottom","mapWidthPx","mapLengthPx","topMargin","detailsHtml","lastTile","startTileX","thisPosY","thisPosX","newTile","newData","h","tile","createBlock","tileHeight","tileStack","allowDebug","debugInfo","id","xPos","yPos","corner","createSlopeBlock","getTile","./config.component","./mapGenerationFunctions.component","./renderelements.component","2","_allowDebug","_tileWidth","_tileLength","_tileHeight","_tileSmallAngle","_tileLargeAngle","_groundColor","Color","_buildingBaseColor","floor","random","_tileEdgeBleed","_maxAllowedHeight","_topMargin","tileSmallAngle","tileLargeAngle","groundColor","buildingBaseColor","tileEdgeBleed","maxAllowedHeight","mapArrayWidth","mapArrayLength","3","mapper_component_1","builder_component_1","RandomBuilding","_builder","_map","Map","document","querySelector","style","background","hex","build2DMap","addToBuilding","buildMap","col","getFirstDefinedColumn","console","log","building","setColors","color","getBaseColor","shade0","changeColorLightingString","shade1","colorDivs","getColorStringByHue","innerHTML","colorMap","drawTileMap","addEventListener","classList","remove","querySelectorAll","forEach","item","parentElement","toggle","addToBuildingAndRedraw","./builder.component","./mapper.component","4","smallAngle","largeAngle","maximumBlockIterations","blockWidth","blockHeight","smallOuterAngle","largeOuterAngle","horizontalWidthFromBottom","getHorizontalBottomShortestWidth","verticalHeightFromBottom","getVerticalBottomShortestHeight","horizontalWidthFromTop","getHorizontalTopLongestWidth","verticalHeightFromTop","getVerticalTopLongestHeight","totalWidth","totalHeight","diagonalWidth","sin","toRadians","diagonalHeight","cos","angle","PI","TileColor","BuildingHeightVariations","params","error","validateHex","hexColor","charAt","setHex","hexToRgb","convertToHSL","validateRgb","setRgb","rgbToHex","toString","g","b","_colorRgb","s","l","_colorHsl","hexadecimal","hexVal1","hexVal2","hexVal3","_colorHex","match","hexValues","substr","split","hexPair1","parseInt","hexPair2","hexPair3","hexR","Number","hexG","hexB","amount","newR","newG","newB","hue","newHue","convertHSLtoRGB","convertRGBtoHex","cmin","min","cmax","max","delta","abs","toFixed","m","5","tile_component_1","primitives_component_1","modifiers_component_1","mapMaxHeight","mapEdgeWidth","averageBuildingSize","pyramid","mapGen","primitives","Primitives","mods","Modifiers","_blockHeightVariationLabels","TallCenter","TallSurrounds","Random","_blockHeightVariation","_mapWidth","_mapLength","_mapMaxHeight","_mapEdgeWidth","_averageBuildingSize","_blockHeight","_maximumBlockIterations","_additionalBlockIterations","calculateAdditionalBlockIterations","_blockGroups","_blockEdges","_blockHeightsArray","_mapHalfLength","_blockIdIterator","_blockAmountIterator","_blockHeightIterator","_decorationLineH","newLineHue","lineColor","_defaultColor","_lineColor","changeColorLighting","mapLengthHalf","startblockLength","startblockWidth","startblockXfromCenter","startblockLengthHalf","startingPositionX","_world","firstBlockHeight","hollowBuildingBlock","thisBlockGroup","column","Column","xConditions","thisPillar","thisWindowed","isRoof","push","Tile","TileType","Body","roof","pillar","windowed","tower","indexOf","setEdges","hasEdge","addBuildingComponent","clearMapEdges","mirrorMap","mapHalfLength","blockGroups","maxBlockIterations","blockAmountIterator","blockEdges","blockHeightsArray","heightsArray","blockIdIterator","blockHeightVariation","lineHeight","defaultColor","decorativeColors","considerLowerEdges","pos","defined","colX","colY","colHeight","_edge","_tileStack","_defined","_x","_y","_height","groupNum","_blockGroup","_corner","tiles","./modifiers.component","./primitives.component","./tile.component","6","world","oldBlockGroups","activeCol","isTower","tileType","getEdges","nextHeight","ceil","randomNum","randomEdgePoint","creationPoint","nextBlockWidth","nextBlockLength","yStartOffset","yConditions","createCol","warn","7","8","tileW","tileL","tileH","bleed","dimensions","calculateStraightLinesFromIsometricSquare","regularColor","regularDarkerColor","regularLighterColor","shadowLight","shadowHighlight","shadow","highlight","almostDarkestColor","almostLightestColor","darkestColor","lightestColor","pointTop","pointLeft","pointBottom","pointRight","leftWallLeftTop","leftWallLeftBottom","leftWallRightBottom","leftWallRightTop","rightWallLeftTop","rightWallLeftBottom","rightWallRightBottom","rightWallRightTop","blockTopLeft","slopeDirection","blockTopBottom","blockTopRight","blockTopTop","blockRightBottom","blockRightRight","blockRightTop","blockLeftLeft","blockLeftBottom","blockLeftTop","blockBottomLeft","blockBottomRight","blockBottomTop","9","options","_options","_id","_h","_tileType","_tileColor","type","None"],"mappings":"CAAA,SAAAA,EAAAC,EAAAC,EAAAC,GAAA,SAAAC,EAAAC,EAAAC,GAAA,IAAAJ,EAAAG,GAAA,CAAA,IAAAJ,EAAAI,GAAA,CAAA,IAAAE,EAAA,mBAAAC,SAAAA,QAAA,IAAAF,GAAAC,EAAA,OAAAA,EAAAF,GAAA,GAAA,GAAAI,EAAA,OAAAA,EAAAJ,GAAA,GAAA,IAAAK,EAAA,IAAAC,MAAA,uBAAAN,EAAA,KAAA,MAAAK,EAAAE,KAAA,mBAAAF,EAAA,IAAAG,EAAAX,EAAAG,GAAA,CAAAS,QAAA,IAAAb,EAAAI,GAAA,GAAAU,KAAAF,EAAAC,QAAA,SAAAd,GAAA,OAAAI,EAAAH,EAAAI,GAAA,GAAAL,IAAAA,IAAAa,EAAAA,EAAAC,QAAAd,EAAAC,EAAAC,EAAAC,GAAA,OAAAD,EAAAG,GAAAS,QAAA,IAAA,IAAAL,EAAA,mBAAAD,SAAAA,QAAAH,EAAA,EAAAA,EAAAF,EAAAa,OAAAX,IAAAD,EAAAD,EAAAE,IAAA,OAAAD,EAAA,CAAA,CAAAa,EAAA,CAAA,SAAAT,EAAAU,EAAAJ,GCCA,aACAK,OAAOC,eAAeN,EAAS,aAAc,CAAEO,OAAO,ICFtD,MAAAC,EAAAd,EAAA,sCAGAe,EAAAf,EAAA,sBACAgB,EAAAhB,EAAA,8BAEAM,EAAAW,SAAA,MAMCC,cAJQC,KAAAC,OAAiB,IAAIL,EAAAM,OACrBF,KAAAG,aAAuC,IAAIR,EAAAS,uBAC3CJ,KAAAK,OAAyB,IAAIR,EAAAS,eAIrCP,SAASQ,GAER,IAAIC,EAAO,yBAKX,OAJAA,iBAAsBD,EAAIE,iCAAiCF,EAAIG,sBAC/DF,kBAAuBR,KAAKC,OAAOU,6BAA6BX,KAAKC,OAAOW,iBAC5EJ,GAAQ,SAKTT,WAAWQ,GAEV,IAAIM,mCAA2Cb,KAAKC,OAAOa,YAAYP,EAAIE,SAAS,UAEpFI,0CAAkDb,KAAKC,OAAOU,sBAAsBX,KAAKC,OAAOW,wBAEhG,IAAK,IAAIlC,EAAI,EAAGA,EAAI6B,EAAIE,SAAU/B,IACjCmC,0CAAkDb,KAAKC,OAAOU,sBAAsBX,KAAKC,OAAOW,kBAAkBlC,UAGnH,IAAK,IAAIqC,EAAI,EAAGA,EAAIR,EAAIG,UAAWK,IAAK,CAEvC,IAAIC,EAAU,GAEVD,IAAME,KAAKC,MAAMX,EAAIG,UAAY,KACpCM,EAAU,SAGXH,2BAAmCG,mBAAyBhB,KAAKC,OAAOU,sBAAsBX,KAAKC,OAAOW,kBAAkBG,UAE5H,IAAK,IAAII,EAAI,EAAGA,EAAIZ,EAAIE,SAAUU,IAIjC,GAFAN,sBAA8BG,mBAAyBhB,KAAKC,OAAOU,sBAAsBX,KAAKC,OAAOW,gBAEjGL,EAAIa,UAAUD,EAAGJ,GAAGM,UAAW,CAElC,IACIC,EADOf,EAAIgB,WAAWJ,EAAGJ,GACLS,WAAWC,MAC/BC,SAAmBJ,EAAgB,MAAMA,EAAgB,MAAMA,EAAgB,KAE/EK,KAAQpB,EAAIA,IAAIQ,GAAGI,GAAGQ,KAAKC,KAAOrB,EAAIA,IAAIQ,GAAGI,GAAGQ,KAAKE,OAAStB,EAAIA,IAAIQ,GAAGI,GAAGQ,KAAKG,QAAUvB,EAAIA,IAAIQ,GAAGI,GAAGQ,KAAKI,MAC9GC,EAAazB,EAAIA,IAAIQ,GAAGI,GAAGa,WAE/BnB,uBAA+Ba,+BAAuCP,QAAQJ,gBAAgBR,EAAIA,IAAIQ,GAAGI,GAAGc,mBAAmBN,eAAkBK,qBAIjJnB,GAAW,WAOd,OAFAA,GAAW,SAKZd,SAASmC,GAER,IAAIC,EAAgBD,EAAWzB,SAC3B2B,EAAiBF,EAAWxB,UAE5B2B,EAAWrC,KAAKK,OAAOiC,WAAW,EAAG,GAGrCC,GADaF,EAASG,OAAOV,OAAOX,EAAIkB,EAASG,OAAOZ,IAAIT,EAC/CkB,EAASG,OAAOX,MAAMd,EAAIsB,EAASG,OAAOT,KAAKhB,GAC5D0B,EAAoBJ,EAASG,OAAOZ,IAAIT,EAAIkB,EAASG,OAAOT,KAAKZ,EACjEuB,EAAqBL,EAASG,OAAOX,MAAMV,EAAIkB,EAASG,OAAOZ,IAAIT,EAGnEwB,EAAoBN,EAASG,OAAOX,MAAMd,EAE1C6B,EAAeD,EAAoBR,EACnCU,GAFuBR,EAASG,OAAOV,OAAOf,EAAIsB,EAASG,OAAOX,MAAMd,GAE/BqB,EACzCU,EAAa7B,KAAKC,OAAOuB,EAAoBC,GAAsB,GACnEK,EAAc9B,KAAKC,MAAM0B,EAAeC,GAAmB7C,KAAKC,OAAO+C,UAE3E,MAAMzC,EAAM2B,EAAW3B,IAEvB,IAAI0C,EAAc,GACdzC,EAAO,eAAesC,EAAW,aAAaC,EAAY,KAE1DG,EAAW,KACXC,EAAaV,GAAqBN,EAAgB,GAEtD,IAAK,IAAIpB,EAAI,EAAGA,EAAIqB,EAAgBrB,IAEnC,IAAK,IAAII,EAAI,EAAGA,EAAIgB,EAAehB,IAAK,CAEvC,IAAIiC,EAAW,EACXC,EAAW,EAEL,IAANlC,GAAiB,IAANJ,IACdsC,EAAWF,GAGI,MAAZD,IACHE,EAAWF,EAASV,OAAOX,MAAMd,GAG9BA,EAAI,GAAW,IAANI,IACZkC,EAAWF,EAAcV,EAAoB1B,EAC7CqC,EAAYT,EAAoB5B,EAAMwB,EAAaxB,GAGhDI,EAAI,IACPkC,EAAYH,EAASV,OAAOX,MAAMV,GAAK+B,EAASV,OAAOX,MAAMV,EAAI+B,EAASV,OAAOV,OAAOX,IAGzF,IAAImC,EAAUtD,KAAKK,OAAOiC,WAAWe,EAAUD,GAC3CG,EAAU,GAEd,GAAIhD,EAAIQ,GAAGI,GAAGE,UAEb,IAAK,IAAImC,EAAI,EAAGA,EAAIjD,EAAIQ,GAAGI,GAAGc,OAAQuB,IAAK,CAC1C,IAAIC,EAAOzD,KAAKK,OAAOqD,YAAYL,EAAUD,EAAUpD,KAAKC,OAAO0D,WAAYpD,EAAIQ,GAAGI,GAAGyC,UAAUJ,IAGnG,GAFAD,GAAWE,EAAKjD,KAEZR,KAAKC,OAAO4D,YACXL,IAAMjD,EAAIQ,GAAGI,GAAGc,OAAS,EAAG,CAC/B,IAAI6B,cAAwB3C,SAASJ,oDAAoDR,EAAIQ,GAAGI,GAAGa,wBAAwBzB,EAAIQ,GAAGI,GAAGa,4BAA4BzB,EAAIQ,GAAGI,GAAGyC,UAAUJ,GAAGO,UAAUP,WAClMP,4CAAwD1C,EAAIQ,GAAGI,GAAGa,4BAA4ByB,EAAKjB,OAAOZ,IAAIT,aAAasC,EAAKjB,OAAOZ,IAAIb,GAAKf,KAAKC,OAAO0D,WAAaH,EAAE,mCAAmCM,WAMlNtD,GAAQ+C,EAERL,EAAWI,EAQb,MAAO,mBAAqBL,EAAc,UAJ1CzC,GAAQ,UAOTT,eAAeQ,EAAYY,EAAWJ,EAAWyC,EAAWQ,EAAcC,GAEzE,IAAIR,EAAO,KA0BX,OAvBCA,EADGlD,EAAIQ,GAAGI,GAAGQ,KAAKC,MAAQrB,EAAIQ,GAAGI,GAAG+C,QAAUV,IAAMjD,EAAIQ,GAAGI,GAAGc,OAAO,EAC9DjC,KAAKK,OAAO8D,iBAAiBH,EAAMC,EAAOjE,KAAKC,OAAO0D,WAAYpD,EAAIQ,GAAGI,GAAGiD,QAAQZ,GAAI,KACrFjD,EAAIQ,GAAGI,GAAGQ,KAAKG,SAAWvB,EAAIQ,GAAGI,GAAG+C,QAAUV,IAAMjD,EAAIQ,GAAGI,GAAGc,OAAO,EACxEjC,KAAKK,OAAO8D,iBAAiBH,EAAMC,EAAOjE,KAAKC,OAAO0D,WAAYpD,EAAIQ,GAAGI,GAAGiD,QAAQZ,GAAI,KACrFjD,EAAIQ,GAAGI,GAAGQ,KAAKE,QAAUtB,EAAIQ,GAAGI,GAAG+C,QAAUV,IAAMjD,EAAIQ,GAAGI,GAAGc,OAAO,EACvEjC,KAAKK,OAAO8D,iBAAiBH,EAAMC,EAAOjE,KAAKC,OAAO0D,WAAYpD,EAAIQ,GAAGI,GAAGiD,QAAQZ,GAAI,KACrFjD,EAAIQ,GAAGI,GAAGQ,KAAKI,OAASxB,EAAIQ,GAAGI,GAAG+C,QAAUV,IAAMjD,EAAIQ,GAAGI,GAAGc,OAAO,EACtEjC,KAAKK,OAAO8D,iBAAiBH,EAAMC,EAAOjE,KAAKC,OAAO0D,WAAYpD,EAAIQ,GAAGI,GAAGiD,QAAQZ,GAAI,KAExFxD,KAAKK,OAAOqD,YAAYM,EAAMC,EAAOjE,KAAKC,OAAO0D,WAAYpD,EAAIQ,GAAGI,GAAGiD,QAAQZ,IAGnFjD,EAAIQ,GAAGI,GAAG+C,QAAUV,IAAMjD,EAAIQ,GAAGI,GAAGc,OAAO,IAC1C1B,EAAIQ,GAAGI,GAAGQ,KAAKC,KAAOrB,EAAIQ,GAAGI,GAAGQ,KAAKI,KACxC0B,EAAOzD,KAAKK,OAAO8D,iBAAiBH,EAAMC,EAAOjE,KAAKC,OAAO0D,WAAYpD,EAAIQ,GAAGI,GAAGiD,QAAQZ,GAAI,MACrFjD,EAAIQ,GAAGI,GAAGQ,KAAKC,KAAOrB,EAAIQ,GAAGI,GAAGQ,KAAKE,MAC/C4B,EAAOzD,KAAKK,OAAO8D,iBAAiBH,EAAMC,EAAOjE,KAAKC,OAAO0D,WAAYpD,EAAIQ,GAAGI,GAAGiD,QAAQZ,GAAI,MACrFjD,EAAIQ,GAAGI,GAAGQ,KAAKG,QAAUvB,EAAIQ,GAAGI,GAAGQ,KAAKI,KAClD0B,EAAOzD,KAAKK,OAAO8D,iBAAiBH,EAAMC,EAAOjE,KAAKC,OAAO0D,WAAYpD,EAAIQ,GAAGI,GAAGiD,QAAQZ,GAAI,MACrFjD,EAAIQ,GAAGI,GAAGQ,KAAKG,QAAUvB,EAAIQ,GAAGI,GAAGQ,KAAKE,QAClD4B,EAAOzD,KAAKK,OAAO8D,iBAAiBH,EAAMC,EAAOjE,KAAKC,OAAO0D,WAAYpD,EAAIQ,GAAGI,GAAGiD,QAAQZ,GAAI,QAI1FC,KDvCP,CAACY,qBAAqB,EAAEC,qCAAqC,EAAEC,6BAA6B,IAAIC,EAAE,CAAC,SAAS3F,EAAQU,EAAOJ,GAC7H,aACAK,OAAOC,eAAeN,EAAS,aAAc,CAAEO,OAAO,IEjJtD,MAAAC,EAAAd,EAAA,sCAEAM,EAAAe,OAAA,MAAAH,cAESC,KAAAyE,aAAuB,EACvBzE,KAAA0E,WAAqB,GACrB1E,KAAA2E,YAAsB,GACtB3E,KAAA4E,YAAsB,GACtB5E,KAAA6E,gBAA0B,GAC1B7E,KAAA8E,gBAA0B,IAC1B9E,KAAA+E,aAAsB,IAAIpF,EAAAqF,MAAM,UAChChF,KAAAiF,mBAA4B,IAAItF,EAAAqF,MACvC,IAAM/D,KAAKiE,MAAsB,GAAhBjE,KAAKkE,UACtB,IAAMlE,KAAKiE,MAAsB,GAAhBjE,KAAKkE,UACtB,IAAMlE,KAAKiE,MAAsB,GAAhBjE,KAAKkE,WAEfnF,KAAAoF,eAAyB,GACzBpF,KAAAqF,kBAA4B,GAC5BrF,KAAAsF,WAAqB,GAE7BzB,iBACC,OAAO7D,KAAKyE,YAGb9D,gBACC,OAAOX,KAAK0E,WAGb9D,iBACC,OAAOZ,KAAK2E,YAGbhB,iBACC,OAAO3D,KAAK4E,YAGbW,qBACC,OAAOvF,KAAK6E,gBAGbW,qBACC,OAAOxF,KAAK8E,gBAGbW,kBACC,OAAOzF,KAAK+E,aAGbW,wBACC,OAAO1F,KAAKiF,mBAGbU,oBACC,OAAO3F,KAAKoF,eAGbQ,uBACC,OAAO5F,KAAKqF,kBAGbrC,gBACC,OAAOhD,KAAKsF,WAGNvF,YAAY8F,GAClB,OAAOA,EAAgB7F,KAAK0E,WAGtB3E,aAAa+F,GACnB,OAAOA,EAAiB9F,KAAK2E,eFqI7B,CAACL,qCAAqC,IAAIyB,EAAE,CAAC,SAASlH,EAAQU,EAAOJ,GACvE,aACAK,OAAOC,eAAeN,EAAS,aAAc,CAAEO,OAAO,IG5MtD,MAAAsG,EAAAnH,EAAA,sBACAoH,EAAApH,EAAA,uBAEAe,EAAAf,EAAA,sBAEA,MAAMqH,EAMLnG,cAHQC,KAAAmG,SAAqB,IAAIF,EAAAnG,SACzBE,KAAAC,OAAiB,IAAIL,EAAAM,OAG5BF,KAAKoG,KAAO,IAAIJ,EAAAK,IAAI,GAAI,GAAI,GAAI,EAAG,EAAG,EAAG,GAAG,GAC5CC,SAASC,cAAc,QAAQC,MAAMC,WAAazG,KAAKC,OAAOwF,YAAYiB,MAGpE3G,QACN,OAAOC,KAAKC,OAAO4D,WAGpBtD,UACC,OAAOP,KAAKoG,KAGNrG,WACN,OAAOC,KAAKmG,SAASQ,WAAW3G,KAAKoG,MAG/BrG,yBAEN,OADAC,KAAKoG,KAAKQ,gBACH5G,KAAKmG,SAASQ,WAAW3G,KAAKoG,MAG/BrG,cACN,OAAOC,KAAKmG,SAASU,SAAS7G,KAAKoG,MAG7BrG,eAEN,MAAM+G,EAAM9G,KAAKO,IAAIwG,wBACftD,EAAOqD,EAAIlD,UAAUkD,EAAIlD,UAAUvE,OAAO,GAIhD,OAFA2H,QAAQC,IAAIxD,GAELA,EAAKjC,YAId,IAAI0F,EAAW,IAAIhB,EA8CnB,SAASiB,EAAUD,GAElB,MAAME,EAAQF,EAASG,eACjBC,EAASF,EAAMG,0BAA0B,GACzCC,EAASJ,EAAMG,0BAA0B,IAQzCE,GAPSL,EAAMG,2BAA2B,8DAQID,oEACAE,oEARrCJ,EAAMM,oBAAoB,sEAC1BN,EAAMM,oBAAoB,uEAC1BN,EAAMM,oBAAoB,uEAC1BN,EAAMM,oBAAoB,uEAC1BN,EAAMM,oBAAoB,iBAWzCpB,SAASC,cAAc,iBAAiBoB,UAAYF,EAlErDnB,SAASC,cAAc,UAAUoB,UAAYT,EAASU,WACtDtB,SAASC,cAAc,cAAcoB,UAAYT,EAASW,cAE1DV,EAAUD,GAEVZ,SAASC,cAAc,aAAauB,iBAAiB,QAAS,KAC7DZ,EAAW,IAAIhB,EACfI,SAASC,cAAc,UAAUoB,UAAYT,EAASU,WACtDtB,SAASC,cAAc,cAAcoB,UAAYT,EAASW,cAC1DvB,SAASC,cAAc,gBAAgBwB,UAAUC,OAAO,UAExD1B,SAAS2B,iBAAiB,UAAUC,QAASC,IAC5CA,EAAKL,iBAAiB,QAAS,KAC9Bd,QAAQC,IAAI,UAAWkB,GACvBA,EAAKC,cAAcL,UAAUM,OAAO,cAItClB,EAAUD,KAGXZ,SAASC,cAAc,WAAWuB,iBAAiB,QAAS,KAC3DZ,EAASoB,yBACThC,SAASC,cAAc,UAAUoB,UAAYT,EAASU,WACtDtB,SAASC,cAAc,cAAcoB,UAAYT,EAASW,cAC1DvB,SAASC,cAAc,gBAAgBwB,UAAUC,OAAO,UAExD1B,SAAS2B,iBAAiB,eAAeC,QAASC,IACjDA,EAAKL,iBAAiB,QAAS,KAC9BK,EAAKJ,UAAUM,OAAO,gBAKzB/B,SAASC,cAAc,gBAAgBuB,iBAAiB,QAAS,KAChExB,SAASC,cAAc,UAAUwB,UAAUM,OAAO,QAClD/B,SAASC,cAAc,gBAAgBwB,UAAUM,OAAO,YAGzD/B,SAAS2B,iBAAiB,eAAeC,QAASC,IACjDA,EAAKL,iBAAiB,QAAS,KAC9BK,EAAKJ,UAAUM,OAAO,eH6MtB,CAACE,sBAAsB,EAAElE,qBAAqB,EAAEmE,qBAAqB,IAAIC,EAAE,CAAC,SAAS5J,EAAQU,EAAOJ,GACtG,aACAK,OAAOC,eAAeN,EAAS,aAAc,CAAEO,OAAO,IIzStD,MAAAE,EAAAf,EAAA,sBAEAM,EAAAiB,uBAAA,MAMCL,cAJQC,KAAAC,OAAiB,IAAIL,EAAAM,OAC7BF,KAAA0I,WAAa1I,KAAKC,OAAOsF,eACzBvF,KAAA2I,WAAa3I,KAAKC,OAAOuF,eAIlBzF,mCAAmC6I,GACzC,OAAO,EAAI3H,KAAKiE,MAAMjE,KAAKkE,SAAWyD,GAIhC7I,0CAA2C8I,EAAoBC,GAarE,IAAIC,GAAmB,IAAM/I,KAAK0I,YAAc,EAC5CM,GAAmB,IAAMhJ,KAAK2I,YAAc,EAE5CM,EAA4BjJ,KAAKkJ,iCAAiCL,EAAYE,GAC9EI,EAA2BnJ,KAAKoJ,gCAAgCH,EAA2BF,GAE3FM,EAAyBrJ,KAAKsJ,6BAA6BR,EAAaE,GACxEO,EAAwBvJ,KAAKwJ,4BAA4BH,EAAwBL,GAKrF,MAAO,CAAES,WAFQR,EAA4BI,EAG1CK,YAJeP,EAA2BI,EAK1CN,0BAA6BA,EAC7BI,uBAA0BA,EAC1BF,yBAA4BA,EAC5BI,sBAAyBA,GAKtBxJ,iCAAkC4J,EAAuBjB,GAC/D,OAAOiB,EAAgB1I,KAAK2I,IAAI5J,KAAK6J,UAAUnB,IAGzC3I,gCAAiC+J,EAAwBpB,GAC/D,OAAOoB,EAAiB7I,KAAK8I,IAAI/J,KAAK6J,UAAUnB,IAG1C3I,6BAA8B4J,EAAuBhB,GAC3D,OAAOgB,EAAgB1I,KAAK2I,IAAI5J,KAAK6J,UAAUlB,IAGzC5I,4BAA6B+J,EAAwBnB,GAC3D,OAAOmB,EAAiB7I,KAAK8I,IAAI/J,KAAK6J,UAAUlB,IAGjD5I,UAAWiK,GACV,OAAOA,GAAS/I,KAAKgJ,GAAK,OAI5B,SAAYC,GACXA,EAAAA,EAAA,IAAM,IAAMjJ,KAAKiE,MAAsB,GAAhBjE,KAAKkE,WAAc,MAC1C+E,EAAAA,EAAA,MAAQ,IAAMjJ,KAAKiE,MAAsB,GAAhBjE,KAAKkE,WAAc,QAC5C+E,EAAAA,EAAA,KAAO,IAAMjJ,KAAKiE,MAAsB,GAAhBjE,KAAKkE,WAAc,OAH5C,CAAYhG,EAAA+K,YAAA/K,EAAA+K,UAAS,KAMrB,SAAYC,GACXA,EAAA,WAAA,aACAA,EAAA,cAAA,gBACAA,EAAA,OAAA,SAHD,CAAYhL,EAAAgL,2BAAAhL,EAAAgL,yBAAwB,KAMpChL,EAAA6F,MAAA,MAKCjF,eAAeqK,GACd,IAAIC,EAAQ,KACZ,GAAsB,IAAlBD,EAAO/K,OACV,GAAyB,iBAAd+K,EAAO,GACjB,GAAIpK,KAAKsK,YAAYF,EAAO,IAAK,CAChC,IAAIG,EAAWH,EAAO,GACK,MAAvBG,EAASC,OAAO,KACnBD,MAAeA,KAEhBvK,KAAKyK,OAAOF,GACZvK,KAAK0K,WACL1K,KAAK2K,oBAELN,EAAQ,sCAGTA,EAAQ,wDAEmB,IAAlBD,EAAO/K,SACbW,KAAK4K,YAAYR,IACpBpK,KAAK6K,OAAOT,EAAO,GAAIA,EAAO,GAAIA,EAAO,IACzCpK,KAAK8K,WACL9K,KAAK2K,gBAELN,EAAQ,+BAIV,GAAc,OAAVA,EACH,KAAM,4BAA8BA,EAAQ,KAAOD,EAAOW,WAIrDhL,OAAO1B,EAAW2M,EAAWC,GACnCjL,KAAKkL,UAAY,CAAC7M,EAAGA,EAAG2M,EAAGA,EAAGC,EAAGA,GAG3BlL,OAAOyD,EAAW2H,EAAWC,GACnCpL,KAAKqL,UAAY,CAAC7H,EAAGA,EAAG2H,EAAGA,EAAGC,EAAGA,GAG3BrL,OAAOuL,GACb,GAAIA,EAAYjM,OAAS,EAAG,CAC3B,IAAIkM,EAAUD,EAAYd,OAAO,GAC7BgB,EAAUF,EAAYd,OAAO,GAC7BiB,EAAUH,EAAYd,OAAO,GACjCc,EAAc,IAAMC,EAAUA,EAAUC,EAAUA,EAAUC,EAAUA,EAEvEzL,KAAK0L,UAAYJ,EAGXvL,MACN,OAAOC,KAAKkL,UAGNnL,MACN,OAAOC,KAAK0L,UAGN3L,MACN,OAAOC,KAAKqL,UAGbtL,YAAY0B,GACX,OAAIA,EAAI,IAAM,GAAKA,EAAI,GAAK,KAC3BA,EAAI,IAAM,GAAKA,EAAI,GAAK,KACxBA,EAAI,IAAM,GAAKA,EAAI,GAAK,IAO1B1B,YAAY2G,GAEX,QAAIA,EAAIiF,MADI,uCAQb5L,WACC,IAAI6L,EAAsB5L,KAAK0L,UAAUG,OAAO,GAAGC,MAAM,IACrDC,EAAWC,SAASJ,EAAU,GAAGA,EAAU,GAAI,IAC/CK,EAAWD,SAASJ,EAAU,GAAGA,EAAU,GAAI,IAC/CM,EAAWF,SAASJ,EAAU,GAAGA,EAAU,GAAI,IACnD5L,KAAK6K,OAAOkB,EAAUE,EAAUC,GAChClM,KAAK8K,WAGN/K,WACC,GAA8B,iBAAnBC,KAAKkL,UAAwB,CACvC,IAAI7M,EAAI2B,KAAKkL,UAAU7M,EACnB4M,EAAIjL,KAAKkL,UAAUD,EACnBD,EAAIhL,KAAKkL,UAAUF,EACnBmB,EAAOC,OAAO/N,GAAG0M,SAAS,IAC1BsB,EAAOD,OAAOpB,GAAGD,SAAS,IAC1BuB,EAAOF,OAAOnB,GAAGF,SAAS,IAC9B/K,KAAK0L,UAAY,IAAMS,EAAOE,EAAOC,GAIvCvM,gBAAgBqH,GACf,IAAI/I,EAAI+I,EAAM/I,EACV4M,EAAI7D,EAAM6D,EACVD,EAAI5D,EAAM4D,EAId,MAAO,IAHIoB,OAAO/N,GAAG0M,SAAS,IACnBqB,OAAOpB,GAAGD,SAAS,IACnBqB,OAAOnB,GAAGF,SAAS,IAIxBhL,0BAA0BwM,GAChC,IAAIlO,EAAI2B,KAAKkL,UAAU7M,EACnB4M,EAAIjL,KAAKkL,UAAUD,EAEnBuB,EAAOnO,EAAIkO,EACXE,EAFIzM,KAAKkL,UAAUF,EAERuB,EACXG,EAAOzB,GAAKsB,EAAS,GAUzB,OATIC,EAAO,MAAKA,EAAO,KACnBC,EAAO,MAAKA,EAAO,KACnBD,EAAO,MAAKA,EAAO,KAKV,IAHFJ,OAAOI,GAAMzB,SAAS,IACtBqB,OAAOK,GAAM1B,SAAS,IACtBqB,OAAOM,GAAM3B,SAAS,IAM3BhL,oBAAoBwM,GAC1B,IAAIlO,EAAI2B,KAAKkL,UAAU7M,EAGnBmO,GAFIxM,KAAKkL,UAAUD,EAEZ5M,EAAIkO,GACXE,EAFIzM,KAAKkL,UAAUF,EAERuB,EAUf,OARIC,EAAO,MAAKA,EAAO,KACnBC,EAAO,MAAKA,EAAO,KACnBD,EAAO,MAAKA,EAAO,KAEvBxM,KAAK6K,OAAO2B,EAAMC,EAAMD,GACxBxM,KAAK8K,WACL9K,KAAK2K,eAEE3K,KAGDD,iBACN,IAAI1B,EAAI2B,KAAKkL,UAAU7M,EACnB4M,EAAIjL,KAAKkL,UAAUD,EAEnBuB,EAAOnO,EAAI,GACXoO,EAFIzM,KAAKkL,UAAUF,EAER,GAKf,OAHIwB,EAAO,MAAKA,EAAO,KACnBC,EAAO,MAAKA,EAAO,KACnBD,EAAO,MAAKA,EAAO,KAChB,CAACnO,EAAGmO,EAAMxB,EAAGyB,EAAMxB,EAJfA,EAAI,IAOTlL,mBACN,IAAI1B,EAAI2B,KAAKkL,UAAU7M,EACnB4M,EAAIjL,KAAKkL,UAAUD,EAEnBuB,EAAOnO,EAAI,GACXoO,EAFIzM,KAAKkL,UAAUF,EAER,GAKf,OAHIwB,EAAO,MAAKA,EAAO,KACnBC,EAAO,MAAKA,EAAO,KACnBD,EAAO,MAAKA,EAAO,KAChB,CAACnO,EAAGmO,EAAMxB,EAAGyB,EAAMxB,EAJfA,EAAI,IAOTlL,sBACN,IAAI1B,EAAI2B,KAAKkL,UAAU7M,EACnB4M,EAAIjL,KAAKkL,UAAUD,EAEnBuB,EAAOnO,EAAI,GACXoO,EAFIzM,KAAKkL,UAAUF,EAER,GAKf,OAHIwB,EAAO,MAAKA,EAAO,KACnBC,EAAO,MAAKA,EAAO,KACnBD,EAAO,MAAKA,EAAO,KAChB,CAACnO,EAAGmO,EAAMxB,EAAGyB,EAAMxB,EAJfA,EAAI,GAOTlL,mBACN,IAAI1B,EAAI2B,KAAKkL,UAAU7M,EACnB4M,EAAIjL,KAAKkL,UAAUD,EAEnBuB,EAAOnO,EAAI,GACXoO,EAFIzM,KAAKkL,UAAUF,EAER,GAKf,OAHIwB,EAAO,MAAKA,EAAO,KACnBC,EAAO,MAAKA,EAAO,KACnBD,EAAO,MAAKA,EAAO,KAChB,CAACnO,EAAGmO,EAAMxB,EAAGyB,EAAMxB,EAJfA,EAAI,IAOTlL,gBACN,IAAI1B,EAAI2B,KAAKkL,UAAU7M,EACnB4M,EAAIjL,KAAKkL,UAAUD,EAEnBuB,EAAOnO,EAAI,GACXoO,EAFIzM,KAAKkL,UAAUF,EAER,GAKf,OAHIwB,EAAO,IAAGA,EAAO,GACjBC,EAAO,IAAGA,EAAO,GACjBD,EAAO,IAAGA,EAAO,GACd,CAACnO,EAAGmO,EAAMxB,EAAGyB,EAAMxB,EAJfA,EAAI,IAOTlL,gBACN,IAAI1B,EAAI2B,KAAKkL,UAAU7M,EACnB4M,EAAIjL,KAAKkL,UAAUD,EAEnBuB,EAAOnO,EAAI,GACXoO,EAFIzM,KAAKkL,UAAUF,EAER,GAKf,OAHIwB,EAAO,IAAGA,EAAO,GACjBC,EAAO,IAAGA,EAAO,GACjBD,EAAO,IAAGA,EAAO,GACd,CAACnO,EAAGmO,EAAMxB,EAAGyB,EAAMxB,EAJfA,EAAI,IAOTlL,oBAAoB4M,GAE1B,IAAInJ,EAAIxD,KAAKqL,UAAU7H,EACtB2H,EAAInL,KAAKqL,UAAUF,EACnBC,EAAIpL,KAAKqL,UAAUD,EAEhBwB,EAASpJ,EAAImJ,EAEbC,EAAS,MACZA,GAAkB,KAGnB,IAAInL,EAAMzB,KAAK6M,gBAAgB,CAACrJ,EAAGoJ,EAAQzB,EAAGA,EAAGC,EAAGA,IAEpD,OAAOpL,KAAK8M,gBAAgBrL,GAGtB1B,cAAc4M,GAEpB,IAAInJ,EAAIxD,KAAKqL,UAAU7H,EACtB2H,EAAInL,KAAKqL,UAAUF,EACnBC,EAAIpL,KAAKqL,UAAUD,EAEhBwB,EAASpJ,EAAImJ,EAEbC,EAAS,MACZA,GAAkB,KAGnB,IAAInL,EAAMzB,KAAK6M,gBAAgB,CAACrJ,EAAGoJ,EAAQzB,EAAGA,EAAGC,EAAGA,IAKpD,OAHApL,KAAK6K,OAAOpJ,EAAIpD,EAAGoD,EAAIuJ,EAAGvJ,EAAIwJ,GAC9BjL,KAAK8K,WAEE9K,KAGRD,eACC,IAAI1B,EAAI2B,KAAKkL,UAAU7M,EACnB4M,EAAIjL,KAAKkL,UAAUD,EACnBD,EAAIhL,KAAKkL,UAAUF,EAEvB3M,GAAK,IACL2M,GAAK,IACLC,GAAK,IAEL,IAAI8B,EAAO9L,KAAK+L,IAAI3O,EAAE2M,EAAEC,GACvBgC,EAAOhM,KAAKiM,IAAI7O,EAAE2M,EAAEC,GACpBkC,EAAQF,EAAOF,EACfvJ,EAAI,EACJ2H,EAAI,EACJC,EAAI,EAIJ5H,EADa,IAAV2J,EACC,EACMF,IAAS5O,GACb2M,EAAIC,GAAKkC,EAAS,EACdF,IAASjC,GACdC,EAAI5M,GAAK8O,EAAQ,GAEjB9O,EAAI2M,GAAKmC,EAAQ,GAGvB3J,EAAIvC,KAAKC,MAAU,GAAJsC,IAEP,IACPA,GAAK,KAIN4H,GAAK6B,EAAOF,GAAQ,EAKpB5B,IAAU,KAFVA,EAAc,IAAVgC,EAAc,EAAIA,GAAS,EAAIlM,KAAKmM,IAAI,EAAIhC,EAAI,MAErCiC,QAAQ,GACvBjC,IAAU,IAAJA,GAASiC,QAAQ,GAEvBrN,KAAKqL,UAAY,CAAE7H,EAAGA,EAAG2H,EAAGA,EAAGC,EAAGA,GAGnCrL,gBAAgBqH,GAEf,IAAI5D,EAAI4D,EAAM5D,EACV2H,EAAI/D,EAAM+D,EACVC,EAAIhE,EAAMgE,EAEdD,GAAK,IACLC,GAAK,IAEL,IAAIxM,GAAK,EAAIqC,KAAKmM,IAAI,EAAIhC,EAAI,IAAMD,EACnChK,EAAIvC,GAAK,EAAIqC,KAAKmM,IAAK5J,EAAI,GAAM,EAAI,IACrC8J,EAAIlC,EAAIxM,EAAI,EACZP,EAAI,EACJ2M,EAAI,EACJC,EAAI,EAoBL,OAlBI,GAAKzH,GAAKA,EAAI,IACjBnF,EAAIO,EAAGoM,EAAI7J,EAAG8J,EAAI,GACR,IAAMzH,GAAKA,EAAI,KACzBnF,EAAI8C,EAAG6J,EAAIpM,EAAGqM,EAAI,GACR,KAAOzH,GAAKA,EAAI,KAC1BnF,EAAI,EAAG2M,EAAIpM,EAAGqM,EAAI9J,GACR,KAAOqC,GAAKA,EAAI,KAC1BnF,EAAI,EAAG2M,EAAI7J,EAAG8J,EAAIrM,GACR,KAAO4E,GAAKA,EAAI,KAC1BnF,EAAI8C,EAAG6J,EAAI,EAAGC,EAAIrM,GACR,KAAO4E,GAAKA,EAAI,MAC1BnF,EAAIO,EAAGoM,EAAI,EAAGC,EAAI9J,GAOZ,CAAC9C,EAJRA,EAAI4C,KAAKC,MAAgB,KAAT7C,EAAIiP,IAINtC,EAHdA,EAAI/J,KAAKC,MAAgB,KAAT8J,EAAIsC,IAGArC,EAFpBA,EAAIhK,KAAKC,MAAgB,KAAT+J,EAAIqC,QJ2PpB,CAACjJ,qBAAqB,IAAIkJ,EAAE,CAAC,SAAS1O,EAAQU,EAAOJ,GACvD,aACAK,OAAOC,eAAeN,EAAS,aAAc,CAAEO,OAAO,IK3qBtD,MAAAC,EAAAd,EAAA,sCACA2O,EAAA3O,EAAA,oBACAe,EAAAf,EAAA,sBACA4O,EAAA5O,EAAA,0BACA6O,EAAA7O,EAAA,yBAEAM,EAAAkH,IAAA,MA+BCtG,YACEU,EACAC,EACAiN,EACAC,EACAC,EACA/E,EACAF,EACAkF,GArCM9N,KAAA+N,OAAiC,IAAIpO,EAAAS,uBACrCJ,KAAAC,OAAiB,IAAIL,EAAAM,OACrBF,KAAAgO,WAAyB,IAAIP,EAAAQ,WAC7BjO,KAAAkO,KAAkB,IAAIR,EAAAS,UAiBtBnO,KAAAoO,4BAA8B,CAACzO,EAAAwK,yBAAyBkE,WAAY1O,EAAAwK,yBAAyBmE,cAAe3O,EAAAwK,yBAAyBoE,QACrIvO,KAAAwO,sBAAwBxO,KAAKoO,4BAA4BnN,KAAKiE,MAAsB,EAAhBjE,KAAKkE,WAkBhFnF,KAAKyO,UAAYhO,EACjBT,KAAK0O,WAAahO,EAClBV,KAAK2O,cAAgBhB,EACrB3N,KAAK4O,cAAgBhB,EACrB5N,KAAK6O,qBAAuBhB,EAC5B7N,KAAK8O,aAAehG,EACpB9I,KAAK+O,wBAA0BnG,EAC/B5I,KAAKgP,2BAA6BhP,KAAK+N,OAAOkB,mCAAmCrG,GACjF5I,KAAKkP,aAAe,GACpBlP,KAAKmP,YAAc,GACnBnP,KAAKoP,mBAAqB,GAC1BpP,KAAKqP,eAAiBpO,KAAKiE,MAAMxE,EAAY,GAC7CV,KAAKsP,iBAAmB,EACxBtP,KAAKuP,qBAAuB,EAC5BvP,KAAKwP,qBAAuB,EAC5BxP,KAAKyP,kBAAoB,EACzB,IAAIC,EAAa1P,KAAKC,OAAOyF,kBAAkBgC,qBAAqB,KAChEiI,EAAY,IAAIhQ,EAAAqF,MAAM0K,GAC1B1P,KAAK4P,cAAgB,IAAIjQ,EAAAqF,MAAMhF,KAAKC,OAAOyF,kBAAkBgB,OAC7D1G,KAAK6P,WAAaF,EAAUG,qBAAqB,IAEjD,IAAIC,EAAgB9O,KAAKiE,MAAMxE,EAAY,GAGvCsP,GAFe/O,KAAKiE,MAAMzE,EAAW,GAElBT,KAAK6O,qBAAuB5N,KAAKiE,MAAsB,EAAhBjE,KAAKkE,WAC/D8K,EAAkBjQ,KAAK6O,qBAAuB5N,KAAKiE,MAAsB,EAAhBjE,KAAKkE,UAC9D+K,EAAwB,EAAIjP,KAAKiE,MAHA,EAGMjE,KAAKkE,UAC5CgL,EAAuBlP,KAAKiE,MAAM8K,EAAmB,GAErDI,GADsBnP,KAAKiE,MAAM+K,EAAkB,GAC/BhP,KAAKiE,MAAMlF,KAAKyO,UAAY,GAAKxN,KAAKiE,MAAMgL,EAAwB,IAE5FlQ,KAAKqQ,OAAS,GACd,IACIC,EAEAtQ,KAAKwO,wBAA0B7O,EAAAwK,yBAAyBkE,WAC3DiC,EAAuC,EAApBtQ,KAAK8O,aACd9O,KAAKwO,wBAA0B7O,EAAAwK,yBAAyBmE,eAClEgC,EAAmB,EAAIrP,KAAKC,MAAMD,KAAKkE,UACvCnF,KAAK8O,aAAewB,GAEpBA,EAAmBtQ,KAAK8O,aAAe7N,KAAKC,MAAsB,EAAhBD,KAAKkE,UAGpDmL,EAAmB,EACtBtQ,KAAKyP,iBAAmB,EACda,EAAmB,IAC7BtQ,KAAKyP,iBAAmB,GAGzBzI,QAAQC,IAAI,gBACZD,QAAQC,IAAI,eAAgBjH,KAAK6P,YAEjC7P,KAAK8O,aAAewB,EAEpB,IAAIC,EAAqD,IAA9BtP,KAAKC,MAAMD,KAAKkE,UAE3C,IAAK,IAAIpE,EAAI,EAAGA,EAAIf,KAAKU,UAAWK,IAAK,CAExCf,KAAKqQ,OAAOtP,GAAK,GAEjB,IAAK,IAAII,EAAI,EAAGA,EAAInB,KAAKS,SAAUU,IAAK,CAEvC,IAAIqP,EAAiB,EAEjBC,EAAS,IAAIC,GAAO,EAAOvP,EAAGJ,EAAG,GAGjC4P,EAAexP,EAAIiP,GAAqBjP,GAAMiP,EAAoBH,EAEtE,GAHmBlP,GAAKgP,GAAiBhP,GAAMgP,EAAgBI,GAK1DQ,EAAa,CAEhBH,EAAiB,EACjB,IAAI5M,EAAY,GAEhB,IAAK,IAAIJ,EAAI,EAAGA,EAAI8M,EAAkB9M,IAAK,CAE1C,IAAIoN,EAAa,EACbC,EAAe,EACfC,EAAUtN,IAAM8M,EAAiB,EACjC5O,EAAY1B,KAAK4P,cAGpBlO,EADG8B,IAAMxD,KAAKyP,iBACFzP,KAAK6P,WAEL7P,KAAK4P,cAGlBhM,EAAUmN,KACT,IAAIvD,EAAAwD,KACHhR,KAAKsP,iBACLnO,EACAJ,EACAyC,EACAgK,EAAAyD,SAASC,KACTxP,EACA,CACCyP,KAAUL,EACVM,OAAYR,EACZS,SAAaR,EACbS,OAAW,MAIqC,IAA/CtR,KAAKkP,aAAaqC,QAAQf,IAC7BxQ,KAAKkP,aAAa6B,KAAKP,GAGxBxQ,KAAKoP,mBAAmB2B,KAAKT,GAE7BtQ,KAAKsP,oBAGNmB,EAAS,IAAIC,GAAO,EAAMvP,EAAGJ,EAAGuP,IAEzBtO,WAAawO,EACpBC,EAAOxO,OAASqO,EAChBG,EAAOvM,QAAS,EAChBuM,EAAO7M,UAAYA,EAIrB5D,KAAKqQ,OAAOtP,GAAGI,GAAKsP,GAOtB,GAHAzQ,KAAKwR,UAAS,GAGVjB,EAEH,IAAK,IAAIxP,EAAI,EAAGA,EAAIf,KAAKU,UAAWK,IACnC,IAAK,IAAII,EAAI,EAAGA,EAAInB,KAAKS,SAAUU,IAAK,CAEvC,IAAIsQ,KAAWzR,KAAKqQ,OAAOtP,GAAGI,GAAGQ,KAAKI,MAAQ/B,KAAKqQ,OAAOtP,GAAGI,GAAGQ,KAAKG,QAAU9B,KAAKqQ,OAAOtP,GAAGI,GAAGQ,KAAKE,OAElG7B,KAAKqQ,OAAOtP,GAAGI,GAAGE,YAAcoQ,IACnCzR,KAAKqQ,OAAOtP,GAAGI,GAAK,IAAIuP,GAAO,EAAOvP,EAAGJ,EAAG,IAMhD,IAAK,IAAIrC,EAAI,EAAGA,EAAIsB,KAAKgP,2BAA4BtQ,IACpDsB,KAAKqQ,OAASrQ,KAAKkO,KAAKwD,qBAAqB1R,MAG9CA,KAAKqQ,OAASrQ,KAAKkO,KAAKyD,cAAc3R,MACtCA,KAAKqQ,OAASrQ,KAAKkO,KAAK0D,UAAU5R,MAClCA,KAAKwR,UAAS,GAEdxK,QAAQC,IAAIjH,KAAKqQ,QAGlB5P,eACC,OAAOT,KAAKyO,UAGb/N,gBACC,OAAOV,KAAK0O,WAGbmD,oBACC,OAAO7R,KAAKqP,eAGbzB,mBACC,OAAO5N,KAAK4O,cAGbrO,UACC,OAAOP,KAAKqQ,OAGbyB,kBACC,OAAO9R,KAAKkP,aAGb4C,gBAAgBA,GACf9R,KAAKkP,aAAe4C,EAGrBhJ,kBACC,OAAO9I,KAAK8O,aAGbnB,mBACC,OAAO3N,KAAK2O,cAGb7F,gBAAgB7G,GACfjC,KAAK8O,aAAe7M,EAGrB8P,yBACC,OAAO/R,KAAK+O,wBAGbiD,0BACC,OAAOhS,KAAKuP,qBAGbyC,wBAAwBtT,GACvBsB,KAAKuP,qBAAuB7Q,EAG7BmP,0BACC,OAAO7N,KAAK6O,qBAGboD,iBACC,OAAOjS,KAAKmP,YAGb8C,eAAeA,GACdjS,KAAKmP,YAAc8C,EAGpBC,wBACC,OAAOlS,KAAKoP,mBAGb8C,sBAAsBC,GACrBnS,KAAKoP,mBAAqB+C,EAG3BC,sBACC,OAAOpS,KAAKsP,iBAGb8C,oBAAoB1T,GACnBsB,KAAKsP,iBAAmB5Q,EAGzB2T,2BACC,OAAOrS,KAAKwO,sBAGb8D,iBACC,OAAOtS,KAAKyP,iBAGb8C,mBACC,OAAOvS,KAAK4P,cAGb4C,uBACC,MAAO,CAAE7C,UAAW3P,KAAK6P,YAGnB9P,UAAUoB,EAAGJ,GACnB,OAAOf,KAAKqQ,OAAOtP,GAAGI,GAGhBpB,SAASoB,EAAGJ,GAClB,OAAOf,KAAKqQ,OAAOtP,GAAGI,GAAGyC,UAGnB7D,QAAQoB,EAAGJ,EAAGyC,GACpB,OAAOxD,KAAKqQ,OAAOtP,GAAGI,GAAGiD,QAAQZ,GAG3BzD,WAAWoB,EAAGJ,GACpB,IAAIkB,EAASjC,KAAKqQ,OAAOtP,GAAGI,GAAGc,OAC/B,OAAOjC,KAAKqQ,OAAOtP,GAAGI,GAAGiD,QAAQnC,EAAO,GAGlClC,wBACN,IAAI0Q,EAEJ,IAAK,IAAI1P,EAAI,EAAGA,EAAIf,KAAKU,UAAWK,IACnC,IAAK,IAAII,EAAI,EAAGA,EAAInB,KAAKS,SAAUU,IAClC,GAAInB,KAAKqQ,OAAOtP,GAAGI,GAAGE,UAAW,CAChCoP,EAASzQ,KAAKqQ,OAAOtP,GAAGI,GACxB,MAKH,OAAOsP,EAGD1Q,gBACNC,KAAKqQ,OAASrQ,KAAKkO,KAAKwD,qBAAqB1R,MAC7CA,KAAKqQ,OAASrQ,KAAKkO,KAAK0D,UAAU5R,MAClCA,KAAKqQ,OAASrQ,KAAKkO,KAAKyD,cAAc3R,MACtCA,KAAKwR,UAAS,GAGfzR,SAAS0S,GAER,IAAK,IAAI1R,EAAI,EAAGA,EAAIf,KAAKU,UAAWK,IACnC,IAAK,IAAII,EAAI,EAAGA,EAAInB,KAAKS,SAAUU,IAE9BJ,EAAI,GAAKI,EAAI,GAAKJ,EAAIf,KAAKU,UAAY,GAAKS,EAAInB,KAAKS,SAAW,GAAKT,KAAKqQ,OAAOtP,GAAGI,GAAGE,YAEtFoR,IAECzS,KAAKqQ,OAAOtP,EAAE,GAAGI,GAAGc,OAASjC,KAAKqQ,OAAOtP,GAAGI,GAAGc,QAAgB,IAANlB,KAC5Df,KAAKqQ,OAAOtP,GAAGI,GAAGQ,KAAKC,KAAM,IAG1B5B,KAAKqQ,OAAOtP,EAAE,GAAGI,GAAGc,OAASjC,KAAKqQ,OAAOtP,GAAGI,GAAGc,QAAUlB,IAAMf,KAAKU,UAAY,KACnFV,KAAKqQ,OAAOtP,GAAGI,GAAGQ,KAAKG,QAAS,GAG7B9B,KAAKqQ,OAAOtP,GAAGI,EAAE,GAAGc,OAASjC,KAAKqQ,OAAOtP,GAAGI,GAAGc,SAClDjC,KAAKqQ,OAAOtP,GAAGI,GAAGQ,KAAKI,MAAO,GAG3B/B,KAAKqQ,OAAOtP,GAAGI,EAAE,GAAGc,OAASjC,KAAKqQ,OAAOtP,GAAGI,GAAGc,SAClDjC,KAAKqQ,OAAOtP,GAAGI,GAAGQ,KAAKE,OAAQ,KAK3B7B,KAAKqQ,OAAOtP,EAAE,GAAGI,GAAGE,WAAmB,IAANN,IACrCf,KAAKqQ,OAAOtP,GAAGI,GAAGQ,KAAKC,KAAM,GAGzB5B,KAAKqQ,OAAOtP,EAAE,GAAGI,GAAGE,WAAaN,IAAMf,KAAKU,UAAY,IAC5DV,KAAKqQ,OAAOtP,GAAGI,GAAGQ,KAAKG,QAAS,GAG5B9B,KAAKqQ,OAAOtP,GAAGI,EAAE,GAAGE,YACxBrB,KAAKqQ,OAAOtP,GAAGI,GAAGQ,KAAKI,MAAO,GAG1B/B,KAAKqQ,OAAOtP,GAAGI,EAAE,GAAGE,YACxBrB,KAAKqQ,OAAOtP,GAAGI,GAAGQ,KAAKE,OAAQ,KAI3B7B,KAAKqQ,OAAOtP,GAAGI,GAAGQ,KAAU,KAAK3B,KAAKqQ,OAAOtP,GAAGI,GAAGQ,KAAY,OAClE3B,KAAKqQ,OAAOtP,GAAGI,GAAGQ,KAAU,KAAK3B,KAAKqQ,OAAOtP,GAAGI,GAAGQ,KAAW,MAC9D3B,KAAKqQ,OAAOtP,GAAGI,GAAGQ,KAAa,QAAK3B,KAAKqQ,OAAOtP,GAAGI,GAAGQ,KAAY,OAClE3B,KAAKqQ,OAAOtP,GAAGI,GAAGQ,KAAa,QAAK3B,KAAKqQ,OAAOtP,GAAGI,GAAGQ,KAAW,QACnE3B,KAAKqQ,OAAOtP,GAAGI,GAAG+C,QAAS,IAOzBnE,WAENC,KAAKmP,YAAc,GAEnB,IAAK,IAAIpO,EAAI,EAAGA,EAAIf,KAAK0O,WAAY3N,IAGpC,GAAIA,EAAIf,KAAKqP,eAAiB,EAAIrP,KAAKuP,sBAAwBxO,EAAIf,KAAK0O,WAAa,EAEpF,IAAK,IAAIvN,EAAI,EAAGA,EAAInB,KAAKyO,UAAWtN,IAEnC,GAAIA,EAAInB,KAAK4O,eAAiBzN,EAAInB,KAAKyO,UAAY,GAE9CzO,KAAKqQ,OAAOtP,GAAGI,GAAGE,aAEhBrB,KAAKqQ,OAAOtP,GAAGI,EAAE,GAAGE,WACvBrB,KAAKqQ,OAAOtP,GAAGI,EAAE,GAAGE,WACpBrB,KAAKqQ,OAAOtP,EAAE,GAAGI,GAAGE,WACpBrB,KAAKqQ,OAAOtP,EAAE,GAAGI,EAAE,GAAGE,WACtBrB,KAAKqQ,OAAOtP,EAAE,GAAGI,EAAE,GAAGE,WAAW,CAE9BN,EAAIf,KAAK0O,WAAa,IACzB3N,EAAIf,KAAK0O,WAAa,GAGvB,IAAIgE,EAAgB,CAACvR,EAAGA,EAAGJ,EAAGA,GAE9Bf,KAAKmP,YAAY4B,KAAK2B,GAQ5B,OAAO1S,KAAKmP,cAId,MAAauB,EAWZ3Q,YAAoB4S,EAA0BC,EAAsBC,EAAsBC,GAAtE9S,KAAA2S,QAAAA,EAA0B3S,KAAA4S,KAAAA,EAAsB5S,KAAA6S,KAAAA,EAAsB7S,KAAA8S,UAAAA,EAHlF9S,KAAA+S,MAAgB,CAAEnR,KAAO,EAAOC,OAAS,EAAOC,QAAU,EAAOC,MAAQ,GACzE/B,KAAAgT,WAAqB,GAG5BhT,KAAKiT,SAAWN,EAChB3S,KAAKkT,GAAKN,EACV5S,KAAKmT,GAAKN,EACV7S,KAAKoT,QAAUN,EAGhB3R,MAAMA,GACLnB,KAAKkT,GAAK/R,EAGXJ,MAAMA,GACLf,KAAKmT,GAAKpS,EAGXkB,WAAWA,GACVjC,KAAKoT,QAAUnR,EAGhBD,eAAeqR,GACdrT,KAAKsT,YAAcD,EAGpBnP,WAAWA,GACVlE,KAAKuT,QAAUrP,EAGhBvC,SAASA,GACR3B,KAAK+S,MAAQpR,EAGdiC,cAAc4P,GACbxT,KAAKgT,WAAaQ,EAGnBnS,gBACC,OAAOrB,KAAKiT,SAGb9R,QACC,OAAOnB,KAAKkT,GAGbnS,QACC,OAAOf,KAAKmT,GAGblR,aACC,OAAOjC,KAAKoT,QAGbpR,iBACC,OAAOhC,KAAKsT,YAGbpP,aACC,OAAOlE,KAAKuT,QAGb5R,WACC,OAAO3B,KAAK+S,MAGbnP,gBACC,OAAO5D,KAAKgT,WAGNjT,QAAQkC,GACd,OAAOjC,KAAKgT,WAAW/Q,IA/EzB9C,EAAAuR,OAAAA,GLumBE,CAACrM,qBAAqB,EAAEC,qCAAqC,EAAEmP,wBAAwB,EAAEC,yBAAyB,EAAEC,mBAAmB,IAAIC,EAAE,CAAC,SAAS/U,EAAQU,EAAOJ,GACxK,aACAK,OAAOC,eAAeN,EAAS,aAAc,CAAEO,OAAO,IMzhCtD,MAAAsG,EAAAnH,EAAA,sBACAc,EAAAd,EAAA,sCACA2O,EAAA3O,EAAA,oBACAe,EAAAf,EAAA,sBAEAM,EAAAgP,UAAA,MAAApO,cAESC,KAAAC,OAAiB,IAAIL,EAAAM,OAE7BH,UAAU8T,GAET,IAAIC,EAAiB,GACrBD,EAAM/B,YAAY5J,QAAQnE,IACzB+P,EAAe/C,KAAKhN,KAGrB,IAAK,IAAIhD,EAAI,EAAGA,EAAI8S,EAAMhC,cAAe9Q,IACxC,GAAIA,EAAI8S,EAAMhC,cAEb,IAAK,IAAI1Q,EAAI,EAAGA,EAAI0S,EAAMpT,SAAUU,IAEnC,GAAI0S,EAAMtT,IAAIsT,EAAMnT,UAAYK,EAAI,GAAGI,GAAGE,UAAW,CAEpD,IAAI0S,EAAYF,EAAMtT,IAAIsT,EAAMnT,UAAYK,EAAI,GAAGI,GAC/Cc,EAAS8R,EAAU9R,OACnBD,EAAa8R,EAAezU,OAAS0U,EAAU/R,WAE/C4B,EAAY,GAEhB,IAAK,IAAIJ,EAAI,EAAGA,EAAIvB,EAAQuB,IAAK,CAEhC,IAAI9B,EAAYqS,EAAUnQ,UAAUJ,GAAG9B,UACnCkP,EAAamD,EAAUnQ,UAAUJ,GAAG4N,OACpCP,EAAekD,EAAUnQ,UAAUJ,GAAG6N,SACtC2C,EAAUD,EAAUnQ,UAAUJ,GAAG8N,MACjCR,EAAUtN,IAAMvB,EAAO,EAE3B2B,EAAUmN,KACT,IAAIvD,EAAAwD,KACH6C,EAAMzB,gBACNjR,EACAJ,EACAyC,EACAuQ,EAAUnQ,UAAUJ,GAAGyQ,SACvBvS,EACA,CACCyP,KAAUL,EACVM,OAAYR,EACZS,SAAaR,EACbS,MAAW0C,KAIdH,EAAMzB,kBAGPyB,EAAM3B,kBAAkBnB,KAAK9O,IAEkB,IAA3C4R,EAAM/B,YAAYP,QAAQvP,IAC7B6R,EAAM/B,YAAYf,KAAK/O,GAGxB6R,EAAMtT,IAAIQ,GAAGI,GAAK,KAElB,IAAIsP,EAAS,IAAIzK,EAAA0K,QAAO,EAAMvP,EAAGJ,EAAGkB,GAEpCwO,EAAOzO,WAAaA,EACpByO,EAAOxO,OAASA,EAChBwO,EAAOvM,QAAS,EAChBuM,EAAO7M,UAAYA,EAEnBiQ,EAAMtT,IAAIQ,GAAGI,GAAKsP,EAMtB,OAAOoD,EAAMtT,IAGdR,cAAc8T,GAEb,IAAK,IAAI9S,EAAI,EAAGA,EAAI8S,EAAMnT,UAAWK,IACpC,IAAK,IAAII,EAAI,EAAGA,EAAI0S,EAAMpT,SAAUU,IACnC,GAAIA,EAAI0S,EAAMjG,cAAgBzM,GAAK0S,EAAMpT,SAAWoT,EAAMjG,cACzD7M,EAAI8S,EAAMjG,cAAgB7M,GAAK8S,EAAMnT,UAAYmT,EAAMjG,aAAc,CACrEiG,EAAMtT,IAAIQ,GAAGI,GAAK,KAClB,IAAIsP,EAAS,IAAIzK,EAAA0K,QAAO,EAAOvP,EAAGJ,EAAG,GACrC0P,EAAO7M,UAAY,GACnBiQ,EAAMtT,IAAIQ,GAAGI,GAAKsP,EAKrB,OAAOoD,EAAMtT,IAGdR,qBAAqB8T,GAEpB,GAAIA,EAAM7B,oBAAsB6B,EAAM9B,mBAIrC,GAFA8B,EAAM5B,WAAa4B,EAAMK,WAErBL,EAAM5B,WAAW5S,OAAS,EAAG,CAEhC,IAAI8U,EAEJ,GAAIN,EAAMxB,uBAAyB1S,EAAAwK,yBAAyBkE,WAC3D8F,EAAaN,EAAM/K,YAAe+K,EAAyB,yBACrD,GAAIA,EAAMxB,uBAAyB1S,EAAAwK,yBAAyBmE,cAClE6F,EAAaN,EAAM/K,YAAe+K,EAAM7B,oBAAsB/Q,KAAKmT,KAAqB,EAAhBnT,KAAKkE,eACvE,GAAI0O,EAAMxB,uBAAyB1S,EAAAwK,yBAAyBoE,OAAQ,CAC1E,IAAI8F,EAAYpT,KAAKmT,KAAqB,EAAhBnT,KAAKkE,UAG9BgP,EADiB,IADFlT,KAAKC,MAAMD,KAAKkE,WACT0O,EAAM/K,YAAc,EAC7B+K,EAAM/K,YAAcuL,EAEpBR,EAAM/K,YAAcuL,EAI/BF,EAAa,EAChBA,EAAa,EACHA,EAAaN,EAAMlG,eAC7BwG,EAAaN,EAAMlG,cAGpB,IAAI2G,EAAkBrT,KAAKiE,MAAMjE,KAAKkE,SAAW0O,EAAM5B,WAAW5S,QAC9DkV,EAA0BV,EAAM5B,WAAWqC,GAC3CtS,EAAa6R,EAAM/B,YAAYzS,OAAS,EAExCmV,GAD0BvT,KAAKC,MAAMD,KAAKkE,UACxB0O,EAAyB,oBAAK5S,KAAKiE,MAAsB,EAAhBjE,KAAKkE,WAChEsP,EAAmBZ,EAAyB,oBAAK5S,KAAKiE,MAAsB,EAAhBjE,KAAKkE,UACjEuP,EAAe,EAAIzT,KAAKiE,MAAsB,EAAhBjE,KAAKkE,UACnCoL,EAAoD,IAA9BtP,KAAKC,MAAMD,KAAKkE,UAE1C6B,QAAQC,IAAI,iBAAkBuN,GAC9BxN,QAAQC,IAAI,kBAAmBwN,GAG9BlE,GAAsB,EAKvBvJ,QAAQC,IAAI,SAAU4M,EAAM5B,YAC5BjL,QAAQC,IAAI,oBAAqBsN,EAAcxT,GAAK0T,EAAkBC,IACtE1N,QAAQC,IAAI,qBAAsBsN,EAAcxT,EAAI,GACpDiG,QAAQC,IAAI,oBAAqBsN,EAAcpT,EAAKqT,EAAiB,GACrExN,QAAQC,IAAI,qBAAsBsN,EAAcpT,EAAKqT,EAAiB,GAEtE,IAAK,IAAIzT,EAAI,EAAGA,EAAI8S,EAAMnT,UAAWK,IACpC,IAAK,IAAII,EAAI,EAAGA,EAAI0S,EAAMpT,SAAUU,IAAK,CAExC,IAAIwT,EAAcxT,EAAKoT,EAAcpT,EAAKqT,EAAiB,GAAOrT,EAAKoT,EAAcpT,EAAKqT,EAAiB,EACvG7D,EAAe5P,EAAIwT,EAAcxT,EAAI2T,GAAgB3T,EAAIwT,EAAcxT,EAAI0T,EAAkBC,EAEjG,GAAIC,GACChE,EAAa,CAEhB3J,QAAQC,IAAI,mBAAqBlG,GAEjC,IAAI6T,GAAY,EAYhB,GAVIrE,GACCxP,EAAIwT,EAAcxT,EAAI,GAAKA,EAAIwT,EAAcxT,EAAI0T,EAAkB,IACjEtT,EAAKoT,EAAcpT,EAAKqT,EAAiB,GAAOrT,EAAIoT,EAAcpT,EAAKqT,EAAiB,EAAK,GAEhGrT,EAAKoT,EAAcpT,EAAKqT,EAAiB,GAAOrT,EAAIoT,EAAcpT,EAAKqT,EAAiB,EAAK,KAC9FI,GAAY,GAKXA,EAAW,CAEd,IAAIhR,EAAY,GAEhB,IAAK,IAAIJ,EAAI,EAAGA,EAAI2Q,EAAY3Q,IAAK,CAEpC,IAAIoN,EAAa,EACbC,EAAe,EACfC,EAAUtN,IAAM2Q,EAAW,EAC3BzS,EAAYmS,EAAM9M,wBAAwBnD,UAAU,GAAGlC,UAG1DA,EADG8B,IAAMqQ,EAAMvB,WACHuB,EAAMrB,iBAA4B,UAElCqB,EAAMtB,aAGnB3O,EAAUmN,KACT,IAAIvD,EAAAwD,KACH6C,EAAMzB,gBACNjR,EACAJ,EACAyC,EACAgK,EAAAyD,SAASC,KACTxP,EACA,CACCyP,KAAUL,EACVM,OAAYR,EACZS,SAAaR,EACbS,OAAW,KAIduC,EAAM3B,kBAAkBnB,KAAKoD,GAE7BN,EAAMzB,mBAGwC,IAA3CyB,EAAM/B,YAAYP,QAAQvP,IAC7B6R,EAAM/B,YAAYf,KAAK/O,GAGxB6R,EAAMtT,IAAIQ,GAAGI,GAAK,KAElB,IAAIsP,EAAS,IAAIzK,EAAA0K,QAAO,EAAMvP,EAAGJ,EAAGoT,GAEpC1D,EAAOzO,WAAaA,EACpByO,EAAOxO,OAASkS,EAChB1D,EAAOvM,QAAS,EAChBuM,EAAO7M,UAAYA,EAEnBiQ,EAAMtT,IAAIQ,GAAGI,GAAKsP,IAOvBoD,EAAM/K,YAAcqL,EAEpBN,EAAM7B,2BAGNhL,QAAQ6N,KAAK,oCAId7N,QAAQ6N,KAAK,0EAGd,OAAOhB,EAAMtT,ON49Bb,CAAC8D,qBAAqB,EAAEC,qCAAqC,EAAEkE,qBAAqB,EAAEmL,mBAAmB,IAAImB,EAAE,CAAC,SAASjW,EAAQU,EAAOJ,GAC1I,aACAK,OAAOC,eAAeN,EAAS,aAAc,CAAEO,OAAO,IOltCtDP,EAAA8O,WAAA,MAEClO,aAEC,MAAO,CACL,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GACvB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GACvB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GACvB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GACvB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GACvB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GACvB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GACvB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GACvB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GACvB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GACvB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GACvB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,OPstCzB,IAAIgV,EAAE,CAAC,SAASlW,EAAQU,EAAOJ,GACjC,aACAK,OAAOC,eAAeN,EAAS,aAAc,CAAEO,OAAO,IQxuCtD,MAAAE,EAAAf,EAAA,sBACAc,EAAAd,EAAA,sCAGAM,EAAAmB,eAAA,MAAAP,cAESC,KAAAC,OAAiB,IAAIL,EAAAM,OACrBF,KAAAG,aAAuC,IAAIR,EAAAS,uBAE3CJ,KAAAgV,MAAgBhV,KAAKC,OAAOU,UAC5BX,KAAAiV,MAAgBjV,KAAKC,OAAOW,WAC5BZ,KAAAkV,MAAgBlV,KAAKC,OAAO0D,WAC5B3D,KAAAmV,MAAgBnV,KAAKC,OAAO0F,cAC5B3F,KAAAoV,WAAapV,KAAKG,aAAakV,0CAA0CrV,KAAKgV,MAAOhV,KAAKiV,OAE1FjV,KAAA0B,UAAoB1B,KAAKC,OAAOwF,YAAYiB,MAC5C1G,KAAAsV,aAAuBtV,KAAKC,OAAOyF,kBAAkBgB,MACrD1G,KAAAuV,mBAA6BvV,KAAKC,OAAOyF,kBAAkB6B,2BAA2B,IACtFvH,KAAAwV,oBAA8BxV,KAAKC,OAAOyF,kBAAkB6B,0BAA0B,IACtFvH,KAAAyV,YAAsBzV,KAAKC,OAAOyF,kBAAkB6B,2BAA2B,IAC/EvH,KAAA0V,gBAA0B1V,KAAKC,OAAOyF,kBAAkB6B,0BAA0B,IAClFvH,KAAA2V,OAAiB3V,KAAKC,OAAOyF,kBAAkB6B,2BAA2B,IAC1EvH,KAAA4V,UAAoB5V,KAAKC,OAAOyF,kBAAkB6B,0BAA0B,IAC5EvH,KAAA6V,mBAA6B7V,KAAKC,OAAOyF,kBAAkB6B,2BAA2B,IACtFvH,KAAA8V,oBAA8B9V,KAAKC,OAAOyF,kBAAkB6B,0BAA0B,IACtFvH,KAAA+V,aAAuB/V,KAAKC,OAAOyF,kBAAkB6B,2BAA2B,IAChFvH,KAAAgW,cAAwBhW,KAAKC,OAAOyF,kBAAkB6B,0BAA0B,IAExFxH,WAAWiE,EAAcC,GAExB,IAAIrC,EAAgB,CAAET,EAAM6C,EAAOhE,KAAKoV,WAAW/L,uBAAyBtI,EAAKkD,GAC7ElC,EAAiB,CAAEZ,EAAK6C,EAAMjD,EAAMkD,EAAOjE,KAAKoV,WAAW7L,uBAC3DzH,EAAmB,CAAEX,EAAM6C,EAAOhE,KAAKoV,WAAWnM,0BAA4BlI,EAAMkD,EAAOjE,KAAKoV,WAAW1L,aAC3G7H,EAAkB,CAAEV,EAAM6C,EAAOhE,KAAKoV,WAAW3L,WAAa1I,EAAMkD,EAAOjE,KAAKoV,WAAWjM,0BAE3F8M,KAAcrU,EAAIT,KAAKS,EAAIb,EAAEf,KAAKmV,QAClCe,KAAenU,EAAKZ,EAAEnB,KAAKmV,SAASpT,EAAKhB,IACzCoV,KAAiBrU,EAAOX,KAAKW,EAAOf,EAAEf,KAAKmV,QAC3CiB,KAAgBvU,EAAMV,EAAEnB,KAAKmV,SAAStT,EAAMd,IAWhD,MAAO,CAAEP,oBATiBR,KAAK0B,6BACtBwU,kBACHC,kBACAC,kBACAH,kBACAC,UAIe1T,OAFA,CAAEZ,IAAOA,EAAKG,KAAQA,EAAMD,OAAUA,EAAQD,MAASA,IAK7E9B,YAAYiE,EAAcC,EAAcR,GAEvC,IAGI6R,EACAM,EACAG,EALAhS,EAAKN,EAAKM,GACV9B,EAAUwB,EAAKD,EAAIxD,KAAKkV,MAASlV,KAAKkV,MAMtCzR,EAAK/B,UAAUgF,QAAU1G,KAAKC,OAAOyF,kBAAkBgB,OAC1D4O,EAAe7R,EAAK/B,UAAUgF,MAC9BkP,EAAYnS,EAAK/B,UAAU6F,0BAA0B,IACrDwO,EAAetS,EAAK/B,UAAU6F,2BAA2B,MAEzD+N,EAAetV,KAAKC,OAAOyF,kBAAkBgB,MAC7CkP,EAAY5V,KAAKC,OAAOyF,kBAAkB6B,0BAA0B,IACpEwO,EAAe/V,KAAKC,OAAOyF,kBAAkB6B,2BAA2B,KAGzE,IAAI3F,EAAgB,CAAET,EAAKF,KAAKmT,KAAKpQ,EAAOhE,KAAKoV,WAAW/L,wBAAyBtI,EAAKE,KAAKmT,KAAKnQ,EAAOjE,KAAKC,OAAO+C,YACnHjB,EAAiB,CAAEZ,EAAKF,KAAKmT,KAAKpQ,GAAOjD,EAAKE,KAAKmT,KAAKnQ,EAAOjE,KAAKoV,WAAW7L,sBAAwBvJ,KAAKC,OAAO+C,YACnHlB,EAAmB,CAAEX,EAAKF,KAAKmT,KAAKpQ,EAAOhE,KAAKoV,WAAWnM,2BAA4BlI,EAAKE,KAAKmT,KAAKnQ,EAAOjE,KAAKoV,WAAW1L,YAAc1J,KAAKC,OAAO+C,YACvJnB,EAAkB,CAAEV,EAAKF,KAAKmT,KAAKpQ,EAAOhE,KAAKoV,WAAW3L,YAAa1I,EAAKE,KAAKmT,KAAKnQ,EAAOjE,KAAKoV,WAAWjM,yBAA2BnJ,KAAKC,OAAO+C,YAEpJqT,KAAqBtU,EAAKZ,EAAEnB,KAAKmV,SAASpT,EAAKhB,EAAEkB,EAAOjC,KAAKkV,QAC7DoB,KAAwBvU,EAAKZ,EAAEnB,KAAKmV,SAASpT,EAAKhB,EAAEkB,EAAOjC,KAAKmV,QAChEoB,KAAyBzU,EAAOX,KAAKW,EAAOf,EAAEkB,EAAOjC,KAAKmV,QAC1DqB,KAAsB1U,EAAOX,KAAKW,EAAOf,EAAEkB,EAAOjC,KAAKkV,QAEvDuB,KAAsB3U,EAAOX,KAAKW,EAAOf,EAAEkB,EAAOjC,KAAKkV,QACvDwB,KAAyB5U,EAAOX,KAAKW,EAAOf,EAAEkB,EAAOjC,KAAKmV,QAC1DwB,KAA0B9U,EAAMV,EAAEnB,KAAKmV,SAAStT,EAAMd,EAAEkB,EAAOjC,KAAKmV,QACpEyB,KAAuB/U,EAAMV,EAAEnB,KAAKmV,SAAStT,EAAMd,EAAEkB,EAAOjC,KAAKkV,QAEjE2B,KAAkB9U,EAAKZ,EAAEnB,KAAKmV,SAASpT,EAAKhB,EAAEkB,EAAOjC,KAAKkV,QA0B9D,MAAO,CAAE1U,0BArBuBuD,mBAAoBgS,qBAC3CM,kBACHC,kBACAC,kBACAC,kBACAH,kCACWf,qBACRmB,kBACHC,kBACAC,kBACAC,kBACAH,kCACWb,qBACRiB,qBAjBe/U,EAAOX,KAAKW,EAAOf,EAAEkB,EAAOjC,KAAKkV,2BAClCrT,EAAMV,EAAEnB,KAAKmV,SAAStT,EAAMd,EAAEkB,EAAOjC,KAAKkV,2BAC5CtT,EAAIT,KAAKS,EAAIb,EAAEkB,EAAOjC,KAAKkV,wBAmB1C2B,cAIerU,OAFA,CAAEZ,IAAOA,EAAKG,KAAQA,EAAMD,OAAUA,EAAQD,MAASA,IAK7E9B,iBAAiBiE,EAAcC,EAAcR,EAAYqT,GAExD,IAAI/S,EAAKN,EAAKM,GACV9B,EAAUwB,EAAKD,EAAIxD,KAAKkV,MAASlV,KAAKkV,MAEtCtT,EAAgB,CAAET,EAAKF,KAAKmT,KAAKpQ,EAAOhE,KAAKoV,WAAW/L,wBAAyBtI,EAAKE,KAAKmT,KAAKnQ,IAChGlC,EAAiB,CAAEZ,EAAKF,KAAKmT,KAAKpQ,GAAOjD,EAAKE,KAAKmT,KAAKnQ,EAAOjE,KAAKoV,WAAW7L,wBAC/EzH,EAAmB,CAAEX,EAAKF,KAAKmT,KAAKpQ,EAAOhE,KAAKoV,WAAWnM,2BAA4BlI,EAAKE,KAAKmT,KAAKnQ,EAAOjE,KAAKoV,WAAW1L,cAC7H7H,EAAkB,CAAEV,EAAKF,KAAKmT,KAAKpQ,EAAOhE,KAAKoV,WAAW3L,YAAa1I,EAAKE,KAAKmT,KAAKnQ,EAAOjE,KAAKoV,WAAWjM,2BAE7G3I,EAAO,GACPgC,EAAiB,CAAEZ,IAAOA,EAAKG,KAAQA,EAAMD,OAAUA,EAAQD,MAASA,GAE5E,GAAuB,MAAnBiV,EAAwB,CAE3B,IAAIT,KAAqBtU,EAAKZ,EAAEnB,KAAKmV,SAASpT,EAAKhB,EAAEkB,EAAOjC,KAAKkV,QAC7DoB,KAAwBvU,EAAKZ,EAAEnB,KAAKmV,SAASpT,EAAKhB,EAAEkB,EAAOjC,KAAKmV,QAChEoB,KAAyBzU,EAAOX,KAAKW,EAAOf,EAAEkB,EAAOjC,KAAKmV,QAC1DqB,KAAsB1U,EAAOX,KAAKW,EAAOf,EAAEkB,EAAOjC,KAAKkV,QAEvDuB,KAAsB3U,EAAOX,KAAKW,EAAOf,EAAEkB,EAAOjC,KAAKkV,QACvDwB,KAAyB5U,EAAOX,KAAKW,EAAOf,EAAEkB,EAAOjC,KAAKmV,QAC1DwB,KAA0B9U,EAAMV,EAAEnB,KAAKmV,SAAStT,EAAMd,EAAEkB,EAAOjC,KAAKmV,QAEpE0B,KAAkB9U,EAAKZ,EAAEnB,KAAKmV,SAASpT,EAAKhB,EAAEkB,EAAOjC,KAAKkV,QAC1D6B,KAAoBjV,EAAOX,KAAKW,EAAOf,EAAEkB,EAAOjC,KAAKkV,QACrD8B,KAAmBnV,EAAMV,EAAEnB,KAAKmV,SAAStT,EAAMd,EAAEkB,EAAOjC,KAAKmV,QAC7D8B,KAAiBrV,EAAIT,KAAKS,EAAIb,EAAEkB,IAEpCzB,uBAA4BuD,mCACV/D,KAAK2V,8BACbU,sBACHC,sBACAC,sBACAC,sBACAH,sCACWrW,KAAKsV,oCACbmB,qBACHC,qBACAC,qBACAF,sCACWzW,KAAKgW,qCACba,qBACHE,qBACAC,qBACAC,qBACAJ,4BAIR,GAAuB,OAAnBC,EAAyB,CAE5B9P,QAAQC,IAAI,aAEZ,IAAIoP,KAAqBtU,EAAKZ,EAAEnB,KAAKmV,SAASpT,EAAKhB,EAAEkB,IACjDqU,KAAwBvU,EAAKZ,EAAEnB,KAAKmV,SAASpT,EAAKhB,EAAEkB,EAAOjC,KAAKmV,QAChEoB,KAAyBzU,EAAOX,KAAKW,EAAOf,EAAEkB,EAAOjC,KAAKkV,MAAMlV,KAAKmV,QAErE0B,KAAkB9U,EAAKZ,EAAEnB,KAAKmV,SAASpT,EAAKhB,EAAEkB,EAAOjC,KAAKmV,QAC1D4B,KAAoBjV,EAAOX,KAAKW,EAAOf,EAAEkB,EAAOjC,KAAKkV,MAAMlV,KAAKmV,QAChE8B,KAAiBrV,EAAIT,KAAKS,EAAIb,EAAEkB,IAEhCiV,KAAsBpV,EAAOX,KAAKW,EAAOf,EAAEkB,EAAOjC,KAAKkV,QACvDiC,KAAqBtV,EAAMV,EAAEnB,KAAKmV,SAAStT,EAAMd,EAAEkB,EAAOjC,KAAKmV,QAC/DiC,KAAmBxV,EAAIT,KAAKS,EAAIb,EAAEkB,IAEtCzB,uBAA4BuD,mCACV/D,KAAK+V,oCACbM,qBACHC,qBACAC,qBACAF,sCACWrW,KAAKuV,0CACbsB,qBACHE,qBACAE,qBACAJ,sCACW7W,KAAKgW,qCACbkB,qBACHC,qBACAC,qBACAF,4BAIR,GAAuB,MAAnBJ,EAAwB,CAE3B,IAAIJ,KAAyB5U,EAAOX,KAAKW,EAAOf,EAAEkB,EAAOjC,KAAKmV,QAC1DwB,KAA0B9U,EAAMV,EAAEnB,KAAKmV,SAAStT,EAAMd,EAAEkB,EAAOjC,KAAKmV,QACpEyB,KAAuB/U,EAAMV,EAAEnB,KAAKmV,SAAStT,EAAMd,EAAEkB,EAAOjC,KAAKkV,QAEjE2B,KAAkB9U,EAAKZ,EAAEnB,KAAKmV,SAASpT,EAAKhB,EAAEkB,EAAOjC,KAAKmV,QAC1D4B,KAAoBjV,EAAOX,KAAKW,EAAOf,EAAEkB,EAAOjC,KAAKmV,QACrD6B,KAAmBnV,EAAMV,EAAEnB,KAAKmV,SAAStT,EAAMd,EAAEkB,EAAOjC,KAAKkV,MAAMlV,KAAKmV,QACxE8B,KAAiBrV,EAAIT,KAAKS,EAAIb,EAAEkB,EAAOjC,KAAKkV,QAEhD1U,uBAA4BuD,mCACV/D,KAAKsV,oCACboB,qBACHC,qBACAC,qBACAF,sCACW1W,KAAK2V,8BACbkB,qBACHE,qBACAC,qBACAC,qBACAJ,4BAIR,GAAuB,OAAnBC,EAAyB,CAE5B,IAAIO,KAAmBtV,EAAKZ,EAAEnB,KAAKmV,SAASpT,EAAKhB,EAAEkB,EAAOjC,KAAKmV,QAC3DmC,KAAqBxV,EAAOX,KAAKW,EAAOf,EAAEkB,EAAOjC,KAAKmV,QACtDoC,KAAkB3V,EAAIT,KAAKS,EAAIb,EAAEkB,EAAOjC,KAAKkV,QAE7CgC,KAAsBpV,EAAOX,KAAKW,EAAOf,EAAEkB,EAAOjC,KAAKmV,QACvDgC,KAAqBtV,EAAMV,EAAEnB,KAAKmV,SAAStT,EAAMd,EAAEkB,EAAOjC,KAAKmV,QAC/DiC,KAAmBxV,EAAIT,KAAKS,EAAIb,EAAEkB,EAAOjC,KAAKkV,QAElD1U,uBAA4BuD,iCACX/D,KAAK2V,4BACb0B,mBACHC,mBACAC,mBACAF,oCACWrX,KAAKuV,wCACb4B,mBACHD,mBACAE,mBACAD,0BAIP,GAAuB,MAAnBL,EAAwB,CAE3B,IAAIT,KAAqBtU,EAAKZ,EAAEnB,KAAKmV,SAASpT,EAAKhB,EAAEkB,EAAOjC,KAAKkV,QAC7DoB,KAAwBvU,EAAKZ,EAAEnB,KAAKmV,SAASpT,EAAKhB,EAAEkB,EAAOjC,KAAKmV,QAChEoB,KAAyBzU,EAAOX,KAAKW,EAAOf,EAAEkB,EAAOjC,KAAKmV,QAE1D0B,KAAkB9U,EAAKZ,EAAEnB,KAAKmV,SAASpT,EAAKhB,EAAEkB,EAAOjC,KAAKkV,MAAMlV,KAAKmV,QACrE4B,KAAoBjV,EAAOX,KAAKW,EAAOf,EAAEkB,EAAOjC,KAAKmV,QACrD6B,KAAmBnV,EAAMV,EAAEnB,KAAKmV,SAAStT,EAAMd,EAAEkB,EAAOjC,KAAKmV,QAC7D8B,KAAiBrV,EAAIT,KAAKS,EAAIb,EAAEkB,EAAOjC,KAAKkV,QAEhD1U,uBAA4BuD,mCACV/D,KAAK+V,oCACbM,qBACHC,qBACAC,qBACAF,sCACWrW,KAAKuV,0CACbsB,qBACHE,qBACAC,qBACAC,qBACAJ,4BAIR,GAAuB,OAAnBC,EAAyB,CAE5B,IAAIT,KAAqBtU,EAAKZ,EAAEnB,KAAKmV,SAASpT,EAAKhB,EAAEkB,EAAOjC,KAAKkV,QAC7DoB,KAAwBvU,EAAKZ,EAAEnB,KAAKmV,SAASpT,EAAKhB,EAAEkB,EAAOjC,KAAKmV,QAChEoB,KAAyBzU,EAAOX,KAAKW,EAAOf,EAAEkB,EAAOjC,KAAKmV,QAE1DqC,KAAqBzV,EAAKZ,EAAEnB,KAAKmV,SAASpT,EAAKhB,EAAEkB,EAAOjC,KAAKkV,MAAMlV,KAAKmV,QACxEsC,KAAsB5V,EAAMV,EAAEnB,KAAKmV,SAAStT,EAAMd,EAAEkB,EAAOjC,KAAKmV,QAChEuC,KAAoB9V,EAAIT,KAAKS,EAAIb,EAAEkB,IAEnC4U,KAAkB9U,EAAKZ,EAAEnB,KAAKmV,SAASpT,EAAKhB,EAAEkB,EAAOjC,KAAKkV,MAAMlV,KAAKmV,QACrE4B,KAAoBjV,EAAOX,KAAKW,EAAOf,EAAEkB,EAAOjC,KAAKmV,QACrD6B,KAAmBnV,EAAMV,EAAEnB,KAAKmV,SAAStT,EAAMd,EAAEkB,EAAOjC,KAAKmV,QAEjE3U,uBAA4BuD,iCACX/D,KAAK+V,kCACbM,mBACHC,mBACAC,mBACAF,oCACWrW,KAAKuV,wCACbsB,mBACHE,mBACAC,mBACAH,oCACW7W,KAAKgW,mCACbwB,mBACHE,mBACAD,mBACAD,0BAIP,GAAuB,MAAnBV,EAAwB,CAE3B,IAAIT,KAAqBtU,EAAKZ,EAAEnB,KAAKmV,SAASpT,EAAKhB,EAAEkB,IACjDqU,KAAwBvU,EAAKZ,EAAEnB,KAAKmV,SAASpT,EAAKhB,EAAEkB,EAAOjC,KAAKmV,QAChEoB,KAAyBzU,EAAOX,KAAKW,EAAOf,EAAEkB,EAAOjC,KAAKkV,MAAMlV,KAAKmV,QAErE0B,KAAkB9U,EAAKZ,EAAEnB,KAAKmV,SAASpT,EAAKhB,EAAEkB,EAAOjC,KAAKmV,QAC1D4B,KAAoBjV,EAAOX,KAAKW,EAAOf,EAAEkB,EAAOjC,KAAKkV,MAAMlV,KAAKmV,QAChE6B,KAAmBnV,EAAMV,EAAEnB,KAAKmV,SAAStT,EAAMd,EAAEkB,EAAOjC,KAAKkV,MAAMlV,KAAKmV,QACxE8B,KAAiBrV,EAAIT,KAAKS,EAAIb,EAAEkB,IAEpCzB,uBAA4BuD,mCACV/D,KAAK+V,oCACbM,qBACHC,qBACAC,qBACAF,sCACWrW,KAAKuV,0CACbsB,qBACHE,qBACAC,qBACAC,qBACAJ,4BAIR,GAAuB,OAAnBC,EAAyB,CAE5B,IAAIJ,KAAyB5U,EAAOX,KAAKW,EAAOf,EAAEkB,EAAOjC,KAAKmV,QAC1DwB,KAA0B9U,EAAMV,EAAEnB,KAAKmV,SAAStT,EAAMd,EAAEkB,EAAOjC,KAAKmV,QACpEyB,KAAuB/U,EAAMV,EAAEnB,KAAKmV,SAAStT,EAAMd,EAAEkB,EAAOjC,KAAKkV,QAEjE2B,KAAkB9U,EAAKZ,EAAEnB,KAAKmV,SAASpT,EAAKhB,EAAEkB,EAAOjC,KAAKmV,QAC1D4B,KAAoBjV,EAAOX,KAAKW,EAAOf,EAAEkB,EAAOjC,KAAKmV,QACrD6B,KAAmBnV,EAAMV,EAAEnB,KAAKmV,SAAStT,EAAMd,EAAEkB,EAAOjC,KAAKkV,MAAMlV,KAAKmV,QACxE8B,KAAiBrV,EAAIT,KAAKS,EAAIb,EAAEkB,IAEpCzB,uBAA4BuD,mCACV/D,KAAKsV,oCACboB,qBACHC,qBACAC,qBACAF,sCACW1W,KAAKuV,0CACbsB,qBACHI,qBACAD,qBACAH,sCACW7W,KAAK2V,8BACbkB,qBACHE,qBACAC,qBACAH,4BAIR,MAAO,CAAErW,KAAMA,EAAMgC,OAAQA,GAG9BzC,kBAAkBiE,EAAcC,EAAcR,GAE7C,IAGI6R,EACAM,EACAG,EALAhS,EAAKN,EAAKM,GACV9B,EAAUwB,EAAKD,EAAIxD,KAAKkV,MAASlV,KAAKkV,MAMtCzR,EAAK/B,UAAUgF,QAAU1G,KAAKC,OAAOyF,kBAAkBgB,OAC1D4O,EAAe7R,EAAK/B,UAAUgF,MAC9BkP,EAAYnS,EAAK/B,UAAU6F,0BAA0B,IACrDwO,EAAetS,EAAK/B,UAAU6F,2BAA2B,MAEzD+N,EAAetV,KAAKC,OAAOyF,kBAAkBgB,MAC7CkP,EAAY5V,KAAKC,OAAOyF,kBAAkB6B,0BAA0B,IACpEwO,EAAe/V,KAAKC,OAAOyF,kBAAkB6B,2BAA2B,KAGzE,IAAI3F,EAAgB,CAAET,EAAKF,KAAKmT,KAAKpQ,EAAOhE,KAAKoV,WAAW/L,wBAAyBtI,EAAKE,KAAKmT,KAAKnQ,EAAOjE,KAAKC,OAAO+C,YACnHjB,EAAiB,CAAEZ,EAAKF,KAAKmT,KAAKpQ,GAAOjD,EAAKE,KAAKmT,KAAKnQ,EAAOjE,KAAKoV,WAAW7L,sBAAwBvJ,KAAKC,OAAO+C,YACnHlB,EAAmB,CAAEX,EAAKF,KAAKmT,KAAKpQ,EAAOhE,KAAKoV,WAAWnM,2BAA4BlI,EAAKE,KAAKmT,KAAKnQ,EAAOjE,KAAKoV,WAAW1L,YAAc1J,KAAKC,OAAO+C,YACvJnB,EAAkB,CAAEV,EAAKF,KAAKmT,KAAKpQ,EAAOhE,KAAKoV,WAAW3L,YAAa1I,EAAKE,KAAKmT,KAAKnQ,EAAOjE,KAAKoV,WAAWjM,yBAA2BnJ,KAAKC,OAAO+C,YAEpJqT,KAAqBtU,EAAKZ,EAAEnB,KAAKmV,SAASpT,EAAKhB,EAAEkB,EAAOjC,KAAKkV,QAC7DoB,KAAwBvU,EAAKZ,EAAEnB,KAAKmV,SAASpT,EAAKhB,EAAEkB,EAAOjC,KAAKmV,QAChEoB,KAAyBzU,EAAOX,KAAKW,EAAOf,EAAEkB,EAAOjC,KAAKmV,QAC1DqB,KAAsB1U,EAAOX,KAAKW,EAAOf,EAAEkB,EAAOjC,KAAKkV,QAEvDuB,KAAsB3U,EAAOX,KAAKW,EAAOf,EAAEkB,EAAOjC,KAAKkV,QACvDwB,KAAyB5U,EAAOX,KAAKW,EAAOf,EAAEkB,EAAOjC,KAAKmV,QAC1DwB,KAA0B9U,EAAMV,EAAEnB,KAAKmV,SAAStT,EAAMd,EAAEkB,EAAOjC,KAAKmV,QACpEyB,KAAuB/U,EAAMV,EAAEnB,KAAKmV,SAAStT,EAAMd,EAAEkB,EAAOjC,KAAKkV,QAEjE2B,KAAkB9U,EAAKZ,EAAEnB,KAAKmV,SAASpT,EAAKhB,EAAEkB,EAAOjC,KAAKkV,QA0B9D,MAAO,CAAE1U,0BArBuBuD,mBAAoBgS,qBAC3CM,kBACHC,kBACAC,kBACAC,kBACAH,kCACWf,qBACRmB,kBACHC,kBACAC,kBACAC,kBACAH,kCACWb,qBACRiB,qBAjBe/U,EAAOX,KAAKW,EAAOf,EAAEkB,EAAOjC,KAAKkV,2BAClCrT,EAAMV,EAAEnB,KAAKmV,SAAStT,EAAMd,EAAEkB,EAAOjC,KAAKkV,2BAC5CtT,EAAIT,KAAKS,EAAIb,EAAEkB,EAAOjC,KAAKkV,wBAmB1C2B,cAIerU,OAFA,CAAEZ,IAAOA,EAAKG,KAAQA,EAAMD,OAAUA,EAAQD,MAASA,ORyqC5E,CAACwC,qBAAqB,EAAEC,qCAAqC,IAAIqT,EAAE,CAAC,SAAS9Y,EAAQU,EAAOJ,GAC9F,aACAK,OAAOC,eAAeN,EAAS,aAAc,CAAEO,OAAO,IS1gDtD,IAAYuR,EAzEZ9R,EAAA6R,KAAA,MAUCjR,YACEgE,EACA5C,EACAJ,EACAyC,EACAyQ,EACAvS,EACAkW,GATF5X,KAAA6X,SAAoB,GAWnB7X,KAAK8X,IAAM/T,EACX/D,KAAKkT,GAAK/R,EACVnB,KAAKmT,GAAKpS,EACVf,KAAK+X,GAAKvU,EACVxD,KAAKgY,UAAY/D,EACjBjU,KAAKiY,WAAavW,EAEdkW,IACH5X,KAAK6X,SAAWD,GAIlB7T,SACC,OAAO/D,KAAK8X,IAGb3W,QACC,OAAOnB,KAAKkT,GAGbnS,QACC,OAAOf,KAAKmT,GAGb3P,QACC,OAAOxD,KAAK+X,GAGbG,WACC,OAAOlY,KAAKgY,UAGbJ,cACC,OAAI5X,KAAKgY,WAAa/G,EAASkH,KACvBnY,KAAK6X,SAEL,CAAElF,SAAW,GAIf5S,WACN,OAAOC,KAAKiY,WAGbvW,gBACC,OAAO1B,KAAKiY,WAGbvW,cAAc0F,GACbpH,KAAKiY,WAAa7Q,IAKpB,SAAY6J,GACXA,EAAA,KAAA,OACAA,EAAA,KAAA,OACAA,EAAA,MAAA,QACAA,EAAA,KAAA,OAJD,CAAYA,EAAA9R,EAAA8R,WAAA9R,EAAA8R,SAAQ,MTikDlB,KAAK,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE","file":"bundle.min.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()",null,"import { MapGenerationFunctions, Color } from './mapGenerationFunctions.component'\r\nimport { Map } from './mapper.component'\r\nimport { Tile, TileType } from './tile.component'\r\nimport { Config, Coords, TileTemplate, Position } from './config.component'\r\nimport { RenderElements } from './renderelements.component'\r\n\r\nexport class Renderer {\t\r\n\r\n\tprivate config: Config = new Config()\r\n\tprivate calculations: MapGenerationFunctions = new MapGenerationFunctions()\r\n\tprivate render: RenderElements = new RenderElements()\r\n\r\n\tconstructor() {\t}\r\n\r\n\tshowData(map: Map): string {\r\n\r\n\t\tlet html = '<div class=\"showData\">'\r\n\t\thtml += `map width: ${map.mapWidth} tiles<br>map length: ${map.mapLength} tiles<br>`\r\n\t\thtml += `tile width: ${this.config.tileWidth}<br>tile length: ${this.config.tileLength}<br>`\r\n\t\thtml += '</div>'\r\n\r\n\t\treturn html\r\n\t}\r\n\r\n\tbuild2DMap(map: Map): string {\r\n\r\n\t\tlet htmlMap = `<div class=\"map\" style=\"width:${this.config.getMapWidth(map.mapWidth+1)}px;\">`\r\n\r\n\t\thtmlMap += `<div class=\"tile axis\" style=\"width:${this.config.tileWidth}px;height:${this.config.tileLength}px;\"></div>`\r\n\r\n\t\tfor (let i = 0; i < map.mapWidth; i++) {\r\n\t\t\thtmlMap += `<div class=\"tile axis\" style=\"width:${this.config.tileWidth}px;height:${this.config.tileLength}px;\">${i}</div>`\r\n\t\t}\r\n\r\n\t\tfor (let y = 0; y < map.mapLength; y++) {\r\n\r\n\t\t\tlet halfWay = ''\r\n\r\n\t\t\tif (y === Math.round(map.mapLength / 2)) {\r\n\t\t\t\thalfWay = ' half'\r\n\t\t\t}\r\n\r\n\t\t\thtmlMap += `<div class=\"tile axis${halfWay}\" style=\"width:${this.config.tileWidth}px;height:${this.config.tileLength}px;\">${y}</div>`\r\n\r\n\t\t\tfor (let x = 0; x < map.mapWidth; x++) {\r\n\r\n\t\t\t\thtmlMap += `<div class=\"tile${halfWay}\" style=\"width:${this.config.tileWidth}px;height:${this.config.tileLength}px;`\r\n\r\n\t\t\t\tif (map.getColumn(x, y).isDefined) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tlet tile = map.getTopTile(x, y)\r\n\t\t\t\t\tlet tileTopColor = tile.getColor().rgb()\r\n\t\t\t\t\tlet tileColor = `rgb(${tileTopColor['r']}, ${tileTopColor['g']}, ${tileTopColor['b']})`\r\n\r\n\t\t\t\t\tlet edge = (map.map[y][x].edge.top || map.map[y][x].edge.right || map.map[y][x].edge.bottom || map.map[y][x].edge.left) ? true : false\r\n\t\t\t\t\tlet blockGroup = map.map[y][x].blockGroup\r\n\r\n\t\t\t\t\thtmlMap += `background-color:${tileColor}\"><div class=\"tileInfo\">x: ${x} y: ${y}<br>height: ${map.map[y][x].height}<br>edge: ${edge}<br>group: ${blockGroup}</div></div>`\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\thtmlMap += `\"></div>`\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\thtmlMap += `</div>`\r\n\r\n\t\treturn htmlMap\r\n\t}\r\n\r\n\tbuildMap(mapToBuild: Map): string {\r\n\r\n\t\tlet mapTotalWidth = mapToBuild.mapWidth\r\n\t\tlet mapTotalLength = mapToBuild.mapLength\r\n\r\n\t\tlet testTile = this.render.createTile(0, 0)\r\n\r\n\t\tlet xDeviation = testTile.coords.bottom.x - testTile.coords.top.x\r\n\t\tlet yDeviation = testTile.coords.right.y - testTile.coords.left.y\r\n\t\tlet tileHalfWidthLeft = testTile.coords.top.x - testTile.coords.left.x\r\n\t\tlet tileHalfWidthRight = testTile.coords.right.x - testTile.coords.top.x\r\n\t\tlet mapWidthLeft = tileHalfWidthLeft * mapTotalLength\r\n\t\tlet mapWidthRight = tileHalfWidthRight * mapTotalWidth\r\n\t\tlet tileHalfLengthTop = testTile.coords.right.y\r\n\t\tlet tileHalfLengthBottom = testTile.coords.bottom.y - testTile.coords.right.y\r\n\t\tlet mapLengthTop = tileHalfLengthTop * mapTotalWidth\r\n\t\tlet mapLengthBottom = tileHalfLengthBottom * mapTotalLength\r\n\t\tlet mapWidthPx = Math.round((tileHalfWidthLeft + tileHalfWidthRight) * (mapTotalWidth ))\r\n\t\tlet mapLengthPx = Math.round(mapLengthTop + mapLengthBottom) + this.config.topMargin\r\n\r\n\t\tconst map = mapToBuild.map\r\n\r\n\t\tlet detailsHtml = ''\r\n\t\tlet html = '<svg width=\"'+mapWidthPx+'\" height=\"'+mapLengthPx+'\">'\r\n\r\n\t\tlet lastTile = null\r\n\t\tlet startTileX = tileHalfWidthLeft * (mapTotalWidth - 1)\r\n\r\n\t\tfor (let y = 0; y < mapTotalLength; y++) {\r\n\r\n\t\t\tfor (let x = 0; x < mapTotalWidth; x++) {\r\n\r\n\t\t\t\tlet thisPosY = 0\r\n\t\t\t\tlet thisPosX = 0\r\n\r\n\t\t\t\tif (x === 0 && y === 0) {\r\n\t\t\t\t\tthisPosX = startTileX\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (lastTile != null) {\r\n\t\t\t\t\tthisPosY = lastTile.coords.right.y\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (y > 0 && x === 0) {\r\n\t\t\t\t\tthisPosX = startTileX - (tileHalfWidthLeft * y)\r\n\t\t\t\t\tthisPosY = (tileHalfLengthTop * y) - (yDeviation * y)\r\n\t\t\t\t}\t\r\n\t\t\t\t\r\n\t\t\t\tif (x > 0) {\r\n\t\t\t\t\tthisPosX = (lastTile.coords.right.x - (lastTile.coords.right.x - lastTile.coords.bottom.x))\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet newTile = this.render.createTile(thisPosX, thisPosY)\r\n\t\t\t\tlet newData = ''\r\n\t\t\t\t\r\n\t\t\t\tif (map[y][x].isDefined) {\r\n\r\n\t\t\t\t\tfor (let h = 0; h < map[y][x].height; h++) {\r\n\t\t\t\t\t\tlet tile = this.render.createBlock(thisPosX, thisPosY- this.config.tileHeight, map[y][x].tileStack[h])\r\n\t\t\t\t\t\tnewData += tile.html\r\n\r\n\t\t\t\t\t\tif (this.config.allowDebug) {\r\n\t\t\t\t\t\t\tif (h === map[y][x].height - 1) {\r\n\t\t\t\t\t\t\t\tlet debugInfo = `<span>x: ${x}, y: ${y} <span class=\"debugLink showGroups\" data-group=\"${map[y][x].blockGroup}\">groupId: ${map[y][x].blockGroup}</span><br>id: ${map[y][x].tileStack[h].id}  h: ${h}</span>`\r\n\t\t\t\t\t\t\t\tdetailsHtml += `<div class=\"blockLabel\" data-groupId=\"${map[y][x].blockGroup}\" style=\"left: ${tile.coords.top.x}px; top: ${tile.coords.top.y - (this.config.tileHeight * h-1)}px;\"><div class=\"point\"></div>${debugInfo}</div>`\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} \r\n\r\n\t\t\t\thtml += newData\r\n\r\n\t\t\t\tlastTile = newTile\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\thtml += '</svg>'\r\n\r\n\t\t// document.querySelector('#debug').innerHTML = detailsHtml\r\n\r\n\t\treturn '<div id=\"debug\">' + detailsHtml + '</div>' + html\r\n\t}\r\n\r\n\taddSlopedEdges(map: any[], x: number, y: number, h: number, xPos: number, yPos: number) {\r\n\r\n\t\tlet tile = null\r\n\r\n\t\tif (map[y][x].edge.top && !map[y][x].corner && h === map[y][x].height-1) {\r\n\t\t\ttile = this.render.createSlopeBlock(xPos, yPos - this.config.tileHeight, map[y][x].getTile(h), 'n')\r\n\t\t} else if (map[y][x].edge.bottom && !map[y][x].corner && h === map[y][x].height-1) {\r\n\t\t\ttile = this.render.createSlopeBlock(xPos, yPos - this.config.tileHeight, map[y][x].getTile(h), 's')\r\n\t\t} else if (map[y][x].edge.right && !map[y][x].corner && h === map[y][x].height-1) {\r\n\t\t\ttile = this.render.createSlopeBlock(xPos, yPos - this.config.tileHeight, map[y][x].getTile(h), 'e')\r\n\t\t} else if (map[y][x].edge.left && !map[y][x].corner && h === map[y][x].height-1) {\r\n\t\t\ttile = this.render.createSlopeBlock(xPos, yPos - this.config.tileHeight, map[y][x].getTile(h), 'w')\r\n\t\t} else {\r\n\t\t\ttile = this.render.createBlock(xPos, yPos - this.config.tileHeight, map[y][x].getTile(h))\t\r\n\t\t}\r\n\r\n\t\tif (map[y][x].corner && h === map[y][x].height-1) {\r\n\t\t\tif (map[y][x].edge.top && map[y][x].edge.left) {\r\n\t\t\t\ttile = this.render.createSlopeBlock(xPos, yPos - this.config.tileHeight, map[y][x].getTile(h), 'nw')\r\n\t\t\t} else if (map[y][x].edge.top && map[y][x].edge.right) {\r\n\t\t\t\ttile = this.render.createSlopeBlock(xPos, yPos - this.config.tileHeight, map[y][x].getTile(h), 'ne')\r\n\t\t\t} else if (map[y][x].edge.bottom && map[y][x].edge.left) {\r\n\t\t\t\ttile = this.render.createSlopeBlock(xPos, yPos - this.config.tileHeight, map[y][x].getTile(h), 'sw')\r\n\t\t\t} else if (map[y][x].edge.bottom && map[y][x].edge.right) {\r\n\t\t\t\ttile = this.render.createSlopeBlock(xPos, yPos - this.config.tileHeight, map[y][x].getTile(h), 'se')\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn tile\r\n\t}\r\n}\r\n","import { Color } from './mapGenerationFunctions.component'\r\n\r\nexport class Config {\r\n\r\n\tprivate _allowDebug: boolean = true\r\n\tprivate _tileWidth: number = 20\r\n\tprivate _tileLength: number = 20\r\n\tprivate _tileHeight: number = 15\r\n\tprivate _tileSmallAngle: number = 85\r\n\tprivate _tileLargeAngle: number = 100\r\n\tprivate _groundColor: Color = new Color('f5f3e5')\r\n\tprivate _buildingBaseColor: Color = new Color(\r\n\t\t115 + Math.floor(Math.random() * 75),\r\n\t\t155 + Math.floor(Math.random() * 40),\r\n\t\t150 + Math.floor(Math.random() * 30)\r\n\t)\r\n\tprivate _tileEdgeBleed: number = 0.3\r\n\tprivate _maxAllowedHeight: number = 12\r\n\tprivate _topMargin: number = 80\r\n\r\n\tpublic get allowDebug(): boolean {\r\n\t\treturn this._allowDebug\r\n\t}\r\n\r\n\tpublic get tileWidth(): number {\r\n\t\treturn this._tileWidth\r\n\t}\r\n\r\n\tpublic get tileLength(): number {\r\n\t\treturn this._tileLength\r\n\t}\r\n\r\n\tpublic get tileHeight(): number {\r\n\t\treturn this._tileHeight\r\n\t}\r\n\r\n\tpublic get tileSmallAngle(): number {\r\n\t\treturn this._tileSmallAngle\r\n\t}\r\n\r\n\tpublic get tileLargeAngle(): number {\r\n\t\treturn this._tileLargeAngle\r\n\t}\r\n\r\n\tpublic get groundColor(): Color {\r\n\t\treturn this._groundColor\r\n\t}\r\n\r\n\tpublic get buildingBaseColor(): Color {\r\n\t\treturn this._buildingBaseColor\r\n\t}\r\n\r\n\tpublic get tileEdgeBleed(): number {\r\n\t\treturn this._tileEdgeBleed\r\n\t}\r\n\r\n\tpublic get maxAllowedHeight(): number {\r\n\t\treturn this._maxAllowedHeight\r\n\t}\r\n\r\n\tpublic get topMargin(): number {\r\n\t\treturn this._topMargin\r\n\t}\r\n\r\n\tpublic getMapWidth(mapArrayWidth: number): number {\r\n\t\treturn mapArrayWidth * this._tileWidth\r\n\t}\r\n\r\n\tpublic getMapLength(mapArrayLength: number): number {\r\n\t\treturn mapArrayLength * this._tileLength\r\n\t}\r\n}\r\n\r\nexport interface Coords {\r\n\ttop?: Position,\r\n\tleft?: Position,\r\n\tbottom?: Position,\r\n\tright?: Position\r\n}\r\n\r\nexport interface TileTemplate {\r\n\thtml?: string,\r\n\tcoords?: Coords\r\n}\r\n\r\nexport interface Position {\r\n\tx?: number,\r\n\ty?: number\r\n}\r\n","import { Map } from './mapper.component'\r\nimport { Renderer } from './builder.component'\r\nimport { Color } from './mapGenerationFunctions.component'\r\nimport { Config } from './config.component'\r\n\r\nclass RandomBuilding {\r\n\r\n\tprivate _map: Map\r\n\tprivate _builder: Renderer = new Renderer\r\n\tprivate config: Config = new Config\r\n\r\n\tconstructor() {\r\n\t\tthis._map = new Map(30, 30, 10, 1, 5, 3, 4, false)\r\n\t\tdocument.querySelector('body').style.background = this.config.groundColor.hex()\r\n\t}\r\n\r\n\tpublic debug(): boolean {\r\n\t\treturn this.config.allowDebug\r\n\t}\r\n\r\n\tget map() {\r\n\t\treturn this._map\r\n\t}\r\n\r\n\tpublic colorMap(): string {\r\n\t\treturn this._builder.build2DMap(this._map)\r\n\t}\r\n\r\n\tpublic addToBuildingAndRedraw(): string {\r\n\t\tthis._map.addToBuilding()\r\n\t\treturn this._builder.build2DMap(this._map)\r\n\t}\r\n\r\n\tpublic drawTileMap(): string {\r\n\t\treturn this._builder.buildMap(this._map)\r\n\t}\r\n\r\n\tpublic getBaseColor(): Color {\r\n\r\n\t\tconst col = this.map.getFirstDefinedColumn()\r\n\t\tconst tile = col.tileStack[col.tileStack.length-1]\r\n\r\n\t\tconsole.log(tile)\r\n\r\n\t\treturn tile.getColor()\r\n\t}\r\n}\r\n\r\nlet building = new RandomBuilding()\r\ndocument.querySelector('#color').innerHTML = building.colorMap()\r\ndocument.querySelector(\"#worldtest\").innerHTML = building.drawTileMap()\r\n\r\nsetColors(building)\r\n\r\ndocument.querySelector('#generate').addEventListener('click', () => {\r\n\tbuilding = new RandomBuilding()\r\n\tdocument.querySelector('#color').innerHTML = building.colorMap()\r\n\tdocument.querySelector(\"#worldtest\").innerHTML = building.drawTileMap()\r\n\tdocument.querySelector('#debugActive').classList.remove('active')\r\n\r\n\tdocument.querySelectorAll('.point').forEach((item) => {\r\n\t\titem.addEventListener('click', () => {\r\n\t\t\tconsole.log('toggled', item)\r\n\t\t\titem.parentElement.classList.toggle('active')\r\n\t\t})\t\t\r\n\t})\r\n\r\n\tsetColors(building)\r\n})\r\n\r\ndocument.querySelector('#redraw').addEventListener('click', () => {\r\n\tbuilding.addToBuildingAndRedraw()\r\n\tdocument.querySelector('#color').innerHTML = building.colorMap()\r\n\tdocument.querySelector(\"#worldtest\").innerHTML = building.drawTileMap()\r\n\tdocument.querySelector('#debugActive').classList.remove('active')\r\n\r\n\tdocument.querySelectorAll('.blockLabel').forEach((item) => {\r\n\t\titem.addEventListener('click', () => {\r\n\t\t\titem.classList.toggle('active')\r\n\t\t})\r\n\t})\r\n})\r\n\r\ndocument.querySelector('#debugActive').addEventListener('click', () => {\r\n\tdocument.querySelector('#debug').classList.toggle('show')\r\n\tdocument.querySelector('#debugActive').classList.toggle('active')\r\n})\r\n\r\ndocument.querySelectorAll('.blockLabel').forEach((item) => {\r\n\titem.addEventListener('click', () => {\r\n\t\titem.classList.toggle('active')\r\n\t})\r\n})\r\n\r\nfunction setColors(building: RandomBuilding) {\r\n\r\n\tconst color = building.getBaseColor()\r\n\tconst shade0 = color.changeColorLightingString(0)\r\n\tconst shade1 = color.changeColorLightingString(20)\r\n\tconst shade2 = color.changeColorLightingString(-20)\r\n\tconst shade3 = color.getColorStringByHue(60)\r\n\tconst shade4 = color.getColorStringByHue(120)\r\n\tconst shade5 = color.getColorStringByHue(180)\r\n\tconst shade6 = color.getColorStringByHue(240)\r\n\tconst shade7 = color.getColorStringByHue(300)\r\n\r\n\tconst colorDivs = `\r\n\t\t<div class=\"color__tile\" style=\"background-color:${shade0};\"></div>\r\n\t\t<div class=\"color__tile\" style=\"background-color:${shade1};\"></div>\r\n\t\t<div class=\"color__tile\" style=\"background-color:${shade3};\"></div>\r\n\t\t<div class=\"color__tile\" style=\"background-color:${shade4};\"></div>\r\n\t\t<div class=\"color__tile\" style=\"background-color:${shade5};\"></div>\r\n\t\t<div class=\"color__tile\" style=\"background-color:${shade6};\"></div>\r\n\t\t<div class=\"color__tile\" style=\"background-color:${shade7};\"></div>`\r\n\r\n\tdocument.querySelector('#color-scheme').innerHTML = colorDivs\r\n}","import { Config } from './config.component'\r\n\r\nexport class MapGenerationFunctions {\r\n\r\n\tprivate config: Config = new Config();\r\n\tsmallAngle = this.config.tileSmallAngle;\r\n\tlargeAngle = this.config.tileLargeAngle;\r\n\r\n\tconstructor() { }\r\n\r\n\tpublic calculateAdditionalBlockIterations(maximumBlockIterations: number) {\r\n\t\treturn 2 + Math.floor(Math.random() * maximumBlockIterations);\r\n\t}\r\n\r\n\t// calculate the dimensions to draw the isometric perspective tile with the parameters as if it were a straight square tile\r\n\tpublic calculateStraightLinesFromIsometricSquare (blockWidth: number, blockHeight: number) {\r\n\t\t// lengths this function returns when it comes to positions of longest and shortest sides as array\r\n\t\t/*           [0]\r\n\t\t *   _________________ \r\n\t\t *   |    [3]  |      |\r\n\t\t *   | [5]            |\r\n\t\t *   |               -|\r\n\t\t *   |-               | [1]\r\n\t\t *   | [4]            |\r\n\t\t *   |    [2]         |\r\n\t\t *   |_______|________|\r\n\t\t */  \r\n\r\n\t\tlet smallOuterAngle = (180 - this.smallAngle) / 2;\r\n\t\tlet largeOuterAngle = (180 - this.largeAngle) / 2;\r\n\r\n\t\tlet horizontalWidthFromBottom = this.getHorizontalBottomShortestWidth(blockWidth, smallOuterAngle);\r\n\t\tlet verticalHeightFromBottom = this.getVerticalBottomShortestHeight(horizontalWidthFromBottom, smallOuterAngle);\r\n\r\n\t\tlet horizontalWidthFromTop = this.getHorizontalTopLongestWidth(blockHeight, largeOuterAngle);\r\n\t\tlet verticalHeightFromTop = this.getVerticalTopLongestHeight(horizontalWidthFromTop, largeOuterAngle);\r\n\r\n\t\tlet totalHeight = verticalHeightFromBottom + verticalHeightFromTop;\r\n\t\tlet totalWidth = horizontalWidthFromBottom + horizontalWidthFromTop;\r\n\r\n\t\treturn {\t'totalWidth': totalWidth, // 0\r\n\t\t\t\t\t'totalHeight': totalHeight,  // 1\r\n\t\t\t\t\t'horizontalWidthFromBottom': horizontalWidthFromBottom,  // 2\r\n\t\t\t\t\t'horizontalWidthFromTop': horizontalWidthFromTop,  // 3\r\n\t\t\t\t\t'verticalHeightFromBottom': verticalHeightFromBottom,  // 4\r\n\t\t\t\t\t'verticalHeightFromTop': verticalHeightFromTop } // 5\r\n\t}\r\n\r\n\t// calculate the amount of pixels from the bottom left side of a straight square to the point at the bottom \r\n\t// .. where the tip of the tile meets the border of the square\r\n\tpublic getHorizontalBottomShortestWidth (diagonalWidth: number, smallAngle: number): number {\r\n\t\treturn diagonalWidth * Math.sin(this.toRadians(smallAngle));\r\n\t}\r\n\r\n\tpublic getVerticalBottomShortestHeight (diagonalHeight: number, smallAngle: number): number {\r\n\t\treturn diagonalHeight * Math.cos(this.toRadians(smallAngle));\r\n\t}\r\n\r\n\tpublic getHorizontalTopLongestWidth (diagonalWidth: number, largeAngle: number): number {\r\n\t\treturn diagonalWidth * Math.sin(this.toRadians(largeAngle));\r\n\t}\r\n\r\n\tpublic getVerticalTopLongestHeight (diagonalHeight: number, largeAngle: number): number {\r\n\t\treturn diagonalHeight * Math.cos(this.toRadians(largeAngle));\r\n\t}\r\n\r\n\ttoRadians (angle: number): number {\r\n\t\treturn angle * (Math.PI / 180);\r\n\t}\r\n}\r\n\r\nexport enum TileColor {\r\n\tRed = 125 + Math.floor(Math.random() * 75),\r\n\tGreen = 170 + Math.floor(Math.random() * 40),\r\n\tBlue = 180 + Math.floor(Math.random() * 30)\r\n}\r\n\r\nexport enum BuildingHeightVariations {\r\n\tTallCenter = 'tallCenter',\r\n\tTallSurrounds = 'tallSurrounds',\r\n\tRandom = 'random'\r\n}\r\n\r\nexport class Color {\r\n\tprivate _colorRgb: RGB\r\n\tprivate _colorHex: string\r\n\tprivate _colorHsl: HSL\r\n\r\n\tconstructor(...params: any[]) {\r\n\t\tlet error = null\r\n\t\tif (params.length === 1) {\r\n\t\t\tif (typeof params[0] === 'string') {\r\n\t\t\t\tif (this.validateHex(params[0])) {\r\n\t\t\t\t\tlet hexColor = params[0]\r\n\t\t\t\t\tif (hexColor.charAt(0) !== '#') {\r\n\t\t\t\t\t\thexColor = `#${hexColor}`\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.setHex(hexColor)\r\n\t\t\t\t\tthis.hexToRgb()\r\n\t\t\t\t\tthis.convertToHSL()\r\n\t\t\t\t} else {\r\n\t\t\t\t\terror = \"Hexadecimal color is incorrect\"\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\terror = \"Length of 1 in parameters is not equal to string\"\r\n\t\t\t}\r\n\t\t} else if (params.length === 3) {\r\n\t\t\tif (this.validateRgb(params)) {\r\n\t\t\t\tthis.setRgb(params[0], params[1], params[2])\r\n\t\t\t\tthis.rgbToHex()\r\n\t\t\t\tthis.convertToHSL()\r\n\t\t\t} else {\r\n\t\t\t\terror = \"Values of RGB exceed limits\"\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (error !== null) {\r\n\t\t\tthrow \"Color type is incorrect. \" + error + \": \" + params.toString()\r\n\t\t}\r\n\t}\r\n\r\n\tpublic setRgb(r: number, g: number, b: number) {\r\n\t\tthis._colorRgb = {r: r, g: g, b: b} as RGB\r\n\t}\r\n\r\n\tpublic setHsl(h: number, s: number, l: number) {\r\n\t\tthis._colorHsl = {h: h, s: s, l: l} as HSL\r\n\t}\r\n\r\n\tpublic setHex(hexadecimal: string) {\r\n\t\tif (hexadecimal.length < 7) {\r\n\t\t\tlet hexVal1 = hexadecimal.charAt(1)\r\n\t\t\tlet hexVal2 = hexadecimal.charAt(2)\r\n\t\t\tlet hexVal3 = hexadecimal.charAt(3)\r\n\t\t\thexadecimal = \"#\" + hexVal1 + hexVal1 + hexVal2 + hexVal2 + hexVal3 + hexVal3\r\n\t\t}\r\n\t\tthis._colorHex = hexadecimal\r\n\t}\r\n\r\n\tpublic rgb(): RGB {\r\n\t\treturn this._colorRgb\r\n\t}\r\n\r\n\tpublic hex(): string {\r\n\t\treturn this._colorHex\r\n\t}\r\n\r\n\tpublic hsl(): HSL {\r\n\t\treturn this._colorHsl\r\n\t}\r\n\r\n\tvalidateRgb(rgb: number[]): boolean {\r\n\t\tif (rgb[0] > -1 && rgb[0] < 256 &&\r\n\t\t\trgb[1] > -1 && rgb[1] < 256 &&\r\n\t\t\trgb[2] > -1 && rgb[2] < 256) {\r\n\t\t\treturn true\r\n\t\t} else {\r\n\t\t\treturn false\r\n\t\t}\r\n\t}\r\n\r\n\tvalidateHex(hex: string): boolean {\r\n\t\tlet regex = /^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/\r\n\t\tif (hex.match(regex)) {\r\n\t\t\treturn true\r\n\t\t} else {\r\n\t\t\treturn false\r\n\t\t}\r\n\t}\r\n\r\n\thexToRgb() {\r\n\t\tlet hexValues: string[] = this._colorHex.substr(1).split('')\r\n\t\tlet hexPair1 = parseInt(hexValues[0]+hexValues[1], 16)\r\n\t\tlet hexPair2 = parseInt(hexValues[2]+hexValues[3], 16)\r\n\t\tlet hexPair3 = parseInt(hexValues[4]+hexValues[5], 16)\r\n\t\tthis.setRgb(hexPair1, hexPair2, hexPair3)\r\n\t\tthis.rgbToHex()\r\n\t}\r\n\r\n\trgbToHex() {\r\n\t\tif (typeof this._colorRgb === 'object') {\r\n\t\t\tlet r = this._colorRgb.r\r\n\t\t\tlet b = this._colorRgb.b\r\n\t\t\tlet g = this._colorRgb.g\r\n\t\t\tlet hexR = Number(r).toString(16)\r\n\t\t\tlet hexG = Number(g).toString(16)\r\n\t\t\tlet hexB = Number(b).toString(16)\r\n\t\t\tthis._colorHex = \"#\" + hexR + hexG + hexB\t\t\t\r\n\t\t}\r\n\t}\r\n\r\n\tconvertRGBtoHex(color: RGB): string {\r\n\t\tlet r = color.r\r\n\t\tlet b = color.b\r\n\t\tlet g = color.g\r\n\t\tlet hexR = Number(r).toString(16)\r\n\t\tlet hexG = Number(g).toString(16)\r\n\t\tlet hexB = Number(b).toString(16)\r\n\t\treturn \"#\" + hexR + hexG + hexB\r\n\t}\r\n\r\n\tpublic changeColorLightingString(amount: number): string {\r\n\t\tlet r = this._colorRgb.r\r\n\t\tlet b = this._colorRgb.b\r\n\t\tlet g = this._colorRgb.g\r\n\t\tlet newR = r + amount\r\n\t\tlet newG = g + amount\r\n\t\tlet newB = b + (amount - 8)\r\n\t\tif (newR > 255) newR = 255\r\n\t\tif (newG > 255) newG = 255\r\n\t\tif (newR > 255) newR = 255\r\n\r\n\t\tlet hexR = Number(newR).toString(16)\r\n\t\tlet hexG = Number(newG).toString(16)\r\n\t\tlet hexB = Number(newB).toString(16)\r\n\t\tlet result = \"#\" + hexR + hexG + hexB\r\n\r\n\t\treturn result\r\n\t}\r\n\r\n\tpublic changeColorLighting(amount: number): Color {\r\n\t\tlet r = this._colorRgb.r\r\n\t\tlet b = this._colorRgb.b\r\n\t\tlet g = this._colorRgb.g\r\n\t\tlet newR = r + amount\r\n\t\tlet newG = g + amount\r\n\t\tlet newB = b + (amount - 8)\r\n\t\tif (newR > 255) newR = 255\r\n\t\tif (newG > 255) newG = 255\r\n\t\tif (newR > 255) newR = 255\r\n\t\t\r\n\t\tthis.setRgb(newR, newG, newR)\r\n\t\tthis.rgbToHex()\r\n\t\tthis.convertToHSL()\r\n\r\n\t\treturn this\r\n\t}\r\n\r\n\tpublic getLightestRGB(): RGB {\r\n\t\tlet r = this._colorRgb.r\r\n\t\tlet b = this._colorRgb.b\r\n\t\tlet g = this._colorRgb.g\r\n\t\tlet newR = r + 55\r\n\t\tlet newG = g + 55\r\n\t\tlet newB = b + 40\r\n\t\tif (newR > 255) newR = 255\r\n\t\tif (newG > 255) newG = 255\r\n\t\tif (newR > 255) newR = 255\r\n\t\treturn {r: newR, g: newG, b: newB}\r\n\t}\r\n\r\n\tpublic getHighlightsRGB(): RGB {\r\n\t\tlet r = this._colorRgb.r\r\n\t\tlet b = this._colorRgb.b\r\n\t\tlet g = this._colorRgb.g\r\n\t\tlet newR = r + 45\r\n\t\tlet newG = g + 45\r\n\t\tlet newB = b + 30\r\n\t\tif (newR > 255) newR = 255\r\n\t\tif (newG > 255) newG = 255\r\n\t\tif (newR > 255) newR = 255\r\n\t\treturn {r: newR, g: newG, b: newB}\r\n\t}\r\n\r\n\tpublic getDarkerRegularRGB(): RGB {\r\n\t\tlet r = this._colorRgb.r\r\n\t\tlet b = this._colorRgb.b\r\n\t\tlet g = this._colorRgb.g\r\n\t\tlet newR = r + 15\r\n\t\tlet newG = g + 15\r\n\t\tlet newB = b + 5\r\n\t\tif (newR > 255) newR = 255\r\n\t\tif (newG > 255) newG = 255\r\n\t\tif (newR > 255) newR = 255\r\n\t\treturn {r: newR, g: newG, b: newB}\r\n\t}\r\n\r\n\tpublic getHalflightsRGB(): RGB {\r\n\t\tlet r = this._colorRgb.r\r\n\t\tlet b = this._colorRgb.b\r\n\t\tlet g = this._colorRgb.g\r\n\t\tlet newR = r + 25\r\n\t\tlet newG = g + 25\r\n\t\tlet newB = b + 15\r\n\t\tif (newR > 255) newR = 255\r\n\t\tif (newG > 255) newG = 255\r\n\t\tif (newR > 255) newR = 255\r\n\t\treturn {r: newR, g: newG, b: newB}\r\n\t}\r\n\r\n\tpublic getShadowsRGB(): RGB {\r\n\t\tlet r = this._colorRgb.r\r\n\t\tlet b = this._colorRgb.b\r\n\t\tlet g = this._colorRgb.g\r\n\t\tlet newR = r - 55\r\n\t\tlet newG = g - 55\r\n\t\tlet newB = b - 35\r\n\t\tif (newR < 0) newR = 0\r\n\t\tif (newG < 0) newG = 0\r\n\t\tif (newR < 0) newR = 0\r\n\t\treturn {r: newR, g: newG, b: newB}\r\n\t}\r\n\r\n\tpublic getDarkestRGB(): RGB {\r\n\t\tlet r = this._colorRgb.r\r\n\t\tlet b = this._colorRgb.b\r\n\t\tlet g = this._colorRgb.g\r\n\t\tlet newR = r - 70\r\n\t\tlet newG = g - 70\r\n\t\tlet newB = b - 60\r\n\t\tif (newR < 0) newR = 0\r\n\t\tif (newG < 0) newG = 0\r\n\t\tif (newR < 0) newR = 0\r\n\t\treturn {r: newR, g: newG, b: newB}\r\n\t}\r\n\r\n\tpublic getColorStringByHue(hue: number): string {\r\n\r\n\t\tlet h = this._colorHsl.h,\r\n\t\t\ts = this._colorHsl.s,\r\n\t\t\tl = this._colorHsl.l\r\n\r\n\t\tlet newHue = h + hue\r\n\r\n\t\tif (newHue > 360) {\r\n\t\t\tnewHue = newHue % 360\r\n\t\t}\r\n\r\n\t\tlet rgb = this.convertHSLtoRGB({h: newHue, s: s, l: l})\r\n\r\n\t\treturn this.convertRGBtoHex(rgb)\r\n\t}\r\n\r\n\tpublic getColorByHue(hue: number): Color {\r\n\r\n\t\tlet h = this._colorHsl.h,\r\n\t\t\ts = this._colorHsl.s,\r\n\t\t\tl = this._colorHsl.l\r\n\r\n\t\tlet newHue = h + hue\r\n\r\n\t\tif (newHue > 360) {\r\n\t\t\tnewHue = newHue % 360\r\n\t\t}\r\n\r\n\t\tlet rgb = this.convertHSLtoRGB({h: newHue, s: s, l: l})\r\n\r\n\t\tthis.setRgb(rgb.r, rgb.g, rgb.b)\r\n\t\tthis.rgbToHex()\r\n\r\n\t\treturn this\r\n\t}\r\n\r\n\tconvertToHSL(): void {\r\n\t\tlet r = this._colorRgb.r\r\n\t\tlet b = this._colorRgb.b\r\n\t\tlet g = this._colorRgb.g\r\n\r\n\t\tr /= 255\r\n\t\tg /= 255\r\n\t\tb /= 255\r\n\r\n\t\tlet cmin = Math.min(r,g,b),\r\n\t\t\tcmax = Math.max(r,g,b),\r\n\t\t\tdelta = cmax - cmin,\r\n\t\t\th = 0,\r\n\t\t\ts = 0,\r\n\t\t\tl = 0\r\n\r\n\t\t// calculate hue\r\n\t\tif (delta === 0) {\r\n\t\t\th = 0\r\n\t\t} else if (cmax === r) {\r\n\t\t\th = ((g - b) / delta) % 6\r\n\t\t} else if (cmax === g) {\r\n\t\t\th = (b - r) / delta + 2\r\n\t\t} else {\r\n\t\t\th = (r - g) / delta + 4\r\n\t\t}\r\n\r\n\t\th = Math.round(h * 60)\r\n\r\n\t\tif (h < 0) {\r\n\t\t\th += 360\r\n\t\t}\r\n\r\n\t\t// calculate lightness\r\n\t\tl = (cmax + cmin) / 2 \r\n\r\n\t\t// calculate saturation\r\n\t\ts = delta === 0 ? 0 : delta / (1 - Math.abs(2 * l - 1))\r\n\r\n\t\ts = +(s * 100).toFixed(1)\r\n\t\tl = +(l * 100).toFixed(1)\r\n\r\n\t\tthis._colorHsl = { h: h, s: s, l: l }\r\n\t}\r\n\r\n\tconvertHSLtoRGB(color: HSL): RGB {\r\n\r\n\t\tlet h = color.h\r\n\t\tlet s = color.s\r\n\t\tlet l = color.l\r\n\r\n\t\ts /= 100\r\n\t\tl /= 100\r\n\r\n\t\tlet c = (1 - Math.abs(2 * l - 1)) * s,\r\n\t\t\tx = c * (1 - Math.abs((h / 60) % 2 - 1)),\r\n\t\t\tm = l - c / 2,\r\n\t\t\tr = 0,\r\n\t\t\tg = 0,\r\n\t\t\tb = 0\r\n\r\n\t\tif (0 <= h && h < 60) {\r\n\t\t\tr = c; g = x; b = 0;\r\n\t\t} else if (60 <= h && h < 120) {\r\n\t\t\tr = x; g = c; b = 0;\r\n\t\t} else if (120 <= h && h < 180) {\r\n\t\t\tr = 0; g = c; b = x;\r\n\t\t} else if (180 <= h && h < 240) {\r\n\t\t\tr = 0; g = x; b = c;\r\n\t\t} else if (240 <= h && h < 300) {\r\n\t\t\tr = x; g = 0; b = c;\r\n\t\t} else if (300 <= h && h < 360) {\r\n\t\t\tr = c; g = 0; b = x;\r\n\t\t}\r\n\t\t\r\n\t\tr = Math.round((r + m) * 255)\r\n\t\tg = Math.round((g + m) * 255)\r\n\t\tb = Math.round((b + m) * 255)\r\n\r\n\t\treturn {r: r, g: g, b: b}\r\n\t}\r\n}\r\n\r\nexport interface RGB {\r\n\tr: number,\r\n\tg: number,\r\n\tb: number\r\n}\r\n\r\nexport interface HSL {\r\n\th: number,\r\n\ts: number,\r\n\tl: number\r\n}","import { MapGenerationFunctions, BuildingHeightVariations, Color } from './mapGenerationFunctions.component'\r\nimport { Tile, TileType } from './tile.component'\r\nimport { Config, Position } from './config.component'\r\nimport { Primitives } from './primitives.component'\r\nimport { Modifiers } from './modifiers.component'\r\n\r\nexport class Map {\r\n\r\n\tprivate mapGen: MapGenerationFunctions = new MapGenerationFunctions()\r\n\tprivate config: Config = new Config()\r\n\tprivate primitives: Primitives = new Primitives()\r\n\tprivate mods: Modifiers = new Modifiers()\r\n\r\n\tprivate _mapWidth: number\r\n\tprivate _mapLength: number\r\n\tprivate _mapMaxHeight: number\r\n\tprivate _averageBuildingSize: number\r\n\tprivate _blockHeight: number\r\n\tprivate _maximumBlockIterations: number\r\n\tprivate _additionalBlockIterations: number\r\n\tprivate _mapEdgeWidth: number\r\n\tprivate _highestPoint: number\r\n\tprivate _startBlockXfromCenterDeviation: number\r\n\tprivate _mapHalfLength: number\r\n\tprivate _world: any[][]\r\n\tprivate _blockHeightsArray: number[]\r\n\tprivate _blockGroups: number[]\r\n\tprivate _blockEdges: Position[]\t\r\n\tprivate _blockHeightVariationLabels = [BuildingHeightVariations.TallCenter, BuildingHeightVariations.TallSurrounds, BuildingHeightVariations.Random]\r\n\tprivate _blockHeightVariation = this._blockHeightVariationLabels[Math.floor(Math.random() * 3)]\r\n\tprivate _blockIdIterator: number\r\n\tprivate _blockHeightIterator: number\r\n\tprivate _blockAmountIterator: number\r\n\tprivate _decorationLineH: number\r\n\tprivate _defaultColor: Color\r\n\tprivate _lineColor: Color\r\n\r\n\tconstructor(\t\r\n\t\t\tmapWidth: number, \r\n\t\t\tmapLength: number, \r\n\t\t\tmapMaxHeight: number, \r\n\t\t\tmapEdgeWidth: number,\r\n\t\t\taverageBuildingSize: number,\r\n\t\t\tblockHeight: number,\r\n\t\t\tmaximumBlockIterations: number,\r\n\t\t\tpyramid: boolean)\r\n\t{\r\n\t\tthis._mapWidth = mapWidth\r\n\t\tthis._mapLength = mapLength\r\n\t\tthis._mapMaxHeight = mapMaxHeight\r\n\t\tthis._mapEdgeWidth = mapEdgeWidth\r\n\t\tthis._averageBuildingSize = averageBuildingSize \r\n\t\tthis._blockHeight = blockHeight\r\n\t\tthis._maximumBlockIterations = maximumBlockIterations\r\n\t\tthis._additionalBlockIterations = this.mapGen.calculateAdditionalBlockIterations(maximumBlockIterations)\r\n\t\tthis._blockGroups = []\r\n\t\tthis._blockEdges = []\r\n\t\tthis._blockHeightsArray = []\r\n\t\tthis._mapHalfLength = Math.floor(mapLength / 2)\r\n\t\tthis._blockIdIterator = 0\r\n\t\tthis._blockAmountIterator = 1\r\n\t\tthis._blockHeightIterator = 1\r\n\t\tthis._decorationLineH = -1\r\n\t\tlet newLineHue = this.config.buildingBaseColor.getColorStringByHue(-120)\r\n\t\tlet lineColor = new Color(newLineHue)\r\n\t\tthis._defaultColor = new Color(this.config.buildingBaseColor.hex())\r\n\t\tthis._lineColor = lineColor.changeColorLighting(-30)\r\n\r\n\t\tlet mapLengthHalf = Math.floor(mapLength / 2) \r\n\t\tlet mapWidthHalf = Math.floor(mapWidth / 2)\r\n\t\tlet startBlockXfromCenterDeviation = 7\r\n\t\tlet startblockLength = this._averageBuildingSize + Math.floor(Math.random() * 4)\r\n\t\tlet startblockWidth = this._averageBuildingSize + Math.floor(Math.random() * 3)\r\n\t\tlet startblockXfromCenter = 4 + Math.floor(Math.random() * startBlockXfromCenterDeviation)\r\n\t\tlet startblockLengthHalf = Math.floor(startblockLength / 2)\r\n\t\tlet startblockWidthHalf = Math.floor(startblockWidth / 2)\r\n\t\tlet startingPositionX = Math.floor(this._mapWidth / 2) - Math.floor(startblockXfromCenter / 2)\r\n\r\n\t\tthis._world = []\r\n\t\tlet tileHeight = 0\r\n\t\tlet firstBlockHeight\r\n\r\n\t\tif (this._blockHeightVariation === BuildingHeightVariations.TallCenter) {\r\n\t\t\tfirstBlockHeight = this._blockHeight * 3\r\n\t\t} else if (this._blockHeightVariation === BuildingHeightVariations.TallSurrounds) {\r\n\t\t\tfirstBlockHeight = 3 + Math.round(Math.random())\r\n\t\t\tthis._blockHeight = firstBlockHeight\r\n\t\t} else {\r\n\t\t\tfirstBlockHeight = this._blockHeight + Math.round(Math.random() * 4)\r\n\t\t}\r\n\r\n\t\tif (firstBlockHeight > 6) {\r\n\t\t\tthis._decorationLineH = 4\r\n\t\t} else if (firstBlockHeight > 3) {\r\n\t\t\tthis._decorationLineH = 3\r\n\t\t}\r\n\r\n\t\tconsole.log('base color: ', )\r\n\t\tconsole.log('line color: ', this._lineColor)\r\n\r\n\t\tthis._blockHeight = firstBlockHeight\r\n\r\n\t\tlet hollowBuildingBlock = (Math.round(Math.random()) === 1 ? true : false) \r\n\r\n\t\tfor (let y = 0; y < this.mapLength; y++) {\r\n\r\n\t\t\tthis._world[y] = []\r\n\r\n\t\t\tfor (let x = 0; x < this.mapWidth; x++) {\r\n\r\n\t\t\t\tlet thisBlockGroup = 0\r\n\r\n\t\t\t\tlet column = new Column(false, x, y, 0)\r\n\r\n\t\t\t\tlet yConditions = (y >= mapLengthHalf && y <= (mapLengthHalf + startblockLengthHalf))\r\n\t\t\t\tlet xConditions = (x > startingPositionX && x <= (startingPositionX + startblockWidth))\r\n\r\n\t\t\t\tif (yConditions) {\r\n\r\n\t\t\t\t\tif (xConditions) {\r\n\r\n\t\t\t\t\t\tthisBlockGroup = 1\r\n\t\t\t\t\t\tlet tileStack = []\r\n\r\n\t\t\t\t\t\tfor (let h = 0; h < firstBlockHeight; h++) {\r\n\r\n\t\t\t\t\t\t\tlet thisPillar = 0\r\n\t\t\t\t\t\t\tlet thisWindowed = 0\r\n\t\t\t\t\t\t\tlet isRoof = (h === firstBlockHeight-1) ? true : false\r\n\t\t\t\t\t\t\tlet tileColor = this._defaultColor\r\n\r\n\t\t\t\t\t\t\tif (h === this._decorationLineH) {\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\ttileColor = this._lineColor\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttileColor = this._defaultColor\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\ttileStack.push(\r\n\t\t\t\t\t\t\t\tnew Tile(\r\n\t\t\t\t\t\t\t\t\tthis._blockIdIterator, \r\n\t\t\t\t\t\t\t\t\tx, \r\n\t\t\t\t\t\t\t\t\ty, \r\n\t\t\t\t\t\t\t\t\th, \r\n\t\t\t\t\t\t\t\t\tTileType.Body,\r\n\t\t\t\t\t\t\t\t\ttileColor,\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t'roof':\t\t\tisRoof,\r\n\t\t\t\t\t\t\t\t\t\t'pillar': \t\tthisPillar,\r\n\t\t\t\t\t\t\t\t\t\t'windowed': \tthisWindowed,\r\n\t\t\t\t\t\t\t\t\t\t'tower': \t\tfalse\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t)\r\n\r\n\t\t\t\t\t\t\tif (this._blockGroups.indexOf(thisBlockGroup) === -1) {\r\n\t\t\t\t\t\t\t\tthis._blockGroups.push(thisBlockGroup)\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tthis._blockHeightsArray.push(firstBlockHeight)\r\n\r\n\t\t\t\t\t\t\tthis._blockIdIterator++\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tcolumn = new Column(true, x, y, firstBlockHeight)\r\n\r\n\t\t\t\t\t\tcolumn.blockGroup = thisBlockGroup\r\n\t\t\t\t\t\tcolumn.height = firstBlockHeight\r\n\t\t\t\t\t\tcolumn.corner = false\r\n\t\t\t\t\t\tcolumn.tileStack = tileStack\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._world[y][x] = column\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.setEdges(false)\r\n\r\n\t\t/* Make hollow */\r\n\t\tif (hollowBuildingBlock) {\r\n\r\n\t\t\tfor (let y = 0; y < this.mapLength; y++) {\r\n\t\t\t\tfor (let x = 0; x < this.mapWidth; x++) {\r\n\r\n\t\t\t\t\tlet hasEdge = (this._world[y][x].edge.left || this._world[y][x].edge.bottom || this._world[y][x].edge.right) ? true : false\r\n\r\n\t\t\t\t\tif (this._world[y][x].isDefined && !hasEdge) {\r\n\t\t\t\t\t\tthis._world[y][x] = new Column(false, x, y, 0)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tfor (let i = 0; i < this._additionalBlockIterations; i++) {\r\n\t\t\tthis._world = this.mods.addBuildingComponent(this)\r\n\t\t}\r\n\t\t\r\n\t\tthis._world = this.mods.clearMapEdges(this)\r\n\t\tthis._world = this.mods.mirrorMap(this)\r\n\t\tthis.setEdges(false)\r\n\r\n\t\tconsole.log(this._world)\r\n\t}\r\n\r\n\tget mapWidth(): number {\r\n\t\treturn this._mapWidth\r\n\t}\r\n\r\n\tget mapLength(): number {\r\n\t\treturn this._mapLength\r\n\t}\r\n\r\n\tget mapHalfLength(): number {\r\n\t\treturn this._mapHalfLength\r\n\t}\r\n\r\n\tget mapEdgeWidth(): number {\r\n\t\treturn this._mapEdgeWidth\r\n\t}\r\n\r\n\tget map(): any[] {\r\n\t\treturn this._world\r\n\t}\r\n\r\n\tget blockGroups(): number[] {\r\n\t\treturn this._blockGroups\r\n\t}\r\n\r\n\tset blockGroups(blockGroups: number[]) {\r\n\t\tthis._blockGroups = blockGroups\r\n\t}\r\n\r\n\tget blockHeight(): number {\r\n\t\treturn this._blockHeight\r\n\t}\r\n\r\n\tget mapMaxHeight(): number {\r\n\t\treturn this._mapMaxHeight\r\n\t}\r\n\r\n\tset blockHeight(height: number) {\r\n\t\tthis._blockHeight = height\r\n\t}\r\n\r\n\tget maxBlockIterations(): number {\r\n\t\treturn this._maximumBlockIterations\r\n\t}\r\n\r\n\tget blockAmountIterator(): number {\r\n\t\treturn this._blockAmountIterator\r\n\t}\r\n\r\n\tset blockAmountIterator(i: number) {\r\n\t\tthis._blockAmountIterator = i\r\n\t}\r\n\r\n\tget averageBuildingSize(): number {\r\n\t\treturn this._averageBuildingSize\r\n\t}\r\n\r\n\tget blockEdges(): object[] {\r\n\t\treturn this._blockEdges\r\n\t}\r\n\r\n\tset blockEdges(blockEdges: object[]) {\r\n\t\tthis._blockEdges = blockEdges\r\n\t}\r\n\r\n\tget blockHeightsArray(): number[] {\r\n\t\treturn this._blockHeightsArray\r\n\t}\r\n\r\n\tset blockHeightsArray(heightsArray: number[]) {\r\n\t\tthis._blockHeightsArray = heightsArray\r\n\t}\r\n\r\n\tget blockIdIterator(): number {\r\n\t\treturn this._blockIdIterator\r\n\t}\r\n\r\n\tset blockIdIterator(i: number) {\r\n\t\tthis._blockIdIterator = i\r\n\t}\r\n\r\n\tget blockHeightVariation(): BuildingHeightVariations {\r\n\t\treturn this._blockHeightVariation\r\n\t}\r\n\r\n\tget lineHeight(): number {\r\n\t\treturn this._decorationLineH\r\n\t}\r\n\r\n\tget defaultColor(): Color {\r\n\t\treturn this._defaultColor\r\n\t}\r\n\r\n\tget decorativeColors(): object {\r\n\t\treturn { lineColor: this._lineColor }\r\n\t}\r\n\r\n\tpublic getColumn(x, y): Column {\r\n\t\treturn this._world[y][x]\r\n\t}\r\n\r\n\tpublic getTiles(x, y): Tile[] {\r\n\t\treturn this._world[y][x].tileStack\r\n\t}\r\n\r\n\tpublic getTile(x, y, h): Tile {\r\n\t\treturn this._world[y][x].getTile(h)\r\n\t}\r\n\r\n\tpublic getTopTile(x, y): Tile {\r\n\t\tlet height = this._world[y][x].height\r\n\t\treturn this._world[y][x].getTile(height-1)\r\n\t}\r\n\r\n\tpublic getFirstDefinedColumn(): Column {\r\n\t\tlet column\r\n\r\n\t\tfor (let y = 0; y < this.mapLength; y++) {\r\n\t\t\tfor (let x = 0; x < this.mapWidth; x++) {\r\n\t\t\t\tif (this._world[y][x].isDefined) {\r\n\t\t\t\t\tcolumn = this._world[y][x]\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn column\r\n\t}\r\n\r\n\tpublic addToBuilding(): void {\r\n\t\tthis._world = this.mods.addBuildingComponent(this)\r\n\t\tthis._world = this.mods.mirrorMap(this)\r\n\t\tthis._world = this.mods.clearMapEdges(this)\r\n\t\tthis.setEdges(false)\t\t\r\n\t}\r\n\r\n\tsetEdges(considerLowerEdges: boolean): void {\r\n\r\n\t\tfor (let y = 0; y < this.mapLength; y++) {\r\n\t\t\tfor (let x = 0; x < this.mapWidth; x++) {\r\n\t\t\t\t\r\n\t\t\t\tif (y > 0 && x > 0 && y < this.mapLength - 1 && x < this.mapWidth - 1 && this._world[y][x].isDefined) {\r\n\r\n\t\t\t\t\tif (considerLowerEdges) {\r\n\r\n\t\t\t\t\t\tif (this._world[y-1][x].height < this._world[y][x].height || y === 0) {\r\n\t\t\t\t\t\t\tthis._world[y][x].edge.top = true\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (this._world[y+1][x].height < this._world[y][x].height || y === this.mapLength - 1) {\r\n\t\t\t\t\t\t\tthis._world[y][x].edge.bottom = true\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (this._world[y][x-1].height < this._world[y][x].height) {\r\n\t\t\t\t\t\t\tthis._world[y][x].edge.left = true\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (this._world[y][x+1].height < this._world[y][x].height) {\r\n\t\t\t\t\t\t\tthis._world[y][x].edge.right = true\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tif (!this._world[y-1][x].isDefined || y === 0) {\r\n\t\t\t\t\t\t\tthis._world[y][x].edge.top = true\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (!this._world[y+1][x].isDefined || y === this.mapLength - 1) {\r\n\t\t\t\t\t\t\tthis._world[y][x].edge.bottom = true\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (!this._world[y][x-1].isDefined) {\r\n\t\t\t\t\t\t\tthis._world[y][x].edge.left = true\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (!this._world[y][x+1].isDefined) {\r\n\t\t\t\t\t\t\tthis._world[y][x].edge.right = true\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( (this._world[y][x].edge['top'] && this._world[y][x].edge['right']) ||\r\n\t\t\t\t\t\t (this._world[y][x].edge['top'] && this._world[y][x].edge['left']) ||\r\n\t\t\t\t\t\t (this._world[y][x].edge['bottom'] && this._world[y][x].edge['right']) ||\r\n\t\t\t\t\t\t (this._world[y][x].edge['bottom'] && this._world[y][x].edge['left']) ) {\r\n\t\t\t\t\t\tthis._world[y][x].corner = true\r\n\t\t\t\t\t}\r\n\t\t\t\t}\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getEdges(): Position[] {\r\n\r\n\t\tthis._blockEdges = []\r\n\r\n\t\tfor (let y = 0; y < this._mapLength; y++) {\r\n\t\t\t// only check second half of map\r\n\r\n\t\t\tif (y > this._mapHalfLength + 1 + this._blockAmountIterator && y < this._mapLength - 2) {\r\n\r\n\t\t\t\tfor (let x = 0; x < this._mapWidth; x++) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (x > this._mapEdgeWidth && x < this._mapWidth - 1) {\r\n\r\n\t\t\t\t\t\tif (this._world[y][x].isDefined) {\r\n\r\n\t\t\t\t\t\t\tif (!this._world[y][x+1].isDefined || \r\n\t\t\t\t\t\t\t\t!this._world[y][x-1].isDefined || \r\n\t\t\t\t\t\t\t\t!this._world[y+1][x].isDefined || \r\n\t\t\t\t\t\t\t\t!this._world[y-1][x+1].isDefined || \r\n\t\t\t\t\t\t\t\t!this._world[y-1][x-1].isDefined) {\r\n\r\n\t\t\t\t\t\t\t\tif (y > this._mapLength - 1) {\r\n\t\t\t\t\t\t\t\t\ty = this._mapLength - 1\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tlet pos: Position = {x: x, y: y}\r\n\r\n\t\t\t\t\t\t\t\tthis._blockEdges.push(pos)\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this._blockEdges\r\n\t}\r\n}\r\n\r\nexport class Column {\r\n\r\n\tprivate _defined: boolean\r\n\tprivate _x: number\r\n\tprivate _y: number\r\n\tprivate _height: number\r\n\tprivate _blockGroup: number\r\n\tprivate _corner: boolean\r\n\tprivate _edge: object = { 'top': false, 'right': false, 'bottom': false, 'left': false }\r\n\tprivate _tileStack: Tile[] = []\r\n\r\n\tconstructor(private defined: boolean, private colX: number, private colY: number, private colHeight: number) {\r\n\t\tthis._defined = defined\r\n\t\tthis._x = colX\r\n\t\tthis._y = colY\r\n\t\tthis._height = colHeight\r\n\t}\r\n\r\n\tset x(x: number) {\r\n\t\tthis._x = x\r\n\t}\r\n\r\n\tset y(y: number) {\r\n\t\tthis._y = y\r\n\t}\r\n\r\n\tset height(height: number) {\r\n\t\tthis._height = height\r\n\t}\r\n\r\n\tset blockGroup(groupNum: number) {\r\n\t\tthis._blockGroup = groupNum\r\n\t}\r\n\r\n\tset corner(corner: boolean) {\r\n\t\tthis._corner = corner\r\n\t}\r\n\r\n\tset edge(edge: object) {\r\n\t\tthis._edge = edge\r\n\t}\r\n\r\n\tset tileStack(tiles: Tile[]) {\r\n\t\tthis._tileStack = tiles\r\n\t}\r\n\r\n\tget isDefined(): boolean {\r\n\t\treturn this._defined\r\n\t}\r\n\r\n\tget x(): number {\r\n\t\treturn this._x\r\n\t}\r\n\r\n\tget y(): number {\r\n\t\treturn this._y\r\n\t}\r\n\r\n\tget height(): number {\r\n\t\treturn this._height\r\n\t}\r\n\r\n\tget blockGroup(): number {\r\n\t\treturn this._blockGroup\r\n\t}\r\n\r\n\tget corner(): boolean {\r\n\t\treturn this._corner\r\n\t}\r\n\r\n\tget edge(): object {\r\n\t\treturn this._edge\r\n\t}\r\n\r\n\tget tileStack(): Tile[] {\r\n\t\treturn this._tileStack\r\n\t}\r\n\r\n\tpublic getTile(height: number): Tile {\r\n\t\treturn this._tileStack[height]\r\n\t}\r\n}\r\n","import { Map, Column } from './mapper.component'\r\nimport { MapGenerationFunctions, BuildingHeightVariations, Color } from './mapGenerationFunctions.component'\r\nimport { Tile, TileType } from './tile.component'\r\nimport { Config, Position } from './config.component'\r\n\r\nexport class Modifiers {\r\n\r\n\tprivate config: Config = new Config()\r\n\r\n\tmirrorMap(world: Map): any[][] {\r\n\r\n\t\tlet oldBlockGroups = []\r\n\t\tworld.blockGroups.forEach(id => {\r\n\t\t\toldBlockGroups.push(id)\r\n\t\t})\r\n\r\n\t\tfor (let y = 0; y < world.mapHalfLength; y++) {\r\n\t\t\tif (y < world.mapHalfLength) {\r\n\t\t\t\t\t\t\t\r\n\t\t\t\tfor (let x = 0; x < world.mapWidth; x++) {\r\n\r\n\t\t\t\t\tif (world.map[world.mapLength - y - 1][x].isDefined) {\r\n\r\n\t\t\t\t\t\tlet activeCol = world.map[world.mapLength - y - 1][x]\r\n\t\t\t\t\t\tlet height = activeCol.height\r\n\t\t\t\t\t\tlet blockGroup = oldBlockGroups.length + activeCol.blockGroup\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlet tileStack = []\r\n\r\n\t\t\t\t\t\tfor (let h = 0; h < height; h++) {\r\n\r\n\t\t\t\t\t\t\tlet tileColor = activeCol.tileStack[h].tileColor\r\n\t\t\t\t\t\t\tlet thisPillar = activeCol.tileStack[h].pillar\r\n\t\t\t\t\t\t\tlet thisWindowed = activeCol.tileStack[h].windowed\r\n\t\t\t\t\t\t\tlet isTower = activeCol.tileStack[h].tower\r\n\t\t\t\t\t\t\tlet isRoof = (h === height-1) ? true : false\r\n\r\n\t\t\t\t\t\t\ttileStack.push(\r\n\t\t\t\t\t\t\t\tnew Tile(\r\n\t\t\t\t\t\t\t\t\tworld.blockIdIterator, \r\n\t\t\t\t\t\t\t\t\tx, \r\n\t\t\t\t\t\t\t\t\ty, \r\n\t\t\t\t\t\t\t\t\th, \r\n\t\t\t\t\t\t\t\t\tactiveCol.tileStack[h].tileType,\r\n\t\t\t\t\t\t\t\t\ttileColor,\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t'roof':\t\t\tisRoof,\r\n\t\t\t\t\t\t\t\t\t\t'pillar': \t\tthisPillar,\r\n\t\t\t\t\t\t\t\t\t\t'windowed': \tthisWindowed,\r\n\t\t\t\t\t\t\t\t\t\t'tower': \t\tisTower\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t)\r\n\r\n\t\t\t\t\t\t\tworld.blockIdIterator++\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tworld.blockHeightsArray.push(height)\r\n\r\n\t\t\t\t\t\tif (world.blockGroups.indexOf(blockGroup) === -1) {\r\n\t\t\t\t\t\t\tworld.blockGroups.push(blockGroup)\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tworld.map[y][x] = null\r\n\r\n\t\t\t\t\t\tlet column = new Column(true, x, y, height)\r\n\r\n\t\t\t\t\t\tcolumn.blockGroup = blockGroup\r\n\t\t\t\t\t\tcolumn.height = height\r\n\t\t\t\t\t\tcolumn.corner = false\r\n\t\t\t\t\t\tcolumn.tileStack = tileStack\r\n\r\n\t\t\t\t\t\tworld.map[y][x] = column\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn world.map\r\n\t}\r\n\t\r\n\tclearMapEdges(world: Map): any[][] {\r\n\r\n\t\tfor (let y = 0; y < world.mapLength; y++) {\r\n\t\t\tfor (let x = 0; x < world.mapWidth; x++) {\r\n\t\t\t\tif (x < world.mapEdgeWidth || x >= world.mapWidth - world.mapEdgeWidth ||\r\n\t\t\t\t\ty < world.mapEdgeWidth || y >= world.mapLength - world.mapEdgeWidth) {\r\n\t\t\t\t\tworld.map[y][x] = null\r\n\t\t\t\t\tlet column = new Column(false, x, y, 0)\r\n\t\t\t\t\tcolumn.tileStack = []\r\n\t\t\t\t\tworld.map[y][x] = column\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn world.map\r\n\t}\r\n\r\n\taddBuildingComponent(world: Map): any[][] {\r\n\r\n\t\tif (world.blockAmountIterator < world.maxBlockIterations) {\r\n\r\n\t\t\tworld.blockEdges = world.getEdges()\r\n\r\n\t\t\tif (world.blockEdges.length > 0) {\t\t\t\r\n\r\n\t\t\t\tlet nextHeight\r\n\r\n\t\t\t\tif (world.blockHeightVariation === BuildingHeightVariations.TallCenter) {\r\n\t\t\t\t\tnextHeight = world.blockHeight - (world.blockAmountIterator)\r\n\t\t\t\t} else if (world.blockHeightVariation === BuildingHeightVariations.TallSurrounds) {\r\n\t\t\t\t\tnextHeight = world.blockHeight + (world.blockAmountIterator * Math.ceil(Math.random() * 2))\r\n\t\t\t\t} else if (world.blockHeightVariation === BuildingHeightVariations.Random) {\r\n\t\t\t\t\tlet randomNum = Math.ceil(Math.random() * 4)\r\n\t\t\t\t\tlet randomAdd = Math.round(Math.random())\r\n\t\t\t\t\tif (randomAdd === 0 && world.blockHeight > 3) {\r\n\t\t\t\t\t\tnextHeight = world.blockHeight - randomNum\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tnextHeight = world.blockHeight + randomNum\r\n\t\t\t\t\t}\t\t\t\t\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (nextHeight < 2) {\r\n\t\t\t\t\tnextHeight = 1\r\n\t\t\t\t} else if (nextHeight > world.mapMaxHeight) {\r\n\t\t\t\t\tnextHeight = world.mapMaxHeight\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet randomEdgePoint = Math.floor(Math.random() * world.blockEdges.length)\r\n\t\t\t\tlet creationPoint: Position = world.blockEdges[randomEdgePoint]\r\n\t\t\t\tlet blockGroup = world.blockGroups.length + 1\r\n\t\t\t\tlet manipulateExistingCols = (Math.round(Math.random()) < 1) ? false : true\r\n\t\t\t\tlet nextBlockWidth = (world.averageBuildingSize ) + Math.floor(Math.random() * 5)\r\n\t\t\t\tlet nextBlockLength = (world.averageBuildingSize ) + Math.floor(Math.random() * 5)\r\n\t\t\t\tlet yStartOffset = 1 + Math.floor(Math.random() * 2)\r\n\t\t\t\tlet hollowBuildingBlock = Math.round(Math.random()) === 1 ? true : false\r\n\r\n\t\t\t\tconsole.log('nextBlockWidth', nextBlockWidth)\r\n\t\t\t\tconsole.log('nextBlockLength', nextBlockLength)\r\n\t\t\t\t\r\n\t\t\t\tif (nextBlockWidth > 4 && nextBlockLength > 4) {\r\n\t\t\t\t\thollowBuildingBlock = false // true\r\n\t\t\t\t} else {\r\n\t\t\t\t\thollowBuildingBlock = false\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconsole.log('edges:', world.blockEdges)\t\t\t\r\n\t\t\t\tconsole.log('creation y left: ', creationPoint.y - (nextBlockLength - yStartOffset))\r\n\t\t\t\tconsole.log('creation y right: ', creationPoint.y + (nextBlockLength))\r\n\t\t\t\tconsole.log('creation x left: ', creationPoint.x - (nextBlockWidth / 2))\r\n\t\t\t\tconsole.log('creation x right: ', creationPoint.x + (nextBlockWidth / 2))\r\n\r\n\t\t\t\tfor (let y = 0; y < world.mapLength; y++) {\r\n\t\t\t\t\tfor (let x = 0; x < world.mapWidth; x++) {\r\n\r\n\t\t\t\t\t\tlet yConditions = x > (creationPoint.x - (nextBlockWidth / 2)) && x < (creationPoint.x + (nextBlockWidth / 2))\r\n\t\t\t\t\t\tlet xConditions = (y > creationPoint.y - yStartOffset && y < creationPoint.y + nextBlockLength - yStartOffset)\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (yConditions) {\r\n\t\t\t\t\t\t\tif (xConditions) {\r\n\r\n\t\t\t\t\t\t\t\tconsole.log('placement on y: ' + y)\r\n\r\n\t\t\t\t\t\t\t\tlet createCol = true\r\n\r\n\t\t\t\t\t\t\t\tif (hollowBuildingBlock) {\r\n\t\t\t\t\t\t\t\t\tif (y > creationPoint.y + 1 && y < creationPoint.y + nextBlockLength - 1) {\r\n\t\t\t\t\t\t\t\t\t\tif ((x > (creationPoint.x - (nextBlockWidth / 2)) && x < creationPoint.x - (nextBlockWidth / 2) + 2)\r\n\t\t\t\t\t\t\t\t\t\t\t||\r\n\t\t\t\t\t\t\t\t\t\t\t(x < (creationPoint.x + (nextBlockWidth / 2)) && x > creationPoint.x - (nextBlockWidth / 2) - 2)) {\r\n\t\t\t\t\t\t\t\t\t\t\tcreateCol = false\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tif (createCol) {\r\n\r\n\t\t\t\t\t\t\t\t\tlet tileStack = []\r\n\r\n\t\t\t\t\t\t\t\t\tfor (let h = 0; h < nextHeight; h++) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tlet thisPillar = 0\r\n\t\t\t\t\t\t\t\t\t\tlet thisWindowed = 0\r\n\t\t\t\t\t\t\t\t\t\tlet isRoof = (h === nextHeight-1) ? true : false\r\n\t\t\t\t\t\t\t\t\t\tlet tileColor = world.getFirstDefinedColumn().tileStack[0].tileColor\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (h === world.lineHeight) {\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\ttileColor = world.decorativeColors['lineColor']\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\ttileColor = world.defaultColor\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\ttileStack.push(\r\n\t\t\t\t\t\t\t\t\t\t\tnew Tile(\r\n\t\t\t\t\t\t\t\t\t\t\t\tworld.blockIdIterator, \r\n\t\t\t\t\t\t\t\t\t\t\t\tx, \r\n\t\t\t\t\t\t\t\t\t\t\t\ty, \r\n\t\t\t\t\t\t\t\t\t\t\t\th, \r\n\t\t\t\t\t\t\t\t\t\t\t\tTileType.Body,\r\n\t\t\t\t\t\t\t\t\t\t\t\ttileColor,\r\n\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t'roof':\t\t\tisRoof,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t'pillar': \t\tthisPillar,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t'windowed': \tthisWindowed,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t'tower': \t\tfalse\r\n\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t)\t\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t\t\t\tworld.blockHeightsArray.push(nextHeight)\r\n\r\n\t\t\t\t\t\t\t\t\t\tworld.blockIdIterator++\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tif (world.blockGroups.indexOf(blockGroup) === -1) {\r\n\t\t\t\t\t\t\t\t\t\tworld.blockGroups.push(blockGroup)\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tworld.map[y][x] = null\r\n\r\n\t\t\t\t\t\t\t\t\tlet column = new Column(true, x, y, nextHeight)\r\n\r\n\t\t\t\t\t\t\t\t\tcolumn.blockGroup = blockGroup\r\n\t\t\t\t\t\t\t\t\tcolumn.height = nextHeight\r\n\t\t\t\t\t\t\t\t\tcolumn.corner = false\r\n\t\t\t\t\t\t\t\t\tcolumn.tileStack = tileStack\r\n\r\n\t\t\t\t\t\t\t\t\tworld.map[y][x] = column\t\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tworld.blockHeight = nextHeight\r\n\r\n\t\t\t\tworld.blockAmountIterator++\r\n\r\n\t\t\t} else {\t\t\r\n\t\t\t\tconsole.warn(\"Block edges array is empty.\")\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\t\t\tconsole.warn(\"Cannot add more building components, maximum block iterations reached.\")\r\n\t\t}\r\n\r\n\t\treturn world.map\r\n\t}\t\r\n}","export class Primitives {\r\n\r\n\tgetPyramid(): number[][] {\r\n\r\n\t\treturn [\r\n\t\t\t\t[0,0,0,0,0,0,0,0,0,0,0,0],\r\n\t\t\t\t[0,1,1,1,1,1,1,1,1,1,1,0],\r\n\t\t\t\t[0,1,2,2,2,2,2,2,2,2,1,0],\r\n\t\t\t\t[0,1,2,3,3,3,3,3,3,2,1,0],\r\n\t\t\t\t[0,1,2,3,4,4,4,4,3,2,1,0],\r\n\t\t\t\t[0,1,2,3,4,5,5,4,3,2,1,0],\r\n\t\t\t\t[0,1,2,3,4,5,5,4,3,2,1,0],\r\n\t\t\t\t[0,1,2,3,4,4,4,4,3,2,1,0],\r\n\t\t\t\t[0,1,2,3,3,3,3,3,3,2,1,0],\r\n\t\t\t\t[0,1,2,2,2,2,2,2,2,2,1,0],\r\n\t\t\t\t[0,1,1,1,1,1,1,1,1,1,1,0],\r\n\t\t\t\t[0,0,0,0,0,0,0,0,0,0,0,0],\r\n\t\t\t]\r\n\t}\r\n}","import { Config, Coords, TileTemplate, Position } from './config.component'\r\nimport { MapGenerationFunctions, Color } from './mapGenerationFunctions.component'\r\nimport { Tile, TileType } from './tile.component'\r\n\r\nexport class RenderElements {\r\n\r\n\tprivate config: Config = new Config()\r\n\tprivate calculations: MapGenerationFunctions = new MapGenerationFunctions()\r\n\r\n\tprivate tileW: number = this.config.tileWidth\r\n\tprivate tileL: number = this.config.tileLength\r\n\tprivate tileH: number = this.config.tileHeight\r\n\tprivate bleed: number = this.config.tileEdgeBleed\r\n\tprivate dimensions = this.calculations.calculateStraightLinesFromIsometricSquare(this.tileW, this.tileL)\r\n\r\n\tprivate tileColor: string = this.config.groundColor.hex()\r\n\tprivate regularColor: string = this.config.buildingBaseColor.hex()\r\n\tprivate regularDarkerColor: string = this.config.buildingBaseColor.changeColorLightingString(-10)\r\n\tprivate regularLighterColor: string = this.config.buildingBaseColor.changeColorLightingString(10)\r\n\tprivate shadowLight: string = this.config.buildingBaseColor.changeColorLightingString(-20)\r\n\tprivate shadowHighlight: string = this.config.buildingBaseColor.changeColorLightingString(20)\r\n\tprivate shadow: string = this.config.buildingBaseColor.changeColorLightingString(-30)\r\n\tprivate highlight: string = this.config.buildingBaseColor.changeColorLightingString(30)\r\n\tprivate almostDarkestColor: string = this.config.buildingBaseColor.changeColorLightingString(-40)\r\n\tprivate almostLightestColor: string = this.config.buildingBaseColor.changeColorLightingString(40)\r\n\tprivate darkestColor: string = this.config.buildingBaseColor.changeColorLightingString(-50)\r\n\tprivate lightestColor: string = this.config.buildingBaseColor.changeColorLightingString(50)\r\n\r\n\tcreateTile(xPos: number, yPos: number): TileTemplate {\r\n\r\n\t\tlet top: Position = { \"x\": (xPos + this.dimensions.horizontalWidthFromTop), \"y\": yPos}\r\n\t\tlet left: Position = { \"x\": xPos, \"y\": (yPos + this.dimensions.verticalHeightFromTop) }\r\n\t\tlet bottom: Position = { \"x\": (xPos + this.dimensions.horizontalWidthFromBottom), \"y\": (yPos + this.dimensions.totalHeight) }\r\n\t\tlet right: Position = { \"x\": (xPos + this.dimensions.totalWidth), \"y\": (yPos + this.dimensions.verticalHeightFromBottom) }\r\n\r\n\t\tlet pointTop = `${top.x} ${top.y-this.bleed}`\r\n\t\tlet pointLeft = `${left.x-this.bleed} ${left.y}`\r\n\t\tlet pointBottom = `${bottom.x} ${bottom.y+this.bleed}`\r\n\t\tlet pointRight = `${right.x+this.bleed} ${right.y}`\r\n\r\n\t\tvar html = `<path fill=\"${this.tileColor}\"\r\n\t\t\t\t\td=\"M${pointLeft} \r\n\t\t\t\t\tL${pointBottom} \r\n\t\t\t\t\tL${pointRight} \r\n\t\t\t\t\tL${pointTop} \r\n\t\t\t\t\tL${pointLeft} Z\" />`\r\n\r\n\t\tlet coords: Coords = { \"top\": top, \"left\": left, \"bottom\": bottom, \"right\": right }\r\n\r\n\t\treturn { html: html, coords: coords }\r\n\t}\r\n\r\n\tcreateBlock(xPos: number, yPos: number, tile: Tile): TileTemplate {\r\n\r\n\t\tlet id = tile.id\r\n\t\tlet height = (tile.h * this.tileH) - this.tileH\r\n\r\n\t\tlet regularColor\r\n\t\tlet highlight\r\n\t\tlet darkestColor\r\n\r\n\t\tif (tile.tileColor.hex() !== this.config.buildingBaseColor.hex()) {\r\n\t\t\tregularColor = tile.tileColor.hex()\r\n\t\t\thighlight = tile.tileColor.changeColorLightingString(30)\r\n\t\t\tdarkestColor = tile.tileColor.changeColorLightingString(-50)\r\n\t\t} else {\r\n\t\t\tregularColor = this.config.buildingBaseColor.hex()\r\n\t\t\thighlight = this.config.buildingBaseColor.changeColorLightingString(30)\r\n\t\t\tdarkestColor = this.config.buildingBaseColor.changeColorLightingString(-50)\r\n\t\t}\t\r\n\r\n\t\tlet top: Position = { \"x\": Math.ceil(xPos + this.dimensions.horizontalWidthFromTop), \"y\": Math.ceil(yPos + this.config.topMargin ) }\r\n\t\tlet left: Position = { \"x\": Math.ceil(xPos), \"y\": Math.ceil(yPos + this.dimensions.verticalHeightFromTop + this.config.topMargin ) }\r\n\t\tlet bottom: Position = { \"x\": Math.ceil(xPos + this.dimensions.horizontalWidthFromBottom), \"y\": Math.ceil(yPos + this.dimensions.totalHeight + this.config.topMargin ) }\r\n\t\tlet right: Position = { \"x\": Math.ceil(xPos + this.dimensions.totalWidth), \"y\": Math.ceil(yPos + this.dimensions.verticalHeightFromBottom + this.config.topMargin ) }\r\n\r\n\t\tlet leftWallLeftTop = `${left.x-this.bleed} ${left.y-height-this.tileH}`\r\n\t\tlet leftWallLeftBottom = `${left.x-this.bleed} ${left.y-height+this.bleed}`\r\n\t\tlet leftWallRightBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\tlet leftWallRightTop = `${bottom.x} ${bottom.y-height-this.tileH}`\r\n\r\n\t\tlet rightWallLeftTop = `${bottom.x} ${bottom.y-height-this.tileH}`\r\n\t\tlet rightWallLeftBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\tlet rightWallRightBottom = `${right.x+this.bleed} ${right.y-height+this.bleed}`\r\n\t\tlet rightWallRightTop = `${right.x+this.bleed} ${right.y-height-this.tileH}`\r\n\r\n\t\tlet blockTopLeft = `${left.x-this.bleed} ${left.y-height-this.tileH}`\r\n\t\tlet blockTopBottom = `${bottom.x} ${bottom.y-height-this.tileH}`\r\n\t\tlet blockTopRight = `${right.x+this.bleed} ${right.y-height-this.tileH}`\r\n\t\tlet blockTopTop = `${top.x} ${top.y-height-this.tileH}`\r\n\r\n\t\tlet html = `<g style=\"z-index:${id};\"><path fill=\"${darkestColor}\"\r\n\t\t\t\t\td=\"M${leftWallLeftTop} \r\n\t\t\t\t\tL${leftWallLeftBottom} \r\n\t\t\t\t\tL${leftWallRightBottom} \r\n\t\t\t\t\tL${leftWallRightTop} \r\n\t\t\t\t\tL${leftWallLeftTop} Z\" />\r\n\t\t\t\t\t<path fill=\"${regularColor}\"\r\n\t\t\t\t\td=\"M${rightWallLeftTop} \r\n\t\t\t\t\tL${rightWallLeftBottom} \r\n\t\t\t\t\tL${rightWallRightBottom} \r\n\t\t\t\t\tL${rightWallRightTop} \r\n\t\t\t\t\tL${rightWallLeftTop} Z\" />\r\n\t\t\t\t\t<path fill=\"${highlight}\"\r\n\t\t\t\t\td=\"M${blockTopLeft} \r\n\t\t\t\t\tL${blockTopBottom} \r\n\t\t\t\t\tL${blockTopRight} \r\n\t\t\t\t\tL${blockTopTop} \r\n\t\t\t\t\tL${blockTopLeft} Z\" /></g>`\r\n\r\n\t\tlet coords: Coords = { \"top\": top, \"left\": left, \"bottom\": bottom, \"right\": right }\r\n\r\n\t\treturn { html: html, coords: coords }\r\n\t}\r\n\r\n\tcreateSlopeBlock(xPos: number, yPos: number, tile: Tile, slopeDirection: string): TileTemplate {\r\n\r\n\t\tlet id = tile.id\r\n\t\tlet height = (tile.h * this.tileH) - this.tileH\r\n\r\n\t\tlet top: Position = { \"x\": Math.ceil(xPos + this.dimensions.horizontalWidthFromTop), \"y\": Math.ceil(yPos) }\r\n\t\tlet left: Position = { \"x\": Math.ceil(xPos), \"y\": Math.ceil(yPos + this.dimensions.verticalHeightFromTop) }\r\n\t\tlet bottom: Position = { \"x\": Math.ceil(xPos + this.dimensions.horizontalWidthFromBottom), \"y\": Math.ceil(yPos + this.dimensions.totalHeight) }\r\n\t\tlet right: Position = { \"x\": Math.ceil(xPos + this.dimensions.totalWidth), \"y\": Math.ceil(yPos + this.dimensions.verticalHeightFromBottom) }\r\n\r\n\t\tlet html = ''\r\n\t\tlet coords: Coords = { \"top\": top, \"left\": left, \"bottom\": bottom, \"right\": right }\r\n\r\n\t\tif (slopeDirection === 'n') {\r\n\r\n\t\t\tlet leftWallLeftTop = `${left.x-this.bleed} ${left.y-height-this.tileH}`\r\n\t\t\tlet leftWallLeftBottom = `${left.x-this.bleed} ${left.y-height+this.bleed}`\r\n\t\t\tlet leftWallRightBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\t\tlet leftWallRightTop = `${bottom.x} ${bottom.y-height-this.tileH}`\r\n\r\n\t\t\tlet rightWallLeftTop = `${bottom.x} ${bottom.y-height-this.tileH}`\r\n\t\t\tlet rightWallLeftBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\t\tlet rightWallRightBottom = `${right.x+this.bleed} ${right.y-height+this.bleed}`\r\n\r\n\t\t\tlet blockTopLeft = `${left.x-this.bleed} ${left.y-height-this.tileH}`\r\n\t\t\tlet blockTopBottom = `${bottom.x} ${bottom.y-height-this.tileH}`\r\n\t\t\tlet blockTopRight = `${right.x+this.bleed} ${right.y-height+this.bleed}`\r\n\t\t\tlet blockTopTop = `${top.x} ${top.y-height}`\r\n\r\n\t\t\thtml = `<g style=\"z-index:${id};\">\r\n\t\t\t\t\t\t\t<path fill=\"${this.shadow}\"\r\n\t\t\t\t\t\t\td=\"M${leftWallLeftTop} \r\n\t\t\t\t\t\t\tL${leftWallLeftBottom} \r\n\t\t\t\t\t\t\tL${leftWallRightBottom} \r\n\t\t\t\t\t\t\tL${leftWallRightTop} \r\n\t\t\t\t\t\t\tL${leftWallLeftTop} Z\" />\r\n\t\t\t\t\t\t\t<path fill=\"${this.regularColor}\"\r\n\t\t\t\t\t\t\td=\"M${rightWallLeftTop}\r\n\t\t\t\t\t\t\tL${rightWallLeftBottom}\r\n\t\t\t\t\t\t\tL${rightWallRightBottom}\r\n\t\t\t\t\t\t\tL${rightWallLeftTop} Z\" />\r\n\t\t\t\t\t\t\t<path fill=\"${this.lightestColor}\"\r\n\t\t\t\t\t\t\td=\"M${blockTopLeft}\r\n\t\t\t\t\t\t\tL${blockTopBottom}\r\n\t\t\t\t\t\t\tL${blockTopRight}\r\n\t\t\t\t\t\t\tL${blockTopTop}\r\n\t\t\t\t\t\t\tL${blockTopLeft} Z\" />\r\n\t\t\t\t\t\t</g>`\r\n\t\t}\r\n\r\n\t\tif (slopeDirection === 'nw') {\r\n\r\n\t\t\tconsole.log('northwest')\r\n\r\n\t\t\tlet leftWallLeftTop = `${left.x-this.bleed} ${left.y-height}`\r\n\t\t\tlet leftWallLeftBottom = `${left.x-this.bleed} ${left.y-height+this.bleed}`\r\n\t\t\tlet leftWallRightBottom = `${bottom.x} ${bottom.y-height-this.tileH+this.bleed}`\r\n\r\n\t\t\tlet blockTopLeft = `${left.x-this.bleed} ${left.y-height+this.bleed}`\r\n\t\t\tlet blockTopBottom = `${bottom.x} ${bottom.y-height-this.tileH+this.bleed}`\r\n\t\t\tlet blockTopTop = `${top.x} ${top.y-height}`\r\n\r\n\t\t\tlet blockRightBottom = `${bottom.x} ${bottom.y-height-this.tileH}`\r\n\t\t\tlet blockRightRight = `${right.x+this.bleed} ${right.y-height+this.bleed}`\r\n\t\t\tlet blockRightTop = `${top.x} ${top.y-height}`\r\n\r\n\t\t\thtml = `<g style=\"z-index:${id};\">\r\n\t\t\t\t\t\t\t<path fill=\"${this.darkestColor}\"\r\n\t\t\t\t\t\t\td=\"M${leftWallLeftTop}\r\n\t\t\t\t\t\t\tL${leftWallLeftBottom}\r\n\t\t\t\t\t\t\tL${leftWallRightBottom}\r\n\t\t\t\t\t\t\tL${leftWallLeftTop} Z\" />\r\n\t\t\t\t\t\t\t<path fill=\"${this.regularDarkerColor}\"\r\n\t\t\t\t\t\t\td=\"M${blockTopLeft}\r\n\t\t\t\t\t\t\tL${blockTopBottom}\r\n\t\t\t\t\t\t\tL${blockTopTop}\r\n\t\t\t\t\t\t\tL${blockTopLeft} Z\" />\r\n\t\t\t\t\t\t\t<path fill=\"${this.lightestColor}\"\r\n\t\t\t\t\t\t\td=\"M${blockRightBottom}\r\n\t\t\t\t\t\t\tL${blockRightRight}\r\n\t\t\t\t\t\t\tL${blockRightTop}\r\n\t\t\t\t\t\t\tL${blockRightBottom} Z\" />\r\n\t\t\t\t\t\t</g>`\r\n\t\t}\r\n\r\n\t\tif (slopeDirection === 's') {\r\n\r\n\t\t\tlet rightWallLeftBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\t\tlet rightWallRightBottom = `${right.x+this.bleed} ${right.y-height+this.bleed}`\r\n\t\t\tlet rightWallRightTop = `${right.x+this.bleed} ${right.y-height-this.tileH}`\r\n\r\n\t\t\tlet blockTopLeft = `${left.x-this.bleed} ${left.y-height+this.bleed}`\r\n\t\t\tlet blockTopBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\t\tlet blockTopRight = `${right.x+this.bleed} ${right.y-height-this.tileH+this.bleed}`\r\n\t\t\tlet blockTopTop = `${top.x} ${top.y-height-this.tileH}`\r\n\r\n\t\t\thtml = `<g style=\"z-index:${id};\">\r\n\t\t\t\t\t\t\t<path fill=\"${this.regularColor}\"\r\n\t\t\t\t\t\t\td=\"M${rightWallLeftBottom}\r\n\t\t\t\t\t\t\tL${rightWallRightBottom}\r\n\t\t\t\t\t\t\tL${rightWallRightTop}\r\n\t\t\t\t\t\t\tL${rightWallLeftBottom} Z\" />\r\n\t\t\t\t\t\t\t<path fill=\"${this.shadow}\"\r\n\t\t\t\t\t\t\td=\"M${blockTopLeft}\r\n\t\t\t\t\t\t\tL${blockTopBottom}\r\n\t\t\t\t\t\t\tL${blockTopRight}\r\n\t\t\t\t\t\t\tL${blockTopTop}\r\n\t\t\t\t\t\t\tL${blockTopLeft} Z\" />\r\n\t\t\t\t\t\t</g>`\r\n\t\t}\r\n\r\n\t\tif (slopeDirection === 'se') {\r\n\r\n\t\t\tlet blockLeftLeft = `${left.x-this.bleed} ${left.y-height+this.bleed}`\r\n\t\t\tlet blockLeftBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\t\tlet blockLeftTop = `${top.x} ${top.y-height-this.tileH}`\r\n\r\n\t\t\tlet blockRightBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\t\tlet blockRightRight = `${right.x+this.bleed} ${right.y-height+this.bleed}`\r\n\t\t\tlet blockRightTop = `${top.x} ${top.y-height-this.tileH}`\r\n\r\n\t\t\thtml = `<g style=\"z-index:${id};\">\r\n\t\t\t\t\t\t<path fill=\"${this.shadow}\"\r\n\t\t\t\t\t\td=\"M${blockLeftLeft}\r\n\t\t\t\t\t\tL${blockLeftBottom}\r\n\t\t\t\t\t\tL${blockLeftTop}\r\n\t\t\t\t\t\tL${blockLeftLeft} Z\" />\r\n\t\t\t\t\t\t<path fill=\"${this.regularDarkerColor}\"\r\n\t\t\t\t\t\td=\"M${blockRightRight}\r\n\t\t\t\t\t\tL${blockRightBottom}\r\n\t\t\t\t\t\tL${blockRightTop}\r\n\t\t\t\t\t\tL${blockRightRight} Z\" />\r\n\t\t\t\t\t</g>`\r\n\t\t}\r\n\r\n\t\tif (slopeDirection === 'e') {\r\n\r\n\t\t\tlet leftWallLeftTop = `${left.x-this.bleed} ${left.y-height-this.tileH}`\r\n\t\t\tlet leftWallLeftBottom = `${left.x-this.bleed} ${left.y-height+this.bleed}`\r\n\t\t\tlet leftWallRightBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\r\n\t\t\tlet blockTopLeft = `${left.x-this.bleed} ${left.y-height-this.tileH+this.bleed}`\r\n\t\t\tlet blockTopBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\t\tlet blockTopRight = `${right.x+this.bleed} ${right.y-height+this.bleed}`\r\n\t\t\tlet blockTopTop = `${top.x} ${top.y-height-this.tileH}`\r\n\r\n\t\t\thtml = `<g style=\"z-index:${id};\">\r\n\t\t\t\t\t\t\t<path fill=\"${this.darkestColor}\"\r\n\t\t\t\t\t\t\td=\"M${leftWallLeftTop}\r\n\t\t\t\t\t\t\tL${leftWallLeftBottom}\r\n\t\t\t\t\t\t\tL${leftWallRightBottom}\r\n\t\t\t\t\t\t\tL${leftWallLeftTop} Z\" />\r\n\t\t\t\t\t\t\t<path fill=\"${this.regularDarkerColor}\"\r\n\t\t\t\t\t\t\td=\"M${blockTopLeft}\r\n\t\t\t\t\t\t\tL${blockTopBottom}\r\n\t\t\t\t\t\t\tL${blockTopRight}\r\n\t\t\t\t\t\t\tL${blockTopTop}\r\n\t\t\t\t\t\t\tL${blockTopLeft} Z\" />\r\n\t\t\t\t\t\t</g>`\r\n\t\t}\r\n\r\n\t\tif (slopeDirection === 'ne') {\r\n\r\n\t\t\tlet leftWallLeftTop = `${left.x-this.bleed} ${left.y-height-this.tileH}`\r\n\t\t\tlet leftWallLeftBottom = `${left.x-this.bleed} ${left.y-height+this.bleed}`\r\n\t\t\tlet leftWallRightBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\r\n\t\t\tlet blockBottomLeft = `${left.x-this.bleed} ${left.y-height-this.tileH+this.bleed}`\r\n\t\t\tlet blockBottomRight = `${right.x+this.bleed} ${right.y-height+this.bleed}`\r\n\t\t\tlet blockBottomTop = `${top.x} ${top.y-height}`\r\n\r\n\t\t\tlet blockTopLeft = `${left.x-this.bleed} ${left.y-height-this.tileH+this.bleed}`\r\n\t\t\tlet blockTopBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\t\tlet blockTopRight = `${right.x+this.bleed} ${right.y-height+this.bleed}`\r\n\r\n\t\t\thtml = `<g style=\"z-index:${id};\">\r\n\t\t\t\t\t\t<path fill=\"${this.darkestColor}\"\r\n\t\t\t\t\t\td=\"M${leftWallLeftTop}\r\n\t\t\t\t\t\tL${leftWallLeftBottom}\r\n\t\t\t\t\t\tL${leftWallRightBottom}\r\n\t\t\t\t\t\tL${leftWallLeftTop} Z\" />\r\n\t\t\t\t\t\t<path fill=\"${this.regularDarkerColor}\"\r\n\t\t\t\t\t\td=\"M${blockTopLeft}\r\n\t\t\t\t\t\tL${blockTopBottom}\r\n\t\t\t\t\t\tL${blockTopRight}\r\n\t\t\t\t\t\tL${blockTopLeft} Z\" />\r\n\t\t\t\t\t\t<path fill=\"${this.lightestColor}\"\r\n\t\t\t\t\t\td=\"M${blockBottomLeft}\r\n\t\t\t\t\t\tL${blockBottomTop}\r\n\t\t\t\t\t\tL${blockBottomRight}\r\n\t\t\t\t\t\tL${blockBottomLeft} Z\" />\r\n\t\t\t\t\t</g>`\r\n\t\t}\r\n\r\n\t\tif (slopeDirection === 'w') {\r\n\r\n\t\t\tlet leftWallLeftTop = `${left.x-this.bleed} ${left.y-height}`\r\n\t\t\tlet leftWallLeftBottom = `${left.x-this.bleed} ${left.y-height+this.bleed}`\r\n\t\t\tlet leftWallRightBottom = `${bottom.x} ${bottom.y-height-this.tileH+this.bleed}`\r\n\r\n\t\t\tlet blockTopLeft = `${left.x-this.bleed} ${left.y-height+this.bleed}`\r\n\t\t\tlet blockTopBottom = `${bottom.x} ${bottom.y-height-this.tileH+this.bleed}`\r\n\t\t\tlet blockTopRight = `${right.x+this.bleed} ${right.y-height-this.tileH+this.bleed}`\r\n\t\t\tlet blockTopTop = `${top.x} ${top.y-height}`\r\n\r\n\t\t\thtml = `<g style=\"z-index:${id};\">\r\n\t\t\t\t\t\t\t<path fill=\"${this.darkestColor}\"\r\n\t\t\t\t\t\t\td=\"M${leftWallLeftTop}\r\n\t\t\t\t\t\t\tL${leftWallLeftBottom}\r\n\t\t\t\t\t\t\tL${leftWallRightBottom}\r\n\t\t\t\t\t\t\tL${leftWallLeftTop} Z\" />\r\n\t\t\t\t\t\t\t<path fill=\"${this.regularDarkerColor}\"\r\n\t\t\t\t\t\t\td=\"M${blockTopLeft}\r\n\t\t\t\t\t\t\tL${blockTopBottom}\r\n\t\t\t\t\t\t\tL${blockTopRight}\r\n\t\t\t\t\t\t\tL${blockTopTop}\r\n\t\t\t\t\t\t\tL${blockTopLeft} Z\" />\r\n\t\t\t\t\t\t</g>`\r\n\t\t}\r\n\r\n\t\tif (slopeDirection === 'sw') {\r\n\r\n\t\t\tlet rightWallLeftBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\t\tlet rightWallRightBottom = `${right.x+this.bleed} ${right.y-height+this.bleed}`\r\n\t\t\tlet rightWallRightTop = `${right.x+this.bleed} ${right.y-height-this.tileH}`\r\n\r\n\t\t\tlet blockTopLeft = `${left.x-this.bleed} ${left.y-height+this.bleed}`\r\n\t\t\tlet blockTopBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\t\tlet blockTopRight = `${right.x+this.bleed} ${right.y-height-this.tileH+this.bleed}`\r\n\t\t\tlet blockTopTop = `${top.x} ${top.y-height}`\r\n\r\n\t\t\thtml = `<g style=\"z-index:${id};\">\r\n\t\t\t\t\t\t\t<path fill=\"${this.regularColor}\"\r\n\t\t\t\t\t\t\td=\"M${rightWallLeftBottom}\r\n\t\t\t\t\t\t\tL${rightWallRightBottom}\r\n\t\t\t\t\t\t\tL${rightWallRightTop}\r\n\t\t\t\t\t\t\tL${rightWallLeftBottom} Z\" />\r\n\t\t\t\t\t\t\t<path fill=\"${this.regularDarkerColor}\"\r\n\t\t\t\t\t\t\td=\"M${blockTopLeft}\r\n\t\t\t\t\t\t\tL${blockTopTop}\r\n\t\t\t\t\t\t\tL${blockTopRight}\r\n\t\t\t\t\t\t\tL${blockTopLeft} Z\" />\r\n\t\t\t\t\t\t\t<path fill=\"${this.shadow}\"\r\n\t\t\t\t\t\t\td=\"M${blockTopLeft}\r\n\t\t\t\t\t\t\tL${blockTopBottom}\r\n\t\t\t\t\t\t\tL${blockTopRight}\r\n\t\t\t\t\t\t\tL${blockTopLeft} Z\" />\r\n\t\t\t\t\t\t</g>`\r\n\t\t}\r\n\r\n\t\treturn { html: html, coords: coords }\r\n\t}\r\n\r\n\tcreatePillarBlock(xPos: number, yPos: number, tile: Tile): TileTemplate {\r\n\r\n\t\tlet id = tile.id\r\n\t\tlet height = (tile.h * this.tileH) - this.tileH\r\n\r\n\t\tlet regularColor\r\n\t\tlet highlight\r\n\t\tlet darkestColor\r\n\r\n\t\tif (tile.tileColor.hex() !== this.config.buildingBaseColor.hex()) {\r\n\t\t\tregularColor = tile.tileColor.hex()\r\n\t\t\thighlight = tile.tileColor.changeColorLightingString(30)\r\n\t\t\tdarkestColor = tile.tileColor.changeColorLightingString(-50)\r\n\t\t} else {\r\n\t\t\tregularColor = this.config.buildingBaseColor.hex()\r\n\t\t\thighlight = this.config.buildingBaseColor.changeColorLightingString(30)\r\n\t\t\tdarkestColor = this.config.buildingBaseColor.changeColorLightingString(-50)\r\n\t\t}\t\r\n\r\n\t\tlet top: Position = { \"x\": Math.ceil(xPos + this.dimensions.horizontalWidthFromTop), \"y\": Math.ceil(yPos + this.config.topMargin ) }\r\n\t\tlet left: Position = { \"x\": Math.ceil(xPos), \"y\": Math.ceil(yPos + this.dimensions.verticalHeightFromTop + this.config.topMargin ) }\r\n\t\tlet bottom: Position = { \"x\": Math.ceil(xPos + this.dimensions.horizontalWidthFromBottom), \"y\": Math.ceil(yPos + this.dimensions.totalHeight + this.config.topMargin ) }\r\n\t\tlet right: Position = { \"x\": Math.ceil(xPos + this.dimensions.totalWidth), \"y\": Math.ceil(yPos + this.dimensions.verticalHeightFromBottom + this.config.topMargin ) }\r\n\r\n\t\tlet leftWallLeftTop = `${left.x-this.bleed} ${left.y-height-this.tileH}`\r\n\t\tlet leftWallLeftBottom = `${left.x-this.bleed} ${left.y-height+this.bleed}`\r\n\t\tlet leftWallRightBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\tlet leftWallRightTop = `${bottom.x} ${bottom.y-height-this.tileH}`\r\n\r\n\t\tlet rightWallLeftTop = `${bottom.x} ${bottom.y-height-this.tileH}`\r\n\t\tlet rightWallLeftBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\tlet rightWallRightBottom = `${right.x+this.bleed} ${right.y-height+this.bleed}`\r\n\t\tlet rightWallRightTop = `${right.x+this.bleed} ${right.y-height-this.tileH}`\r\n\r\n\t\tlet blockTopLeft = `${left.x-this.bleed} ${left.y-height-this.tileH}`\r\n\t\tlet blockTopBottom = `${bottom.x} ${bottom.y-height-this.tileH}`\r\n\t\tlet blockTopRight = `${right.x+this.bleed} ${right.y-height-this.tileH}`\r\n\t\tlet blockTopTop = `${top.x} ${top.y-height-this.tileH}`\r\n\r\n\t\tlet html = `<g style=\"z-index:${id};\"><path fill=\"${darkestColor}\"\r\n\t\t\t\t\td=\"M${leftWallLeftTop} \r\n\t\t\t\t\tL${leftWallLeftBottom} \r\n\t\t\t\t\tL${leftWallRightBottom} \r\n\t\t\t\t\tL${leftWallRightTop} \r\n\t\t\t\t\tL${leftWallLeftTop} Z\" />\r\n\t\t\t\t\t<path fill=\"${regularColor}\"\r\n\t\t\t\t\td=\"M${rightWallLeftTop} \r\n\t\t\t\t\tL${rightWallLeftBottom} \r\n\t\t\t\t\tL${rightWallRightBottom} \r\n\t\t\t\t\tL${rightWallRightTop} \r\n\t\t\t\t\tL${rightWallLeftTop} Z\" />\r\n\t\t\t\t\t<path fill=\"${highlight}\"\r\n\t\t\t\t\td=\"M${blockTopLeft} \r\n\t\t\t\t\tL${blockTopBottom} \r\n\t\t\t\t\tL${blockTopRight} \r\n\t\t\t\t\tL${blockTopTop} \r\n\t\t\t\t\tL${blockTopLeft} Z\" /></g>`\r\n\r\n\t\tlet coords: Coords = { \"top\": top, \"left\": left, \"bottom\": bottom, \"right\": right }\r\n\r\n\t\treturn { html: html, coords: coords }\r\n\t}\r\n}","import { Color } from './mapGenerationFunctions.component'\r\n\r\nexport class Tile {\r\n\t\r\n\t_id: number\r\n\t_x: number\r\n\t_y: number\r\n\t_h: number\r\n\t_tileType: TileType\r\n\t_tileColor: Color\r\n\t_options?: object = {}\r\n\r\n\tconstructor(\t\t\t\r\n\t\t\tid: number,\r\n\t\t\tx: number,\r\n\t\t\ty: number,\r\n\t\t\th: number,\r\n\t\t\ttileType: TileType,\r\n\t\t\ttileColor: Color,\r\n\t\t\toptions?: object)\r\n\t{\r\n\t\tthis._id = id\r\n\t\tthis._x = x\r\n\t\tthis._y = y\r\n\t\tthis._h = h\r\n\t\tthis._tileType = tileType\r\n\t\tthis._tileColor = tileColor\r\n\r\n\t\tif (options) {\r\n\t\t\tthis._options = options\r\n\t\t}\r\n\t}\r\n\r\n\tget id(): number {\r\n\t\treturn this._id\r\n\t}\r\n\r\n\tget x(): number {\r\n\t\treturn this._x\r\n\t}\r\n\r\n\tget y(): number {\r\n\t\treturn this._y\r\n\t}\r\n\r\n\tget h(): number {\r\n\t\treturn this._h\r\n\t}\r\n\r\n\tget type(): TileType {\r\n\t\treturn this._tileType\r\n\t}\r\n\r\n\tget options(): object {\r\n\t\tif (this._tileType != TileType.None) {\r\n\t\t\treturn this._options\r\n\t\t} else {\r\n\t\t\treturn { 'defined': false }\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getColor(): Color {\r\n\t\treturn this._tileColor\r\n\t}\r\n\r\n\tget tileColor(): Color {\r\n\t\treturn this._tileColor\r\n\t}\r\n\r\n\tset tileColor(color: Color) {\r\n\t\tthis._tileColor = color\r\n\t}\r\n\r\n}\r\n\r\nexport enum TileType {\r\n\tNone = 'none',\r\n\tBody = 'body',\r\n\tTower = 'tower',\r\n\tRoof = 'roof'\r\n}\r\n"]}
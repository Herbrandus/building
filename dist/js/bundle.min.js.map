{"version":3,"sources":["node_modules/browser-pack/_prelude.js","bundle.min.js","src/ts/builder.component.ts","src/ts/config.component.ts","src/ts/main.ts","src/ts/mapGenerationFunctions.component.ts","src/ts/mapper.component.ts","src/ts/modifiers.component.ts","src/ts/primitives.component.ts","src/ts/renderelements.component.ts","src/ts/tile.component.ts"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","Object","defineProperty","value","mapGenerationFunctions_component_1","tile_component_1","config_component_1","renderelements_component_1","Renderer","[object Object]","this","config","Config","calculations","MapGenerationFunctions","render","RenderElements","map","html","mapWidth","mapLength","tileWidth","tileLength","htmlMap","getMapWidth","y","halfWay","Math","round","x","getColumn","isDefined","getTopTile","tileTopColor","getColor","rgb","tileColor","emptyBlocksPresent","h","height","tileStack","type","TileType","None","edge","top","right","bottom","left","blockGroup","mapToBuild","mapTotalWidth","mapTotalLength","testTile","createTile","yDeviation","coords","tileHalfWidthLeft","tileHalfWidthRight","tileHalfLengthTop","mapLengthTop","mapLengthBottom","mapWidthPx","mapLengthPx","topMargin","shadowColor","groundColor","changeColorLighting","detailsHtml","lastTile","startTileX","thisPosY","thisPosX","newTile","newData","Shadow","color","createPlane","Grass","options","currentTile","roof","pillar","slope","windowed","tower","stairs","halfArch","wholeArch","Body","tile","createBlock","tileHeight","allowDebug","debugInfo","id","HalfBlock","createPillarBlock","createHalfArch","createHalfBlock","xPos","yPos","corner","createSlopeBlock","getTile","./config.component","./mapGenerationFunctions.component","./renderelements.component","./tile.component","2","_allowDebug","_tileWidth","_tileLength","_tileHeight","_tileSmallAngle","_tileLargeAngle","_groundColor","Color","_buildingBaseColor","floor","random","_tileEdgeBleed","_maxAllowedHeight","_topMargin","_allowSurroundingDecorations","tileSmallAngle","tileLargeAngle","buildingBaseColor","tileEdgeBleed","maxAllowedHeight","allowSurroundingDecorations","mapArrayWidth","mapArrayLength","3","mapper_component_1","builder_component_1","RandomBuilding","_builder","_map","Map","document","querySelector","style","background","hex","build2DMap","addToBuilding","buildMap","col","getFirstDefinedColumn","console","log","remove","svg","XMLSerializer","serializeToString","base64","window","btoa","newImg","createElement","setAttribute","beforeElement","insertBefore","classList","add","innerHTML","building","colorMap","setColors","getBaseColor","shade0","changeColorLightingString","shade1","colorDivs","getColorStringByHue","drawTileMap","getImageTag","addEventListener","querySelectorAll","forEach","item","parentElement","toggle","./builder.component","./mapper.component","4","smallAngle","largeAngle","maximumBlockIterations","blockWidth","blockHeight","smallOuterAngle","largeOuterAngle","horizontalWidthFromBottom","getHorizontalBottomShortestWidth","verticalHeightFromBottom","getVerticalBottomShortestHeight","horizontalWidthFromTop","getHorizontalTopLongestWidth","verticalHeightFromTop","getVerticalTopLongestHeight","totalWidth","totalHeight","diagonalWidth","sin","toRadians","diagonalHeight","cos","colorLeft","colorRight","gradient","angle","PI","TileColor","BuildingHeightVariations","params","error","validateHex","hexColor","charAt","setHex","hexToRgb","convertToHSL","validateRgb","setRgb","rgbToHex","toString","g","b","_colorRgb","s","l","_colorHsl","hexadecimal","hexVal1","hexVal2","hexVal3","_colorHex","match","hexValues","substr","split","hexPair1","parseInt","hexPair2","hexPair3","hexR","Number","hexG","hexB","amount","newR","newG","newB","hue","newHue","convertHSLtoRGB","convertRGBtoHex","cmin","min","cmax","max","delta","abs","toFixed","m","5","primitives_component_1","modifiers_component_1","mapMaxHeight","mapEdgeWidth","averageBuildingSize","pyramid","mapGen","primitives","Primitives","mods","Modifiers","_blockHeightVariationLabels","TallCenter","TallSurrounds","Random","_blockHeightVariation","_world","_mapWidth","_mapLength","_mapMaxHeight","_mapEdgeWidth","_averageBuildingSize","_blockHeight","_maximumBlockIterations","_additionalBlockIterations","calculateAdditionalBlockIterations","_blockGroups","_blockEdges","_blockHeightsArray","_mapHalfLength","_blockIdIterator","_blockAmountIterator","_blockHeightIterator","_decorationLineH","newLineHue","lineColor","_defaultColor","_lineColor","_firstLevelColor","_HorizontalRemainingEmptyBlocksMin","_HorizontalRemainingEmptyBlocksMax","_surroundingsGrassColor","_surroundingsWaterColor","_surroundingsSandColor","_surroundingsDefaultColor","_showWindows","firstBlockHeight","mapLengthHalf","startblockLength","startblockWidth","startblockXfromCenter","startblockLengthHalf","startingPositionX","buildGardens","useWaterGarden","hollowBuildingBlock","openGroundLevel","thisBlockGroup","column","Column","xConditions","isSlope","thisPillar","tileType","thisWindowed","isRoof","push","Tile","indexOf","setEdges","hasEdge","getEdges","addBuildingComponent","edgePointY","edgePointX","grass","getLeastOpenSpaceOnX","landsLength","landsEdge","defaultHeight","gardenBlock","clearMapEdges","mirrorMap","mapHalfLength","blockGroups","maxBlockIterations","blockAmountIterator","blockEdges","blockHeightsArray","heightsArray","blockIdIterator","blockHeightVariation","lineHeight","defaultColor","firstLevelColor","decorativeColors","showWindows","considerLowerEdges","pos","xMinValues","xMaxValues","xMin","xMax","defined","colX","colY","colHeight","_edge","_tileStack","_defined","_x","_y","_height","groupNum","_blockGroup","_corner","tiles","pop","./modifiers.component","./primitives.component","6","_lastBlockHollow","world","oldBlockGroups","activeCol","isTower","halfArches","nextHeight","openFloor","ceil","randomNum","randomEdgePoint","creationPoint","nextBlockWidth","nextBlockLength","yStartOffset","chanceForHigherSpace","changeForHighCorridor","yLowEdge","yHighEdge","xLowEdge","xHighEdge","yEdgeLowActive","yEdgeHighActive","createTower","towerLocation","defaultTileColor","xEdgeLowActive","xEdgeHighActive","createCol","buildTowerHere","thisHeight","thisHalfArch","thisWholeArch","maxWallPoint","undefined","warn","7","width","widthHalf","heightHalf","quarter","quarterRev","reverse","8","tileW","tileL","tileH","bleed","dimensions","calculateStraightLinesFromIsometricSquare","shadow","pointTop","pointLeft","pointBottom","pointRight","regularColor","blockTopLeft","highlight","darkestColor","leftWallLeftTop","leftWallLeftBottom","leftWallRightBottom","leftWallRightTop","rightWallLeftTop","rightWallLeftBottom","rightWallRightBottom","rightWallRightTop","slopeDirection","regularDarkerColor","regularLighterColor","shadowLight","shadowHighlight","almostDarkestColor","almostLightestColor","lightestColor","blockTopBottom","blockTopTop","blockRightBottom","blockLeftLeft","blockLeftBottom","blockLeftTop","blockRightRight","blockBottomLeft","blockBottomRight","blockBottomTop","blockTopRight","leftWallBezier","rightWallBezier","addGradient","columnInfo","highlightLeft","highlightRight","size","sizeModifierY","isometricHeightDifferenceLeft","isometricHeightDifferenceRight","sizeModifierX","leftEdge","rightEdge","topEdge","bottomEdge","windowInsideLeftTop","orientation","halfTileWidth","rightWallLeftBottomBezier","rightWallRightTopBezier","rightWallLeftTopBezier","rightWallRightBottomBezier","blockBackRightBottom","9","_id","_h","_tileType","_tileColor","_options"],"mappings":"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","file":"bundle.min.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()",null,"import { MapGenerationFunctions, Color } from './mapGenerationFunctions.component'\r\nimport { Map } from './mapper.component'\r\nimport { Tile, TileType } from './tile.component'\r\nimport { Config, Coords, TileTemplate, Position } from './config.component'\r\nimport { RenderElements } from './renderelements.component'\r\n\r\nexport class Renderer {\t\r\n\r\n\tprivate config: Config = new Config()\r\n\tprivate calculations: MapGenerationFunctions = new MapGenerationFunctions()\r\n\tprivate render: RenderElements = new RenderElements()\r\n\r\n\tconstructor() {\t}\r\n\r\n\tshowData(map: Map): string {\r\n\r\n\t\tlet html = '<div class=\"showData\">'\r\n\t\thtml += `map width: ${map.mapWidth} tiles<br>map length: ${map.mapLength} tiles<br>`\r\n\t\thtml += `tile width: ${this.config.tileWidth}<br>tile length: ${this.config.tileLength}<br>`\r\n\t\thtml += '</div>'\r\n\r\n\t\treturn html\r\n\t}\r\n\r\n\tbuild2DMap(map: Map): string {\r\n\r\n\t\tlet htmlMap = `<div class=\"map\" style=\"width:${this.config.getMapWidth(map.mapWidth+1)}px;\">`\r\n\r\n\t\thtmlMap += `<div class=\"tile axis\" style=\"width:${this.config.tileWidth}px;height:${this.config.tileLength}px;\"></div>`\r\n\r\n\t\tfor (let i = 0; i < map.mapWidth; i++) {\r\n\t\t\thtmlMap += `<div class=\"tile axis\" style=\"width:${this.config.tileWidth}px;height:${this.config.tileLength}px;\">${i}</div>`\r\n\t\t}\r\n\r\n\t\tfor (let y = 0; y < map.mapLength; y++) {\r\n\r\n\t\t\tlet halfWay = ''\r\n\r\n\t\t\tif (y === Math.round(map.mapLength / 2)) {\r\n\t\t\t\thalfWay = ' half'\r\n\t\t\t}\r\n\r\n\t\t\thtmlMap += `<div class=\"tile axis${halfWay}\" style=\"width:${this.config.tileWidth}px;height:${this.config.tileLength}px;\">${y}</div>`\r\n\r\n\t\t\tfor (let x = 0; x < map.mapWidth; x++) {\r\n\r\n\t\t\t\thtmlMap += `<div class=\"tile${halfWay}\" style=\"width:${this.config.tileWidth}px;height:${this.config.tileLength}px;`\r\n\r\n\t\t\t\tif (map.getColumn(x, y).isDefined && map.getTopTile(x, y)) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tlet tile = map.getTopTile(x, y)\r\n\t\t\t\t\tlet tileTopColor = tile.getColor().rgb()\r\n\t\t\t\t\tlet tileColor = `rgb(${tileTopColor['r']}, ${tileTopColor['g']}, ${tileTopColor['b']})`\r\n\t\t\t\t\tlet emptyBlocksPresent = false\r\n\t\t\t\t\tfor (let h = 0; h < map.map[y][x].height; h++) {\r\n\t\t\t\t\t\tif (map.map[y][x].tileStack[h].type === TileType.None) {\r\n\t\t\t\t\t\t\temptyBlocksPresent = true\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlet edge = (map.map[y][x].edge.top || map.map[y][x].edge.right || map.map[y][x].edge.bottom || map.map[y][x].edge.left) ? true : false\r\n\t\t\t\t\tlet blockGroup = map.map[y][x].blockGroup\r\n\r\n\t\t\t\t\tlet indicateEmptyBlocks = emptyBlocksPresent ? 'x' : ''\r\n\r\n\t\t\t\t\thtmlMap += `background-color:${tileColor}\">${indicateEmptyBlocks}<div class=\"tileInfo\">x: ${x} y: ${y}<br>height: ${map.map[y][x].height}<br>edge: ${edge}<br>group: ${blockGroup}</div></div>`\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\thtmlMap += `\"></div>`\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\thtmlMap += `</div>`\r\n\r\n\t\treturn htmlMap\r\n\t}\r\n\r\n\tbuildMap(mapToBuild: Map): string {\r\n\r\n\t\tlet mapTotalWidth = mapToBuild.mapWidth\r\n\t\tlet mapTotalLength = mapToBuild.mapLength\r\n\r\n\t\tlet testTile = this.render.createTile(0, 0, '')\r\n\r\n\t\tlet xDeviation = testTile.coords.bottom.x - testTile.coords.top.x\r\n\t\tlet yDeviation = testTile.coords.right.y - testTile.coords.left.y\r\n\t\tlet tileHalfWidthLeft = testTile.coords.top.x - testTile.coords.left.x\r\n\t\tlet tileHalfWidthRight = testTile.coords.right.x - testTile.coords.top.x\r\n\t\tlet mapWidthLeft = tileHalfWidthLeft * mapTotalLength\r\n\t\tlet mapWidthRight = tileHalfWidthRight * mapTotalWidth\r\n\t\tlet tileHalfLengthTop = testTile.coords.right.y\r\n\t\tlet tileHalfLengthBottom = testTile.coords.bottom.y - testTile.coords.right.y\r\n\t\tlet mapLengthTop = tileHalfLengthTop * mapTotalWidth\r\n\t\tlet mapLengthBottom = tileHalfLengthBottom * mapTotalLength\r\n\t\tlet mapWidthPx = Math.round((tileHalfWidthLeft + tileHalfWidthRight) * (mapTotalWidth ))\r\n\t\tlet mapLengthPx = Math.round(mapLengthTop + mapLengthBottom) + this.config.topMargin\r\n\r\n\t\tconst shadowColor = this.config.groundColor.changeColorLighting(-20)\r\n\r\n\t\tconst map = mapToBuild.map\r\n\r\n\t\tlet detailsHtml = ''\r\n\t\tlet html = '<svg width=\"'+mapWidthPx+'\" height=\"'+mapLengthPx+'\">'\r\n\r\n\t\tlet lastTile = null\r\n\t\tlet startTileX = tileHalfWidthLeft * (mapTotalWidth - 1)\r\n\r\n\t\tfor (let y = 0; y < mapTotalLength; y++) {\r\n\r\n\t\t\tfor (let x = 0; x < mapTotalWidth; x++) {\r\n\r\n\t\t\t\tlet thisPosY = 0\r\n\t\t\t\tlet thisPosX = 0\r\n\r\n\t\t\t\tif (x === 0 && y === 0) {\r\n\t\t\t\t\tthisPosX = startTileX\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (lastTile != null) {\r\n\t\t\t\t\tthisPosY = lastTile.coords.right.y\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (y > 0 && x === 0) {\r\n\t\t\t\t\tthisPosX = startTileX - (tileHalfWidthLeft * y)\r\n\t\t\t\t\tthisPosY = (tileHalfLengthTop * y) - (yDeviation * y)\r\n\t\t\t\t}\t\r\n\t\t\t\t\r\n\t\t\t\tif (x > 0) {\r\n\t\t\t\t\tthisPosX = (lastTile.coords.right.x - (lastTile.coords.right.x - lastTile.coords.bottom.x))\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet newTile = this.render.createTile(thisPosX, thisPosY, 'shade')\r\n\t\t\t\tlet newData = ''\r\n\t\t\t\t\r\n\t\t\t\tif (map[y][x].isDefined) {\r\n\r\n\t\t\t\t\tif (map[y][x].tileStack[0].type === TileType.Shadow) {\r\n\t\t\t\t\t\tlet color = shadowColor\r\n\t\t\t\t\t\tnewData += this.render.createPlane(thisPosX, thisPosY, map[y][x].tileStack[0], color).html\r\n\t\t\t\t\t} else if (map[y][x].tileStack[0].type === TileType.Grass) {\r\n\t\t\t\t\t\tlet color = map[y][x].tileStack[0].tileColor\r\n\t\t\t\t\t\tnewData += this.render.createPlane(thisPosX, thisPosY, map[y][x].tileStack[0], color).html\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (map[y][x].height > 0) {\r\n\r\n\t\t\t\t\t\tnewData += this.render.createPlane(thisPosX, thisPosY, map[y][x].tileStack[0], shadowColor).html\r\n\r\n\t\t\t\t\t\tfor (let h = 0; h < map[y][x].height; h++) {\r\n\r\n\t\t\t\t\t\t\tlet currentTile = map[y][x].tileStack[h]\r\n\t\t\t\t\t\t\tlet options\r\n\r\n\t\t\t\t\t\t\tif (currentTile.options) {\r\n\t\t\t\t\t\t\t\toptions = currentTile.options\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\toptions = {\r\n\t\t\t\t\t\t\t\t\troof: false,\r\n\t\t\t\t\t\t\t\t\tpillar: false,\r\n\t\t\t\t\t\t\t\t\tslope: false,\r\n\t\t\t\t\t\t\t\t\twindowed: 0,\r\n\t\t\t\t\t\t\t\t\ttower: false,\r\n\t\t\t\t\t\t\t\t\tstairs:\tfalse,\r\n\t\t\t\t\t\t\t\t\thalfArch: false,\r\n\t\t\t\t\t\t\t\t\twholeArch: false\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif (currentTile.type === TileType.Body) {\r\n\t\t\t\t\t\t\t\tlet tile = this.render.createBlock(thisPosX, thisPosY - this.config.tileHeight, currentTile)\r\n\t\t\t\t\t\t\t\tnewData += tile.html\r\n\r\n\t\t\t\t\t\t\t\tif (currentTile.options.windowed > 0) {\r\n\t\t\t\t\t\t\t\t\t//let window = this.render.createWindow(thisPosX, thisPosY - (this.config.tileHeight * h), currentTile, map[y][x])\r\n\t\t\t\t\t\t\t\t\t//newData += window.html\r\n\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t\tif (this.config.allowDebug) {\r\n\t\t\t\t\t\t\t\t\tif (h === map[y][x].height - 1) {\r\n\t\t\t\t\t\t\t\t\t\tlet debugInfo = `<span>x: ${x}, y: ${y} <span class=\"debugLink showGroups\" data-group=\"${map[y][x].blockGroup}\">groupId: ${map[y][x].blockGroup}</span><br>id: ${currentTile.id}  h: ${h}</span>`\r\n\t\t\t\t\t\t\t\t\t\tdetailsHtml += `<div class=\"blockLabel\" data-groupId=\"${map[y][x].blockGroup}\" style=\"left: ${tile.coords.top.x}px; top: ${tile.coords.top.y - (this.config.tileHeight * h-1)}px;\"><div class=\"point\"></div>${debugInfo}</div>`\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t} else if (!options.tower && currentTile.type === TileType.HalfBlock) {\r\n\r\n\t\t\t\t\t\t\t\tlet tile = this.render.createHalfBlock(thisPosX, thisPosY- this.config.tileHeight, currentTile)\r\n\t\t\t\t\t\t\t\tnewData += tile.html\r\n\r\n\t\t\t\t\t\t\t} else if (!options.tower && currentTile.type === TileType.None) {\r\n\r\n\t\t\t\t\t\t\t\tif (currentTile.options.pillar && h < map[y][x].height) {\r\n\t\t\t\t\t\t\t\t\tif (y < (mapTotalLength/2)-1 || y > (mapTotalLength/2)) {\r\n\t\t\t\t\t\t\t\t\t\tlet pillar = this.render.createPillarBlock(thisPosX, thisPosY- this.config.tileHeight, currentTile)\r\n\t\t\t\t\t\t\t\t\t\tnewData += pillar.html\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tif (currentTile.options.halfArch) {\r\n\r\n\t\t\t\t\t\t\t\t\tif (map[y+1][x].isDefined && map[y+1][x].height > 0 && map[y+1][x].height > h && map[y+1][x].tileStack[h].type === TileType.None) {\r\n\t\t\t\t\t\t\t\t\t\tlet arch = this.render.createHalfArch(thisPosX, thisPosY - this.config.tileHeight, currentTile, 'right-top')\r\n\t\t\t\t\t\t\t\t\t\tnewData += arch.html\r\n\t\t\t\t\t\t\t\t\t} else if (map[y-1][x].isDefined && map[y-1][x].height > 0 && map[y-1][x].height > h && map[y-1][x].tileStack[h].type === TileType.None) {\r\n\t\t\t\t\t\t\t\t\t\tlet arch = this.render.createHalfArch(thisPosX, thisPosY - this.config.tileHeight, currentTile, 'right-bottom')\r\n\t\t\t\t\t\t\t\t\t\tnewData += arch.html\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else if (currentTile.options.tower) {\r\n\t\t\t\t\t\t\t\tlet tile = this.render.createBlock(thisPosX, thisPosY - this.config.tileHeight, currentTile)\r\n\t\t\t\t\t\t\t\tnewData += tile.html\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\t\t\t\t\t\r\n\t\t\t\t} \r\n\r\n\t\t\t\thtml += newData\r\n\r\n\t\t\t\tlastTile = newTile\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\thtml += '</svg>'\r\n\r\n\t\t// document.querySelector('#debug').innerHTML = detailsHtml\r\n\r\n\t\treturn '<div id=\"debug\">' + detailsHtml + '</div>' + html\r\n\t}\r\n\r\n\taddSlopedEdges(map: any[], x: number, y: number, h: number, xPos: number, yPos: number) {\r\n\r\n\t\tlet tile = null\r\n\r\n\t\tif (map[y][x].edge.top && !map[y][x].corner && h === map[y][x].height-1) {\r\n\t\t\ttile = this.render.createSlopeBlock(xPos, yPos - this.config.tileHeight, map[y][x].getTile(h), 'n')\r\n\t\t} else if (map[y][x].edge.bottom && !map[y][x].corner && h === map[y][x].height-1) {\r\n\t\t\ttile = this.render.createSlopeBlock(xPos, yPos - this.config.tileHeight, map[y][x].getTile(h), 's')\r\n\t\t} else if (map[y][x].edge.right && !map[y][x].corner && h === map[y][x].height-1) {\r\n\t\t\ttile = this.render.createSlopeBlock(xPos, yPos - this.config.tileHeight, map[y][x].getTile(h), 'e')\r\n\t\t} else if (map[y][x].edge.left && !map[y][x].corner && h === map[y][x].height-1) {\r\n\t\t\ttile = this.render.createSlopeBlock(xPos, yPos - this.config.tileHeight, map[y][x].getTile(h), 'w')\r\n\t\t} else {\r\n\t\t\ttile = this.render.createBlock(xPos, yPos - this.config.tileHeight, map[y][x].getTile(h))\t\r\n\t\t}\r\n\r\n\t\tif (map[y][x].corner && h === map[y][x].height-1) {\r\n\t\t\tif (map[y][x].edge.top && map[y][x].edge.left) {\r\n\t\t\t\ttile = this.render.createSlopeBlock(xPos, yPos - this.config.tileHeight, map[y][x].getTile(h), 'nw')\r\n\t\t\t} else if (map[y][x].edge.top && map[y][x].edge.right) {\r\n\t\t\t\ttile = this.render.createSlopeBlock(xPos, yPos - this.config.tileHeight, map[y][x].getTile(h), 'ne')\r\n\t\t\t} else if (map[y][x].edge.bottom && map[y][x].edge.left) {\r\n\t\t\t\ttile = this.render.createSlopeBlock(xPos, yPos - this.config.tileHeight, map[y][x].getTile(h), 'sw')\r\n\t\t\t} else if (map[y][x].edge.bottom && map[y][x].edge.right) {\r\n\t\t\t\ttile = this.render.createSlopeBlock(xPos, yPos - this.config.tileHeight, map[y][x].getTile(h), 'se')\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn tile\r\n\t}\r\n}\r\n","import { Color } from './mapGenerationFunctions.component'\r\n\r\nexport class Config {\r\n\r\n\tprivate _allowDebug: boolean = true\r\n\tprivate _tileWidth: number = 20\r\n\tprivate _tileLength: number = 20\r\n\tprivate _tileHeight: number = 15\r\n\tprivate _tileSmallAngle: number = 85\r\n\tprivate _tileLargeAngle: number = 100\r\n\tprivate _groundColor: Color = new Color('#f5f3e5')\r\n\tprivate _buildingBaseColor: Color = new Color(\r\n\t\t115 + Math.floor(Math.random() * 75),\r\n\t\t155 + Math.floor(Math.random() * 40),\r\n\t\t150 + Math.floor(Math.random() * 30)\r\n\t)\r\n\tprivate _tileEdgeBleed: number = 0.3\r\n\tprivate _maxAllowedHeight: number = 12\r\n\tprivate _topMargin: number = 80\r\n\tprivate _allowSurroundingDecorations: boolean = true\r\n\r\n\tconstructor() {\t}\t\r\n\r\n\tpublic get allowDebug(): boolean {\r\n\t\treturn this._allowDebug\r\n\t}\r\n\r\n\tpublic get tileWidth(): number {\r\n\t\treturn this._tileWidth\r\n\t}\r\n\r\n\tpublic get tileLength(): number {\r\n\t\treturn this._tileLength\r\n\t}\r\n\r\n\tpublic get tileHeight(): number {\r\n\t\treturn this._tileHeight\r\n\t}\r\n\r\n\tpublic get tileSmallAngle(): number {\r\n\t\treturn this._tileSmallAngle\r\n\t}\r\n\r\n\tpublic get tileLargeAngle(): number {\r\n\t\treturn this._tileLargeAngle\r\n\t}\r\n\r\n\tpublic get groundColor(): Color {\r\n\t\treturn this._groundColor\r\n\t}\r\n\r\n\tpublic get buildingBaseColor(): Color {\r\n\t\treturn this._buildingBaseColor\r\n\t}\r\n\r\n\tpublic get tileEdgeBleed(): number {\r\n\t\treturn this._tileEdgeBleed\r\n\t}\r\n\r\n\tpublic get maxAllowedHeight(): number {\r\n\t\treturn this._maxAllowedHeight\r\n\t}\r\n\r\n\tpublic get topMargin(): number {\r\n\t\treturn this._topMargin\r\n\t}\r\n\r\n\tpublic get allowSurroundingDecorations(): boolean {\r\n\t\treturn this._allowSurroundingDecorations\r\n\t}\r\n\r\n\tpublic getMapWidth(mapArrayWidth: number): number {\r\n\t\treturn mapArrayWidth * this._tileWidth\r\n\t}\r\n\r\n\tpublic getMapLength(mapArrayLength: number): number {\r\n\t\treturn mapArrayLength * this._tileLength\r\n\t}\r\n}\r\n\r\nexport interface Coords {\r\n\ttop?: Position,\r\n\tleft?: Position,\r\n\tbottom?: Position,\r\n\tright?: Position\r\n}\r\n\r\nexport interface TileTemplate {\r\n\thtml?: string,\r\n\tcoords?: Coords\r\n}\r\n\r\nexport interface Position {\r\n\tx?: number,\r\n\ty?: number\r\n}\r\n","import { Map } from './mapper.component'\r\nimport { Renderer } from './builder.component'\r\nimport { Color } from './mapGenerationFunctions.component'\r\nimport { Config } from './config.component'\r\n\r\nclass RandomBuilding {\r\n\r\n\tprivate _map: Map\r\n\tprivate _builder: Renderer = new Renderer\r\n\tprivate config: Config = new Config\r\n\r\n\tconstructor() {\r\n\t\tthis._map = new Map(30, 30, 10, 1, 5, 3, 4, false)\r\n\t\tdocument.querySelector('body').style.background = this.config.groundColor.hex()\r\n\t}\r\n\r\n\tpublic debug(): boolean {\r\n\t\treturn this.config.allowDebug\r\n\t}\r\n\r\n\tget map() {\r\n\t\treturn this._map\r\n\t}\r\n\r\n\tpublic colorMap(): string {\r\n\t\treturn this._builder.build2DMap(this._map)\r\n\t}\r\n\r\n\tpublic addToBuildingAndRedraw(): string {\r\n\t\tthis._map.addToBuilding()\r\n\t\treturn this._builder.build2DMap(this._map)\r\n\t}\r\n\r\n\tpublic drawTileMap(): string {\r\n\t\treturn this._builder.buildMap(this._map)\r\n\t}\r\n\r\n\tpublic getBaseColor(): Color {\r\n\r\n\t\tconst col = this.map.getFirstDefinedColumn()\r\n\t\tconst tile = col.tileStack[col.tileStack.length-1]\r\n\r\n\t\tconsole.log(tile)\r\n\r\n\t\treturn tile.getColor()\r\n\t}\r\n\r\n\tpublic getImageTag(): void {\r\n\t\tif (document.querySelector('#buildingimg')) {\r\n\t\t\tdocument.querySelector('#buildingimg').remove()\r\n\t\t}\r\n\r\n\t\tlet svg = new XMLSerializer().serializeToString(document.querySelector('svg'))\r\n\t\tlet base64 = window.btoa(svg)\r\n\r\n\t\tlet newImg = document.createElement('img')\r\n\t\tnewImg.setAttribute('id', 'buildingimg')\r\n\t\tif (window['debug']) {\r\n\t\t\tnewImg.setAttribute('class', 'debug-active')\r\n\t\t}\r\n\t\tnewImg.setAttribute('src', 'data:image/svg+xml;base64,'+base64)\r\n\t\t\r\n\t\tlet beforeElement = document.querySelector('#worldtest')\r\n\t\tlet parent = document.querySelector(\"body\")\r\n\t\tparent.insertBefore(newImg, beforeElement)\t\t\r\n\t}\r\n}\r\n\r\nwindow['debug'] = false\r\n\r\nwindow['activateDebug'] = () => { \r\n\twindow['debug'] = true\r\n\tdocument.querySelector('#color').classList.remove('hide')\r\n\tdocument.querySelector('#color-scheme').classList.remove('hide')\r\n\tdocument.querySelector('#buildingimg').classList.add('debug-active')\r\n\tdocument.querySelector('#color').innerHTML = building.colorMap()\r\n}\r\n\r\nlet building = new RandomBuilding()\r\n\r\ndocument.querySelector(\"#worldtest\").innerHTML = building.drawTileMap()\r\nbuilding.getImageTag()\r\n\r\nsetColors(building)\r\n\r\ndocument.querySelector('#generate').addEventListener('click', () => {\r\n\tbuilding = new RandomBuilding()\r\n\tif (window['debug']) {\r\n\t\tdocument.querySelector('#color').innerHTML = building.colorMap()\r\n\t}\t\r\n\tdocument.querySelector(\"#worldtest\").innerHTML = building.drawTileMap()\r\n\tbuilding.getImageTag()\r\n\r\n\tdocument.querySelectorAll('.point').forEach((item) => {\r\n\t\titem.addEventListener('click', () => {\r\n\t\t\tconsole.log('toggled', item)\r\n\t\t\titem.parentElement.classList.toggle('active')\r\n\t\t})\t\t\r\n\t})\r\n\r\n\tsetColors(building)\r\n})\r\n/*\r\ndocument.querySelector('#debugActive').addEventListener('click', () => {\r\n\tdocument.querySelector('#debug').classList.toggle('show')\r\n\tdocument.querySelector('#debugActive').classList.toggle('active')\r\n})\r\n\r\ndocument.querySelectorAll('.blockLabel').forEach((item) => {\r\n\titem.addEventListener('click', () => {\r\n\t\titem.classList.toggle('active')\r\n\t})\r\n}) */\r\n\r\nfunction setColors(building: RandomBuilding) {\r\n\r\n\tconst color = building.getBaseColor()\r\n\tconst shade0 = color.changeColorLightingString(0)\r\n\tconst shade1 = color.changeColorLightingString(20)\r\n\tconst shade2 = color.changeColorLightingString(-20)\r\n\tconst shade3 = color.getColorStringByHue(60)\r\n\tconst shade4 = color.getColorStringByHue(120)\r\n\tconst shade5 = color.getColorStringByHue(180)\r\n\tconst shade6 = color.getColorStringByHue(240)\r\n\tconst shade7 = color.getColorStringByHue(300)\r\n\r\n\tconst colorDivs = `\r\n\t\t<div class=\"color__tile\" style=\"background-color:${shade0};\"></div>\r\n\t\t<div class=\"color__tile\" style=\"background-color:${shade1};\"></div>\r\n\t\t<div class=\"color__tile\" style=\"background-color:${shade3};\"></div>\r\n\t\t<div class=\"color__tile\" style=\"background-color:${shade4};\"></div>\r\n\t\t<div class=\"color__tile\" style=\"background-color:${shade5};\"></div>\r\n\t\t<div class=\"color__tile\" style=\"background-color:${shade6};\"></div>\r\n\t\t<div class=\"color__tile\" style=\"background-color:${shade7};\"></div>`\r\n\r\n\tdocument.querySelector('#color-scheme').innerHTML = colorDivs\r\n}\r\n/*\r\ndocument.querySelector('#download').addEventListener('click', () => {\r\n\tlet svg = new XMLSerializer().serializeToString(document.querySelector('svg'))\r\n\tlet base64 = window.btoa(svg)\r\n\r\n\tlet newImg = document.createElement('img')\r\n\tnewImg.setAttribute('src', 'data:image/svg+xml;base64,'+base64)\r\n\tdocument.querySelector('body').appendChild(newImg)\r\n}); */","import { Config } from './config.component'\r\n\r\nexport class MapGenerationFunctions {\r\n\r\n\tprivate config: Config = new Config();\r\n\tsmallAngle = this.config.tileSmallAngle;\r\n\tlargeAngle = this.config.tileLargeAngle;\r\n\r\n\tconstructor() { }\r\n\r\n\tpublic calculateAdditionalBlockIterations(maximumBlockIterations: number) {\r\n\t\treturn 2 + Math.floor(Math.random() * maximumBlockIterations);\r\n\t}\r\n\r\n\t// calculate the dimensions to draw the isometric perspective tile with the parameters as if it were a straight square tile\r\n\tpublic calculateStraightLinesFromIsometricSquare (blockWidth: number, blockHeight: number) {\r\n\t\t// lengths this function returns when it comes to positions of longest and shortest sides as array\r\n\t\t/*           [0]\r\n\t\t *   _________________ \r\n\t\t *   |    [3]  |      |\r\n\t\t *   | [5]            |\r\n\t\t *   |               -|\r\n\t\t *   |-               | [1]\r\n\t\t *   | [4]            |\r\n\t\t *   |    [2]         |\r\n\t\t *   |_______|________|\r\n\t\t */  \r\n\r\n\t\tlet smallOuterAngle = (180 - this.smallAngle) / 2;\r\n\t\tlet largeOuterAngle = (180 - this.largeAngle) / 2;\r\n\r\n\t\tlet horizontalWidthFromBottom = this.getHorizontalBottomShortestWidth(blockWidth, smallOuterAngle);\r\n\t\tlet verticalHeightFromBottom = this.getVerticalBottomShortestHeight(horizontalWidthFromBottom, smallOuterAngle);\r\n\r\n\t\tlet horizontalWidthFromTop = this.getHorizontalTopLongestWidth(blockHeight, largeOuterAngle);\r\n\t\tlet verticalHeightFromTop = this.getVerticalTopLongestHeight(horizontalWidthFromTop, largeOuterAngle);\r\n\r\n\t\tlet totalHeight = verticalHeightFromBottom + verticalHeightFromTop;\r\n\t\tlet totalWidth = horizontalWidthFromBottom + horizontalWidthFromTop;\r\n\r\n\t\treturn {\t'totalWidth': totalWidth, // 0\r\n\t\t\t\t\t'totalHeight': totalHeight,  // 1\r\n\t\t\t\t\t'horizontalWidthFromBottom': horizontalWidthFromBottom,  // 2\r\n\t\t\t\t\t'horizontalWidthFromTop': horizontalWidthFromTop,  // 3\r\n\t\t\t\t\t'verticalHeightFromBottom': verticalHeightFromBottom,  // 4\r\n\t\t\t\t\t'verticalHeightFromTop': verticalHeightFromTop } // 5\r\n\t}\r\n\r\n\t// calculate the amount of pixels from the bottom left side of a straight square to the point at the bottom \r\n\t// .. where the tip of the tile meets the border of the square\r\n\tpublic getHorizontalBottomShortestWidth (diagonalWidth: number, smallAngle: number): number {\r\n\t\treturn diagonalWidth * Math.sin(this.toRadians(smallAngle));\r\n\t}\r\n\r\n\tpublic getVerticalBottomShortestHeight (diagonalHeight: number, smallAngle: number): number {\r\n\t\treturn diagonalHeight * Math.cos(this.toRadians(smallAngle));\r\n\t}\r\n\r\n\tpublic getHorizontalTopLongestWidth (diagonalWidth: number, largeAngle: number): number {\r\n\t\treturn diagonalWidth * Math.sin(this.toRadians(largeAngle));\r\n\t}\r\n\r\n\tpublic getVerticalTopLongestHeight (diagonalHeight: number, largeAngle: number): number {\r\n\t\treturn diagonalHeight * Math.cos(this.toRadians(largeAngle));\r\n\t}\r\n\r\n\tpublic addGradient(id: string, colorLeft: string, colorRight: string) {\r\n\r\n\t\tlet gradient = '<linearGradient id=\"'+id+'\">'\r\n\t\t\tgradient += '<stop offset=\"5%\" stop-color=\"'+colorLeft+'\" />'\r\n\t\t\tgradient += '<stop offset=\"95%\" stop-color=\"'+colorRight+'\" />'\r\n\t\t\tgradient += '</linearGradient>'\r\n\r\n\t\treturn gradient\r\n\t}\r\n\r\n\ttoRadians (angle: number): number {\r\n\t\treturn angle * (Math.PI / 180);\r\n\t}\r\n}\r\n\r\nexport enum TileColor {\r\n\tRed = 125 + Math.floor(Math.random() * 75),\r\n\tGreen = 170 + Math.floor(Math.random() * 40),\r\n\tBlue = 180 + Math.floor(Math.random() * 30)\r\n}\r\n\r\nexport enum BuildingHeightVariations {\r\n\tTallCenter = 'tallCenter',\r\n\tTallSurrounds = 'tallSurrounds',\r\n\tRandom = 'random'\r\n}\r\n\r\nexport class Color {\r\n\tprivate _colorRgb: RGB\r\n\tprivate _colorHex: string\r\n\tprivate _colorHsl: HSL\r\n\r\n\tconstructor(...params: any[]) {\r\n\t\tlet error = null\r\n\t\tif (params.length === 1) {\r\n\t\t\tif (typeof params[0] === 'string') {\r\n\t\t\t\tif (this.validateHex(params[0])) {\r\n\t\t\t\t\tlet hexColor = params[0]\r\n\t\t\t\t\tif (hexColor.charAt(0) !== '#') {\r\n\t\t\t\t\t\thexColor = `#${hexColor}`\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.setHex(hexColor)\r\n\t\t\t\t\tthis.hexToRgb()\r\n\t\t\t\t\tthis.convertToHSL()\r\n\t\t\t\t} else {\r\n\t\t\t\t\terror = \"Hexadecimal color is incorrect\"\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\terror = \"Length of 1 in parameters is not equal to string\"\r\n\t\t\t}\r\n\t\t} else if (params.length === 3) {\r\n\t\t\tif (this.validateRgb(params)) {\r\n\t\t\t\tthis.setRgb(params[0], params[1], params[2])\r\n\t\t\t\tthis.rgbToHex()\r\n\t\t\t\tthis.convertToHSL()\r\n\t\t\t} else {\r\n\t\t\t\terror = \"Values of RGB exceed limits\"\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (error !== null) {\r\n\t\t\tthrow \"Color type is incorrect. \" + error + \": \" + params.toString()\r\n\t\t}\r\n\t}\r\n\r\n\tpublic setRgb(r: number, g: number, b: number) {\r\n\t\tthis._colorRgb = {r: r, g: g, b: b} as RGB\r\n\t}\r\n\r\n\tpublic setHsl(h: number, s: number, l: number) {\r\n\t\tthis._colorHsl = {h: h, s: s, l: l} as HSL\r\n\t}\r\n\r\n\tpublic setHex(hexadecimal: string) {\r\n\t\tif (hexadecimal.length < 7) {\r\n\t\t\tlet hexVal1 = hexadecimal.charAt(1)\r\n\t\t\tlet hexVal2 = hexadecimal.charAt(2)\r\n\t\t\tlet hexVal3 = hexadecimal.charAt(3)\r\n\t\t\thexadecimal = \"#\" + hexVal1 + hexVal1 + hexVal2 + hexVal2 + hexVal3 + hexVal3\r\n\t\t}\r\n\t\tthis._colorHex = hexadecimal\r\n\t}\r\n\r\n\tpublic rgb(): RGB {\r\n\t\treturn this._colorRgb\r\n\t}\r\n\r\n\tpublic hex(): string {\r\n\t\treturn this._colorHex\r\n\t}\r\n\r\n\tpublic hsl(): HSL {\r\n\t\treturn this._colorHsl\r\n\t}\r\n\r\n\tvalidateRgb(rgb: number[]): boolean {\r\n\t\tif (rgb[0] > -1 && rgb[0] < 256 &&\r\n\t\t\trgb[1] > -1 && rgb[1] < 256 &&\r\n\t\t\trgb[2] > -1 && rgb[2] < 256) {\r\n\t\t\treturn true\r\n\t\t} else {\r\n\t\t\treturn false\r\n\t\t}\r\n\t}\r\n\r\n\tvalidateHex(hex: string): boolean {\r\n\t\tlet regex = /^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/\r\n\t\tif (hex.match(regex)) {\r\n\t\t\treturn true\r\n\t\t} else {\r\n\t\t\treturn false\r\n\t\t}\r\n\t}\r\n\r\n\thexToRgb() {\r\n\t\tlet hexValues: string[] = this._colorHex.substr(1).split('')\r\n\t\tlet hexPair1 = parseInt(hexValues[0]+hexValues[1], 16)\r\n\t\tlet hexPair2 = parseInt(hexValues[2]+hexValues[3], 16)\r\n\t\tlet hexPair3 = parseInt(hexValues[4]+hexValues[5], 16)\r\n\t\tthis.setRgb(hexPair1, hexPair2, hexPair3)\r\n\t\tthis.rgbToHex()\r\n\t}\r\n\r\n\trgbToHex() {\r\n\t\tif (typeof this._colorRgb === 'object') {\r\n\t\t\tlet r = this._colorRgb.r\r\n\t\t\tlet b = this._colorRgb.b\r\n\t\t\tlet g = this._colorRgb.g\r\n\t\t\tlet hexR = Number(r).toString(16)\r\n\t\t\tlet hexG = Number(g).toString(16)\r\n\t\t\tlet hexB = Number(b).toString(16)\r\n\t\t\tthis._colorHex = \"#\" + hexR + hexG + hexB\t\t\t\r\n\t\t}\r\n\t}\r\n\r\n\tconvertRGBtoHex(color: RGB): string {\r\n\t\tlet r = color.r\r\n\t\tlet b = color.b\r\n\t\tlet g = color.g\r\n\t\tlet hexR = Number(r).toString(16)\r\n\t\tlet hexG = Number(g).toString(16)\r\n\t\tlet hexB = Number(b).toString(16)\r\n\t\treturn \"#\" + hexR + hexG + hexB\r\n\t}\r\n\r\n\tpublic changeColorLightingString(amount: number): string {\r\n\t\tlet r = this._colorRgb.r\r\n\t\tlet b = this._colorRgb.b\r\n\t\tlet g = this._colorRgb.g\r\n\t\tlet newR = r + amount\r\n\t\tlet newG = g + amount\r\n\t\tlet newB = b + (amount - 8)\r\n\t\tif (newR > 255) newR = 255\r\n\t\tif (newG > 255) newG = 255\r\n\t\tif (newR > 255) newR = 255\r\n\r\n\t\tlet hexR = Number(newR).toString(16)\r\n\t\tlet hexG = Number(newG).toString(16)\r\n\t\tlet hexB = Number(newB).toString(16)\r\n\t\tlet result = \"#\" + hexR + hexG + hexB\r\n\r\n\t\treturn result\r\n\t}\r\n\r\n\tpublic changeColorLighting(amount: number): Color {\r\n\t\tlet r = this._colorRgb.r\r\n\t\tlet b = this._colorRgb.b\r\n\t\tlet g = this._colorRgb.g\r\n\t\tlet newR = r + amount\r\n\t\tlet newG = g + amount\r\n\t\tlet newB = b + (amount - 8)\r\n\t\tif (newR > 255) newR = 255\r\n\t\tif (newG > 255) newG = 255\r\n\t\tif (newR > 255) newR = 255\r\n\t\t\r\n\t\tthis.setRgb(newR, newG, newR)\r\n\t\tthis.rgbToHex()\r\n\t\tthis.convertToHSL()\r\n\r\n\t\treturn this\r\n\t}\r\n\r\n\tpublic getLightestRGB(): RGB {\r\n\t\tlet r = this._colorRgb.r\r\n\t\tlet b = this._colorRgb.b\r\n\t\tlet g = this._colorRgb.g\r\n\t\tlet newR = r + 55\r\n\t\tlet newG = g + 55\r\n\t\tlet newB = b + 40\r\n\t\tif (newR > 255) newR = 255\r\n\t\tif (newG > 255) newG = 255\r\n\t\tif (newR > 255) newR = 255\r\n\t\treturn {r: newR, g: newG, b: newB}\r\n\t}\r\n\r\n\tpublic getHighlightsRGB(): RGB {\r\n\t\tlet r = this._colorRgb.r\r\n\t\tlet b = this._colorRgb.b\r\n\t\tlet g = this._colorRgb.g\r\n\t\tlet newR = r + 45\r\n\t\tlet newG = g + 45\r\n\t\tlet newB = b + 30\r\n\t\tif (newR > 255) newR = 255\r\n\t\tif (newG > 255) newG = 255\r\n\t\tif (newR > 255) newR = 255\r\n\t\treturn {r: newR, g: newG, b: newB}\r\n\t}\r\n\r\n\tpublic getDarkerRegularRGB(): RGB {\r\n\t\tlet r = this._colorRgb.r\r\n\t\tlet b = this._colorRgb.b\r\n\t\tlet g = this._colorRgb.g\r\n\t\tlet newR = r + 15\r\n\t\tlet newG = g + 15\r\n\t\tlet newB = b + 5\r\n\t\tif (newR > 255) newR = 255\r\n\t\tif (newG > 255) newG = 255\r\n\t\tif (newR > 255) newR = 255\r\n\t\treturn {r: newR, g: newG, b: newB}\r\n\t}\r\n\r\n\tpublic getHalflightsRGB(): RGB {\r\n\t\tlet r = this._colorRgb.r\r\n\t\tlet b = this._colorRgb.b\r\n\t\tlet g = this._colorRgb.g\r\n\t\tlet newR = r + 25\r\n\t\tlet newG = g + 25\r\n\t\tlet newB = b + 15\r\n\t\tif (newR > 255) newR = 255\r\n\t\tif (newG > 255) newG = 255\r\n\t\tif (newR > 255) newR = 255\r\n\t\treturn {r: newR, g: newG, b: newB}\r\n\t}\r\n\r\n\tpublic getShadowsRGB(): RGB {\r\n\t\tlet r = this._colorRgb.r\r\n\t\tlet b = this._colorRgb.b\r\n\t\tlet g = this._colorRgb.g\r\n\t\tlet newR = r - 55\r\n\t\tlet newG = g - 55\r\n\t\tlet newB = b - 35\r\n\t\tif (newR < 0) newR = 0\r\n\t\tif (newG < 0) newG = 0\r\n\t\tif (newR < 0) newR = 0\r\n\t\treturn {r: newR, g: newG, b: newB}\r\n\t}\r\n\r\n\tpublic getDarkestRGB(): RGB {\r\n\t\tlet r = this._colorRgb.r\r\n\t\tlet b = this._colorRgb.b\r\n\t\tlet g = this._colorRgb.g\r\n\t\tlet newR = r - 70\r\n\t\tlet newG = g - 70\r\n\t\tlet newB = b - 60\r\n\t\tif (newR < 0) newR = 0\r\n\t\tif (newG < 0) newG = 0\r\n\t\tif (newR < 0) newR = 0\r\n\t\treturn {r: newR, g: newG, b: newB}\r\n\t}\r\n\r\n\tpublic getColorStringByHue(hue: number): string {\r\n\r\n\t\tlet h = this._colorHsl.h,\r\n\t\t\ts = this._colorHsl.s,\r\n\t\t\tl = this._colorHsl.l\r\n\r\n\t\tlet newHue = h + hue\r\n\r\n\t\tif (newHue > 360) {\r\n\t\t\tnewHue = newHue % 360\r\n\t\t}\r\n\r\n\t\tlet rgb = this.convertHSLtoRGB({h: newHue, s: s, l: l})\r\n\r\n\t\treturn this.convertRGBtoHex(rgb)\r\n\t}\r\n\r\n\tpublic getColorByHue(hue: number): Color {\r\n\r\n\t\tlet h = this._colorHsl.h,\r\n\t\t\ts = this._colorHsl.s,\r\n\t\t\tl = this._colorHsl.l\r\n\r\n\t\tlet newHue = h + hue\r\n\r\n\t\tif (newHue > 360) {\r\n\t\t\tnewHue = newHue % 360\r\n\t\t}\r\n\r\n\t\tlet rgb = this.convertHSLtoRGB({h: newHue, s: s, l: l})\r\n\r\n\t\tthis.setRgb(rgb.r, rgb.g, rgb.b)\r\n\t\tthis.rgbToHex()\r\n\r\n\t\treturn this\r\n\t}\r\n\r\n\tconvertToHSL(): void {\r\n\t\tlet r = this._colorRgb.r\r\n\t\tlet b = this._colorRgb.b\r\n\t\tlet g = this._colorRgb.g\r\n\r\n\t\tr /= 255\r\n\t\tg /= 255\r\n\t\tb /= 255\r\n\r\n\t\tlet cmin = Math.min(r,g,b),\r\n\t\t\tcmax = Math.max(r,g,b),\r\n\t\t\tdelta = cmax - cmin,\r\n\t\t\th = 0,\r\n\t\t\ts = 0,\r\n\t\t\tl = 0\r\n\r\n\t\t// calculate hue\r\n\t\tif (delta === 0) {\r\n\t\t\th = 0\r\n\t\t} else if (cmax === r) {\r\n\t\t\th = ((g - b) / delta) % 6\r\n\t\t} else if (cmax === g) {\r\n\t\t\th = (b - r) / delta + 2\r\n\t\t} else {\r\n\t\t\th = (r - g) / delta + 4\r\n\t\t}\r\n\r\n\t\th = Math.round(h * 60)\r\n\r\n\t\tif (h < 0) {\r\n\t\t\th += 360\r\n\t\t}\r\n\r\n\t\t// calculate lightness\r\n\t\tl = (cmax + cmin) / 2 \r\n\r\n\t\t// calculate saturation\r\n\t\ts = delta === 0 ? 0 : delta / (1 - Math.abs(2 * l - 1))\r\n\r\n\t\ts = +(s * 100).toFixed(1)\r\n\t\tl = +(l * 100).toFixed(1)\r\n\r\n\t\tthis._colorHsl = { h: h, s: s, l: l }\r\n\t}\r\n\r\n\tconvertHSLtoRGB(color: HSL): RGB {\r\n\r\n\t\tlet h = color.h\r\n\t\tlet s = color.s\r\n\t\tlet l = color.l\r\n\r\n\t\ts /= 100\r\n\t\tl /= 100\r\n\r\n\t\tlet c = (1 - Math.abs(2 * l - 1)) * s,\r\n\t\t\tx = c * (1 - Math.abs((h / 60) % 2 - 1)),\r\n\t\t\tm = l - c / 2,\r\n\t\t\tr = 0,\r\n\t\t\tg = 0,\r\n\t\t\tb = 0\r\n\r\n\t\tif (0 <= h && h < 60) {\r\n\t\t\tr = c; g = x; b = 0;\r\n\t\t} else if (60 <= h && h < 120) {\r\n\t\t\tr = x; g = c; b = 0;\r\n\t\t} else if (120 <= h && h < 180) {\r\n\t\t\tr = 0; g = c; b = x;\r\n\t\t} else if (180 <= h && h < 240) {\r\n\t\t\tr = 0; g = x; b = c;\r\n\t\t} else if (240 <= h && h < 300) {\r\n\t\t\tr = x; g = 0; b = c;\r\n\t\t} else if (300 <= h && h < 360) {\r\n\t\t\tr = c; g = 0; b = x;\r\n\t\t}\r\n\t\t\r\n\t\tr = Math.round((r + m) * 255)\r\n\t\tg = Math.round((g + m) * 255)\r\n\t\tb = Math.round((b + m) * 255)\r\n\r\n\t\treturn {r: r, g: g, b: b}\r\n\t}\r\n}\r\n\r\nexport interface RGB {\r\n\tr: number,\r\n\tg: number,\r\n\tb: number\r\n}\r\n\r\nexport interface HSL {\r\n\th: number,\r\n\ts: number,\r\n\tl: number\r\n}","import { MapGenerationFunctions, BuildingHeightVariations, Color } from './mapGenerationFunctions.component'\r\nimport { Tile, TileType, TileOptions } from './tile.component'\r\nimport { Config, Position } from './config.component'\r\nimport { Primitives } from './primitives.component'\r\nimport { Modifiers } from './modifiers.component'\r\n\r\nexport class Map {\r\n\r\n\tprivate mapGen: MapGenerationFunctions = new MapGenerationFunctions()\r\n\tprivate config: Config = new Config()\r\n\tprivate primitives: Primitives = new Primitives()\r\n\tprivate mods: Modifiers = new Modifiers()\r\n\r\n\tprivate _mapWidth: number\r\n\tprivate _mapLength: number\r\n\tprivate _mapMaxHeight: number\r\n\tprivate _averageBuildingSize: number\r\n\tprivate _blockHeight: number\r\n\tprivate _maximumBlockIterations: number\r\n\tprivate _additionalBlockIterations: number\r\n\tprivate _mapEdgeWidth: number\r\n\tprivate _highestPoint: number\r\n\tprivate _startBlockXfromCenterDeviation: number\r\n\tprivate _mapHalfLength: number\r\n\tprivate _world: any[][]\r\n\tprivate _blockHeightsArray: number[]\r\n\tprivate _blockGroups: number[]\r\n\tprivate _blockEdges: Position[]\t\r\n\tprivate _blockHeightVariationLabels = [BuildingHeightVariations.TallCenter, BuildingHeightVariations.TallSurrounds, BuildingHeightVariations.Random]\r\n\tprivate _blockHeightVariation = this._blockHeightVariationLabels[Math.floor(Math.random() * 3)]\r\n\tprivate _blockIdIterator: number\r\n\tprivate _blockHeightIterator: number\r\n\tprivate _blockAmountIterator: number\r\n\tprivate _HorizontalRemainingEmptyBlocksMin: number\r\n\tprivate _HorizontalRemainingEmptyBlocksMax: number\r\n\tprivate _decorationLineH: number\r\n\tprivate _groundColor: Color\r\n\tprivate _defaultColor: Color\r\n\tprivate _lineColor: Color\r\n\tprivate _firstLevelColor: Color\r\n\tprivate _surroundingsGrassColor: Color\r\n\tprivate _surroundingsWaterColor: Color\r\n\tprivate _surroundingsSandColor: Color\r\n\tprivate _surroundingsDefaultColor: Color\r\n\tprivate _showWindows: number\r\n\r\n\tconstructor(\t\r\n\t\t\tmapWidth: number, \r\n\t\t\tmapLength: number, \r\n\t\t\tmapMaxHeight: number, \r\n\t\t\tmapEdgeWidth: number,\r\n\t\t\taverageBuildingSize: number,\r\n\t\t\tblockHeight: number,\r\n\t\t\tmaximumBlockIterations: number,\r\n\t\t\tpyramid: boolean)\r\n\t{\r\n\t\tthis._world = []\r\n\t\tthis._mapWidth = mapWidth\r\n\t\tthis._mapLength = mapLength\r\n\t\tthis._mapMaxHeight = mapMaxHeight\r\n\t\tthis._mapEdgeWidth = mapEdgeWidth\r\n\t\tthis._averageBuildingSize = averageBuildingSize \r\n\t\tthis._blockHeight = blockHeight\r\n\t\tthis._maximumBlockIterations = maximumBlockIterations\r\n\t\tthis._additionalBlockIterations = this.mapGen.calculateAdditionalBlockIterations(maximumBlockIterations)\r\n\t\tthis._blockGroups = []\r\n\t\tthis._blockEdges = []\r\n\t\tthis._blockHeightsArray = []\r\n\t\tthis._mapHalfLength = Math.floor(mapLength / 2)\r\n\t\tthis._blockIdIterator = 0\r\n\t\tthis._blockAmountIterator = 1\r\n\t\tthis._blockHeightIterator = 1\r\n\t\tthis._decorationLineH = -1\r\n\t\tlet newLineHue = this.config.buildingBaseColor.getColorStringByHue(-120)\r\n\t\tlet lineColor = new Color(newLineHue)\r\n\t\tthis._defaultColor = new Color(this.config.buildingBaseColor.hex())\r\n\t\tthis._lineColor = lineColor.changeColorLighting(-30)\r\n\t\tthis._firstLevelColor = new Color(this.config.buildingBaseColor.getColorStringByHue(10)).changeColorLighting(-20)\r\n\t\tthis._groundColor = this.config.groundColor\r\n\t\tthis._HorizontalRemainingEmptyBlocksMin = 0\r\n\t\tthis._HorizontalRemainingEmptyBlocksMax = 0\r\n\t\tthis._surroundingsGrassColor = new Color('#7bb376')\r\n\t\tthis._surroundingsWaterColor = new Color('#6fb9ca')\r\n\t\tthis._surroundingsSandColor = new Color('#e9e3ba')\r\n\t\tthis._surroundingsDefaultColor = this._surroundingsGrassColor\r\n\t\tthis._showWindows = Math.round(Math.random() * 2)\r\n\r\n\t\tlet mapLengthHalf = Math.floor(mapLength / 2) \r\n\t\tlet mapWidthHalf = Math.floor(mapWidth / 2)\r\n\t\tlet startBlockXfromCenterDeviation = 7\r\n\t\tlet startblockLength = this._averageBuildingSize + Math.floor(Math.random() * 4)\r\n\t\tlet startblockWidth = this._averageBuildingSize + Math.floor(Math.random() * 3)\r\n\t\tlet startblockXfromCenter = 4 + Math.floor(Math.random() * startBlockXfromCenterDeviation)\r\n\t\tlet startblockLengthHalf = Math.floor(startblockLength / 2)\r\n\t\tlet startblockWidthHalf = Math.floor(startblockWidth / 2)\r\n\t\tlet startingPositionX = Math.floor(this._mapWidth / 2) - Math.floor(startblockXfromCenter / 2)\r\n\t\tlet buildGardens = !!(Math.round(Math.random() * 2))\r\n\t\tlet useWaterGarden = false\t\t\r\n\t\tlet tileHeight = 0\r\n\t\tlet firstBlockHeight\r\n\r\n\t\tif (this._defaultColor.rgb().g >= 180 && this._defaultColor.rgb().b >= 150 && Math.round(Math.random() * 4) >= 3) {\r\n\t\t\tuseWaterGarden = true\r\n\t\t\tthis._surroundingsDefaultColor = this._surroundingsWaterColor\r\n\t\t} else if (Math.round(Math.random() * 10) <= 1) {\r\n\t\t\tuseWaterGarden = true\r\n\t\t\tthis._surroundingsDefaultColor = this._surroundingsWaterColor\r\n\t\t}\r\n\r\n\t\tif (this._blockHeightVariation === BuildingHeightVariations.TallCenter) {\r\n\t\t\tfirstBlockHeight = this._blockHeight * 3\r\n\t\t} else if (this._blockHeightVariation === BuildingHeightVariations.TallSurrounds) {\r\n\t\t\tfirstBlockHeight = 3 + Math.round(Math.random())\r\n\t\t\tthis._blockHeight = firstBlockHeight\r\n\t\t} else {\r\n\t\t\tfirstBlockHeight = this._blockHeight + Math.round(Math.random() * 4)\r\n\t\t}\r\n\r\n\t\tif (firstBlockHeight > 6) {\r\n\t\t\tthis._decorationLineH = 4\r\n\t\t} else if (firstBlockHeight > 3) {\r\n\t\t\tthis._decorationLineH = 3\r\n\t\t}\r\n\r\n\t\tthis._blockHeight = firstBlockHeight\r\n\r\n\t\tlet hollowBuildingBlock = (Math.round(Math.random()) === 1 ? true : false) \r\n\t\tlet openGroundLevel = (Math.round(Math.random()) === 1 ? true : false) \r\n\r\n\t\tconsole.log('showWindows', this._showWindows)\r\n\r\n\t\tfor (let y = 0; y < this.mapLength; y++) {\r\n\r\n\t\t\tthis._world[y] = []\r\n\r\n\t\t\tfor (let x = 0; x < this.mapWidth; x++) {\r\n\r\n\t\t\t\tlet thisBlockGroup = 0\r\n\r\n\t\t\t\tlet column = new Column(false, x, y, 0)\r\n\r\n\t\t\t\tlet yConditions = (y >= mapLengthHalf && y <= (mapLengthHalf + startblockLengthHalf))\r\n\t\t\t\tlet xConditions = (x > startingPositionX && x <= (startingPositionX + startblockWidth))\r\n\r\n\t\t\t\tif (yConditions) {\r\n\r\n\t\t\t\t\tif (xConditions) {\r\n\r\n\t\t\t\t\t\tthisBlockGroup = 1\r\n\t\t\t\t\t\tlet tileStack = []\r\n\r\n\t\t\t\t\t\tfor (let h = 0; h < firstBlockHeight; h++) {\r\n\r\n\t\t\t\t\t\t\tlet isSlope = true\r\n\t\t\t\t\t\t\tlet thisPillar = false\r\n\t\t\t\t\t\t\tlet tileType = TileType.Body\r\n\t\t\t\t\t\t\tif (h < 2 && openGroundLevel) {\r\n\t\t\t\t\t\t\t\tif (y % 2 === 0) {\r\n\t\t\t\t\t\t\t\t\tthisPillar = true\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\ttileType = TileType.None\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (this._decorationLineH > 3 && h+1 === this._decorationLineH && h+1 < firstBlockHeight) {\r\n\t\t\t\t\t\t\t\ttileType = TileType.None\r\n\t\t\t\t\t\t\t\tif (y % 2 === 0) {\r\n\t\t\t\t\t\t\t\t\tthisPillar = true\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tlet thisWindowed = 0\r\n\t\t\t\t\t\t\tif (!thisPillar && this._showWindows > 0 && h % 2 === 1) {\r\n\t\t\t\t\t\t\t\tthisWindowed = this._showWindows\r\n\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tlet isRoof = (h === firstBlockHeight-1) ? true : false\r\n\t\t\t\t\t\t\tlet tileColor = this._defaultColor\r\n\r\n\t\t\t\t\t\t\tif (h === this._decorationLineH) {\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\ttileColor = this._lineColor\r\n\t\t\t\t\t\t\t} else if (h === 0) { \r\n\t\t\t\t\t\t\t\ttileColor = this._firstLevelColor\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttileColor = this._defaultColor\r\n\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\ttileStack.push(\r\n\t\t\t\t\t\t\t\tnew Tile(\r\n\t\t\t\t\t\t\t\t\tthis._blockIdIterator, \r\n\t\t\t\t\t\t\t\t\tx, \r\n\t\t\t\t\t\t\t\t\ty, \r\n\t\t\t\t\t\t\t\t\th, \r\n\t\t\t\t\t\t\t\t\ttileType,\r\n\t\t\t\t\t\t\t\t\ttileColor,\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\troof:\t\tisRoof,\r\n\t\t\t\t\t\t\t\t\t\tpillar: \tthisPillar,\r\n\t\t\t\t\t\t\t\t\t\tslope:\t\tisSlope,\r\n\t\t\t\t\t\t\t\t\t\twindowed: \tthisWindowed,\r\n\t\t\t\t\t\t\t\t\t\ttower: \t\tfalse,\r\n\t\t\t\t\t\t\t\t\t\tstairs:\t\tfalse,\r\n\t\t\t\t\t\t\t\t\t\thalfArch: \tfalse,\r\n\t\t\t\t\t\t\t\t\t\twholeArch:\tfalse\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t)\r\n\r\n\t\t\t\t\t\t\tif (this._blockGroups.indexOf(thisBlockGroup) === -1) {\r\n\t\t\t\t\t\t\t\tthis._blockGroups.push(thisBlockGroup)\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tthis._blockHeightsArray.push(firstBlockHeight)\r\n\r\n\t\t\t\t\t\t\tthis._blockIdIterator++\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tcolumn = new Column(true, x, y, firstBlockHeight)\r\n\r\n\t\t\t\t\t\tcolumn.blockGroup = thisBlockGroup\r\n\t\t\t\t\t\tcolumn.height = firstBlockHeight\r\n\t\t\t\t\t\tcolumn.corner = false\r\n\t\t\t\t\t\tcolumn.tileStack = tileStack\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._world[y][x] = column\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.setEdges(false)\r\n\r\n\t\t/* Make hollow */\r\n\t\tif (hollowBuildingBlock) {\r\n\r\n\t\t\tfor (let y = 0; y < this.mapLength; y++) {\r\n\t\t\t\tfor (let x = 0; x < this.mapWidth; x++) {\r\n\r\n\t\t\t\t\tlet hasEdge = (this._world[y][x].edge.left || this._world[y][x].edge.bottom || this._world[y][x].edge.right) ? true : false\r\n\r\n\t\t\t\t\tif (this._world[y][x].isDefined && !hasEdge) {\r\n\t\t\t\t\t\tthis._world[y][x] = new Column(false, x, y, 0)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tfor (let i = 0; i < this._additionalBlockIterations; i++) {\r\n\t\t\tthis.getEdges()\r\n\t\t\tthis._world = this.mods.addBuildingComponent(this)\r\n\t\t}\r\n\r\n\t\t/* \t\r\n\t\t *\tAdd shadows around the building\r\n\t\t */\r\n\r\n\t\tfor (let e = 0; e < this._blockEdges.length; e++) {\r\n\t\t\tlet edgePointY = this._blockEdges[e].y\r\n\t\t\tlet edgePointX = this._blockEdges[e].x\r\n\t\t\tlet grass = new Column(true, edgePointX, edgePointY, 0)\r\n\t\t\t\tgrass.tileStack = [new Tile(\r\n\t\t\t\t\t\t\t\t\tthis._blockIdIterator, \r\n\t\t\t\t\t\t\t\t\tedgePointX, \r\n\t\t\t\t\t\t\t\t\tedgePointY, \r\n\t\t\t\t\t\t\t\t\t0, \r\n\t\t\t\t\t\t\t\t\tTileType.Shadow,\r\n\t\t\t\t\t\t\t\t\tthis._defaultColor)]\r\n\r\n\t\t\tif (this._world[edgePointY][edgePointX].isDefined) {\r\n\t\t\t\t\r\n\t\t\t\tif (!this._world[edgePointY - 1][edgePointX].isDefined) {\r\n\t\t\t\t\tthis._world[edgePointY - 1][edgePointX] = grass\r\n\t\t\t\t}\r\n\t\t\t\tif (!this._world[edgePointY + 1][edgePointX].isDefined) {\r\n\t\t\t\t\tthis._world[edgePointY + 1][edgePointX] = grass\r\n\t\t\t\t}\r\n\t\t\t\tif (!this._world[edgePointY][edgePointX - 1].isDefined) {\r\n\t\t\t\t\tthis._world[edgePointY][edgePointX - 1] = grass\r\n\t\t\t\t}\r\n\t\t\t\tif (!this._world[edgePointY][edgePointX + 1].isDefined) {\r\n\t\t\t\t\tthis._world[edgePointY][edgePointX + 1] = grass\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis._blockIdIterator++\r\n\t\t}\r\n\r\n\t\t/* \t\r\n\t\t *\tAdd gardens or other ornamental features around the building\r\n\t\t */\r\n\r\n\t\tif (this.config.allowSurroundingDecorations && buildGardens) {\r\n\r\n\t\t\tthis._HorizontalRemainingEmptyBlocksMin = this.getLeastOpenSpaceOnX()['min']\r\n\t\t\tthis._HorizontalRemainingEmptyBlocksMax = this.getLeastOpenSpaceOnX()['max']\r\n\r\n\t\t\tif (this._HorizontalRemainingEmptyBlocksMin > 7) {\r\n\r\n\t\t\t\tlet landsLength = this._HorizontalRemainingEmptyBlocksMin * 2\r\n\t\t\t\tif (landsLength > 16) landsLength = 16\r\n\t\t\t\tlet landsEdge = this._mapLength - landsLength\r\n\r\n\t\t\t\tfor (let y = Math.floor(landsEdge / 2); y < this.mapLength - Math.floor(landsEdge / 2); y++) {\t\t\t\t\r\n\t\t\t\t\tfor (let x = 0; x < this._HorizontalRemainingEmptyBlocksMin - 3; x++) {\r\n\t\t\t\t\t\tif (!this._world[y][x].isDefined) {\r\n\t\t\t\t\t\t\tlet edgeOfGarden = false\r\n\t\t\t\t\t\t\tlet tileType: TileType = TileType.Grass\r\n\t\t\t\t\t\t\tlet tileColor = this._surroundingsDefaultColor\r\n\t\t\t\t\t\t\tlet defaultHeight = 0\r\n\t\t\t\t\t\t\tif (x === 0 || \r\n\t\t\t\t\t\t\t\tx === this._HorizontalRemainingEmptyBlocksMin - 4) {\r\n\t\t\t\t\t\t\t\tif (useWaterGarden) {\r\n\t\t\t\t\t\t\t\t\ttileColor = this._defaultColor\r\n\t\t\t\t\t\t\t\t\ttileType = TileType.HalfBlock\r\n\t\t\t\t\t\t\t\t\tdefaultHeight = 1\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\ttileColor = this._surroundingsSandColor\r\n\t\t\t\t\t\t\t\t\ttileType = TileType.Grass\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else if (\r\n\t\t\t\t\t\t\t\t\t(y === Math.floor(landsEdge / 2) + 1) ||\r\n\t\t\t\t\t\t\t\t\t(y === this.mapLength - Math.floor(landsEdge / 2) - 1) ) {\r\n\t\t\t\t\t\t\t\tif (useWaterGarden) {\r\n\t\t\t\t\t\t\t\t\ttileColor = this._defaultColor\r\n\t\t\t\t\t\t\t\t\ttileType = TileType.HalfBlock\r\n\t\t\t\t\t\t\t\t\tdefaultHeight = 1\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\ttileColor = this._surroundingsSandColor\r\n\t\t\t\t\t\t\t\t\ttileType = TileType.Grass\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tlet gardenBlock = new Column(true, x, y, defaultHeight)\r\n\t\t\t\t\t\t\t\tgardenBlock.tileStack = [new Tile(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis._blockIdIterator, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\tx, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\ty, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t0, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttileType,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttileColor)]\r\n\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\tthis._world[y][x] = gardenBlock\r\n\t\t\t\t\t\t\tthis._blockIdIterator++\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (this._HorizontalRemainingEmptyBlocksMax > 7) {\r\n\r\n\t\t\t\tlet landsLength = this._HorizontalRemainingEmptyBlocksMax * 2\r\n\t\t\t\tlet landsEdge = this._mapLength - landsLength\r\n\r\n\t\t\t\tfor (let y = Math.floor(landsEdge / 2); y < this.mapLength - Math.floor(landsEdge / 2); y++) {\r\n\t\t\t\t\tfor (let x = this._mapWidth - this._HorizontalRemainingEmptyBlocksMax + 2; x < this._mapWidth; x++) {\r\n\t\t\t\t\t\tif (!this._world[y][x].isDefined) {\r\n\t\t\t\t\t\t\tlet edgeOfGarden = false\r\n\t\t\t\t\t\t\tlet tileType: TileType = TileType.Grass\r\n\t\t\t\t\t\t\tlet tileColor = this._surroundingsDefaultColor\r\n\t\t\t\t\t\t\tlet defaultHeight = 0\r\n\t\t\t\t\t\t\tif (x === this._mapWidth - 1 || \r\n\t\t\t\t\t\t\t\tx === this._mapWidth - this._HorizontalRemainingEmptyBlocksMax + 2) {\r\n\t\t\t\t\t\t\t\tif (useWaterGarden) {\r\n\t\t\t\t\t\t\t\t\ttileColor = this._defaultColor\r\n\t\t\t\t\t\t\t\t\ttileType = TileType.HalfBlock\r\n\t\t\t\t\t\t\t\t\tdefaultHeight = 1\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\ttileColor = this._surroundingsSandColor\r\n\t\t\t\t\t\t\t\t\ttileType = TileType.Grass\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else if (\r\n\t\t\t\t\t\t\t\t\ty === Math.floor(landsEdge / 2) + 1 ||\r\n\t\t\t\t\t\t\t\t\ty === this.mapLength - Math.floor(landsEdge / 2) - 1) {\r\n\t\t\t\t\t\t\t\tif (useWaterGarden) {\r\n\t\t\t\t\t\t\t\t\ttileColor = this._defaultColor\r\n\t\t\t\t\t\t\t\t\ttileType = TileType.HalfBlock\r\n\t\t\t\t\t\t\t\t\tdefaultHeight = 1\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\ttileColor = this._surroundingsSandColor\r\n\t\t\t\t\t\t\t\t\ttileType = TileType.Grass\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tlet gardenBlock = new Column(true, x, y, defaultHeight)\r\n\t\t\t\t\t\t\t\tgardenBlock.tileStack = [new Tile(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis._blockIdIterator, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\tx, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\ty, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t0, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttileType,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttileColor)]\r\n\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\tthis._world[y][x] = gardenBlock\r\n\t\t\t\t\t\t\tthis._blockIdIterator++\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/* \t\r\n\t\t *\tClear the edges and mirror the building\r\n\t\t */\r\n\r\n\t\tthis._world = this.mods.clearMapEdges(this)\r\n\t\tthis._world = this.mods.mirrorMap(this)\r\n\t\tthis.setEdges(false)\r\n\r\n\t\tconsole.log(this._blockEdges)\r\n\t\tconsole.log(this._world)\r\n\t}\t\r\n\r\n\tget mapWidth(): number {\r\n\t\treturn this._mapWidth\r\n\t}\r\n\r\n\tget mapLength(): number {\r\n\t\treturn this._mapLength\r\n\t}\r\n\r\n\tget mapHalfLength(): number {\r\n\t\treturn this._mapHalfLength\r\n\t}\r\n\r\n\tget mapEdgeWidth(): number {\r\n\t\treturn this._mapEdgeWidth\r\n\t}\r\n\r\n\tget map(): any[] {\r\n\t\treturn this._world\r\n\t}\r\n\r\n\tget blockGroups(): number[] {\r\n\t\treturn this._blockGroups\r\n\t}\r\n\r\n\tset blockGroups(blockGroups: number[]) {\r\n\t\tthis._blockGroups = blockGroups\r\n\t}\r\n\r\n\tget blockHeight(): number {\r\n\t\treturn this._blockHeight\r\n\t}\r\n\r\n\tget mapMaxHeight(): number {\r\n\t\treturn this._mapMaxHeight\r\n\t}\r\n\r\n\tset blockHeight(height: number) {\r\n\t\tthis._blockHeight = height\r\n\t}\r\n\r\n\tget maxBlockIterations(): number {\r\n\t\treturn this._maximumBlockIterations\r\n\t}\r\n\r\n\tget blockAmountIterator(): number {\r\n\t\treturn this._blockAmountIterator\r\n\t}\r\n\r\n\tset blockAmountIterator(i: number) {\r\n\t\tthis._blockAmountIterator = i\r\n\t}\r\n\r\n\tget averageBuildingSize(): number {\r\n\t\treturn this._averageBuildingSize\r\n\t}\r\n\r\n\tget blockEdges(): object[] {\r\n\t\treturn this._blockEdges\r\n\t}\r\n\r\n\tset blockEdges(blockEdges: object[]) {\r\n\t\tthis._blockEdges = blockEdges\r\n\t}\r\n\r\n\tget blockHeightsArray(): number[] {\r\n\t\treturn this._blockHeightsArray\r\n\t}\r\n\r\n\tset blockHeightsArray(heightsArray: number[]) {\r\n\t\tthis._blockHeightsArray = heightsArray\r\n\t}\r\n\r\n\tget blockIdIterator(): number {\r\n\t\treturn this._blockIdIterator\r\n\t}\r\n\r\n\tset blockIdIterator(i: number) {\r\n\t\tthis._blockIdIterator = i\r\n\t}\r\n\r\n\tget blockHeightVariation(): BuildingHeightVariations {\r\n\t\treturn this._blockHeightVariation\r\n\t}\r\n\r\n\tget lineHeight(): number {\r\n\t\treturn this._decorationLineH\r\n\t}\r\n\r\n\tget groundColor(): Color {\r\n\t\treturn this._groundColor\r\n\t}\r\n\r\n\tget defaultColor(): Color {\r\n\t\treturn this._defaultColor\r\n\t}\r\n\r\n\tget firstLevelColor(): Color {\r\n\t\treturn this._firstLevelColor\r\n\t}\r\n\r\n\tget decorativeColors(): object {\r\n\t\treturn { lineColor: this._lineColor }\r\n\t}\r\n\r\n\tget showWindows(): number {\r\n\t\treturn this._showWindows\r\n\t}\r\n\r\n\tpublic getColumn(x, y): Column {\r\n\t\treturn this._world[y][x]\r\n\t}\r\n\r\n\tpublic getTiles(x, y): Tile[] {\r\n\t\treturn this._world[y][x].tileStack\r\n\t}\r\n\r\n\tpublic getTile(x, y, h): Tile {\r\n\t\treturn this._world[y][x].getTile(h)\r\n\t}\r\n\r\n\tpublic getTopTile(x, y): Tile {\r\n\t\tlet height = this._world[y][x].height\r\n\t\treturn this._world[y][x].getTile(height-1)\r\n\t}\r\n\r\n\tpublic getFirstDefinedColumn(): Column {\r\n\t\tlet column\r\n\r\n\t\tfor (let y = 0; y < this.mapLength; y++) {\r\n\t\t\tfor (let x = 0; x < this.mapWidth; x++) {\r\n\t\t\t\tif (this._world[y][x].isDefined) {\r\n\t\t\t\t\tcolumn = this._world[y][x]\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn column\r\n\t}\r\n\r\n\tpublic addToBuilding(): void {\r\n\t\tthis._world = this.mods.addBuildingComponent(this)\r\n\t\tthis._world = this.mods.mirrorMap(this)\r\n\t\tthis._world = this.mods.clearMapEdges(this)\r\n\t\tthis.setEdges(false)\r\n\t\tconsole.log(this._world)\t\r\n\t}\r\n\r\n\tsetEdges(considerLowerEdges: boolean): void {\r\n\r\n\t\tfor (let y = 0; y < this.mapLength; y++) {\r\n\t\t\tfor (let x = 0; x < this.mapWidth; x++) {\r\n\t\t\t\t\r\n\t\t\t\tif (y > 0 && x > 0 && y < this.mapLength - 1 && x < this.mapWidth - 1 && this._world[y][x].isDefined) {\r\n\r\n\t\t\t\t\tif (considerLowerEdges) {\r\n\r\n\t\t\t\t\t\tif (this._world[y-1][x].height < this._world[y][x].height || y === 0) {\r\n\t\t\t\t\t\t\tthis._world[y][x].edge.top = true\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (this._world[y+1][x].height < this._world[y][x].height || y === this.mapLength - 1) {\r\n\t\t\t\t\t\t\tthis._world[y][x].edge.bottom = true\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (this._world[y][x-1].height < this._world[y][x].height) {\r\n\t\t\t\t\t\t\tthis._world[y][x].edge.left = true\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (this._world[y][x+1].height < this._world[y][x].height) {\r\n\t\t\t\t\t\t\tthis._world[y][x].edge.right = true\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tif (!this._world[y-1][x].isDefined || y === 0) {\r\n\t\t\t\t\t\t\tthis._world[y][x].edge.top = true\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (!this._world[y+1][x].isDefined || y === this.mapLength - 1) {\r\n\t\t\t\t\t\t\tthis._world[y][x].edge.bottom = true\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (!this._world[y][x-1].isDefined) {\r\n\t\t\t\t\t\t\tthis._world[y][x].edge.left = true\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (!this._world[y][x+1].isDefined) {\r\n\t\t\t\t\t\t\tthis._world[y][x].edge.right = true\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( (this._world[y][x].edge.top && this._world[y][x].edge.right) ||\r\n\t\t\t\t\t\t (this._world[y][x].edge.top && this._world[y][x].edge.left) ||\r\n\t\t\t\t\t\t (this._world[y][x].edge.bottom && this._world[y][x].edge.right) ||\r\n\t\t\t\t\t\t (this._world[y][x].edge.bottom && this._world[y][x].edge.left) ) {\r\n\t\t\t\t\t\tthis._world[y][x].corner = true\r\n\t\t\t\t\t}\r\n\t\t\t\t}\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getEdges(): Position[] {\r\n\r\n\t\tthis._blockEdges = []\r\n\r\n\t\tfor (let y = 0; y < this._mapLength; y++) {\r\n\t\t\t// only check second half of map\r\n\r\n\t\t\tif (y > this._mapHalfLength + (this._blockAmountIterator - 1) && y < this._mapLength - 2) {\r\n\r\n\t\t\t\tfor (let x = 0; x < this._mapWidth; x++) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (x > this._mapEdgeWidth && x < this._mapWidth - 1) {\r\n\r\n\t\t\t\t\t\tif (this._world[y][x].isDefined) {\r\n\r\n\t\t\t\t\t\t\tif (!this._world[y][x+1].isDefined || \r\n\t\t\t\t\t\t\t\t!this._world[y][x-1].isDefined || \r\n\t\t\t\t\t\t\t\t!this._world[y+1][x].isDefined || \r\n\t\t\t\t\t\t\t\t!this._world[y-1][x+1].isDefined || \r\n\t\t\t\t\t\t\t\t!this._world[y-1][x-1].isDefined) {\r\n\r\n\t\t\t\t\t\t\t\tif (y > this._mapLength - 1) {\r\n\t\t\t\t\t\t\t\t\ty = this._mapLength - 1\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tlet pos: Position = {x: x, y: y}\r\n\r\n\t\t\t\t\t\t\t\tthis._blockEdges.push(pos)\r\n\r\n\t\t\t\t\t\t\t} else if ((!this._world[y-1][x].isDefined && !this._world[y+1][x].isDefined) ||\r\n\t\t\t\t\t\t\t\t(!this._world[y][x-1].isDefined && !this._world[y][x+1].isDefined)) {\r\n\r\n\t\t\t\t\t\t\t\tif (y > this._mapLength - 1) {\r\n\t\t\t\t\t\t\t\t\ty = this._mapLength - 1\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tlet pos: Position = {x: x, y: y}\r\n\r\n\t\t\t\t\t\t\t\tthis._blockEdges.push(pos)\t\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this._blockEdges\r\n\t}\r\n\r\n\tgetLeastOpenSpaceOnX(): object {\r\n\t\tlet xMinValues = []\r\n\t\tlet xMaxValues = []\r\n\r\n\t\tfor (let y = 0; y < this.mapLength; y++) {\r\n\t\t\t\r\n\t\t\tlet xMin = 0\r\n\t\t\tlet xMax = 0\r\n\t\t\t\r\n\t\t\tfor (let x = 0; x < this.mapWidth; x++) {\r\n\t\t\t\tif (x < Math.floor(this.mapWidth / 2)) {\r\n\t\t\t\t\tif (!this._world[y][x].isDefined && this._world[y][x].height === 0) {\r\n\t\t\t\t\t\txMin++\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (!this._world[y][x].isDefined && this._world[y][x].height === 0) {\r\n\t\t\t\t\t\txMax++\r\n\t\t\t\t\t}\r\n\t\t\t\t}\t\t\t\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\txMinValues.push(xMin)\r\n\t\t\txMaxValues.push(xMax)\r\n\t\t}\r\n\r\n\t\treturn {'min': Math.min(...xMinValues), 'max': Math.min(...xMaxValues) }\t\t\r\n\t}\r\n}\r\n\r\nexport class Column {\r\n\r\n\tprivate _defined: boolean\r\n\tprivate _x: number\r\n\tprivate _y: number\r\n\tprivate _height: number\r\n\tprivate _blockGroup: number\r\n\tprivate _corner: boolean\r\n\tprivate _edge: ColumnEdge = { top: false, right: false, bottom: false, left: false }\r\n\tprivate _tileStack: Tile[] = []\r\n\r\n\tconstructor(private defined: boolean, private colX: number, private colY: number, private colHeight: number) {\r\n\t\tthis._defined = defined\r\n\t\tthis._x = colX\r\n\t\tthis._y = colY\r\n\t\tthis._height = colHeight\r\n\t}\r\n\r\n\tset x(x: number) {\r\n\t\tthis._x = x\r\n\t}\r\n\r\n\tset y(y: number) {\r\n\t\tthis._y = y\r\n\t}\r\n\r\n\tset height(height: number) {\r\n\t\tthis._height = height\r\n\t}\r\n\r\n\tset blockGroup(groupNum: number) {\r\n\t\tthis._blockGroup = groupNum\r\n\t}\r\n\r\n\tset corner(corner: boolean) {\r\n\t\tthis._corner = corner\r\n\t}\r\n\r\n\tset edge(edge: ColumnEdge) {\r\n\t\tthis._edge = edge\r\n\t}\r\n\r\n\tset tileStack(tiles: Tile[]) {\r\n\t\tthis._tileStack = tiles\r\n\t}\r\n\r\n\tget isDefined(): boolean {\r\n\t\treturn this._defined\r\n\t}\r\n\r\n\tget x(): number {\r\n\t\treturn this._x\r\n\t}\r\n\r\n\tget y(): number {\r\n\t\treturn this._y\r\n\t}\r\n\r\n\tget height(): number {\r\n\t\treturn this._height\r\n\t}\r\n\r\n\tget blockGroup(): number {\r\n\t\treturn this._blockGroup\r\n\t}\r\n\r\n\tget corner(): boolean {\r\n\t\treturn this._corner\r\n\t}\r\n\r\n\tget edge(): ColumnEdge {\r\n\t\treturn this._edge\r\n\t}\r\n\r\n\tget tileStack(): Tile[] {\r\n\t\treturn this._tileStack\r\n\t}\r\n\r\n\tpublic getTile(height: number): Tile {\r\n\t\treturn this._tileStack[height]\r\n\t}\r\n\r\n\tpublic removeTopTile(): void {\r\n\t\tthis._tileStack.pop()\r\n\t}\r\n}\r\n\r\nexport interface ColumnEdge {\r\n\ttop: boolean,\r\n\tright: boolean,\r\n\tbottom: boolean,\r\n\tleft: boolean\r\n}","import { Map, Column } from './mapper.component'\r\nimport { MapGenerationFunctions, BuildingHeightVariations, Color } from './mapGenerationFunctions.component'\r\nimport { Tile, TileType, TileOptions } from './tile.component'\r\nimport { Config, Position } from './config.component'\r\n\r\nexport class Modifiers {\r\n\r\n\tprivate config: Config = new Config()\r\n\tprivate _lastBlockHollow: boolean = false\r\n\r\n\tmirrorMap(world: Map): any[][] {\r\n\r\n\t\tlet oldBlockGroups = []\r\n\t\tworld.blockGroups.forEach(id => {\r\n\t\t\toldBlockGroups.push(id)\r\n\t\t})\r\n\r\n\t\tfor (let y = 0; y < world.mapHalfLength; y++) {\r\n\t\t\tif (y < world.mapHalfLength) {\r\n\t\t\t\t\t\t\t\r\n\t\t\t\tfor (let x = 0; x < world.mapWidth; x++) {\r\n\r\n\t\t\t\t\tif (world.map[world.mapLength - y - 1][x].isDefined) {\r\n\r\n\t\t\t\t\t\tlet activeCol = world.map[world.mapLength - y - 1][x]\r\n\t\t\t\t\t\tlet height = activeCol.height\r\n\r\n\t\t\t\t\t\tif (height > 0) {\r\n\t\t\t\t\t\t\tlet blockGroup = oldBlockGroups.length + activeCol.blockGroup\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tlet tileStack = []\r\n\r\n\t\t\t\t\t\t\tfor (let h = 0; h < height; h++) {\r\n\r\n\t\t\t\t\t\t\t\tlet tileColor = activeCol.tileStack[h].tileColor\r\n\r\n\t\t\t\t\t\t\t\tlet thisPillar\r\n\t\t\t\t\t\t\t\tlet slope\r\n\t\t\t\t\t\t\t\tlet thisWindowed\r\n\t\t\t\t\t\t\t\tlet isTower\r\n\t\t\t\t\t\t\t\tlet stairs\r\n\t\t\t\t\t\t\t\tlet isRoof\r\n\t\t\t\t\t\t\t\tlet halfArches\r\n\t\t\t\t\t\t\t\tlet wholeArch\r\n\r\n\t\t\t\t\t\t\t\tif (activeCol.tileStack[h].options) {\r\n\t\t\t\t\t\t\t\t\tthisPillar = activeCol.tileStack[h].options.pillar\r\n\t\t\t\t\t\t\t\t\tslope = activeCol.tileStack[h].options.slope\r\n\t\t\t\t\t\t\t\t\tthisWindowed = activeCol.tileStack[h].options.windowed\r\n\t\t\t\t\t\t\t\t\tisTower = activeCol.tileStack[h].options.tower\r\n\t\t\t\t\t\t\t\t\tstairs = activeCol.tileStack[h].options.stairs\r\n\t\t\t\t\t\t\t\t\tisRoof = (h === height-1) ? true : false\r\n\t\t\t\t\t\t\t\t\thalfArches = activeCol.tileStack[h].options.halfArch\r\n\t\t\t\t\t\t\t\t\twholeArch = activeCol.tileStack[h].options.wholeArch\r\n\r\n\t\t\t\t\t\t\t\t\ttileStack.push(\r\n\t\t\t\t\t\t\t\t\t\tnew Tile(\r\n\t\t\t\t\t\t\t\t\t\t\tworld.blockIdIterator, \r\n\t\t\t\t\t\t\t\t\t\t\tx, \r\n\t\t\t\t\t\t\t\t\t\t\ty, \r\n\t\t\t\t\t\t\t\t\t\t\th, \r\n\t\t\t\t\t\t\t\t\t\t\tactiveCol.tileStack[h].type,\r\n\t\t\t\t\t\t\t\t\t\t\ttileColor,\r\n\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\troof: isRoof,\r\n\t\t\t\t\t\t\t\t\t\t\t\tpillar: thisPillar,\r\n\t\t\t\t\t\t\t\t\t\t\t\tslope: slope,\r\n\t\t\t\t\t\t\t\t\t\t\t\twindowed: thisWindowed,\r\n\t\t\t\t\t\t\t\t\t\t\t\ttower: isTower,\r\n\t\t\t\t\t\t\t\t\t\t\t\tstairs:\tstairs,\r\n\t\t\t\t\t\t\t\t\t\t\t\thalfArch: halfArches,\r\n\t\t\t\t\t\t\t\t\t\t\t\twholeArch: wholeArch\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\ttileStack.push(\r\n\t\t\t\t\t\t\t\t\t\tnew Tile(\r\n\t\t\t\t\t\t\t\t\t\t\tworld.blockIdIterator, \r\n\t\t\t\t\t\t\t\t\t\t\tx, \r\n\t\t\t\t\t\t\t\t\t\t\ty, \r\n\t\t\t\t\t\t\t\t\t\t\th, \r\n\t\t\t\t\t\t\t\t\t\t\tactiveCol.tileStack[h].type,\r\n\t\t\t\t\t\t\t\t\t\t\ttileColor\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t\tworld.blockIdIterator++\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tworld.blockHeightsArray.push(height)\r\n\r\n\t\t\t\t\t\t\tif (world.blockGroups.indexOf(blockGroup) === -1) {\r\n\t\t\t\t\t\t\t\tworld.blockGroups.push(blockGroup)\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tworld.map[y][x] = null\r\n\r\n\t\t\t\t\t\t\tlet column = new Column(true, x, y, height)\r\n\r\n\t\t\t\t\t\t\tcolumn.blockGroup = blockGroup\r\n\t\t\t\t\t\t\tcolumn.height = height\r\n\t\t\t\t\t\t\tcolumn.corner = false\r\n\t\t\t\t\t\t\tcolumn.tileStack = tileStack\r\n\r\n\t\t\t\t\t\t\tworld.map[y][x] = column\r\n\t\t\t\t\t\t} else if(height === 0 && activeCol.isDefined) {\r\n\t\t\t\t\t\t\tworld.map[y][x] = activeCol\r\n\t\t\t\t\t\t}\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn world.map\r\n\t}\r\n\t\r\n\tclearMapEdges(world: Map): any[][] {\r\n\r\n\t\tfor (let y = 0; y < world.mapLength; y++) {\r\n\t\t\tfor (let x = 1; x < world.mapWidth; x++) {\r\n\t\t\t\tif (x < world.mapEdgeWidth || x >= world.mapWidth ||\r\n\t\t\t\t\ty < world.mapEdgeWidth || y >= world.mapLength - world.mapEdgeWidth) {\r\n\t\t\t\t\tif (world.map[y][x].isDefined && world.map[y][x].height > 0) {\r\n\t\t\t\t\t\tworld.map[y][x] = null\r\n\t\t\t\t\t\tlet column = new Column(false, x, y, 0)\r\n\t\t\t\t\t\tcolumn.tileStack = []\r\n\t\t\t\t\t\tworld.map[y][x] = column\r\n\t\t\t\t\t}\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn world.map\r\n\t}\r\n\r\n\taddBuildingComponent(world: Map): any[][] {\r\n\r\n\t\tif (world.blockAmountIterator < world.maxBlockIterations) {\r\n\r\n\t\t\tworld.blockEdges = world.getEdges()\r\n\r\n\t\t\tif (world.blockEdges.length > 0) {\t\t\t\r\n\r\n\t\t\t\tlet nextHeight\r\n\t\t\t\tlet openFloor = 0\r\n\t\t\t\tlet showWindows = world.showWindows\r\n\r\n\t\t\t\tif (world.blockHeightVariation === BuildingHeightVariations.TallCenter) {\r\n\t\t\t\t\tnextHeight = world.blockHeight - (world.blockAmountIterator)\r\n\t\t\t\t} else if (world.blockHeightVariation === BuildingHeightVariations.TallSurrounds) {\r\n\t\t\t\t\tnextHeight = world.blockHeight + (world.blockAmountIterator * Math.ceil(Math.random() * 2))\r\n\t\t\t\t} else if (world.blockHeightVariation === BuildingHeightVariations.Random) {\r\n\t\t\t\t\tlet randomNum = Math.ceil(Math.random() * 4)\r\n\t\t\t\t\tlet randomAdd = Math.round(Math.random())\r\n\t\t\t\t\tif (randomAdd === 0 && world.blockHeight > 3) {\r\n\t\t\t\t\t\tnextHeight = world.blockHeight - randomNum\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tnextHeight = world.blockHeight + randomNum\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (nextHeight < 2) {\r\n\t\t\t\t\tnextHeight = 1\r\n\t\t\t\t} else if (nextHeight > world.mapMaxHeight) {\r\n\t\t\t\t\tnextHeight = world.mapMaxHeight\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (nextHeight > 5) {\r\n\t\t\t\t\topenFloor = 2 + Math.floor(Math.random() * 3)\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet randomEdgePoint = Math.floor(Math.random() * world.blockEdges.length)\r\n\t\t\t\tlet creationPoint: Position = world.blockEdges[randomEdgePoint]\r\n\t\t\t\tlet blockGroup = world.blockGroups.length + 1\r\n\t\t\t\tlet manipulateExistingCols = (Math.round(Math.random()) < 1) ? false : true\r\n\t\t\t\tlet nextBlockWidth = (world.averageBuildingSize ) + Math.floor(Math.random() * 5)\r\n\t\t\t\tlet nextBlockLength = (world.averageBuildingSize ) + Math.floor(Math.random() * 5)\r\n\t\t\t\tlet yStartOffset = 1 + Math.floor(Math.random() * 2)\r\n\t\t\t\tlet hollowBuildingBlock = Math.round(Math.random()) === 1 ? true : false\r\n\r\n\t\t\t\tif (creationPoint.y + nextBlockLength - yStartOffset > world.mapLength - 1) {\r\n\t\t\t\t\tnextBlockLength = world.mapLength - (creationPoint.y + yStartOffset) - 1\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif (nextBlockWidth > 4 && nextBlockLength > 4) {\r\n\t\t\t\t\tif (!this._lastBlockHollow) {\r\n\t\t\t\t\t\thollowBuildingBlock = Math.round(Math.random() * 8) > 5 ? true : false\r\n\t\t\t\t\t\tthis._lastBlockHollow = true\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\thollowBuildingBlock = false\r\n\t\t\t\t\t\tthis._lastBlockHollow = false\r\n\t\t\t\t\t}\t\t\t\t\t\r\n\t\t\t\t} else {\r\n\t\t\t\t\thollowBuildingBlock = false\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet chanceForHigherSpace = Math.round(Math.random() * 8)\r\n\t\t\t\tlet changeForHighCorridor = true // Math.round(Math.random() * 8) > 5 ? true : false\r\n\r\n\t\t\t\tlet yLowEdge = creationPoint.y - yStartOffset + 1\r\n\t\t\t\tlet yHighEdge = creationPoint.y + nextBlockLength - yStartOffset - 1\r\n\t\t\t\tlet xLowEdge = creationPoint.x - (nextBlockWidth / 2) + 1\r\n\t\t\t\tlet xHighEdge = creationPoint.x + (nextBlockWidth / 2) - 1\r\n\t\t\t\tlet yEdgeLowActive = false\r\n\t\t\t\tlet yEdgeHighActive = false\r\n\r\n\t\t\t\tlet createTower = (nextHeight < 7 && Math.round(Math.random() * 8) > 5) ? true : false\r\n\t\t\t\tlet towerLocation = 0\r\n\t\t\t\tif (createTower) {\r\n\t\t\t\t\ttowerLocation = Math.round(Math.random() * 2)\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet defaultTileColor = world.getFirstDefinedColumn().tileStack[0].tileColor\r\n\r\n\t\t\t\tconsole.log('nextBlockLength: ', nextBlockLength)\r\n\r\n\t\t\t\tfor (let y = 0; y < world.mapLength; y++) {\t\r\n\r\n\t\t\t\t\tif (yLowEdge === y) {\r\n\t\t\t\t\t\tyEdgeLowActive = true\r\n\t\t\t\t\t} else if (yHighEdge === y) {\r\n\t\t\t\t\t\tyEdgeHighActive = true\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tyEdgeLowActive = false\r\n\t\t\t\t\t\tyEdgeHighActive = false\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet xEdgeLowActive = false\r\n\t\t\t\t\tlet xEdgeHighActive = false\r\n\r\n\t\t\t\t\tfor (let x = 0; x < world.mapWidth; x++) {\r\n\r\n\t\t\t\t\t\tif (x === xLowEdge) {\r\n\t\t\t\t\t\t\txEdgeLowActive = true\r\n\t\t\t\t\t\t} else if (x === xHighEdge) {\r\n\t\t\t\t\t\t\txEdgeHighActive = true\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (y >= yLowEdge && y <= yHighEdge) {\r\n\r\n\t\t\t\t\t\t\tif (x >= xLowEdge && x <= xHighEdge) {\r\n\r\n\t\t\t\t\t\t\t\tlet createCol = true\r\n\r\n\t\t\t\t\t\t\t\tif (hollowBuildingBlock) {\r\n\t\t\t\t\t\t\t\t\tif (y > yLowEdge && y < yHighEdge && x > xLowEdge+1 && x < xHighEdge-1) {\r\n\t\t\t\t\t\t\t\t\t\tcreateCol = false\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tif (createCol) {\r\n\r\n\t\t\t\t\t\t\t\t\tlet buildTowerHere = false\r\n\r\n\t\t\t\t\t\t\t\t\tif (createTower) {\r\n\t\t\t\t\t\t\t\t\t\tif (towerLocation === 0) {\r\n\t\t\t\t\t\t\t\t\t\t\tif (y <= yLowEdge + 1 && x <= xLowEdge + 1) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tbuildTowerHere = true\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t} else if (towerLocation === 1) {\r\n\t\t\t\t\t\t\t\t\t\t\tif (y <= yLowEdge + 1 && x >= xHighEdge - 1) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tbuildTowerHere = true\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t} else if (towerLocation === 2) {\r\n\t\t\t\t\t\t\t\t\t\t\tif (y >= yHighEdge - 1 && x >= xHighEdge - 1) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tbuildTowerHere = true\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tlet thisHeight = nextHeight\r\n\t\t\t\t\t\t\t\t\tif (buildTowerHere) {\r\n\t\t\t\t\t\t\t\t\t\tthisHeight = nextHeight + 5\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tlet tileStack = []\r\n\r\n\t\t\t\t\t\t\t\t\tfor (let h = 0; h < thisHeight; h++) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tlet thisPillar = false\r\n\t\t\t\t\t\t\t\t\t\tlet thisWindowed = 0\r\n\t\t\t\t\t\t\t\t\t\tif (showWindows > 0 && h % 2 === 1) {\r\n\t\t\t\t\t\t\t\t\t\t\tthisWindowed = showWindows\r\n\t\t\t\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t\t\t\tlet isRoof = (h === thisHeight-1) ? true : false\r\n\t\t\t\t\t\t\t\t\t\tlet slope = false\r\n\t\t\t\t\t\t\t\t\t\tlet tileColor = defaultTileColor\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tlet tileType = TileType.Body\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tlet isTower = false\r\n\t\t\t\t\t\t\t\t\t\tif (buildTowerHere) {\r\n\t\t\t\t\t\t\t\t\t\t\tisTower = true\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tlet stairs = false\r\n\t\t\t\t\t\t\t\t\t\tlet thisHalfArch = false\r\n\t\t\t\t\t\t\t\t\t\tlet thisWholeArch = false\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (thisHeight > 4) {\r\n\t\t\t\t\t\t\t\t\t\t\tif (changeForHighCorridor) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (nextBlockLength > 4 && nextBlockLength < 6) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tlet maxWallPoint = creationPoint.y + 5\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (creationPoint.y + 5 > creationPoint.y + (nextBlockLength / 2)) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tmaxWallPoint = creationPoint.y + 4\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (y > creationPoint.y + 1 && y < maxWallPoint) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (h < thisHeight - 2) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttileType = TileType.None\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (creationPoint.y + 5 > 27) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (y % 2 === 0 && x % 2 !== 0) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthisPillar = true\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (h === thisHeight - 3) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthisHalfArch = true\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t} \r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (nextBlockLength === 6) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (y === yLowEdge + 1 || \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ty === yLowEdge + 2 ||\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ty === yHighEdge - 2 ||\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ty === yHighEdge - 3) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (h < thisHeight - 2) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttileType = TileType.None\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (h === thisHeight - 3) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthisHalfArch = true\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (nextBlockLength === 8) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (y === yLowEdge + 1 || \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ty === yLowEdge + 2 ||\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ty === yLowEdge + 4 ||\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ty === yLowEdge + 5) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (h < thisHeight - 2) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttileType = TileType.None\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (h === thisHeight - 3) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthisHalfArch = true\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t} else if (y === yLowEdge + 3 || y === yLowEdge + 6) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttileType = TileType.Body\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthisHalfArch = false\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (chanceForHigherSpace > 4) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (openFloor > 0 && (h === openFloor || h+1 === openFloor)) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttileType = TileType.None\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (y % 2 === 0 && x % 2 !== 0) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthisPillar = true\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (thisHeight > 7 && openFloor > 0 && h > openFloor && h < openFloor + 4) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttileType = TileType.None\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (y % 2 === 0 && x % 2 !== 0) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthisPillar = true\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (h === world.lineHeight) {\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\ttileColor = world.decorativeColors['lineColor']\r\n\t\t\t\t\t\t\t\t\t\t} else if (h === 0) {\r\n\t\t\t\t\t\t\t\t\t\t\ttileColor = world.firstLevelColor\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\ttileColor = world.defaultColor\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\ttileStack.push(\r\n\t\t\t\t\t\t\t\t\t\t\tnew Tile(\r\n\t\t\t\t\t\t\t\t\t\t\t\tworld.blockIdIterator, \r\n\t\t\t\t\t\t\t\t\t\t\t\tx, \r\n\t\t\t\t\t\t\t\t\t\t\t\ty, \r\n\t\t\t\t\t\t\t\t\t\t\t\th, \r\n\t\t\t\t\t\t\t\t\t\t\t\ttileType,\r\n\t\t\t\t\t\t\t\t\t\t\t\ttileColor,\r\n\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\troof: isRoof,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tpillar: thisPillar,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tslope: slope,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twindowed: thisWindowed,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttower: isTower,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstairs:\tstairs,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\thalfArch: thisHalfArch,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twholeArch: thisWholeArch\r\n\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t)\t\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t\t\t\tworld.blockHeightsArray.push(thisHeight)\r\n\r\n\t\t\t\t\t\t\t\t\t\tworld.blockIdIterator++\r\n\r\n\t\t\t\t\t\t\t\t\t\ttileColor = undefined\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tif (world.blockGroups.indexOf(blockGroup) === -1) {\r\n\t\t\t\t\t\t\t\t\t\tworld.blockGroups.push(blockGroup)\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tworld.map[y][x] = null\r\n\r\n\t\t\t\t\t\t\t\t\tlet column = new Column(true, x, y, thisHeight)\r\n\r\n\t\t\t\t\t\t\t\t\tcolumn.blockGroup = blockGroup\r\n\t\t\t\t\t\t\t\t\tcolumn.height = thisHeight\r\n\t\t\t\t\t\t\t\t\tcolumn.corner = false\r\n\t\t\t\t\t\t\t\t\tcolumn.tileStack = tileStack\r\n\r\n\t\t\t\t\t\t\t\t\tworld.map[y][x] = column\t\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tworld.blockHeight = nextHeight\r\n\r\n\t\t\t\tworld.blockAmountIterator++\r\n\r\n\t\t\t\tif (1 === 1) {\r\n\r\n\t\t\t\t\tfor (let y = 0; y < world.mapLength; y++) {\r\n\t\t\t\t\t\tfor (let x = 0; x < world.mapWidth; x++) {\r\n\r\n\t\t\t\t\t\t\tif (x < world.mapWidth - 2 && x > 2) {\r\n\t\t\t\t\t\t\t\tif (y < world.mapLength - 2 && y > 2) {\r\n\r\n\t\t\t\t\t\t\t\t\tif (world.map[y][x].isDefined && \r\n\t\t\t\t\t\t\t\t\t\tworld.map[y-1][x].isDefined &&\r\n\t\t\t\t\t\t\t\t\t\tworld.map[y+1][x].isDefined &&\r\n\t\t\t\t\t\t\t\t\t\tworld.map[y][x-1].isDefined &&\r\n\t\t\t\t\t\t\t\t\t\tworld.map[y][x+1].isDefined) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (world.map[y][x].height > 4) {\r\n\t\t\t\t\t\t\t\t\t\t\tif (world.map[y-1][x].blockGroup !== blockGroup) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tworld.map[y][x].tileStack[world.map[y][x].height-1].type = TileType.HalfBlock\r\n\t\t\t\t\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t}\t\t\r\n\t\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\t\t\r\n\t\t\t\tconsole.warn(\"Block edges array is empty.\")\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\t\t\tconsole.warn(\"Cannot add more building components, maximum block iterations reached.\")\r\n\t\t}\r\n\r\n\t\treturn world.map\r\n\t}\t\r\n}","export class Primitives {\r\n\r\n\tgetPyramid(mapWidth: number, mapLength: number): number[][] {\r\n\r\n\t\tlet map = [],\r\n\t\t\twidth = Math.min(mapWidth, mapLength),\r\n\t\t\theight = Math.min(mapWidth, mapLength),\r\n\t\t\twidthHalf = Math.floor(width / 2),\r\n\t\t\theightHalf = Math.floor(height / 2),\r\n\t\t\tquarter = [];\r\n\r\n\t\tfor (let y = 0; y < width; y++) {\r\n\t\t\tmap[y] = []\r\n\t\t\tfor (let x = 0; x < height; x++) {\r\n\t\t\t\tif (y < Math.round(height / 2) && x < Math.round(width / 2)) {  \r\n\t\t\t\t\tmap[y][x] = Math.min(y, x)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmap[y][x] = Math.max(y, x)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfor (let y = 0; y < widthHalf; y++) {\r\n\t\t\tquarter[y] = []\r\n\t\t\tfor (let x = 0; x < heightHalf; x++) {\r\n\t\t\t\tif (y < heightHalf && x < widthHalf) { \r\n\t\t\t\t\tquarter[y][x] = map[y][x]\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet quarterRev = quarter.reverse()\r\n\r\n\t\tfor (let y = 0; y < width; y++) {\r\n\t\t\tfor (let x = 0; x < height; x++) {\r\n\t\t\t  \tif (y > heightHalf - 1 && x < widthHalf) {\r\n\t\t\t    \tmap[y][x] = quarterRev[y - heightHalf][x]\r\n\t\t\t    }\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfor (let y = 0; y < width; y++) {\r\n\t\t\tfor (let x = 0; x < height; x++) {\r\n\t\t\t  \tif (x > widthHalf - 1) {\r\n\t\t\t    \tmap[y][x] = map[y][width - x - 1]\r\n\t\t\t    }\r\n\t\t  \t}\r\n\t\t}\r\n\r\n\t\treturn map\r\n\t}\r\n}","import { Config, Coords, TileTemplate, Position } from './config.component'\r\nimport { MapGenerationFunctions, Color } from './mapGenerationFunctions.component'\r\nimport { Tile, TileType } from './tile.component'\r\nimport { Column, ColumnEdge } from './mapper.component'\r\n\r\nexport class RenderElements {\r\n\r\n\tprivate config: Config = new Config()\r\n\tprivate calculations: MapGenerationFunctions = new MapGenerationFunctions()\r\n\r\n\tprivate tileW: number = this.config.tileWidth\r\n\tprivate tileL: number = this.config.tileLength\r\n\tprivate tileH: number = this.config.tileHeight\r\n\tprivate bleed: number = this.config.tileEdgeBleed\r\n\tprivate dimensions = this.calculations.calculateStraightLinesFromIsometricSquare(this.tileW, this.tileL)\r\n\r\n\tprivate tileColor: Color = this.config.groundColor\r\n\r\n\tcreateTile(xPos: number, yPos: number, shadow: string): TileTemplate {\r\n\r\n\t\tlet top: Position = { \"x\": (xPos + this.dimensions.horizontalWidthFromTop), \"y\": yPos}\r\n\t\tlet left: Position = { \"x\": xPos, \"y\": (yPos + this.dimensions.verticalHeightFromTop) }\r\n\t\tlet bottom: Position = { \"x\": (xPos + this.dimensions.horizontalWidthFromBottom), \"y\": (yPos + this.dimensions.totalHeight) }\r\n\t\tlet right: Position = { \"x\": (xPos + this.dimensions.totalWidth), \"y\": (yPos + this.dimensions.verticalHeightFromBottom) }\r\n\r\n\t\tlet pointTop = `${top.x} ${top.y-this.bleed}`\r\n\t\tlet pointLeft = `${left.x-this.bleed} ${left.y}`\r\n\t\tlet pointBottom = `${bottom.x} ${bottom.y+this.bleed}`\r\n\t\tlet pointRight = `${right.x+this.bleed} ${right.y}`\r\n\r\n\t\tlet tileColor = this.tileColor.hex()\r\n\t\tif (shadow === 'shade') {\r\n\t\t\ttileColor = this.tileColor.changeColorLightingString(-50)\r\n\t\t}\r\n\r\n\t\tvar html = `<path fill=\"${tileColor}\"\r\n\t\t\t\t\td=\"M${pointLeft} \r\n\t\t\t\t\tL${pointBottom} \r\n\t\t\t\t\tL${pointRight} \r\n\t\t\t\t\tL${pointTop} \r\n\t\t\t\t\tL${pointLeft} Z\" />`\r\n\r\n\t\tlet coords: Coords = { \"top\": top, \"left\": left, \"bottom\": bottom, \"right\": right }\r\n\r\n\t\treturn { html: html, coords: coords }\r\n\t}\r\n\r\n\tcreatePlane(xPos: number, yPos: number, tile: Tile, color?: Color): TileTemplate {\r\n\r\n\t\tlet id = tile.id\r\n\t\tlet height = (tile.h * this.tileH) - this.tileH\r\n\r\n\t\tlet regularColor\r\n\r\n\t\tif (color) {\r\n\t\t\tregularColor = color.hex()\r\n\t\t} else {\r\n\t\t\tregularColor = this.config.groundColor.hex()\r\n\t\t}\r\n\r\n\t\tlet top: Position = { \"x\": Math.ceil(xPos + this.dimensions.horizontalWidthFromTop), \"y\": Math.ceil(yPos + this.config.topMargin ) }\r\n\t\tlet left: Position = { \"x\": Math.ceil(xPos), \"y\": Math.ceil(yPos + this.dimensions.verticalHeightFromTop + this.config.topMargin ) }\r\n\t\tlet bottom: Position = { \"x\": Math.ceil(xPos + this.dimensions.horizontalWidthFromBottom), \"y\": Math.ceil(yPos + this.dimensions.totalHeight + this.config.topMargin ) }\r\n\t\tlet right: Position = { \"x\": Math.ceil(xPos + this.dimensions.totalWidth), \"y\": Math.ceil(yPos + this.dimensions.verticalHeightFromBottom + this.config.topMargin ) }\r\n\r\n\t\tlet blockTopLeft = `${left.x-this.bleed} ${left.y}`\r\n\t\tlet blockTopBottom = `${bottom.x} ${bottom.y}`\r\n\t\tlet blockTopRight = `${right.x+this.bleed} ${right.y}`\r\n\t\tlet blockTopTop = `${top.x} ${top.y}`\r\n\r\n\t\tlet html = `<g style=\"z-index:${id};\">\r\n\t\t\t\t\t<path fill=\"${regularColor}\"\r\n\t\t\t\t\td=\"M${blockTopLeft} \r\n\t\t\t\t\tL${blockTopBottom} \r\n\t\t\t\t\tL${blockTopRight} \r\n\t\t\t\t\tL${blockTopTop} \r\n\t\t\t\t\tL${blockTopLeft} Z\" /></g>`\r\n\r\n\t\tlet coords: Coords = { \"top\": top, \"left\": left, \"bottom\": bottom, \"right\": right }\r\n\r\n\t\treturn { html: html, coords: coords }\r\n\t}\r\n\r\n\tcreateBlock(xPos: number, yPos: number, tile: Tile): TileTemplate {\r\n\r\n\t\tlet id = tile.id\r\n\t\tlet height = (tile.h * this.tileH) - this.tileH\r\n\r\n\t\tlet regularColor\r\n\t\tlet highlight\r\n\t\tlet darkestColor\r\n\r\n\t\tif (tile.tileColor.hex() !== this.config.buildingBaseColor.hex()) {\r\n\t\t\tregularColor = tile.tileColor.hex()\r\n\t\t\thighlight = tile.tileColor.changeColorLightingString(30)\r\n\t\t\tdarkestColor = tile.tileColor.changeColorLightingString(-60)\r\n\t\t} else {\r\n\t\t\tregularColor = this.config.buildingBaseColor.hex()\r\n\t\t\thighlight = this.config.buildingBaseColor.changeColorLightingString(30)\r\n\t\t\tdarkestColor = this.config.buildingBaseColor.changeColorLightingString(-60)\r\n\t\t}\r\n\r\n\t\tlet top: Position = { x: Math.ceil(xPos + this.dimensions.horizontalWidthFromTop), y: Math.ceil(yPos + this.config.topMargin ) }\r\n\t\tlet left: Position = { x: Math.ceil(xPos), y: Math.ceil(yPos + this.dimensions.verticalHeightFromTop + this.config.topMargin ) }\r\n\t\tlet bottom: Position = { x: Math.ceil(xPos + this.dimensions.horizontalWidthFromBottom), y: Math.ceil(yPos + this.dimensions.totalHeight + this.config.topMargin ) }\r\n\t\tlet right: Position = { x: Math.ceil(xPos + this.dimensions.totalWidth), y: Math.ceil(yPos + this.dimensions.verticalHeightFromBottom + this.config.topMargin ) }\r\n\r\n\t\tlet leftWallLeftTop = `${left.x-this.bleed} ${left.y-height-this.tileH}`\r\n\t\tlet leftWallLeftBottom = `${left.x-this.bleed} ${left.y-height+this.bleed}`\r\n\t\tlet leftWallRightBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\tlet leftWallRightTop = `${bottom.x} ${bottom.y-height-this.tileH}`\r\n\r\n\t\tlet rightWallLeftTop = `${bottom.x} ${bottom.y-height-this.tileH}`\r\n\t\tlet rightWallLeftBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\tlet rightWallRightBottom = `${right.x+this.bleed} ${right.y-height+this.bleed}`\r\n\t\tlet rightWallRightTop = `${right.x+this.bleed} ${right.y-height-this.tileH}`\r\n\r\n\t\tlet blockTopLeft = `${left.x-this.bleed} ${left.y-height-this.tileH}`\r\n\t\tlet blockTopBottom = `${bottom.x} ${bottom.y-height-this.tileH}`\r\n\t\tlet blockTopRight = `${right.x+this.bleed} ${right.y-height-this.tileH}`\r\n\t\tlet blockTopTop = `${top.x} ${top.y-height-this.tileH}`\r\n\r\n\t\tlet html = `<g style=\"z-index:${id};\">\r\n\t\t\t\t\t<path fill=\"${darkestColor}\"\r\n\t\t\t\t\td=\"M${leftWallLeftTop} \r\n\t\t\t\t\tL${leftWallLeftBottom} \r\n\t\t\t\t\tL${leftWallRightBottom} \r\n\t\t\t\t\tL${leftWallRightTop} \r\n\t\t\t\t\tL${leftWallLeftTop} Z\" />\r\n\t\t\t\t\t<path fill=\"${regularColor}\"\r\n\t\t\t\t\td=\"M${rightWallLeftTop} \r\n\t\t\t\t\tL${rightWallLeftBottom} \r\n\t\t\t\t\tL${rightWallRightBottom} \r\n\t\t\t\t\tL${rightWallRightTop} \r\n\t\t\t\t\tL${rightWallLeftTop} Z\" />\r\n\t\t\t\t\t<path fill=\"${highlight}\"\r\n\t\t\t\t\td=\"M${blockTopLeft} \r\n\t\t\t\t\tL${blockTopBottom} \r\n\t\t\t\t\tL${blockTopRight} \r\n\t\t\t\t\tL${blockTopTop} \r\n\t\t\t\t\tL${blockTopLeft} Z\" />\r\n\t\t\t\t</g>`\r\n\r\n\t\tlet coords: Coords = { \"top\": top, \"left\": left, \"bottom\": bottom, \"right\": right }\r\n\r\n\t\treturn { html: html, coords: coords }\r\n\t}\r\n\r\n\tcreateHalfBlock(xPos: number, yPos: number, tile: Tile): TileTemplate {\r\n\r\n\t\tlet id = tile.id\r\n\t\tlet height = (tile.h * this.tileH) - this.tileH\r\n\r\n\t\tlet regularColor\r\n\t\tlet highlight\r\n\t\tlet darkestColor\r\n\r\n\t\tif (tile.tileColor.hex() !== this.config.buildingBaseColor.hex()) {\r\n\t\t\tregularColor = tile.tileColor.hex()\r\n\t\t\thighlight = tile.tileColor.changeColorLightingString(30)\r\n\t\t\tdarkestColor = tile.tileColor.changeColorLightingString(-60)\r\n\t\t} else {\r\n\t\t\tregularColor = this.config.buildingBaseColor.hex()\r\n\t\t\thighlight = this.config.buildingBaseColor.changeColorLightingString(30)\r\n\t\t\tdarkestColor = this.config.buildingBaseColor.changeColorLightingString(-60)\r\n\t\t}\t\r\n\r\n\t\tlet top: Position = { \"x\": Math.ceil(xPos + this.dimensions.horizontalWidthFromTop), \"y\": Math.ceil(yPos + this.config.topMargin ) }\r\n\t\tlet left: Position = { \"x\": Math.ceil(xPos), \"y\": Math.ceil(yPos + this.dimensions.verticalHeightFromTop + this.config.topMargin ) }\r\n\t\tlet bottom: Position = { \"x\": Math.ceil(xPos + this.dimensions.horizontalWidthFromBottom), \"y\": Math.ceil(yPos + this.dimensions.totalHeight + this.config.topMargin ) }\r\n\t\tlet right: Position = { \"x\": Math.ceil(xPos + this.dimensions.totalWidth), \"y\": Math.ceil(yPos + this.dimensions.verticalHeightFromBottom + this.config.topMargin ) }\r\n\r\n\t\tlet leftWallLeftTop = `${left.x-this.bleed} ${left.y-height-(this.tileH / 2)}`\r\n\t\tlet leftWallLeftBottom = `${left.x-this.bleed} ${left.y-height+this.bleed}`\r\n\t\tlet leftWallRightBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\tlet leftWallRightTop = `${bottom.x} ${bottom.y-height-(this.tileH / 2)}`\r\n\r\n\t\tlet rightWallLeftTop = `${bottom.x} ${bottom.y-height-(this.tileH / 2)}`\r\n\t\tlet rightWallLeftBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\tlet rightWallRightBottom = `${right.x+this.bleed} ${right.y-height+this.bleed}`\r\n\t\tlet rightWallRightTop = `${right.x+this.bleed} ${right.y-height-(this.tileH / 2)}`\r\n\r\n\t\tlet blockTopLeft = `${left.x-this.bleed} ${left.y-height-(this.tileH / 2)}`\r\n\t\tlet blockTopBottom = `${bottom.x} ${bottom.y-height-(this.tileH / 2)}`\r\n\t\tlet blockTopRight = `${right.x+this.bleed} ${right.y-height-(this.tileH / 2)}`\r\n\t\tlet blockTopTop = `${top.x} ${top.y-height-(this.tileH / 2)}`\r\n\r\n\t\tlet html = `<g style=\"z-index:${id};\"><path fill=\"${darkestColor}\"\r\n\t\t\t\t\td=\"M${leftWallLeftTop} \r\n\t\t\t\t\tL${leftWallLeftBottom} \r\n\t\t\t\t\tL${leftWallRightBottom} \r\n\t\t\t\t\tL${leftWallRightTop} \r\n\t\t\t\t\tL${leftWallLeftTop} Z\" />\r\n\t\t\t\t\t<path fill=\"${regularColor}\"\r\n\t\t\t\t\td=\"M${rightWallLeftTop} \r\n\t\t\t\t\tL${rightWallLeftBottom} \r\n\t\t\t\t\tL${rightWallRightBottom} \r\n\t\t\t\t\tL${rightWallRightTop} \r\n\t\t\t\t\tL${rightWallLeftTop} Z\" />\r\n\t\t\t\t\t<path fill=\"${highlight}\"\r\n\t\t\t\t\td=\"M${blockTopLeft} \r\n\t\t\t\t\tL${blockTopBottom} \r\n\t\t\t\t\tL${blockTopRight} \r\n\t\t\t\t\tL${blockTopTop} \r\n\t\t\t\t\tL${blockTopLeft} Z\" /></g>`\r\n\r\n\t\tlet coords: Coords = { \"top\": top, \"left\": left, \"bottom\": bottom, \"right\": right }\r\n\r\n\t\treturn { html: html, coords: coords }\r\n\t}\r\n\r\n\tcreateSlopeBlock(xPos: number, yPos: number, tile: Tile, slopeDirection: string): TileTemplate {\r\n\r\n\t\tlet id = tile.id\r\n\t\tlet height = (tile.h * this.tileH) - this.tileH\r\n\t\tlet regularColor: string\r\n\t\tlet regularDarkerColor: string\r\n\t\tlet regularLighterColor: string\r\n\t\tlet shadowLight: string\r\n\t\tlet shadowHighlight: string\r\n\t\tlet shadow: string\r\n\t\tlet highlight: string\r\n\t\tlet almostDarkestColor: string\r\n\t\tlet almostLightestColor: string\r\n\t\tlet darkestColor: string\r\n\t\tlet lightestColor: string\r\n\r\n\t\tif (tile.tileColor.hex() !== this.config.buildingBaseColor.hex()) {\r\n\t\t\tregularColor = tile.tileColor.hex()\r\n\t\t\tregularDarkerColor = tile.tileColor.changeColorLightingString(-10)\r\n\t\t\tregularLighterColor = tile.tileColor.changeColorLightingString(10)\r\n\t\t\tshadowLight = tile.tileColor.changeColorLightingString(-20)\r\n\t\t\tshadowHighlight = tile.tileColor.changeColorLightingString(20)\r\n\t\t\tshadow = tile.tileColor.changeColorLightingString(-30)\r\n\t\t\thighlight = tile.tileColor.changeColorLightingString(30)\r\n\t\t\talmostDarkestColor = tile.tileColor.changeColorLightingString(-40)\r\n\t\t\talmostLightestColor = tile.tileColor.changeColorLightingString(40)\r\n\t\t\tdarkestColor = tile.tileColor.changeColorLightingString(-60)\r\n\t\t\tlightestColor = tile.tileColor.changeColorLightingString(50)\r\n\t\t} else {\r\n\t\t\tregularColor = this.config.buildingBaseColor.hex()\r\n\t\t\tregularDarkerColor = this.config.buildingBaseColor.changeColorLightingString(-10)\r\n\t\t\tregularLighterColor = this.config.buildingBaseColor.changeColorLightingString(10)\r\n\t\t\tshadowLight = this.config.buildingBaseColor.changeColorLightingString(-20)\r\n\t\t\tshadowHighlight = this.config.buildingBaseColor.changeColorLightingString(20)\r\n\t\t\tshadow = this.config.buildingBaseColor.changeColorLightingString(-30)\r\n\t\t\thighlight = this.config.buildingBaseColor.changeColorLightingString(30)\r\n\t\t\talmostDarkestColor = this.config.buildingBaseColor.changeColorLightingString(-40)\r\n\t\t\talmostLightestColor = this.config.buildingBaseColor.changeColorLightingString(40)\r\n\t\t\tdarkestColor = this.config.buildingBaseColor.changeColorLightingString(-60)\r\n\t\t\tlightestColor = this.config.buildingBaseColor.changeColorLightingString(50)\r\n\t\t}\r\n\r\n\t\tlet top: Position = { \"x\": Math.ceil(xPos + this.dimensions.horizontalWidthFromTop), \"y\": Math.ceil(yPos) }\r\n\t\tlet left: Position = { \"x\": Math.ceil(xPos), \"y\": Math.ceil(yPos + this.dimensions.verticalHeightFromTop) }\r\n\t\tlet bottom: Position = { \"x\": Math.ceil(xPos + this.dimensions.horizontalWidthFromBottom), \"y\": Math.ceil(yPos + this.dimensions.totalHeight) }\r\n\t\tlet right: Position = { \"x\": Math.ceil(xPos + this.dimensions.totalWidth), \"y\": Math.ceil(yPos + this.dimensions.verticalHeightFromBottom) }\r\n\r\n\t\tlet html = ''\r\n\t\tlet coords: Coords = { \"top\": top, \"left\": left, \"bottom\": bottom, \"right\": right }\r\n\r\n\t\tif (slopeDirection === 'n') {\r\n\r\n\t\t\tlet leftWallLeftTop = `${left.x-this.bleed} ${left.y-height-this.tileH}`\r\n\t\t\tlet leftWallLeftBottom = `${left.x-this.bleed} ${left.y-height+this.bleed}`\r\n\t\t\tlet leftWallRightBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\t\tlet leftWallRightTop = `${bottom.x} ${bottom.y-height-this.tileH}`\r\n\r\n\t\t\tlet rightWallLeftTop = `${bottom.x} ${bottom.y-height-this.tileH}`\r\n\t\t\tlet rightWallLeftBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\t\tlet rightWallRightBottom = `${right.x+this.bleed} ${right.y-height+this.bleed}`\r\n\r\n\t\t\tlet blockTopLeft = `${left.x-this.bleed} ${left.y-height-this.tileH}`\r\n\t\t\tlet blockTopBottom = `${bottom.x} ${bottom.y-height-this.tileH}`\r\n\t\t\tlet blockTopRight = `${right.x+this.bleed} ${right.y-height+this.bleed}`\r\n\t\t\tlet blockTopTop = `${top.x} ${top.y-height}`\r\n\r\n\t\t\thtml = `<g style=\"z-index:${id};\">\r\n\t\t\t\t\t\t\t<path fill=\"${shadow}\"\r\n\t\t\t\t\t\t\td=\"M${leftWallLeftTop} \r\n\t\t\t\t\t\t\tL${leftWallLeftBottom} \r\n\t\t\t\t\t\t\tL${leftWallRightBottom} \r\n\t\t\t\t\t\t\tL${leftWallRightTop} \r\n\t\t\t\t\t\t\tL${leftWallLeftTop} Z\" />\r\n\t\t\t\t\t\t\t<path fill=\"${regularColor}\"\r\n\t\t\t\t\t\t\td=\"M${rightWallLeftTop}\r\n\t\t\t\t\t\t\tL${rightWallLeftBottom}\r\n\t\t\t\t\t\t\tL${rightWallRightBottom}\r\n\t\t\t\t\t\t\tL${rightWallLeftTop} Z\" />\r\n\t\t\t\t\t\t\t<path fill=\"${lightestColor}\"\r\n\t\t\t\t\t\t\td=\"M${blockTopLeft}\r\n\t\t\t\t\t\t\tL${blockTopBottom}\r\n\t\t\t\t\t\t\tL${blockTopRight}\r\n\t\t\t\t\t\t\tL${blockTopTop}\r\n\t\t\t\t\t\t\tL${blockTopLeft} Z\" />\r\n\t\t\t\t\t\t</g>`\r\n\t\t}\r\n\r\n\t\tif (slopeDirection === 'nw') {\r\n\r\n\t\t\tconsole.log('northwest')\r\n\r\n\t\t\tlet leftWallLeftTop = `${left.x-this.bleed} ${left.y-height}`\r\n\t\t\tlet leftWallLeftBottom = `${left.x-this.bleed} ${left.y-height+this.bleed}`\r\n\t\t\tlet leftWallRightBottom = `${bottom.x} ${bottom.y-height-this.tileH+this.bleed}`\r\n\r\n\t\t\tlet blockTopLeft = `${left.x-this.bleed} ${left.y-height+this.bleed}`\r\n\t\t\tlet blockTopBottom = `${bottom.x} ${bottom.y-height-this.tileH+this.bleed}`\r\n\t\t\tlet blockTopTop = `${top.x} ${top.y-height}`\r\n\r\n\t\t\tlet blockRightBottom = `${bottom.x} ${bottom.y-height-this.tileH}`\r\n\t\t\tlet blockRightRight = `${right.x+this.bleed} ${right.y-height+this.bleed}`\r\n\t\t\tlet blockRightTop = `${top.x} ${top.y-height}`\r\n\r\n\t\t\thtml = `<g style=\"z-index:${id};\">\r\n\t\t\t\t\t\t\t<path fill=\"${darkestColor}\"\r\n\t\t\t\t\t\t\td=\"M${leftWallLeftTop}\r\n\t\t\t\t\t\t\tL${leftWallLeftBottom}\r\n\t\t\t\t\t\t\tL${leftWallRightBottom}\r\n\t\t\t\t\t\t\tL${leftWallLeftTop} Z\" />\r\n\t\t\t\t\t\t\t<path fill=\"${regularDarkerColor}\"\r\n\t\t\t\t\t\t\td=\"M${blockTopLeft}\r\n\t\t\t\t\t\t\tL${blockTopBottom}\r\n\t\t\t\t\t\t\tL${blockTopTop}\r\n\t\t\t\t\t\t\tL${blockTopLeft} Z\" />\r\n\t\t\t\t\t\t\t<path fill=\"${lightestColor}\"\r\n\t\t\t\t\t\t\td=\"M${blockRightBottom}\r\n\t\t\t\t\t\t\tL${blockRightRight}\r\n\t\t\t\t\t\t\tL${blockRightTop}\r\n\t\t\t\t\t\t\tL${blockRightBottom} Z\" />\r\n\t\t\t\t\t\t</g>`\r\n\t\t}\r\n\r\n\t\tif (slopeDirection === 's') {\r\n\r\n\t\t\tlet rightWallLeftBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\t\tlet rightWallRightBottom = `${right.x+this.bleed} ${right.y-height+this.bleed}`\r\n\t\t\tlet rightWallRightTop = `${right.x+this.bleed} ${right.y-height-this.tileH}`\r\n\r\n\t\t\tlet blockTopLeft = `${left.x-this.bleed} ${left.y-height+this.bleed}`\r\n\t\t\tlet blockTopBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\t\tlet blockTopRight = `${right.x+this.bleed} ${right.y-height-this.tileH+this.bleed}`\r\n\t\t\tlet blockTopTop = `${top.x} ${top.y-height-this.tileH}`\r\n\r\n\t\t\thtml = `<g style=\"z-index:${id};\">\r\n\t\t\t\t\t\t\t<path fill=\"${regularColor}\"\r\n\t\t\t\t\t\t\td=\"M${rightWallLeftBottom}\r\n\t\t\t\t\t\t\tL${rightWallRightBottom}\r\n\t\t\t\t\t\t\tL${rightWallRightTop}\r\n\t\t\t\t\t\t\tL${rightWallLeftBottom} Z\" />\r\n\t\t\t\t\t\t\t<path fill=\"${shadow}\"\r\n\t\t\t\t\t\t\td=\"M${blockTopLeft}\r\n\t\t\t\t\t\t\tL${blockTopBottom}\r\n\t\t\t\t\t\t\tL${blockTopRight}\r\n\t\t\t\t\t\t\tL${blockTopTop}\r\n\t\t\t\t\t\t\tL${blockTopLeft} Z\" />\r\n\t\t\t\t\t\t</g>`\r\n\t\t}\r\n\r\n\t\tif (slopeDirection === 'se') {\r\n\r\n\t\t\tlet blockLeftLeft = `${left.x-this.bleed} ${left.y-height+this.bleed}`\r\n\t\t\tlet blockLeftBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\t\tlet blockLeftTop = `${top.x} ${top.y-height-this.tileH}`\r\n\r\n\t\t\tlet blockRightBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\t\tlet blockRightRight = `${right.x+this.bleed} ${right.y-height+this.bleed}`\r\n\t\t\tlet blockRightTop = `${top.x} ${top.y-height-this.tileH}`\r\n\r\n\t\t\thtml = `<g style=\"z-index:${id};\">\r\n\t\t\t\t\t\t<path fill=\"${shadow}\"\r\n\t\t\t\t\t\td=\"M${blockLeftLeft}\r\n\t\t\t\t\t\tL${blockLeftBottom}\r\n\t\t\t\t\t\tL${blockLeftTop}\r\n\t\t\t\t\t\tL${blockLeftLeft} Z\" />\r\n\t\t\t\t\t\t<path fill=\"${regularDarkerColor}\"\r\n\t\t\t\t\t\td=\"M${blockRightRight}\r\n\t\t\t\t\t\tL${blockRightBottom}\r\n\t\t\t\t\t\tL${blockRightTop}\r\n\t\t\t\t\t\tL${blockRightRight} Z\" />\r\n\t\t\t\t\t</g>`\r\n\t\t}\r\n\r\n\t\tif (slopeDirection === 'e') {\r\n\r\n\t\t\tlet leftWallLeftTop = `${left.x-this.bleed} ${left.y-height-this.tileH}`\r\n\t\t\tlet leftWallLeftBottom = `${left.x-this.bleed} ${left.y-height+this.bleed}`\r\n\t\t\tlet leftWallRightBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\r\n\t\t\tlet blockTopLeft = `${left.x-this.bleed} ${left.y-height-this.tileH+this.bleed}`\r\n\t\t\tlet blockTopBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\t\tlet blockTopRight = `${right.x+this.bleed} ${right.y-height+this.bleed}`\r\n\t\t\tlet blockTopTop = `${top.x} ${top.y-height-this.tileH}`\r\n\r\n\t\t\thtml = `<g style=\"z-index:${id};\">\r\n\t\t\t\t\t\t\t<path fill=\"${darkestColor}\"\r\n\t\t\t\t\t\t\td=\"M${leftWallLeftTop}\r\n\t\t\t\t\t\t\tL${leftWallLeftBottom}\r\n\t\t\t\t\t\t\tL${leftWallRightBottom}\r\n\t\t\t\t\t\t\tL${leftWallLeftTop} Z\" />\r\n\t\t\t\t\t\t\t<path fill=\"${regularDarkerColor}\"\r\n\t\t\t\t\t\t\td=\"M${blockTopLeft}\r\n\t\t\t\t\t\t\tL${blockTopBottom}\r\n\t\t\t\t\t\t\tL${blockTopRight}\r\n\t\t\t\t\t\t\tL${blockTopTop}\r\n\t\t\t\t\t\t\tL${blockTopLeft} Z\" />\r\n\t\t\t\t\t\t</g>`\r\n\t\t}\r\n\r\n\t\tif (slopeDirection === 'ne') {\r\n\r\n\t\t\tlet leftWallLeftTop = `${left.x-this.bleed} ${left.y-height-this.tileH}`\r\n\t\t\tlet leftWallLeftBottom = `${left.x-this.bleed} ${left.y-height+this.bleed}`\r\n\t\t\tlet leftWallRightBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\r\n\t\t\tlet blockBottomLeft = `${left.x-this.bleed} ${left.y-height-this.tileH+this.bleed}`\r\n\t\t\tlet blockBottomRight = `${right.x+this.bleed} ${right.y-height+this.bleed}`\r\n\t\t\tlet blockBottomTop = `${top.x} ${top.y-height}`\r\n\r\n\t\t\tlet blockTopLeft = `${left.x-this.bleed} ${left.y-height-this.tileH+this.bleed}`\r\n\t\t\tlet blockTopBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\t\tlet blockTopRight = `${right.x+this.bleed} ${right.y-height+this.bleed}`\r\n\r\n\t\t\thtml = `<g style=\"z-index:${id};\">\r\n\t\t\t\t\t\t<path fill=\"${darkestColor}\"\r\n\t\t\t\t\t\td=\"M${leftWallLeftTop}\r\n\t\t\t\t\t\tL${leftWallLeftBottom}\r\n\t\t\t\t\t\tL${leftWallRightBottom}\r\n\t\t\t\t\t\tL${leftWallLeftTop} Z\" />\r\n\t\t\t\t\t\t<path fill=\"${regularDarkerColor}\"\r\n\t\t\t\t\t\td=\"M${blockTopLeft}\r\n\t\t\t\t\t\tL${blockTopBottom}\r\n\t\t\t\t\t\tL${blockTopRight}\r\n\t\t\t\t\t\tL${blockTopLeft} Z\" />\r\n\t\t\t\t\t\t<path fill=\"${lightestColor}\"\r\n\t\t\t\t\t\td=\"M${blockBottomLeft}\r\n\t\t\t\t\t\tL${blockBottomTop}\r\n\t\t\t\t\t\tL${blockBottomRight}\r\n\t\t\t\t\t\tL${blockBottomLeft} Z\" />\r\n\t\t\t\t\t</g>`\r\n\t\t}\r\n\r\n\t\tif (slopeDirection === 'w') {\r\n\r\n\t\t\tlet leftWallLeftTop = `${left.x-this.bleed} ${left.y-height}`\r\n\t\t\tlet leftWallLeftBottom = `${left.x-this.bleed} ${left.y-height+this.bleed}`\r\n\t\t\tlet leftWallRightBottom = `${bottom.x} ${bottom.y-height-this.tileH+this.bleed}`\r\n\r\n\t\t\tlet blockTopLeft = `${left.x-this.bleed} ${left.y-height+this.bleed}`\r\n\t\t\tlet blockTopBottom = `${bottom.x} ${bottom.y-height-this.tileH+this.bleed}`\r\n\t\t\tlet blockTopRight = `${right.x+this.bleed} ${right.y-height-this.tileH+this.bleed}`\r\n\t\t\tlet blockTopTop = `${top.x} ${top.y-height}`\r\n\r\n\t\t\thtml = `<g style=\"z-index:${id};\">\r\n\t\t\t\t\t\t\t<path fill=\"${darkestColor}\"\r\n\t\t\t\t\t\t\td=\"M${leftWallLeftTop}\r\n\t\t\t\t\t\t\tL${leftWallLeftBottom}\r\n\t\t\t\t\t\t\tL${leftWallRightBottom}\r\n\t\t\t\t\t\t\tL${leftWallLeftTop} Z\" />\r\n\t\t\t\t\t\t\t<path fill=\"${regularDarkerColor}\"\r\n\t\t\t\t\t\t\td=\"M${blockTopLeft}\r\n\t\t\t\t\t\t\tL${blockTopBottom}\r\n\t\t\t\t\t\t\tL${blockTopRight}\r\n\t\t\t\t\t\t\tL${blockTopTop}\r\n\t\t\t\t\t\t\tL${blockTopLeft} Z\" />\r\n\t\t\t\t\t\t</g>`\r\n\t\t}\r\n\r\n\t\tif (slopeDirection === 'sw') {\r\n\r\n\t\t\tlet rightWallLeftBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\t\tlet rightWallRightBottom = `${right.x+this.bleed} ${right.y-height+this.bleed}`\r\n\t\t\tlet rightWallRightTop = `${right.x+this.bleed} ${right.y-height-this.tileH}`\r\n\r\n\t\t\tlet blockTopLeft = `${left.x-this.bleed} ${left.y-height+this.bleed}`\r\n\t\t\tlet blockTopBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\t\tlet blockTopRight = `${right.x+this.bleed} ${right.y-height-this.tileH+this.bleed}`\r\n\t\t\tlet blockTopTop = `${top.x} ${top.y-height}`\r\n\r\n\t\t\thtml = `<g style=\"z-index:${id};\">\r\n\t\t\t\t\t\t\t<path fill=\"${regularColor}\"\r\n\t\t\t\t\t\t\td=\"M${rightWallLeftBottom}\r\n\t\t\t\t\t\t\tL${rightWallRightBottom}\r\n\t\t\t\t\t\t\tL${rightWallRightTop}\r\n\t\t\t\t\t\t\tL${rightWallLeftBottom} Z\" />\r\n\t\t\t\t\t\t\t<path fill=\"${regularDarkerColor}\"\r\n\t\t\t\t\t\t\td=\"M${blockTopLeft}\r\n\t\t\t\t\t\t\tL${blockTopTop}\r\n\t\t\t\t\t\t\tL${blockTopRight}\r\n\t\t\t\t\t\t\tL${blockTopLeft} Z\" />\r\n\t\t\t\t\t\t\t<path fill=\"${shadow}\"\r\n\t\t\t\t\t\t\td=\"M${blockTopLeft}\r\n\t\t\t\t\t\t\tL${blockTopBottom}\r\n\t\t\t\t\t\t\tL${blockTopRight}\r\n\t\t\t\t\t\t\tL${blockTopLeft} Z\" />\r\n\t\t\t\t\t\t</g>`\r\n\t\t}\r\n\r\n\t\treturn { html: html, coords: coords }\r\n\t}\r\n\r\n\tcreatePillarBlock(xPos: number, yPos: number, tile: Tile): TileTemplate {\r\n\r\n\t\tlet id = tile.id\r\n\t\tlet tileWidth = this.config.tileWidth\r\n\t\tlet height = (tile.h * this.tileH) - this.tileH\r\n\r\n\t\tlet regularColor\r\n\t\tlet highlight\r\n\t\tlet darkestColor\r\n\r\n\t\tif (tile.tileColor.hex() !== this.config.buildingBaseColor.hex()) {\r\n\t\t\tregularColor = tile.tileColor.hex()\r\n\t\t\thighlight = tile.tileColor.changeColorLightingString(30)\r\n\t\t\tdarkestColor = tile.tileColor.changeColorLightingString(-60)\r\n\t\t} else {\r\n\t\t\tregularColor = this.config.buildingBaseColor.hex()\r\n\t\t\thighlight = this.config.buildingBaseColor.changeColorLightingString(30)\r\n\t\t\tdarkestColor = this.config.buildingBaseColor.changeColorLightingString(-60)\r\n\t\t}\t\r\n\r\n\t\tlet top: Position = { \"x\": Math.ceil(xPos + this.dimensions.horizontalWidthFromTop), \"y\": Math.ceil(yPos + this.config.topMargin ) }\r\n\t\tlet left: Position = { \"x\": Math.ceil(xPos), \"y\": Math.ceil(yPos + this.dimensions.verticalHeightFromTop + this.config.topMargin ) }\r\n\t\tlet bottom: Position = { \"x\": Math.ceil(xPos + this.dimensions.horizontalWidthFromBottom), \"y\": Math.ceil(yPos + this.dimensions.totalHeight + this.config.topMargin ) }\r\n\t\tlet right: Position = { \"x\": Math.ceil(xPos + this.dimensions.totalWidth), \"y\": Math.ceil(yPos + this.dimensions.verticalHeightFromBottom + this.config.topMargin ) }\r\n\r\n\t\tlet leftWallLeftTop = `${left.x-this.bleed + (tileWidth / 3)} ${left.y-height-this.tileH}`\r\n\t\tlet leftWallLeftBottom = `${left.x-this.bleed + (tileWidth / 3)} ${left.y-height}`\r\n\r\n\t\tlet rightWallRightBottom = `${right.x+this.bleed - (tileWidth / 3)} ${right.y-height}`\r\n\t\tlet rightWallRightTop = `${right.x+this.bleed - (tileWidth / 3)} ${right.y-height-this.tileH}`\r\n\r\n\t\tlet leftWallBezier = `${left.x-this.bleed + (tileWidth / 3) + (tileWidth / 12)} ${bottom.y-height}`\r\n\t\tlet rightWallBezier = `${right.x-this.bleed - (tileWidth / 3) - (tileWidth / 12)} ${bottom.y-height}`\r\n\r\n\t\tlet blockTopLeft = `${left.x-this.bleed} ${left.y-height-this.tileH}`\r\n\t\tlet blockTopBottom = `${bottom.x} ${bottom.y-height-this.tileH}`\r\n\t\tlet blockTopRight = `${right.x+this.bleed} ${right.y-height-this.tileH}`\r\n\t\tlet blockTopTop = `${top.x} ${top.y-height-this.tileH}`\r\n\r\n\t\tlet html = `<g style=\"z-index:${id};\">`\r\n\t\t\thtml += `<defs>${this.calculations.addGradient(\"pillarGradient\", darkestColor, regularColor)}</defs>` \r\n\t\t\thtml += `<path fill=\"url(#pillarGradient)\"`\r\n\t\t\thtml += ` d=\"M ${leftWallLeftTop} `\r\n\t\t\thtml += `L ${leftWallLeftBottom} `\r\n\t\t\thtml += `C ${leftWallBezier}, ${rightWallBezier}, ${rightWallRightBottom} `\r\n\t\t\thtml += `L ${rightWallRightTop} `\r\n\t\t\thtml += `L ${leftWallLeftTop} Z\" /></g>`\r\n\r\n\t\tlet coords: Coords = { \"top\": top, \"left\": left, \"bottom\": bottom, \"right\": right }\r\n\r\n\t\treturn { html: html, coords: coords }\r\n\t}\r\n\r\n\tcreateWindow(xPos: number, yPos: number, tile: Tile, columnInfo: Column): TileTemplate {\r\n\r\n\t\tlet id = tile.id\r\n\t\tlet height = (tile.h * this.tileH) - this.tileH\r\n\t\tlet regularColor\r\n\t\tlet darkestColor\r\n\t\tlet highlight\r\n\t\tlet highlightLeft\r\n\t\tlet highlightRight\r\n\t\tlet html\r\n\r\n\t\tif (tile.tileColor.hex() !== this.config.buildingBaseColor.hex()) {\r\n\t\t\tregularColor = tile.tileColor.hex()\r\n\t\t\thighlight = tile.tileColor.changeColorLightingString(30)\r\n\t\t\tdarkestColor = tile.tileColor.changeColorLightingString(-60)\r\n\t\t\thighlightLeft = tile.tileColor.changeColorLightingString(15)\r\n\t\t\thighlightRight = tile.tileColor.changeColorLightingString(30)\r\n\t\t} else {\r\n\t\t\tregularColor = this.config.buildingBaseColor.hex()\r\n\t\t\thighlight = this.config.buildingBaseColor.changeColorLightingString(30)\r\n\t\t\tdarkestColor = this.config.buildingBaseColor.changeColorLightingString(-60)\r\n\t\t\thighlightLeft = this.config.buildingBaseColor.changeColorLightingString(15)\r\n\t\t\thighlightRight = this.config.buildingBaseColor.changeColorLightingString(30)\r\n\t\t}\r\n\r\n\t\tlet top: Position = { x: Math.ceil(xPos + this.dimensions.horizontalWidthFromTop), y: Math.ceil(yPos + this.config.topMargin ) }\r\n\t\tlet left: Position = { x: Math.ceil(xPos), y: Math.ceil(yPos + this.dimensions.verticalHeightFromTop + this.config.topMargin ) }\r\n\t\tlet bottom: Position = { x: Math.ceil(xPos + this.dimensions.horizontalWidthFromBottom), y: Math.ceil(yPos + this.dimensions.totalHeight + this.config.topMargin ) }\r\n\t\tlet right: Position = { x: Math.ceil(xPos + this.dimensions.totalWidth), y: Math.ceil(yPos + this.dimensions.verticalHeightFromBottom + this.config.topMargin ) }\r\n\r\n\t\tlet size = 4\r\n\r\n\t\tif (tile.options.windowed === 2) {\r\n\t\t\tsize = 6\r\n\t\t}\r\n\r\n\t\tlet windowBorderWidth = (top.x - left.x) / 10\t\t\r\n\t\tlet sizeModifierY = (bottom.y - top.y) / size\r\n\t\tlet isometricHeightDifferenceLeft = (bottom.y - left.y) / size\r\n\t\tlet isometricHeightDifferenceRight = (bottom.y - right.y) / size\r\n\r\n\t\thtml += `<g style=\"z-index:${id+columnInfo.height};\">`\r\n\r\n\t\tif (columnInfo.edge.bottom) {\r\n\r\n\t\t\tlet sizeModifierX = (top.x - left.x) / size\r\n\r\n\t\t\tlet leftEdge = left.x + sizeModifierX\r\n\t\t\tlet rightEdge = top.x - sizeModifierX\r\n\t\t\tlet topEdge = top.y + sizeModifierY + 2\r\n\t\t\tlet bottomEdge = top.y + this.tileH - sizeModifierY\r\n\r\n\t\t\tlet windowInsideLeftTop = `${leftEdge} ${topEdge - height - isometricHeightDifferenceLeft}`\r\n\t\t\tlet windowInsideLeftBottom = `${leftEdge} ${bottomEdge - height - isometricHeightDifferenceLeft}`\r\n\t\t\tlet windowInsideRightBottom = `${rightEdge} ${bottomEdge - height}`\r\n\t\t\tlet windowInsideRightTop = `${rightEdge} ${topEdge - height}`\r\n\r\n\t\t\thtml += `<path fill=\"#111\"\r\n\t\t\t\t\t\td=\"M${windowInsideLeftTop} \r\n\t\t\t\t\t\tL${windowInsideLeftBottom} \r\n\t\t\t\t\t\tL${windowInsideRightBottom} \r\n\t\t\t\t\t\tL${windowInsideRightTop} \r\n\t\t\t\t\t\tL${windowInsideLeftTop} Z\" />`\r\n\r\n\t\t} \r\n\r\n\t\tif (columnInfo.edge.right) {\r\n\r\n\t\t\tlet sizeModifierX = (right.x - top.x) / size\r\n\r\n\t\t\tlet leftEdge = top.x + sizeModifierX\r\n\t\t\tlet rightEdge = right.x - sizeModifierX\r\n\t\t\tlet topEdge = top.y + sizeModifierY\r\n\t\t\tlet bottomEdge = top.y + this.tileH - sizeModifierY\r\n\r\n\t\t\tlet windowInsideLeftTop = `${leftEdge} ${topEdge - height}`\r\n\t\t\tlet windowInsideLeftBottom = `${leftEdge} ${bottomEdge - height}`\r\n\t\t\tlet windowInsideRightBottom = `${rightEdge} ${bottomEdge - height - isometricHeightDifferenceRight}`\r\n\t\t\tlet windowInsideRightTop = `${rightEdge} ${topEdge - height - isometricHeightDifferenceRight}`\r\n\r\n\t\t\thtml += `<path fill=\"#111\"\r\n\t\t\t\t\t\td=\"M${windowInsideLeftTop} \r\n\t\t\t\t\t\tL${windowInsideLeftBottom} \r\n\t\t\t\t\t\tL${windowInsideRightBottom} \r\n\t\t\t\t\t\tL${windowInsideRightTop} \r\n\t\t\t\t\t\tL${windowInsideLeftTop} Z\" />`\r\n\t\t}\r\n\r\n\t\thtml += `</g>`\r\n\r\n\t\tlet coords: Coords = { top: top, left: left, bottom: bottom, right: right }\r\n\r\n\t\treturn { html: html, coords: coords }\r\n\t}\r\n\r\n\tcreateHalfArch(xPos: number, yPos: number, tile: Tile, orientation: string): TileTemplate {\r\n\r\n\t\tlet id = tile.id\r\n\t\tlet height = (tile.h * this.tileH) - this.tileH\r\n\t\tlet regularColor\r\n\t\tlet darkestColor\r\n\t\tlet highlight\r\n\t\tlet highlightLeft\r\n\t\tlet highlightRight\r\n\t\tlet html\r\n\r\n\t\tif (tile.tileColor.hex() !== this.config.buildingBaseColor.hex()) {\r\n\t\t\tregularColor = tile.tileColor.hex()\r\n\t\t\thighlight = tile.tileColor.changeColorLightingString(30)\r\n\t\t\tdarkestColor = tile.tileColor.changeColorLightingString(-60)\r\n\t\t\thighlightLeft = tile.tileColor.changeColorLightingString(15)\r\n\t\t\thighlightRight = tile.tileColor.changeColorLightingString(30)\r\n\t\t} else {\r\n\t\t\tregularColor = this.config.buildingBaseColor.hex()\r\n\t\t\thighlight = this.config.buildingBaseColor.changeColorLightingString(30)\r\n\t\t\tdarkestColor = this.config.buildingBaseColor.changeColorLightingString(-60)\r\n\t\t\thighlightLeft = this.config.buildingBaseColor.changeColorLightingString(15)\r\n\t\t\thighlightRight = this.config.buildingBaseColor.changeColorLightingString(30)\r\n\t\t}\r\n\r\n\t\tlet top: Position = { x: Math.ceil(xPos + this.dimensions.horizontalWidthFromTop), y: Math.ceil(yPos + this.config.topMargin ) }\r\n\t\tlet left: Position = { x: Math.ceil(xPos), y: Math.ceil(yPos + this.dimensions.verticalHeightFromTop + this.config.topMargin ) }\r\n\t\tlet bottom: Position = { x: Math.ceil(xPos + this.dimensions.horizontalWidthFromBottom), y: Math.ceil(yPos + this.dimensions.totalHeight + this.config.topMargin ) }\r\n\t\tlet right: Position = { x: Math.ceil(xPos + this.dimensions.totalWidth), y: Math.ceil(yPos + this.dimensions.verticalHeightFromBottom + this.config.topMargin ) }\r\n\r\n\t\tlet halfTileWidth = ((right.x - bottom.x) / 3)\r\n\r\n\t\tif (orientation === 'right-bottom') {\r\n\r\n\t\t\tlet leftWallLeftTop = `${left.x-this.bleed} ${left.y-height-this.tileH}`\r\n\t\t\tlet leftWallLeftBottom = `${left.x-this.bleed} ${left.y-height+this.bleed}`\r\n\t\t\tlet leftWallRightBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\t\tlet leftWallRightTop = `${bottom.x} ${bottom.y-height-this.tileH}`\r\n\r\n\t\t\tlet rightWallLeftTop = `${bottom.x} ${bottom.y-height-this.tileH}`\r\n\t\t\tlet rightWallLeftBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\t\tlet rightWallLeftBottomBezier = `${bottom.x} ${bottom.y-height-(this.tileH * 0.5)}`\r\n\t\t\tlet rightWallRightTopBezier = `${bottom.x + (halfTileWidth*0.4)} ${bottom.y-height-this.tileH}`\r\n\t\t\tlet rightWallRightTop = `${right.x+this.bleed} ${right.y-height-this.tileH}`\r\n\r\n\t\t\tlet blockTopLeft = `${left.x-this.bleed} ${left.y-height-this.tileH}`\r\n\t\t\tlet blockTopBottom = `${bottom.x} ${bottom.y-height-this.tileH}`\r\n\t\t\tlet blockTopRight = `${right.x+this.bleed} ${right.y-height-this.tileH}`\r\n\t\t\tlet blockTopTop = `${top.x} ${top.y-height-this.tileH}`\r\n\r\n\t\t\thtml = `<g style=\"z-index:${id};\">\r\n\t\t\t\t\t\t<path fill=\"${darkestColor}\"\r\n\t\t\t\t\t\td=\"M${leftWallLeftTop} \r\n\t\t\t\t\t\tL${leftWallLeftBottom} \r\n\t\t\t\t\t\tL${leftWallRightBottom} \r\n\t\t\t\t\t\tL${leftWallRightTop} \r\n\t\t\t\t\t\tL${leftWallLeftTop} Z\" />\r\n\t\t\t\t\t\t<path fill=\"${regularColor}\"\r\n\t\t\t\t\t\td=\"M${rightWallLeftTop} \r\n\t\t\t\t\t\tL${rightWallLeftBottom}\r\n\t\t\t\t\t\tC${rightWallLeftBottomBezier}, ${rightWallRightTopBezier}, ${rightWallRightTop}\r\n\t\t\t\t\t\tL${rightWallLeftTop} Z\" />\r\n\t\t\t\t\t\t<path fill=\"${highlight}\"\r\n\t\t\t\t\t\td=\"M${blockTopLeft} \r\n\t\t\t\t\t\tL${blockTopBottom} \r\n\t\t\t\t\t\tL${blockTopRight} \r\n\t\t\t\t\t\tL${blockTopTop} \r\n\t\t\t\t\t\tL${blockTopLeft} Z\" />\r\n\t\t\t\t\t</g>`\r\n\r\n\t\t} \r\n\r\n\t\tif (orientation === 'right-top') {\r\n\r\n\t\t\tlet leftWallLeftTop = `${left.x-this.bleed} ${left.y-height-this.tileH}`\r\n\t\t\tlet leftWallLeftBottom = `${left.x-this.bleed} ${left.y-height+this.bleed}`\r\n\t\t\tlet leftWallRightBottom = `${bottom.x} ${bottom.y-height+this.bleed}`\r\n\t\t\tlet leftWallRightTop = `${bottom.x} ${bottom.y-height-this.tileH}`\r\n\r\n\t\t\tlet rightWallLeftTop = `${bottom.x} ${bottom.y-height-this.tileH}`\r\n\t\t\tlet rightWallLeftTopBezier = `${right.x+this.bleed-(halfTileWidth*0.3)} ${right.y-height-(this.tileH*0.7)}`\r\n\t\t\tlet rightWallRightBottomBezier = `${right.x} ${right.y-height-(this.tileH*0.4)}`\r\n\t\t\tlet rightWallRightBottom = `${right.x+this.bleed} ${right.y-height+this.bleed}`\r\n\t\t\tlet rightWallRightTop = `${right.x+this.bleed} ${right.y-height-this.tileH}`\r\n\r\n\t\t\tlet blockTopLeft = `${left.x-this.bleed} ${left.y-height-this.tileH}`\r\n\t\t\tlet blockTopBottom = `${bottom.x} ${bottom.y-height-this.tileH}`\r\n\t\t\tlet blockTopRight = `${right.x+this.bleed} ${right.y-height-this.tileH}`\r\n\t\t\tlet blockTopTop = `${top.x} ${top.y-height-this.tileH}`\r\n\r\n\t\t\tlet blockBackRightBottom = `${right.x+this.bleed} ${right.y-height+this.bleed}`\r\n\t\t\tlet blockBackLeftBottom = `${right.x+this.bleed} ${right.y-height-this.tileH}`\r\n\t\t\tlet blockBackLeftTop = `${top.x-this.bleed} ${top.y-height-this.tileH}`\r\n\t\t\tlet blockBackRightTop = `${top.x-this.bleed} ${top.y-height}`\r\n\r\n\t\t\thtml = `<g style=\"z-index:${id};\">\r\n\t\t\t\t\t\t<path fill=\"${darkestColor}\"\r\n\t\t\t\t\t\td=\"M${blockBackRightBottom} \r\n\t\t\t\t\t\tL${blockBackLeftBottom} \r\n\t\t\t\t\t\tL${blockBackLeftTop} \r\n\t\t\t\t\t\tL${blockBackRightTop} \r\n\t\t\t\t\t\tL${blockBackRightBottom} Z\" />\r\n\t\t\t\t\t\t<path fill=\"${regularColor}\"\r\n\t\t\t\t\t\td=\"M${rightWallLeftTop} \r\n\t\t\t\t\t\tC${rightWallLeftTopBezier}, ${rightWallRightBottomBezier}, ${rightWallRightBottom}\r\n\t\t\t\t\t\tL${rightWallRightTop} \r\n\t\t\t\t\t\tL${rightWallLeftTop} Z\" />\r\n\t\t\t\t\t\t<path fill=\"${highlight}\"\r\n\t\t\t\t\t\td=\"M${blockTopLeft} \r\n\t\t\t\t\t\tL${blockTopBottom} \r\n\t\t\t\t\t\tL${blockTopRight} \r\n\t\t\t\t\t\tL${blockTopTop} \r\n\t\t\t\t\t\tL${blockTopLeft} Z\" />\r\n\t\t\t\t\t</g>`\r\n\t\t}\r\n\r\n\t\tlet coords: Coords = { top: top, left: left, bottom: bottom, right: right }\r\n\r\n\t\treturn { html: html, coords: coords }\r\n\t}\r\n}","import { Color } from './mapGenerationFunctions.component'\r\n\r\nexport class Tile {\r\n\t\r\n\t_id: number\r\n\t_x: number\r\n\t_y: number\r\n\t_h: number\r\n\t_tileType: TileType\r\n\t_tileColor: Color\r\n\t_options?: TileOptions\r\n\r\n\tconstructor(\t\t\t\r\n\t\t\tid: number,\r\n\t\t\tx: number,\r\n\t\t\ty: number,\r\n\t\t\th: number,\r\n\t\t\ttileType: TileType,\r\n\t\t\ttileColor: Color,\r\n\t\t\toptions?: TileOptions)\r\n\t{\r\n\t\tthis._id = id\r\n\t\tthis._x = x\r\n\t\tthis._y = y\r\n\t\tthis._h = h\r\n\t\tthis._tileType = tileType\r\n\t\tthis._tileColor = tileColor\r\n\r\n\t\tif (options) {\r\n\t\t\tthis._options = options\r\n\t\t}\r\n\t}\r\n\r\n\tget id(): number {\r\n\t\treturn this._id\r\n\t}\r\n\r\n\tget x(): number {\r\n\t\treturn this._x\r\n\t}\r\n\r\n\tget y(): number {\r\n\t\treturn this._y\r\n\t}\r\n\r\n\tget h(): number {\r\n\t\treturn this._h\r\n\t}\r\n\r\n\tget type(): TileType {\r\n\t\treturn this._tileType\r\n\t}\r\n\r\n\tget options(): TileOptions | undefined {\r\n\t\tif (this._options) {\r\n\t\t\treturn this._options\r\n\t\t} else {\r\n\t\t\treturn undefined\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getColor(): Color {\r\n\t\treturn this._tileColor\r\n\t}\r\n\r\n\tget tileColor(): Color {\r\n\t\treturn this._tileColor\r\n\t}\r\n\r\n\tset tileColor(color: Color) {\r\n\t\tthis._tileColor = color\r\n\t}\r\n\r\n\tset type(type: TileType) {\r\n\t\tthis._tileType = type\r\n\t}\r\n}\r\n\r\nexport interface TileOptions {\r\n\troof: boolean,\r\n\tpillar: boolean,\r\n\tslope: boolean,\r\n\twindowed: number,\r\n\ttower: boolean,\r\n\tstairs:\tboolean,\r\n\thalfArch: boolean,\r\n\twholeArch: boolean\r\n}\r\n\r\nexport enum TileType {\r\n\tNone = 'none',\r\n\tBody = 'body',\r\n\tTower = 'tower',\r\n\tHalfBlock = 'halfBlock',\r\n\tRoof = 'roof',\r\n\tGrass = 'grass',\r\n\tShadow = 'shadow'\r\n}\r\n"]}